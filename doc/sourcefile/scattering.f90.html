<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>scattering.f90 &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>scattering.f90
      <small>Source File</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 4.6% of total for source files.">135 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
          <li class="active">scattering.f90</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#progs-0">Programs</a>
        </h3>
      </div>
      <div id="progs-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html">SCATTERING</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/scattering.f90.html#src">scattering.f90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~scattering.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilescatteringf90EfferentGraph" width="641pt" height="497pt"
 viewBox="0.00 0.00 641.00 497.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~scattering.f90~~EfferentGraph" class="graph" transform="scale(1.71 1.71) rotate(0) translate(4 848.28)">
<title>sourcefile~~scattering.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-848.28 1095,-848.28 1095,4 -4,4"/>
<!-- sourcefile~scattering.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~scattering.f90</title>
<polygon fill="none" stroke="black" points="1091,-411 1005,-411 1005,-387 1091,-387 1091,-411"/>
<text text-anchor="middle" x="1048" y="-396.6" font-family="Helvetica,sans-Serif" font-size="10.50">scattering.f90</text>
</g>
<!-- sourcefile~input_reader_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~input_reader_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/input_reader_mod.f90.html" xlink:title="input_reader_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="768.5,-785 638.5,-785 638.5,-761 768.5,-761 768.5,-785"/>
<text text-anchor="middle" x="703.5" y="-770.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_reader_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~input_reader_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~input_reader_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-773C862.6,-805.21 796.56,-797.97 752.11,-787.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="752.68,-784.05 742.13,-785.03 750.99,-790.84 752.68,-784.05"/>
</g>
<!-- sourcefile~save_s_matrix_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~save_s_matrix_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/save_s_matrix_mod.f90.html" xlink:title="save_s_matrix_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="537.5,-686 400.5,-686 400.5,-662 537.5,-662 537.5,-686"/>
<text text-anchor="middle" x="469" y="-671.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~save_s_matrix_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~save_s_matrix_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1046.99,-411.19C1046.2,-465.05 1035.13,-682.87 909.5,-773"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-773C905.48,-774.45 561.43,-691.52 559,-691 554.34,-690.01 549.54,-689.01 544.69,-688.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="545.21,-684.56 534.72,-686.03 543.83,-691.43 545.21,-684.56"/>
</g>
<!-- sourcefile~state_to_state_cross_sections_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~state_to_state_cross_sections_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/state_to_state_cross_sections_mod.f90.html" xlink:title="state_to_state_cross_sections_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="812,-371 595,-371 595,-347 812,-347 812,-371"/>
<text text-anchor="middle" x="703.5" y="-356.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~state_to_state_cross_sections_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~state_to_state_cross_sections_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-359C880.24,-353.24 850.47,-351.04 822.32,-350.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="822.05,-347.24 812.04,-350.72 822.03,-354.24 822.05,-347.24"/>
</g>
<!-- sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~data_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/data_mod.f90.html" xlink:title="data_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="309.5,-410 223.5,-410 223.5,-386 309.5,-386 309.5,-410"/>
<text text-anchor="middle" x="266.5" y="-395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">data_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M702.5,-208C657.82,-182.05 519.05,-191.77 470,-208"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M468,-208C378.08,-237.75 307.56,-334.69 280.03,-377.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="277.06,-375.6 274.68,-385.92 282.98,-379.33 277.06,-375.6"/>
</g>
<!-- sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~array_operations_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/array_operations_mod.f90.html" xlink:title="array_operations_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="343,-530 190,-530 190,-506 343,-506 343,-530"/>
<text text-anchor="middle" x="266.5" y="-515.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-773C830.76,-827.21 797.99,-822.65 704.5,-832"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M702.5,-832C666.18,-835.63 407.65,-797.61 379,-775 373.99,-771.05 302.27,-600.87 276.57,-539.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="279.69,-538.04 272.6,-530.17 273.24,-540.75 279.69,-538.04"/>
</g>
<!-- sourcefile~boundary_conditions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~boundary_conditions_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/boundary_conditions_mod.f90.html" xlink:title="boundary_conditions_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="790,-274 617,-274 617,-250 790,-250 790,-274"/>
<text text-anchor="middle" x="703.5" y="-259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~boundary_conditions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~boundary_conditions_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-359C857.75,-348.49 857.9,-317.88 812,-296 796.42,-288.57 778.81,-282.23 762.43,-277.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="763,-273.62 752.41,-274.07 760.97,-280.32 763,-273.62"/>
</g>
<!-- sourcefile~unitarity_check_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~unitarity_check_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/unitarity_check_mod.f90.html" xlink:title="unitarity_check_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="540.5,-24 397.5,-24 397.5,0 540.5,0 540.5,-24"/>
<text text-anchor="middle" x="469" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~unitarity_check_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~unitarity_check_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1011.19,-386.98C983.65,-378.13 944.53,-366.4 909.5,-359"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-359C841.49,-345.05 867.91,-278.77 812,-241 770.59,-213.02 747.72,-233.1 704.5,-208"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M702.5,-208C617.29,-158.51 641.38,-93.06 559,-39 552.19,-34.53 544.6,-30.77 536.81,-27.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="537.84,-24.27 527.24,-24.07 535.4,-30.83 537.84,-24.27"/>
</g>
<!-- sourcefile~pes_matrix_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~pes_matrix_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/pes_matrix_mod.f90.html" xlink:title="pes_matrix_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="764,-329 643,-329 643,-305 764,-305 764,-329"/>
<text text-anchor="middle" x="703.5" y="-314.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_matrix_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~pes_matrix_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~pes_matrix_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-359C864.98,-350.01 854.55,-346.83 812,-338 799.81,-335.47 786.82,-332.86 774.23,-330.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="774.74,-326.91 764.25,-328.41 773.39,-333.78 774.74,-326.91"/>
</g>
<!-- sourcefile~radial_coupling_terms_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~radial_coupling_terms_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/radial_coupling_terms_mod.f90.html" xlink:title="radial_coupling_terms_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="559,-104 379,-104 379,-80 559,-80 559,-104"/>
<text text-anchor="middle" x="469" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~radial_coupling_terms_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~radial_coupling_terms_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M702.5,-208C638.98,-171.11 625.4,-157.42 559,-126 544.91,-119.33 529.13,-112.96 514.82,-107.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="515.77,-104.2 505.18,-104.02 513.35,-110.77 515.77,-104.2"/>
</g>
<!-- sourcefile~channels_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~channels_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/channels_mod.f90.html" xlink:title="channels_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="758.5,-451 648.5,-451 648.5,-427 758.5,-427 758.5,-451"/>
<text text-anchor="middle" x="703.5" y="-436.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~channels_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~channels_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-359C880.34,-353.26 871.81,-363.72 848,-378 828.86,-389.48 831.54,-402.22 812,-413 798.75,-420.31 783.47,-425.59 768.67,-429.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="767.45,-426.08 758.52,-431.78 769.06,-432.89 767.45,-426.08"/>
</g>
<!-- sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~physics_utilities_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/physics_utilities_mod.f90.html" xlink:title="physics_utilities_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="541.5,-450 396.5,-450 396.5,-426 541.5,-426 541.5,-450"/>
<text text-anchor="middle" x="469" y="-435.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">physics_utilities_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~physics_utilities_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.5,-359C864.98,-350.01 854.63,-371.55 812,-380 764.41,-389.43 752.6,-392.66 704.5,-399"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M702.5,-399C649.5,-405.98 590.05,-416 544.54,-424.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="543.68,-420.72 534.46,-425.94 544.92,-427.61 543.68,-420.72"/>
</g>
<!-- sourcefile~propagator_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~propagator_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/propagator_mod.f90.html" xlink:title="propagator_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="969,-411 848,-411 848,-387 969,-387 969,-411"/>
<text text-anchor="middle" x="908.5" y="-396.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">propagator_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~propagator_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~propagator_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1005,-399C996.88,-399 988.17,-399 979.44,-399"/>
<polygon fill="#ff0000" stroke="#ff0000" points="979.21,-395.5 969.21,-399 979.21,-402.5 979.21,-395.5"/>
</g>
<!-- sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~utility_functions_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/utility_functions_mod.f90.html" xlink:title="utility_functions_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="149.5,-182 4.5,-182 4.5,-158 149.5,-158 149.5,-182"/>
<text text-anchor="middle" x="77" y="-167.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scattering.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~scattering.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M702.5,-832C599.69,-842.39 571.25,-852.65 470,-832"/>
</g>
<!-- sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M693.72,-760.74C673.06,-732.6 618.57,-662.54 559,-620 487.61,-569.02 448.18,-592.94 379,-539 367.21,-529.81 310.59,-455.36 282.86,-418.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="285.6,-416.32 276.79,-410.43 280,-420.53 285.6,-416.32"/>
</g>
<!-- sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M646.59,-760.97C629.87,-756.98 611.58,-752.2 595,-747 578.62,-741.86 575.45,-737.9 559,-733 480.64,-709.66 446.09,-741.73 379,-695 322.61,-655.73 288.67,-577.82 274.79,-539.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="278.04,-538.51 271.41,-530.25 271.44,-540.84 278.04,-538.51"/>
</g>
<!-- sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M694.95,-760.67C676.23,-729.76 626.92,-646.15 595,-572 575,-525.53 595.44,-499.1 559,-464 555.42,-460.55 551.41,-457.56 547.12,-454.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="548.47,-451.71 537.99,-450.16 545.21,-457.91 548.47,-451.71"/>
</g>
<!-- sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M669.69,-785.09C615.19,-804.53 508.25,-839.8 470,-832"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M468,-832C427.86,-823.81 415.3,-826.99 379,-808 321.57,-777.96 319.44,-752.77 267.5,-714"/>
</g>
<!-- sourcefile~input_validation_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~input_validation_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/input_validation_mod.f90.html" xlink:title="input_validation_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="542.5,-766 395.5,-766 395.5,-742 542.5,-742 542.5,-766"/>
<text text-anchor="middle" x="469" y="-751.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_validation_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~input_validation_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~input_reader_mod.f90&#45;&gt;sourcefile~input_validation_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M638.35,-767.76C611.9,-765.6 580.9,-763.06 552.77,-760.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="552.8,-757.25 542.54,-759.93 552.23,-764.23 552.8,-757.25"/>
</g>
<!-- sourcefile~save_s_matrix_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~save_s_matrix_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M443.08,-661.83C423.07,-650.86 395.66,-632.95 379,-610 348.04,-567.34 367.34,-543.75 343,-497 327.37,-466.97 302.6,-436.63 285.73,-417.6"/>
<polygon fill="#ff7500" stroke="#ff7500" points="288.33,-415.25 279.03,-410.17 283.13,-419.94 288.33,-415.25"/>
</g>
<!-- sourcefile~save_s_matrix_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~save_s_matrix_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M449.89,-686.06C412.06,-709.59 323.53,-755.83 267.5,-714"/>
</g>
<!-- sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M594.92,-366.02C531.93,-370.45 450.88,-376.71 379,-384 359.59,-385.97 338.34,-388.53 319.64,-390.93"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="319.01,-387.48 309.54,-392.24 319.91,-394.42 319.01,-387.48"/>
</g>
<!-- sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M634.65,-371.06C610.75,-375.24 583.7,-379.91 559,-384 519.5,-390.55 506.99,-382.68 470,-398"/>
</g>
<!-- sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M634.54,-371C621.09,-374.6 607.33,-379.19 595,-385 576.91,-393.53 576.89,-403.05 559,-412 550.75,-416.13 541.74,-419.71 532.72,-422.78"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="531.41,-419.52 522.96,-425.92 533.55,-426.19 531.41,-419.52"/>
</g>
<!-- sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~state_to_state_cross_sections_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M626.61,-346.96C615.87,-344.45 605.06,-341.49 595,-338 440.42,-284.46 431.06,-167.07 267.5,-170"/>
</g>
<!-- sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M669.39,-249.85C614.46,-230.44 506.88,-195.8 470,-208"/>
</g>
<!-- sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M643.87,-274.01C575.28,-290.21 460.74,-324.17 379,-384 356.13,-400.74 307.06,-464.69 282.35,-497.83"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="279.5,-495.8 276.35,-505.92 285.12,-499.97 279.5,-495.8"/>
</g>
<!-- sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M630.85,-274.06C617.61,-279.04 604.87,-286.08 595,-296 556.93,-334.27 597.49,-374.15 559,-412 555.46,-415.48 551.47,-418.51 547.21,-421.13"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="545.3,-418.18 538.11,-425.96 548.58,-424.36 545.3,-418.18"/>
</g>
<!-- sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M647.89,-249.98C629.55,-243.9 609.98,-234.97 595,-222 569.74,-200.12 587.73,-173.06 559,-156 447.47,-89.79 397.17,-166.8 267.5,-170"/>
</g>
<!-- sourcefile~math_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~math_functions_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/math_functions_mod.f90.html" xlink:title="math_functions_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="338.5,-122 194.5,-122 194.5,-98 338.5,-98 338.5,-122"/>
<text text-anchor="middle" x="266.5" y="-107.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~math_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~boundary_conditions_mod.f90&#45;&gt;sourcefile~math_functions_mod.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M639.66,-249.99C623.13,-244.05 606.68,-235.2 595,-222 549.28,-170.33 613.15,-113.76 559,-71 481.56,-9.85 354.94,-63.24 297.5,-93.09"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="295.77,-90.05 288.58,-97.84 299.05,-96.24 295.77,-90.05"/>
</g>
<!-- sourcefile~unitarity_check_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~unitarity_check_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M440.21,-24.18C420.51,-34.14 394.87,-49.99 379,-71 347.23,-113.06 359.77,-134.03 343,-184 319.28,-254.67 289.38,-337.78 275.39,-376.33"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="272.01,-375.38 271.89,-385.98 278.59,-377.78 272.01,-375.38"/>
</g>
<!-- sourcefile~unitarity_check_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~unitarity_check_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M397.39,-19.9C338.23,-29.13 253.5,-48.64 190,-89 169.25,-102.19 173.3,-115.77 154,-131 142.96,-139.71 129.67,-147.32 117.31,-153.45"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="115.62,-150.38 108.1,-157.84 118.63,-156.7 115.62,-150.38"/>
</g>
<!-- sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M642.72,-323.32C577.44,-330.81 470.06,-344.87 379,-365 357.16,-369.83 333.34,-376.66 313.35,-382.85"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="312.06,-379.59 303.57,-385.92 314.16,-386.26 312.06,-379.59"/>
</g>
<!-- sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M642.94,-325.84C627.15,-328.94 610.25,-332.94 595,-338 536.51,-357.4 526.93,-374.42 470,-398"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M468,-398C430.63,-413.48 415,-398.57 379,-417 339.66,-437.14 303.61,-474.79 283.69,-497.99"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="280.86,-495.92 277.1,-505.83 286.22,-500.43 280.86,-495.92"/>
</g>
<!-- sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~radial_coupling_terms_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~radial_coupling_terms_mod.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M642.95,-309.17C625.52,-304.21 607.75,-296.13 595,-283 554.14,-240.9 592.7,-204.03 559,-156 545,-136.05 522.74,-120.05 503.99,-109.03"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="505.54,-105.89 495.11,-104.03 502.1,-111.99 505.54,-105.89"/>
</g>
<!-- sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M642.91,-318.83C626.07,-321.81 608.64,-327.51 595,-338 566.01,-360.29 586.95,-388.41 559,-412 554.69,-415.63 549.9,-418.76 544.84,-421.45"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="543.05,-418.43 535.47,-425.84 546.01,-424.76 543.05,-418.43"/>
</g>
<!-- sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M468,-170C426.2,-154.58 312.05,-169.2 267.5,-170"/>
</g>
<!-- sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~math_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~pes_matrix_mod.f90&#45;&gt;sourcefile~math_functions_mod.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M642.95,-308.07C625.82,-303.06 608.22,-295.23 595,-283 563.67,-254.03 590.94,-222.29 559,-194 528.33,-166.84 508.44,-184.18 470,-170"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M468,-170C419.98,-152.28 364.09,-135.89 323.53,-124.74"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="324.4,-121.34 313.83,-122.09 322.55,-128.1 324.4,-121.34"/>
</g>
<!-- sourcefile~radial_coupling_terms_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~radial_coupling_terms_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M444.98,-104.06C425.33,-115.3 397.4,-133.68 379,-156 321.23,-226.06 286.49,-330.98 273.44,-376.1"/>
<polygon fill="#004eff" stroke="#004eff" points="269.99,-375.41 270.65,-385.98 276.73,-377.31 269.99,-375.41"/>
</g>
<!-- sourcefile~radial_coupling_terms_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~radial_coupling_terms_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M421.83,-104.04C407.92,-108.06 392.71,-112.84 379,-118 327.83,-137.28 322.16,-168.65 267.5,-170"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M265.5,-170C230.85,-170.86 192.58,-171 159.7,-170.88"/>
<polygon fill="#004eff" stroke="#004eff" points="159.7,-167.38 149.68,-170.83 159.67,-174.38 159.7,-167.38"/>
</g>
<!-- sourcefile~radial_coupling_terms_mod.f90&#45;&gt;sourcefile~math_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~radial_coupling_terms_mod.f90&#45;&gt;sourcefile~math_functions_mod.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M378.89,-100C368.88,-100.9 358.71,-101.81 348.81,-102.7"/>
<polygon fill="#004eff" stroke="#004eff" points="348.24,-99.24 338.59,-103.62 348.86,-106.21 348.24,-99.24"/>
</g>
<!-- sourcefile~channels_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~channels_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M673.99,-451.04C629.9,-468.03 542.7,-495.15 470,-478"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M468,-478C428.63,-468.71 416.92,-473.08 379,-459 348.59,-447.71 316.34,-429.27 294.39,-415.62"/>
<polygon fill="#2700ff" stroke="#2700ff" points="295.97,-412.48 285.65,-410.1 292.23,-418.4 295.97,-412.48"/>
</g>
<!-- sourcefile~channels_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~channels_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M648.28,-438.77C619.59,-438.64 583.76,-438.49 551.76,-438.35"/>
<polygon fill="#2700ff" stroke="#2700ff" points="551.54,-434.85 541.52,-438.31 551.51,-441.85 551.54,-434.85"/>
</g>
<!-- sourcefile~channels_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~channels_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M689.88,-451.04C649.12,-489.69 520.76,-609.48 470,-634"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M468,-634C431.58,-651.6 416.92,-638.92 379,-653 326.04,-672.66 312.77,-747.79 267.5,-714"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M265.5,-714C90.06,-583.04 77.59,-277.61 77.63,-192.42"/>
<polygon fill="#2700ff" stroke="#2700ff" points="81.13,-192.33 77.7,-182.31 74.13,-192.29 81.13,-192.33"/>
</g>
<!-- sourcefile~physics_utilities_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~physics_utilities_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M407.84,-426C379.82,-420.41 346.79,-413.82 319.81,-408.44"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="320.29,-404.96 309.8,-406.44 318.92,-411.83 320.29,-404.96"/>
</g>
<!-- sourcefile~physics_utilities_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~physics_utilities_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M437.55,-450.15C402.61,-464.09 345.2,-487 306.89,-502.28"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="305.57,-499.04 297.58,-506 308.17,-505.54 305.57,-499.04"/>
</g>
<!-- sourcefile~physics_utilities_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~physics_utilities_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M411.05,-450.01C350.6,-459.39 255.01,-464.26 190,-419 111.88,-364.61 87.4,-242.34 80.48,-192.14"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="83.93,-191.53 79.19,-182.05 76.99,-192.41 83.93,-191.53"/>
</g>
<!-- sourcefile~propagator_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~propagator_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M897.75,-411.17C871.05,-443.34 792.85,-530.05 704.5,-558"/>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M702.5,-558C636.43,-578.9 625.08,-517.89 559,-497 520.43,-484.81 509.37,-487.29 470,-478"/>
</g>
<!-- sourcefile~propagator_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~propagator_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M702.5,-558C564.86,-601.55 391.39,-558.21 311.48,-533.13"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="312.35,-529.73 301.76,-530.02 310.21,-536.4 312.35,-529.73"/>
</g>
<!-- sourcefile~propagator_mod.f90&#45;&gt;sourcefile~pes_matrix_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~propagator_mod.f90&#45;&gt;sourcefile~pes_matrix_mod.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M874.28,-386.98C865.4,-383.12 856.05,-378.41 848,-373 829.48,-360.55 831.77,-348.35 812,-338 800.32,-331.89 787.08,-327.55 773.99,-324.46"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="774.54,-321 764.03,-322.34 773.08,-327.85 774.54,-321"/>
</g>
<!-- sourcefile~propagator_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~propagator_mod.f90&#45;&gt;sourcefile~physics_utilities_mod.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M847.72,-394.91C807.14,-393.14 752.37,-392.69 704.5,-399"/>
</g>
<!-- sourcefile~propagator_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~propagator_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M702.5,-558C598.97,-591.18 567.89,-586.7 470,-634"/>
</g>
<!-- sourcefile~centrifugal_matrix_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~centrifugal_matrix_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/centrifugal_matrix_mod.f90.html" xlink:title="centrifugal_matrix_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="549,-530 389,-530 389,-506 549,-506 549,-530"/>
<text text-anchor="middle" x="469" y="-515.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">centrifugal_matrix_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~propagator_mod.f90&#45;&gt;sourcefile~centrifugal_matrix_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~propagator_mod.f90&#45;&gt;sourcefile~centrifugal_matrix_mod.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M702.5,-558C669.74,-568.36 580.04,-547.96 522.12,-532.67"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="522.97,-529.27 512.4,-530.07 521.16,-536.03 522.97,-529.27"/>
</g>
<!-- sourcefile~input_validation_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~input_validation_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M438.54,-741.99C418.56,-732.29 393.28,-716.67 379,-695 329.79,-620.31 379.12,-578.83 343,-497 329.4,-466.2 304.41,-436.23 286.91,-417.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="289.36,-414.99 279.93,-410.17 284.3,-419.82 289.36,-414.99"/>
</g>
<!-- sourcefile~input_validation_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~input_validation_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M395.06,-754.38C354.03,-751.18 303.91,-741.18 267.5,-714"/>
</g>
<!-- sourcefile~math_functions_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~math_functions_mod.f90&#45;&gt;sourcefile~utility_functions_mod.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.56,-122.14C198.11,-131.57 157.1,-144.69 125.48,-154.81"/>
<polygon fill="#00ff00" stroke="#00ff00" points="124.02,-151.6 115.57,-157.98 126.16,-158.26 124.02,-151.6"/>
</g>
<!-- sourcefile~special_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~special_functions_mod.f90</title>
<g id="a_sourcefile~~scattering.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/special_functions_mod.f90.html" xlink:title="special_functions_mod.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="154,-122 0,-122 0,-98 154,-98 154,-122"/>
<text text-anchor="middle" x="77" y="-107.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod.f90</text>
</a>
</g>
</g>
<!-- sourcefile~math_functions_mod.f90&#45;&gt;sourcefile~special_functions_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~math_functions_mod.f90&#45;&gt;sourcefile~special_functions_mod.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M194.35,-110C184.48,-110 174.26,-110 164.15,-110"/>
<polygon fill="#00ff00" stroke="#00ff00" points="164.1,-106.5 154.1,-110 164.1,-113.5 164.1,-106.5"/>
</g>
<!-- sourcefile~centrifugal_matrix_mod.f90&#45;&gt;sourcefile~data_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~centrifugal_matrix_mod.f90&#45;&gt;sourcefile~data_mod.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M413.4,-505.95C401.68,-502.3 389.64,-497.71 379,-492 342.2,-472.26 306.54,-438.94 285.82,-417.73"/>
<polygon fill="#0000ff" stroke="#0000ff" points="288.09,-415.04 278.64,-410.25 283.04,-419.89 288.09,-415.04"/>
</g>
<!-- sourcefile~centrifugal_matrix_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90 -->
<g id="sourcefile~~scattering.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~centrifugal_matrix_mod.f90&#45;&gt;sourcefile~array_operations_mod.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M388.76,-518C377.16,-518 365.17,-518 353.44,-518"/>
<polygon fill="#0000ff" stroke="#0000ff" points="353.22,-514.5 343.22,-518 353.22,-521.5 353.22,-514.5"/>
</g>
</g>
</svg>
</div><script>var pansourcefilescatteringf90EfferentGraph = svgPanZoom('#sourcefilescatteringf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#progs-1">Programs</a>
        </h3>
      </div>
      <div id="progs-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html">SCATTERING</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/scattering.f90.html#src">scattering.f90</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w">                              </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="w">      </span><span class="n">no_open_channels_message</span><span class="w"></span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="w">   </span><span class="k">use </span><span class="n">data_mod</span><span class="w"></span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="w">   </span><span class="k">use </span><span class="n">physics_utilities_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="w">      </span><span class="n">save_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">units_conversion</span><span class="w"></span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="w">   </span><span class="k">use </span><span class="n">input_reader_mod</span><span class="w"></span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="w">      </span><span class="n">calculate_largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">prepare_wavevector_array</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="w">      </span><span class="n">print_short_block_summary</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="w">   </span><span class="k">use </span><span class="n">pes_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">initialize_pes_matrix</span><span class="w"></span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="w">   </span><span class="k">use </span><span class="n">propagator_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">numerov</span><span class="w"></span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="p">,</span><span class="w"> </span><span class="n">print_final_unitarity_warning</span><span class="w"></span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="n">initialize_cross_section_arrays</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">  </span><span class="n">add_cross_sections</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">print_cross_sections_for_jtot</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="w">      </span><span class="n">print_final_cross_sections</span><span class="p">,</span><span class="w">  </span><span class="n">determine_largest_cross_sections</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="w">      </span><span class="n">check_cross_section_thresholds</span><span class="p">,</span><span class="w"> </span><span class="n">save_partial_xs_file_header</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="w">      </span><span class="n">save_partial_xs_single_block</span><span class="w"></span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="w">   </span><span class="k">use </span><span class="n">save_s_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">save_s_matrix_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_s_matrix_block_info</span><span class="w"></span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="w">      </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">max_elastic_index</span><span class="p">,</span><span class="w"> </span><span class="n">max_inelastic_index_1</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="w">      </span><span class="n">max_inelastic_index_2</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="w"></span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">max_elastic_cross_section</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="w">      </span><span class="n">max_inelastic_cross_section</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="w">      </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="w">      </span><span class="n">time_parity</span><span class="w"></span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="w"></span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">basis_wavevectors</span><span class="p">(:),</span><span class="w"> </span><span class="n">block_wavevectors</span><span class="p">(:),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="w">      </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">accumulated_cross_sections</span><span class="p">(:),</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="w">      </span><span class="n">partial_cross_sections_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">partial_cross_sections_jtot</span><span class="p">(:)</span><span class="w"></span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">   </span><span class="c">! Print the header</span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">   </span><span class="c">! Read the input file</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="w">   </span><span class="k">call </span><span class="n">save_s_matrix_file_header</span><span class="w"></span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<a id="ln-81" name="ln-81" href="#ln-81"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="k">      call </span><span class="n">save_partial_xs_file_header</span><span class="w"></span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">   </span><span class="k">endif</span><span class="w"></span>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<a id="ln-99" name="ln-99" href="#ln-99"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a><span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">      </span><span class="n">basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<a id="ln-108" name="ln-108" href="#ln-108"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">   </span><span class="c">! Initialize arrays that save the state-to-state cross-sections</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">   </span><span class="k">call </span><span class="n">initialize_cross_section_arrays</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">      </span><span class="n">partial_cross_sections_block</span><span class="p">,</span><span class="w"> </span><span class="n">partial_cross_sections_jtot</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">      </span><span class="n">accumulated_cross_sections</span><span class="p">)</span><span class="w"></span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;jtot_loop&quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">      </span><span class="n">partial_cross_sections_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<a id="ln-133" name="ln-133" href="#ln-133"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">         </span><span class="k">end select</span><span class="w"></span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">         </span><span class="c">! Summary of the current block</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">         </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_blocks</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="k">            call </span><span class="n">print_short_block_summary</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">               </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">         </span><span class="k">endif</span><span class="w"></span>
<a id="ln-154" name="ln-154" href="#ln-154"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<a id="ln-157" name="ln-157" href="#ln-157"></a><span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<a id="ln-170" name="ln-170" href="#ln-170"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="k">            call </span><span class="n">no_open_channels_message</span><span class="p">(</span><span class="n">count_blocks</span><span class="p">)</span><span class="w"></span>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="w">            </span><span class="k">cycle</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="k">         endif</span><span class="w"></span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">         </span><span class="c">! Array of wavevectors in given block (to save in the S-matrix file)</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">block_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="w">         </span><span class="k">call </span><span class="n">prepare_wavevector_array</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">block_wavevectors</span><span class="p">)</span><span class="w"></span>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavevector</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">         </span><span class="k">else</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">         </span><span class="k">endif</span><span class="w"></span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="w">         </span><span class="c">! Prepare the PES matrix</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">         </span><span class="k">call </span><span class="n">initialize_pes_matrix</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">            </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">            </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">         </span><span class="c">! Allocate asymptotic body-fixed (BF) log-derivative matrix</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="w">         </span><span class="c">! and call the propagator</span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">            </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="w">         </span><span class="c">! Allocate asymptotic space-fixed (SF) log-derivative matrix and</span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">         </span><span class="c">! transform the BF result to the SF frame</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix</span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">         </span><span class="c">! (Eq. 4 in &quot;Solution of the coupled equations&quot;)</span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="w">         </span><span class="c">! (Eq. 12 in &quot;Solution of the coupled equations&quot;)</span>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">         </span><span class="k">call </span><span class="n">save_s_matrix_block_info</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="w">            </span><span class="n">block_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="w">            </span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">         </span><span class="k">endif</span><span class="w"></span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">            </span><span class="n">basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">partial_cross_sections_block</span><span class="p">)</span><span class="w"></span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="w">         </span><span class="c">! and add the calculated partial XS to the partial_cross_sections_jtot array</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="k">            call </span><span class="n">save_partial_xs_single_block</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">               </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">partial_cross_sections_block</span><span class="p">)</span><span class="w"></span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="w">         </span><span class="k">endif</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="k">         call </span><span class="n">add_cross_sections</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="w">            </span><span class="n">partial_cross_sections_block</span><span class="p">,</span><span class="w"> </span><span class="n">partial_cross_sections_jtot</span><span class="p">)</span><span class="w"></span>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">      </span><span class="k">call </span><span class="n">add_cross_sections</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="w">            </span><span class="n">partial_cross_sections_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">accumulated_cross_sections</span><span class="p">)</span><span class="w"></span>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="w">      </span><span class="k">call </span><span class="n">determine_largest_cross_sections</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">         </span><span class="n">partial_cross_sections_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">max_elastic_cross_section</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">         </span><span class="n">max_inelastic_cross_section</span><span class="p">,</span><span class="w"> </span><span class="n">max_elastic_index</span><span class="p">,</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-299" name="ln-299" href="#ln-299"></a><span class="w">         </span><span class="n">max_inelastic_index_1</span><span class="p">,</span><span class="w"> </span><span class="n">max_inelastic_index_2</span><span class="p">)</span><span class="w"></span>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="w">         </span><span class="n">max_elastic_cross_section</span><span class="p">,</span><span class="w"> </span><span class="n">max_inelastic_cross_section</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="w">         </span><span class="n">max_elastic_index</span><span class="p">,</span><span class="w"> </span><span class="n">max_inelastic_index_1</span><span class="p">,</span><span class="w"> </span><span class="n">max_inelastic_index_2</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="w">         </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<a id="ln-305" name="ln-305" href="#ln-305"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">max_elastic_cross_section</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">            </span><span class="n">max_inelastic_cross_section</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="w">            </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">      </span><span class="k">endif</span><span class="w"></span>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="k">         call </span><span class="n">print_cross_sections_for_jtot</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">            </span><span class="n">accumulated_cross_sections</span><span class="p">)</span><span class="w"></span>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">      </span><span class="k">endif</span><span class="w"></span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Total angular momentum block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="w">      </span><span class="c">! terminate the loop if elastic_xs_threshold/inelastic_xs_threshold</span>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">      </span><span class="c">! condition is satisfied</span>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="k">   enddo</span><span class="w"></span>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;loop_terminated&quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">   </span><span class="c">! these are listed here</span>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="k">      call </span><span class="n">print_final_unitarity_warning</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="w">   </span><span class="k">endif</span><span class="w"></span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="w">   </span><span class="k">call </span><span class="n">print_final_cross_sections</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">accumulated_cross_sections</span><span class="p">)</span><span class="w"></span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-349" name="ln-349" href="#ln-349"></a><span class="w">   </span><span class="c">! Stop the time count</span>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="n">s_matrix_unit</span><span class="p">)</span><span class="w"></span>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="k">      close</span><span class="p">(</span><span class="n">partial_file_unit</span><span class="p">)</span><span class="w"></span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">   </span><span class="k">endif</span><span class="w"></span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="c">!------------------------------------------------------------------------------!</span>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="c">!------------------------------------------------------------------------------!</span>
</pre></div>

    </section>
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-19 11:45            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>