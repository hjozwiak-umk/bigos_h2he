<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">216 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~14">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~4">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~4">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~5">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~5">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~8">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~5">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~5">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~2">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~4">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~2">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/coupling_matrix_mod.html'>coupling_matrix_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/state_to_state_cross_sections_mod.html'>state_to_state_cross_sections_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/radial_coupling_terms_mod.html'>radial_coupling_terms_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="371pt"
 viewBox="0.00 0.00 641.00 371.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.41 1.41) rotate(0) translate(4 519.95)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-519.95 901,-519.95 901,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="897,-264.5 818,-264.5 818,-240.5 897,-240.5 897,-264.5"/>
<text text-anchor="middle" x="857.5" y="-250.1" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="782,-264.5 691,-264.5 691,-240.5 782,-240.5 782,-264.5"/>
<text text-anchor="middle" x="736.5" y="-250.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M817.86,-252.5C809.67,-252.5 800.87,-252.5 792.21,-252.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="792.14,-249 782.14,-252.5 792.14,-256 792.14,-249"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-216.5 334,-216.5 334,-192.5 388,-192.5 388,-216.5"/>
<text text-anchor="middle" x="361" y="-202.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C700.81,-159.71 691.05,-185.28 655,-193.5 612.17,-203.27 601.92,-213.4 558,-212.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M556,-212.5C501.01,-211.38 437.31,-208.44 398.34,-206.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="398.2,-202.94 388.03,-205.92 397.84,-209.93 398.2,-202.94"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="618.5,-184.5 495.5,-184.5 495.5,-160.5 618.5,-160.5 618.5,-184.5"/>
<text text-anchor="middle" x="557" y="-170.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C701.83,-160.09 662.06,-158.97 628.71,-161.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="628.24,-157.97 618.58,-162.31 628.84,-164.94 628.24,-157.97"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="633.5,-306.5 480.5,-306.5 480.5,-282.5 633.5,-282.5 633.5,-306.5"/>
<text text-anchor="middle" x="557" y="-292.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C681.64,-152.65 703.77,-243.23 655,-273.5 651.19,-275.86 647.16,-277.96 642.98,-279.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="641.63,-276.6 633.64,-283.55 644.22,-283.1 641.63,-276.6"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-176.5 134,-176.5 134,-152.5 259,-152.5 259,-176.5"/>
<text text-anchor="middle" x="196.5" y="-162.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M843.08,-240.24C822.22,-221.99 780.01,-188.17 737.5,-172.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C665.61,-146.74 719.08,-63.47 655,-25.5 580.06,18.91 543.52,-4.43 459,-25.5 364.06,-49.17 265.76,-114.46 221.56,-146.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="219.47,-143.61 213.46,-152.34 223.6,-149.26 219.47,-143.61"/>
</g>
<!-- module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~state_to_state_cross_sections_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/state_to_state_cross_sections_mod.html" xlink:title="state_to_state_cross_sections_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="655,-100.5 459,-100.5 459,-76.5 655,-76.5 655,-100.5"/>
<text text-anchor="middle" x="557" y="-86.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~state_to_state_cross_sections_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C692.87,-156.79 696.13,-128.79 655,-109.5 650.39,-107.34 645.55,-105.39 640.6,-103.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="641.55,-100.28 630.96,-100.53 639.4,-106.94 641.55,-100.28"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-296.5 0,-296.5 0,-272.5 94,-272.5 94,-296.5"/>
<text text-anchor="middle" x="47" y="-282.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-480.5C665.85,-517.54 631.79,-452.61 558,-480.5"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="602,-58.5 512,-58.5 512,-34.5 602,-34.5 602,-58.5"/>
<text text-anchor="middle" x="557" y="-44.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C680.32,-152.17 704.67,-98.98 655,-67.5 642.23,-59.4 626.82,-54.39 612.07,-51.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.48,-47.82 602.02,-49.45 611.22,-54.7 612.48,-47.82"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-416.5 130,-416.5 130,-392.5 263,-392.5 263,-416.5"/>
<text text-anchor="middle" x="196.5" y="-402.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M854.84,-264.7C848.59,-305.25 822.26,-435.43 737.5,-480.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-480.5C717.69,-489.97 577.79,-438.59 558,-442.5"/>
</g>
<!-- module~coupling_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~coupling_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/coupling_matrix_mod.html" xlink:title="coupling_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="620.5,-142.5 493.5,-142.5 493.5,-118.5 620.5,-118.5 620.5,-142.5"/>
<text text-anchor="middle" x="557" y="-128.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">coupling_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~coupling_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~coupling_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C701.84,-160.1 663.21,-150.45 630.61,-143.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="631.19,-140.09 620.69,-141.49 629.77,-146.94 631.19,-140.09"/>
</g>
<!-- module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~radial_coupling_terms_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/radial_coupling_terms_mod.html" xlink:title="radial_coupling_terms_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="637,-264.5 477,-264.5 477,-240.5 637,-240.5 637,-264.5"/>
<text text-anchor="middle" x="557" y="-250.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-172.5C695.08,-157.6 694.22,-208.68 655,-226.5 645.56,-230.79 635.26,-234.49 625.03,-237.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="623.88,-234.33 615.26,-240.5 625.84,-241.05 623.88,-234.33"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.32,-240.49C665.94,-229.09 608.85,-213.54 558,-212.5"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M734.49,-264.54C730.87,-299.81 715.32,-403.73 655,-456.5 621.57,-485.74 600.65,-468.1 558,-480.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M556,-480.5C372.68,-533.79 286.8,-534.39 130,-425.5 88,-396.33 64.45,-338.15 54.22,-306.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="57.53,-305.27 51.25,-296.73 50.84,-307.32 57.53,-305.27"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M730.38,-264.61C713.1,-303.42 652.67,-423.28 558,-442.5"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M556,-442.5C446.97,-464.63 316.5,-437.71 246.94,-419.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="247.7,-415.76 237.13,-416.52 245.86,-422.51 247.7,-415.76"/>
</g>
<!-- module~propagators&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~propagators&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M690.71,-252.5C677.53,-252.5 662.61,-252.5 647.66,-252.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="647.32,-249 637.32,-252.5 647.32,-256 647.32,-249"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M333.89,-198.07C313.05,-192.94 283.04,-185.56 256.47,-179.02"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="257.03,-175.55 246.49,-176.56 255.36,-182.35 257.03,-175.55"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M333.77,-201.25C301.37,-197.97 244.73,-194.67 197.5,-204.5"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M344.07,-216.54C330.51,-227.5 311.31,-244.79 299,-263.5 274.17,-301.21 290.7,-322.84 263,-358.5 254.17,-369.87 241.76,-379.57 230.11,-387.09"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="228.13,-384.2 221.43,-392.41 231.79,-390.17 228.13,-384.2"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M495.42,-182.49C463.47,-187.76 425.37,-194.05 398.08,-198.55"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="397.48,-195.1 388.18,-200.18 398.62,-202.01 397.48,-195.1"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M495.27,-167.46C457.03,-164.92 406.63,-162.71 362,-164.5"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M360,-164.5C330.37,-165.69 297.69,-165.9 269.44,-165.74"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="269.28,-162.24 259.25,-165.66 269.23,-169.24 269.28,-162.24"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M360,-164.5C322.84,-165.99 233.91,-196.92 197.5,-204.5"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M195.5,-204.5C147.63,-214.46 99.13,-245.75 71.4,-266.12"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="69.05,-263.5 63.15,-272.3 73.25,-269.1 69.05,-263.5"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M480.46,-283.39C472.94,-280.76 465.64,-277.51 459,-273.5 437.67,-260.61 443.02,-245.35 423,-230.5 415.33,-224.81 406.22,-220.07 397.41,-216.27"/>
<polygon fill="#5cff00" stroke="#5cff00" points="398.64,-213 388.06,-212.52 396.03,-219.49 398.64,-213"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M496.84,-282.45C484.3,-279.69 471.18,-276.63 459,-273.5 437.21,-267.89 383.49,-251.14 362,-244.5"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M541.35,-306.72C517.77,-325.87 469.33,-363.06 423,-385.5 397.44,-397.88 390.01,-399.82 362,-404.5"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M360,-404.5C331.99,-409.18 325.74,-395.05 299,-385.5 253.18,-369.14 244.62,-356.6 197.5,-344.5"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M360,-404.5C331.99,-409.18 300.89,-410.18 273.46,-409.67"/>
<polygon fill="#5cff00" stroke="#5cff00" points="273.23,-406.16 263.14,-409.4 273.05,-413.16 273.23,-406.16"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node13"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-296.5 299,-296.5 299,-272.5 423,-272.5 423,-296.5"/>
<text text-anchor="middle" x="361" y="-282.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M480.44,-290.6C465.05,-289.81 448.91,-288.98 433.66,-288.19"/>
<polygon fill="#5cff00" stroke="#5cff00" points="433.44,-284.68 423.27,-287.66 433.08,-291.67 433.44,-284.68"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-376.5 334,-376.5 334,-352.5 388,-352.5 388,-376.5"/>
<text text-anchor="middle" x="361" y="-362.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M522.65,-306.53C487.79,-319.11 433.3,-338.77 397.62,-351.65"/>
<polygon fill="#5cff00" stroke="#5cff00" points="396.31,-348.4 388.09,-355.09 398.68,-354.98 396.31,-348.4"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M156.18,-176.59C147.15,-180.3 137.89,-184.92 130,-190.5 101.35,-210.76 76.12,-243.03 61.46,-263.99"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="58.41,-262.24 55.66,-272.48 64.19,-266.19 58.41,-262.24"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M473.71,-100.69C468.49,-103.14 463.52,-106.05 459,-109.5 431.5,-130.48 448.39,-155.01 423,-178.5 415.86,-185.1 406.8,-190.18 397.85,-194.01"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="396.35,-190.84 388.29,-197.71 398.87,-197.37 396.35,-190.84"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M491.67,-100.57C453.85,-107.8 405.14,-117.34 362,-126.5"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M458.8,-88.5C427.86,-88.5 393.49,-88.5 362,-88.5"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M511.55,-46.73C493.31,-49.02 473.19,-54.67 459,-67.5 420.53,-102.29 458,-140.23 423,-178.5 416.2,-185.94 406.91,-191.33 397.63,-195.21"/>
<polygon fill="#002eff" stroke="#002eff" points="396.25,-191.98 388.08,-198.72 398.67,-198.56 396.25,-191.98"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M511.7,-50.79C494.49,-53.78 475.1,-58.87 459,-67.5 439.33,-78.05 441.75,-90.4 423,-102.5 398.52,-118.3 390.5,-120.45 362,-126.5"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M360,-126.5C325.75,-133.77 287.63,-142.65 256.92,-149.99"/>
<polygon fill="#002eff" stroke="#002eff" points="255.71,-146.68 246.81,-152.42 257.35,-153.49 255.71,-146.68"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M511.98,-56.03C454.74,-68.42 362,-88.5 362,-88.5"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M360,-88.5C254.9,-88.5 214.34,-80.78 130,-143.5 88.96,-174.01 65.02,-231.64 54.47,-262.94"/>
<polygon fill="#002eff" stroke="#002eff" points="51.14,-261.88 51.4,-272.47 57.8,-264.03 51.14,-261.88"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M177,-392.39C163.63,-383.43 145.32,-370.72 130,-358.5 107.84,-340.83 83.93,-318.89 67.68,-303.51"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="70.02,-300.9 60.36,-296.53 65.19,-305.96 70.02,-300.9"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M493.4,-139.9C481.67,-142.81 469.74,-146.6 459,-151.5 440.81,-159.81 440.32,-168.51 423,-178.5 415.03,-183.1 406.09,-187.36 397.57,-191.04"/>
<polygon fill="#e700ff" stroke="#e700ff" points="396.07,-187.87 388.19,-194.95 398.76,-194.34 396.07,-187.87"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M493.29,-122.01C454.96,-118.59 405.17,-117.33 362,-126.5"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M500.41,-118.46C443.08,-106.05 362,-88.5 362,-88.5"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M493.29,-134.29C480.78,-137.59 468.57,-142.94 459,-151.5 421.6,-184.95 457.06,-221.66 423,-258.5 419.88,-261.87 416.26,-264.82 412.35,-267.41"/>
<polygon fill="#e700ff" stroke="#e700ff" points="410.41,-264.48 403.46,-272.48 413.88,-270.56 410.41,-264.48"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M507.05,-240.39C473.16,-232 428.81,-221.03 398.12,-213.44"/>
<polygon fill="#ff008b" stroke="#ff008b" points="398.81,-210 388.26,-211 397.13,-216.8 398.81,-210"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M476.57,-258.32C440.83,-258.65 398.55,-255.8 362,-244.5"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M360,-244.5C332.87,-236.11 323.4,-240.02 299,-225.5 279.82,-214.09 281.73,-202.63 263,-190.5 257.27,-186.79 250.93,-183.47 244.52,-180.53"/>
<polygon fill="#ff008b" stroke="#ff008b" points="245.7,-177.23 235.13,-176.51 242.95,-183.66 245.7,-177.23"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M481.28,-264.54C473.56,-267 465.99,-269.95 459,-273.5 439.91,-283.19 442.29,-296.21 423,-305.5 377.18,-327.57 246.76,-357.15 197.5,-344.5"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M195.5,-344.5C154.81,-334.18 110.5,-315 81.18,-301.09"/>
<polygon fill="#ff008b" stroke="#ff008b" points="82.37,-297.78 71.84,-296.6 79.33,-304.09 82.37,-297.78"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M483.21,-264.51C466.83,-267.21 449.46,-270.07 433.15,-272.76"/>
<polygon fill="#ff008b" stroke="#ff008b" points="432.44,-269.33 423.14,-274.41 433.58,-276.24 432.44,-269.33"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M320.54,-272.36C312.81,-268.75 305.19,-264.19 299,-258.5 273.83,-235.36 288.46,-213.33 263,-190.5 259.06,-186.97 254.58,-183.88 249.85,-181.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="251.05,-177.89 240.55,-176.52 247.91,-184.14 251.05,-177.89"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M330.3,-272.44C320.27,-268.21 309.07,-263.32 299,-258.5 252.9,-236.46 247.53,-194.09 197.5,-204.5"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-296.5 130,-296.5 130,-272.5 263,-272.5 263,-296.5"/>
<text text-anchor="middle" x="196.5" y="-282.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.57,-284.5C290.32,-284.5 281.79,-284.5 273.34,-284.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.09,-281 263.09,-284.5 273.09,-288 273.09,-281"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="762pt"
 viewBox="0.00 0.00 641.00 761.89" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.27 2.27) rotate(0) translate(4 1728.97)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1728.97 1454,-1728.97 1454,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-781 0,-781 0,-757 79,-757 79,-781"/>
<text text-anchor="middle" x="39.5" y="-766.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="555.5,-1260 473.5,-1260 473.5,-1236 555.5,-1236 555.5,-1260"/>
<text text-anchor="middle" x="514.5" y="-1245.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M40.8,-781.37C42.58,-844.82 53.99,-1133.07 115,-1192 209.19,-1282.97 379.07,-1270.75 463.32,-1257.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="464.09,-1261.1 473.4,-1256.05 462.97,-1254.19 464.09,-1261.1"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="290,-1096 178,-1096 178,-1072 290,-1072 290,-1096"/>
<text text-anchor="middle" x="234" y="-1081.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.91,-781.26C47.95,-831.42 73.15,-1020.19 115,-1060 129.19,-1073.5 148.79,-1080.33 167.95,-1083.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.51,-1087.04 177.89,-1084.95 168.47,-1080.11 167.51,-1087.04"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="589,-886 440,-886 440,-862 589,-862 589,-886"/>
<text text-anchor="middle" x="514.5" y="-871.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M41.56,-781.15C45.1,-813.37 59.64,-900.99 115,-937 159.33,-965.84 304.95,-959.1 353,-937 375.34,-926.73 367.6,-907.1 389,-895 401.48,-887.94 415.71,-883.12 429.98,-879.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="430.75,-883.27 439.85,-877.83 429.35,-876.41 430.75,-883.27"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="551.5,-642 477.5,-642 477.5,-618 551.5,-618 551.5,-642"/>
<text text-anchor="middle" x="514.5" y="-627.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M44.43,-756.73C52.89,-732.54 75.39,-679.03 115,-656 173.65,-621.91 375.52,-624.75 467.36,-627.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="467.35,-631.48 477.47,-628.35 467.61,-624.48 467.35,-631.48"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="279.5,-1008 188.5,-1008 188.5,-984 279.5,-984 279.5,-1008"/>
<text text-anchor="middle" x="234" y="-993.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M41.14,-781.17C43.69,-816.3 56.06,-918.68 115,-970 132.28,-985.04 156.29,-991.98 178.14,-995"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178,-998.5 188.33,-996.15 178.78,-991.55 178,-998.5"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="353,-486 115,-486 115,-462 353,-462 353,-486"/>
<text text-anchor="middle" x="234" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M42.21,-756.71C49.1,-708.98 76.32,-536.67 115,-500 118.57,-496.62 122.48,-493.63 126.63,-491.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="128.42,-494.02 135.46,-486.1 125.02,-487.89 128.42,-494.02"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="278.5,-402 189.5,-402 189.5,-378 278.5,-378 278.5,-402"/>
<text text-anchor="middle" x="234" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M41.26,-756.71C45.04,-699.6 63.77,-460.76 115,-411 131.83,-394.66 156.72,-388.63 179.3,-387.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.65,-390.5 189.48,-386.56 179.34,-383.51 179.65,-390.5"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-928 165,-928 165,-904 303,-904 303,-928"/>
<text text-anchor="middle" x="234" y="-913.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M43.87,-781.06C51.7,-806.63 73.66,-866.32 115,-895 126.81,-903.19 140.83,-908.49 155.02,-911.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="154.34,-915.3 164.84,-913.9 155.76,-908.44 154.34,-915.3"/>
</g>
<!-- proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~calculate_state_to_state_cross_section</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/calculate_state_to_state_cross_section.html" xlink:title="calculate_state_to_state_cross_section">
<polygon fill="#d9534f" stroke="#d9534f" points="342,-1561 126,-1561 126,-1537 342,-1537 342,-1561"/>
<text text-anchor="middle" x="234" y="-1546.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_state_to_state_cross_section</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section</title>
<path fill="none" stroke="#ff0000" d="M40.89,-781.2C43.96,-873.37 65.3,-1458.3 115,-1517 120.16,-1523.09 126.35,-1528.09 133.16,-1532.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="131.6,-1535.31 142.08,-1536.88 134.87,-1529.12 131.6,-1535.31"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="278,-360 190,-360 190,-336 278,-336 278,-360"/>
<text text-anchor="middle" x="234" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.96,-756.94C43.53,-696.3 58.08,-425.46 115,-369 131.78,-352.35 156.91,-346.34 179.66,-344.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="180.06,-348.3 189.92,-344.4 179.78,-341.3 180.06,-348.3"/>
</g>
<!-- proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~read_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/read_radial_coupling_terms.html" xlink:title="read_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="314,-1144 154,-1144 154,-1120 314,-1120 314,-1144"/>
<text text-anchor="middle" x="234" y="-1129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~read_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M41.49,-781.21C46.17,-835.88 67.84,-1057.52 115,-1105 123.19,-1113.25 133.35,-1119.19 144.24,-1123.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.38,-1126.84 153.97,-1126.75 145.64,-1120.22 143.38,-1126.84"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="306.5,-318 161.5,-318 161.5,-294 306.5,-294 306.5,-318"/>
<text text-anchor="middle" x="234" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.73,-756.98C42.2,-692.71 52.42,-390.15 115,-327 124.9,-317.01 137.8,-310.83 151.42,-307.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.45,-310.5 161.44,-304.89 150.91,-303.67 152.45,-310.5"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="322.5,-802 145.5,-802 145.5,-778 322.5,-778 322.5,-802"/>
<text text-anchor="middle" x="234" y="-787.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M79.46,-773.25C95.71,-775.02 115.4,-777.17 135.18,-779.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="134.87,-782.82 145.2,-780.42 135.63,-775.86 134.87,-782.82"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="261,-276 207,-276 207,-252 261,-252 261,-276"/>
<text text-anchor="middle" x="234" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.54,-756.76C41.01,-688.43 46.83,-354.79 115,-285 135.92,-263.58 170.61,-259.61 196.97,-260.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.83,-263.73 206.98,-260.69 197.15,-256.74 196.83,-263.73"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="555,-1218 474,-1218 474,-1194 555,-1194 555,-1218"/>
<text text-anchor="middle" x="514.5" y="-1203.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M41.01,-781.02C43.78,-840.25 59.03,-1100.26 115,-1153 164.33,-1199.48 368.18,-1205.94 463.69,-1206.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="463.96,-1209.85 473.97,-1206.37 463.97,-1202.85 463.96,-1209.85"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1450,-1378 1358,-1378 1358,-1354 1450,-1354 1450,-1378"/>
<text text-anchor="middle" x="1404" y="-1363.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.61,-781.19C41.6,-882.97 50.8,-1589.59 115,-1655 239.72,-1782.07 335.45,-1696 513.5,-1696 513.5,-1696 513.5,-1696 991,-1696 1138.56,-1696 1208.61,-1764.43 1322,-1670 1366.05,-1633.32 1392.32,-1452.42 1400.35,-1388.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1403.86,-1388.61 1401.6,-1378.26 1396.91,-1387.76 1403.86,-1388.61"/>
</g>
<!-- proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~interpolate_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/interpolate_radial_coupling_terms.html" xlink:title="interpolate_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="331,-1051 137,-1051 137,-1027 331,-1027 331,-1051"/>
<text text-anchor="middle" x="234" y="-1036.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.09,-781.08C39.42,-821.39 43.08,-952.42 115,-1017 118.92,-1020.52 123.22,-1023.56 127.78,-1026.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.34,-1029.37 136.85,-1030.72 129.47,-1023.11 126.34,-1029.37"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="279.5,-760 188.5,-760 188.5,-736 279.5,-736 279.5,-760"/>
<text text-anchor="middle" x="234" y="-745.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M79.46,-764.75C107.91,-761.65 146.86,-757.4 178.41,-753.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.81,-757.43 188.37,-752.87 178.05,-750.47 178.81,-757.43"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="305.5,-844 162.5,-844 162.5,-820 305.5,-820 305.5,-844"/>
<text text-anchor="middle" x="234" y="-829.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M58.05,-781.15C72.65,-790.7 94.32,-803.57 115,-811 126.82,-815.24 139.63,-818.66 152.3,-821.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="151.91,-824.88 162.41,-823.44 153.31,-818.02 151.91,-824.88"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="633.5,-1588 395.5,-1588 395.5,-1564 633.5,-1564 633.5,-1588"/>
<text text-anchor="middle" x="514.5" y="-1573.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.94,-781.06C44.32,-869.73 67.09,-1418.87 115,-1473 186.96,-1554.29 254.56,-1482.22 353,-1528 371.13,-1536.43 370.62,-1547.11 389,-1555 394.16,-1557.21 399.54,-1559.2 405.03,-1560.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="404.45,-1564.45 415.03,-1563.94 406.45,-1557.74 404.45,-1564.45"/>
</g>
<!-- proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~print_largest_partial_cross_sections</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/print_largest_partial_cross_sections.html" xlink:title="print_largest_partial_cross_sections">
<polygon fill="#d9534f" stroke="#d9534f" points="1322,-1661 1122,-1661 1122,-1637 1322,-1637 1322,-1661"/>
<text text-anchor="middle" x="1222" y="-1646.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_cross_sections</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_cross_sections</title>
<path fill="none" stroke="#ff0000" d="M40.64,-781.02C41.94,-879.95 53.04,-1557.56 115,-1620 177.66,-1683.15 424.54,-1658 513.5,-1658 513.5,-1658 513.5,-1658 768,-1658 885.33,-1658 1019.72,-1654.94 1111.46,-1652.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1111.7,-1655.89 1121.59,-1652.11 1111.5,-1648.89 1111.7,-1655.89"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="551.5,-722 477.5,-722 477.5,-698 551.5,-698 551.5,-722"/>
<text text-anchor="middle" x="514.5" y="-707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M56.65,-756.9C71.1,-746.84 93.3,-733.19 115,-727 238.38,-691.79 391.91,-698.64 467.32,-705.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="467.16,-708.61 477.43,-706.02 467.78,-701.64 467.16,-708.61"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="829,-1216 705,-1216 705,-1192 829,-1192 829,-1216"/>
<text text-anchor="middle" x="767" y="-1201.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.49,-781.08C40.71,-848.5 45.37,-1177.51 115,-1243 157.54,-1283.01 585.88,-1290.97 640,-1269 660.68,-1260.61 656.94,-1245.6 676,-1234 685.48,-1228.23 696.2,-1223.42 706.86,-1219.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="708.3,-1222.67 716.59,-1216.07 706,-1216.06 708.3,-1222.67"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1276.5,-384 1167.5,-384 1167.5,-360 1276.5,-360 1276.5,-384"/>
<text text-anchor="middle" x="1222" y="-369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.1,-756.85C39.49,-716.92 43.42,-588.83 115,-528 196.38,-458.85 277,-570.02 353,-495 428.82,-420.15 308.2,-327.45 389,-258 447.81,-207.45 1012.55,-270.11 1086,-295 1127.15,-308.94 1169.94,-335.81 1196.03,-353.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1194.34,-356.91 1204.53,-359.79 1198.36,-351.18 1194.34,-356.91"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="570.5,-360 458.5,-360 458.5,-336 570.5,-336 570.5,-360"/>
<text text-anchor="middle" x="514.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.11,-756.9C43.58,-721.98 55.75,-620.38 115,-571 197.57,-502.18 275.34,-602.32 353,-528 405.35,-477.9 336.36,-418.79 389,-369 404.81,-354.05 427.08,-347.53 448.42,-345.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.79,-348.64 458.47,-344.33 448.21,-341.67 448.79,-348.64"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="281,-234 187,-234 187,-210 281,-210 281,-234"/>
<text text-anchor="middle" x="234" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.37,-756.66C39.9,-684.67 41.18,-319.48 115,-243 130.85,-226.58 154.79,-220.37 176.96,-218.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.18,-222.14 187,-218.15 176.83,-215.15 177.18,-222.14"/>
</g>
<!-- proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~reduce_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/reduce_radial_coupling_terms.html" xlink:title="reduce_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="600.5,-1424 428.5,-1424 428.5,-1400 600.5,-1400 600.5,-1424"/>
<text text-anchor="middle" x="514.5" y="-1409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduce_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~reduce_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.51,-781.36C40.82,-853.46 45.81,-1219.49 115,-1302 188.67,-1389.86 325.59,-1410.9 418.13,-1414.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="418.24,-1417.81 428.34,-1414.61 418.45,-1410.81 418.24,-1417.81"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="578,-1630 451,-1630 451,-1606 578,-1606 578,-1630"/>
<text text-anchor="middle" x="514.5" y="-1615.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.73,-781.2C42.64,-877.36 57.41,-1510.82 115,-1570 202.04,-1659.44 362.34,-1647.23 450.79,-1631.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="451.47,-1635.25 460.69,-1630.03 450.22,-1628.37 451.47,-1635.25"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="333.5,-444 134.5,-444 134.5,-420 333.5,-420 333.5,-444"/>
<text text-anchor="middle" x="234" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.62,-756.75C46.7,-703.92 69.35,-496.19 115,-453 118.19,-449.98 121.65,-447.32 125.33,-444.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.17,-447.95 134.24,-440.06 123.79,-441.82 127.17,-447.95"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-604 204,-604 204,-580 264,-580 264,-604"/>
<text text-anchor="middle" x="234" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M42.75,-756.97C48.81,-728.1 68.29,-654.6 115,-618 137.25,-600.56 168.77,-594.28 193.64,-592.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="194.08,-595.72 203.84,-591.6 193.64,-588.73 194.08,-595.72"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-192 133.5,-192 133.5,-168 334.5,-168 334.5,-192"/>
<text text-anchor="middle" x="234" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.23,-756.68C38.86,-681.42 35.48,-284.24 115,-201 117.91,-197.96 121.09,-195.26 124.5,-192.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.57,-195.72 133.36,-187.59 122.98,-189.71 126.57,-195.72"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="281,-1464 187,-1464 187,-1440 281,-1440 281,-1464"/>
<text text-anchor="middle" x="234" y="-1449.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.54,-781.43C40.99,-859.21 46.61,-1278.89 115,-1383 131.41,-1407.97 160.22,-1425.07 185.27,-1436"/>
<polygon fill="#ff0000" stroke="#ff0000" points="184.07,-1439.3 194.65,-1439.89 186.75,-1432.83 184.07,-1439.3"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="285,-150 183,-150 183,-126 285,-126 285,-150"/>
<text text-anchor="middle" x="234" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M41.13,-756.74C45.49,-674.44 72.18,-204.22 115,-159 129.69,-143.48 151.59,-137.04 172.54,-134.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="172.99,-138.36 182.71,-134.14 172.49,-131.37 172.99,-138.36"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-108 162,-108 162,-84 306,-84 306,-108"/>
<text text-anchor="middle" x="234" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M41.03,-756.73C44.86,-671.18 69.31,-165.63 115,-117 124.9,-106.47 138.11,-100.1 152.12,-96.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.88,-99.84 161.91,-94.28 151.39,-93 152.88,-99.84"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="323,-886 145,-886 145,-862 323,-862 323,-886"/>
<text text-anchor="middle" x="234" y="-871.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M47.44,-781.04C58.91,-799.74 83.71,-835.47 115,-853 121.36,-856.57 128.2,-859.55 135.26,-862.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="134.4,-865.44 144.99,-865.15 136.53,-858.77 134.4,-865.44"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="794,-802 740,-802 740,-778 794,-778 794,-802"/>
<text text-anchor="middle" x="767" y="-787.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M48.12,-756.99C59.96,-739.56 84.63,-707.91 115,-695 222.37,-649.35 529.92,-650.33 640,-689 685.86,-705.11 727.4,-745.74 749.44,-770.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="746.91,-772.71 756.14,-777.92 752.18,-768.09 746.91,-772.71"/>
</g>
<!-- proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~check_cross_section_thresholds</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/check_cross_section_thresholds.html" xlink:title="check_cross_section_thresholds">
<polygon fill="#d9534f" stroke="#d9534f" points="324,-66 144,-66 144,-42 324,-42 324,-66"/>
<text text-anchor="middle" x="234" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cross_section_thresholds</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~check_cross_section_thresholds</title>
<path fill="none" stroke="#ff0000" d="M40.94,-756.81C44.25,-668.35 66.43,-127.05 115,-75 120.54,-69.06 127.13,-64.45 134.33,-60.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.88,-64.04 143.73,-56.93 133.16,-57.59 135.88,-64.04"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="280.5,-24 187.5,-24 187.5,0 280.5,0 280.5,-24"/>
<text text-anchor="middle" x="234" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.86,-756.95C43.68,-665.95 63.53,-88.5 115,-33 130.64,-16.13 154.79,-9.92 177.17,-8.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.45,-11.79 187.29,-7.86 177.15,-4.8 177.45,-11.79"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M550.01,-1260.08C576.19,-1270.22 612.28,-1286.35 640,-1307 659.18,-1321.29 654.28,-1336.98 676,-1347 736.3,-1374.81 1188.48,-1369.74 1347.71,-1367.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1347.83,-1370.55 1357.77,-1366.88 1347.71,-1363.55 1347.83,-1370.55"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="802,-1052 732,-1052 732,-1028 802,-1028 802,-1052"/>
<text text-anchor="middle" x="767" y="-1037.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M555.64,-1252.03C582.9,-1252.45 617.88,-1248.11 640,-1227 694.61,-1174.87 623.04,-1114.8 676,-1061 687.93,-1048.88 705.41,-1043.2 721.8,-1040.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="722.28,-1044.17 731.81,-1039.52 721.47,-1037.21 722.28,-1044.17"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="814,-1094 720,-1094 720,-1070 814,-1070 814,-1094"/>
<text text-anchor="middle" x="767" y="-1079.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff0000" d="M555.66,-1250.71C582.23,-1250.4 616.39,-1245.73 640,-1227 672.46,-1201.25 649.51,-1172.87 676,-1141 690.64,-1123.38 711.91,-1109.1 730.09,-1099.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="732.09,-1101.91 739.27,-1094.12 728.8,-1095.73 732.09,-1101.91"/>
</g>
<!-- proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~wavenumber_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/wavenumber_from_energy.html" xlink:title="wavenumber_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="592,-844 437,-844 437,-820 592,-820 592,-844"/>
<text text-anchor="middle" x="514.5" y="-829.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_from_energy</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#ff2800" d="M290.12,-1085.64C312.49,-1083.36 336.83,-1076.64 353,-1060 418.08,-993.04 322.8,-918.86 389,-853 399.35,-842.7 412.75,-836.34 426.9,-832.56"/>
<polygon fill="#ff2800" stroke="#ff2800" points="427.8,-835.95 436.8,-830.35 426.27,-829.12 427.8,-835.95"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="541.5,-1176 487.5,-1176 487.5,-1152 541.5,-1152 541.5,-1176"/>
<text text-anchor="middle" x="514.5" y="-1161.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#ff2800" d="M290.15,-1090.72C310.68,-1094.72 333.66,-1101.04 353,-1111 372.03,-1120.81 369.69,-1133.75 389,-1143 416.8,-1156.32 451.62,-1161.34 477.37,-1163.17"/>
<polygon fill="#ff2800" stroke="#ff2800" points="477.26,-1166.67 487.45,-1163.75 477.67,-1159.68 477.26,-1166.67"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="584.5,-1340 444.5,-1340 444.5,-1316 584.5,-1316 584.5,-1340"/>
<text text-anchor="middle" x="514.5" y="-1325.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#ff2800" d="M290.12,-1084.33C312.36,-1087.3 336.59,-1094.57 353,-1111 403.9,-1161.95 343.93,-1212.82 389,-1269 405.58,-1289.66 431.11,-1303.49 454.75,-1312.53"/>
<polygon fill="#ff2800" stroke="#ff2800" points="453.79,-1315.9 464.38,-1315.99 456.16,-1309.31 453.79,-1315.9"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="794,-400 740,-400 740,-376 794,-376 794,-400"/>
<text text-anchor="middle" x="767" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff2800" d="M290.19,-1083.54C311.79,-1080.8 335.52,-1074.29 353,-1060 384.76,-1034.03 356.59,-1000.16 389,-975 478.12,-905.81 563.56,-1019.99 640,-937 719.67,-850.49 599.8,-498.58 676,-409 688.98,-393.74 710.71,-388.37 729.57,-386.87"/>
<polygon fill="#ff2800" stroke="#ff2800" points="729.85,-390.36 739.68,-386.4 729.52,-383.37 729.85,-390.36"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="541.5,-802 487.5,-802 487.5,-778 541.5,-778 541.5,-802"/>
<text text-anchor="middle" x="514.5" y="-787.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff2800" d="M290.05,-1085.89C312.55,-1083.68 336.99,-1076.95 353,-1060 429.78,-978.71 310.87,-890.99 389,-811 411.48,-787.99 449.1,-784.46 477.11,-785.64"/>
<polygon fill="#ff2800" stroke="#ff2800" points="477.12,-789.14 487.33,-786.29 477.57,-782.16 477.12,-789.14"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-1134 466.5,-1134 466.5,-1110 562.5,-1110 562.5,-1134"/>
<text text-anchor="middle" x="514.5" y="-1119.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#ff2800" d="M290.02,-1091.51C338.12,-1098.07 407.7,-1107.56 456.4,-1114.21"/>
<polygon fill="#ff2800" stroke="#ff2800" points="456.08,-1117.7 466.46,-1115.58 457.03,-1110.76 456.08,-1117.7"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="561,-1382 468,-1382 468,-1358 561,-1358 561,-1382"/>
<text text-anchor="middle" x="514.5" y="-1367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#ff2800" d="M290.11,-1083.68C312.62,-1086.49 337.06,-1093.82 353,-1111 425.76,-1189.42 314,-1272.71 389,-1349 406.62,-1366.92 433.42,-1373 457.65,-1374.25"/>
<polygon fill="#ff2800" stroke="#ff2800" points="457.75,-1377.76 467.84,-1374.51 457.93,-1370.76 457.75,-1377.76"/>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff5000" d="M589.11,-877.9C606.59,-881.09 624.61,-886.37 640,-895 693.47,-925 735.13,-986.7 754.36,-1019.09"/>
<polygon fill="#ff5000" stroke="#ff5000" points="751.35,-1020.87 759.39,-1027.77 757.4,-1017.36 751.35,-1020.87"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ffa100" d="M279.66,-993.05C304.38,-993.9 333.88,-999.4 353,-1018 407.43,-1070.93 334.11,-1132.54 389,-1185 408.57,-1203.7 438.23,-1209.25 463.69,-1209.98"/>
<polygon fill="#ffa100" stroke="#ffa100" points="463.92,-1213.48 473.94,-1210.03 463.95,-1206.48 463.92,-1213.48"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ffa100" d="M279.66,-984.19C304.85,-975.27 334.84,-960.45 353,-937 399.77,-876.63 341.6,-828.87 389,-769 408.57,-744.28 440.99,-729.38 467.85,-720.73"/>
<polygon fill="#ffa100" stroke="#ffa100" points="468.9,-724.07 477.45,-717.82 466.87,-717.37 468.9,-724.07"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="552.5,-1050 476.5,-1050 476.5,-1026 552.5,-1026 552.5,-1050"/>
<text text-anchor="middle" x="514.5" y="-1035.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#ffa100" d="M279.75,-1002.75C330.92,-1010.47 414.33,-1023.04 466.45,-1030.9"/>
<polygon fill="#ffa100" stroke="#ffa100" points="466.03,-1034.38 476.44,-1032.41 467.07,-1027.46 466.03,-1034.38"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="551.5,-928 477.5,-928 477.5,-904 551.5,-904 551.5,-928"/>
<text text-anchor="middle" x="514.5" y="-913.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#ffa100" d="M279.67,-990.93C302.41,-987.19 330.02,-980.79 353,-970 371.35,-961.39 370.6,-950.51 389,-942 413.55,-930.64 443.11,-924.2 467.27,-920.57"/>
<polygon fill="#ffa100" stroke="#ffa100" points="467.84,-924.02 477.26,-919.18 466.87,-917.09 467.84,-924.02"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-1008 467,-1008 467,-984 562,-984 562,-1008"/>
<text text-anchor="middle" x="514.5" y="-993.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#ffa100" d="M279.75,-996C327.75,-996 404.12,-996 456.42,-996"/>
<polygon fill="#ffa100" stroke="#ffa100" points="456.54,-999.5 466.54,-996 456.54,-992.5 456.54,-999.5"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="851.5,-185 682.5,-185 682.5,-161 851.5,-161 851.5,-185"/>
<text text-anchor="middle" x="767" y="-170.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#ffc900" d="M342.01,-461.99C345.96,-459.4 349.66,-456.42 353,-453 426.81,-377.39 313.05,-291.46 389,-218 409.05,-198.6 567.44,-185.18 672.44,-178.32"/>
<polygon fill="#ffc900" stroke="#ffc900" points="672.68,-181.81 682.43,-177.67 672.23,-174.82 672.68,-181.81"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#e4ff00" d="M303.29,-911.93C320.33,-908.79 338,-903.57 353,-895 374.35,-882.8 367.6,-865.1 389,-853 400.56,-846.47 413.61,-841.85 426.81,-838.61"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="427.9,-841.95 436.91,-836.38 426.39,-835.11 427.9,-841.95"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#e4ff00" d="M303.15,-915.29C320.86,-912.22 338.9,-906.19 353,-895 384.81,-869.74 357.08,-836.11 389,-811 413.79,-791.5 450.05,-787.29 477.05,-787.34"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="477.19,-790.84 487.26,-787.56 477.34,-783.84 477.19,-790.84"/>
</g>
<!-- proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#bbff00" d="M286.06,-1561.02C307.02,-1566.43 331.4,-1573.32 353,-1581 369.5,-1586.86 372.24,-1591.95 389,-1597 405.49,-1601.97 423.59,-1605.87 440.75,-1608.88"/>
<polygon fill="#bbff00" stroke="#bbff00" points="440.29,-1612.35 450.73,-1610.56 441.45,-1605.45 440.29,-1612.35"/>
</g>
<!-- proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#6bff00" d="M275.16,-1144.02C298.11,-1151.12 327.35,-1160.55 353,-1170 369.26,-1176 372.35,-1180.19 389,-1185 413.11,-1191.96 440.55,-1196.89 463.52,-1200.22"/>
<polygon fill="#6bff00" stroke="#6bff00" points="463.35,-1203.73 473.73,-1201.64 464.31,-1196.8 463.35,-1203.73"/>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#1aff00" d="M322.74,-790C374.77,-790 437.96,-790 476.96,-790"/>
<polygon fill="#1aff00" stroke="#1aff00" points="477.29,-793.5 487.29,-790 477.29,-786.5 477.29,-793.5"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff35" d="M555.19,-1205.68C592.64,-1205.38 649.64,-1204.93 694.93,-1204.57"/>
<polygon fill="#00ff35" stroke="#00ff35" points="695.02,-1208.07 705,-1204.49 694.97,-1201.07 695.02,-1208.07"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff35" d="M555.2,-1209.55C582.25,-1209.75 617.17,-1205.34 640,-1185 682.85,-1146.83 634.35,-1100.48 676,-1061 688.13,-1049.5 705.29,-1043.88 721.38,-1041.26"/>
<polygon fill="#00ff35" stroke="#00ff35" points="722.26,-1044.68 731.74,-1039.94 721.38,-1037.74 722.26,-1044.68"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-1092 487.5,-1092 487.5,-1068 541.5,-1068 541.5,-1092"/>
<text text-anchor="middle" x="514.5" y="-1077.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline</title>
<path fill="none" stroke="#00ff86" d="M316.68,-1051.02C369.98,-1058.87 436.94,-1068.73 477.42,-1074.69"/>
<polygon fill="#00ff86" stroke="#00ff86" points="476.96,-1078.16 487.36,-1076.15 477.98,-1071.23 476.96,-1078.16"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffae" d="M279.76,-748.28C371.14,-748.83 585.77,-750 766,-750 766,-750 766,-750 991,-750 1160.85,-750 1223.61,-802.56 1322,-941 1369.18,-1007.38 1394.55,-1266.22 1401.21,-1343.86"/>
<polygon fill="#00ffae" stroke="#00ffae" points="1397.73,-1344.29 1402.05,-1353.96 1404.7,-1343.7 1397.73,-1344.29"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#00ffae" d="M279.74,-748.86C302.9,-751 330.87,-756.35 353,-769 374.35,-781.2 367.6,-798.9 389,-811 400.56,-817.53 413.61,-822.15 426.81,-825.39"/>
<polygon fill="#00ffae" stroke="#00ffae" points="426.39,-828.89 436.91,-827.62 427.9,-822.05 426.39,-828.89"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ffae" d="M279.75,-754.75C334.58,-763.02 426.44,-776.87 477.14,-784.52"/>
<polygon fill="#00ffae" stroke="#00ffae" points="476.89,-788.02 487.3,-786.05 477.94,-781.1 476.89,-788.02"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ffd6" d="M305.64,-821.35C360.42,-813.09 434.1,-801.97 477.42,-795.44"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="478.13,-798.87 487.49,-793.92 477.08,-791.95 478.13,-798.87"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffff" d="M633.6,-1575.21C828.99,-1571.94 1209.2,-1556.64 1322,-1488 1360.11,-1464.81 1384.03,-1416.1 1395.31,-1387.75"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1398.61,-1388.9 1398.89,-1378.3 1392.07,-1386.41 1398.61,-1388.9"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffff" d="M629.31,-1563.99C633.15,-1561.39 636.74,-1558.41 640,-1555 730.38,-1460.51 606.92,-1374.02 676,-1263 687.6,-1244.36 707.51,-1230.4 725.67,-1220.75"/>
<polygon fill="#00ffff" stroke="#00ffff" points="727.58,-1223.71 734.94,-1216.1 724.44,-1217.45 727.58,-1223.71"/>
</g>
<!-- proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00d6ff" d="M1276.14,-1636.95C1292.67,-1630.93 1309.75,-1622.04 1322,-1609 1382.19,-1544.94 1397.72,-1434.95 1401.67,-1388.13"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1405.17,-1388.38 1402.42,-1378.15 1398.19,-1387.86 1405.17,-1388.38"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="830.5,-442 703.5,-442 703.5,-418 830.5,-418 830.5,-442"/>
<text text-anchor="middle" x="767" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0035ff" d="M570.8,-349.44C593.38,-351.98 619.06,-357.49 640,-369 660.96,-380.52 655.41,-396.83 676,-409 681.44,-412.21 687.33,-414.94 693.42,-417.24"/>
<polygon fill="#0035ff" stroke="#0035ff" points="692.5,-420.62 703.09,-420.53 694.75,-414 692.5,-420.62"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#0035ff" d="M570.78,-356.83C619.26,-364.57 688.34,-375.6 730,-382.25"/>
<polygon fill="#0035ff" stroke="#0035ff" points="729.54,-385.72 739.97,-383.84 730.65,-378.81 729.54,-385.72"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="839.5,-358 694.5,-358 694.5,-334 839.5,-334 839.5,-358"/>
<text text-anchor="middle" x="767" y="-343.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#0035ff" d="M570.78,-347.56C603.97,-347.29 646.81,-346.95 683.9,-346.66"/>
<polygon fill="#0035ff" stroke="#0035ff" points="684.22,-350.15 694.19,-346.57 684.17,-343.15 684.22,-350.15"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#1a00ff" d="M600.53,-1412.29C747.87,-1411.98 1060.02,-1407.72 1322,-1380 1330.36,-1379.12 1339.17,-1377.9 1347.77,-1376.54"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="1348.44,-1379.98 1357.74,-1374.9 1347.3,-1373.07 1348.44,-1379.98"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#1a00ff" d="M600.69,-1410.69C615.13,-1407.02 628.99,-1400.89 640,-1391 683.96,-1351.51 641.07,-1310.67 676,-1263 689.26,-1244.9 709.88,-1230.8 728.04,-1220.93"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="729.99,-1223.86 737.26,-1216.16 726.77,-1217.65 729.99,-1223.86"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#4300ff" d="M578.15,-1619.03C746.65,-1620.59 1204.7,-1616.48 1322,-1529 1369.06,-1493.9 1390.48,-1423.9 1398.68,-1388.14"/>
<polygon fill="#4300ff" stroke="#4300ff" points="1402.14,-1388.73 1400.82,-1378.22 1395.29,-1387.26 1402.14,-1388.73"/>
</g>
<!-- proc~process_single_matrix_element -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>proc~process_single_matrix_element</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././proc/process_single_matrix_element.html" xlink:title="process_single_matrix_element">
<polygon fill="#d9534f" stroke="#d9534f" points="604,-166 425,-166 425,-142 604,-142 604,-166"/>
<text text-anchor="middle" x="514.5" y="-151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">process_single_matrix_element</text>
</a>
</g>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~process_single_matrix_element -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~process_single_matrix_element</title>
<path fill="none" stroke="#6b00ff" d="M333.66,-424.68C340.81,-421.2 347.4,-416.73 353,-411 425.68,-336.74 317.44,-255.33 389,-180 396.38,-172.24 405.43,-166.48 415.25,-162.25"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="416.74,-165.43 424.88,-158.65 414.29,-158.88 416.74,-165.43"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#9300ff" d="M264.02,-595.96C312.25,-602.54 409.33,-615.79 467.14,-623.67"/>
<polygon fill="#9300ff" stroke="#9300ff" points="466.73,-627.15 477.11,-625.03 467.67,-620.21 466.73,-627.15"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#9300ff" d="M264.07,-585.24C406.64,-553.98 1036.65,-438.36 1322,-763 1399.89,-851.61 1403.52,-1244.74 1403.18,-1343.45"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1399.68,-1343.5 1403.13,-1353.52 1406.68,-1343.54 1399.68,-1343.5"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#9300ff" d="M264.02,-584.34C291.5,-575.49 331.65,-558.14 353,-528 411.53,-445.36 311.94,-368.71 389,-303 505.66,-203.52 997.68,-315.58 1165.02,-357.49"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1164.31,-360.92 1174.86,-359.96 1166.02,-354.13 1164.31,-360.92"/>
</g>
<!-- proc~numerov&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~numerov&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#9300ff" d="M264.13,-589.95C345.84,-584.69 575.47,-573.55 640,-609 704.38,-644.37 743.03,-728.38 758.36,-768.26"/>
<polygon fill="#9300ff" stroke="#9300ff" points="755.15,-769.68 761.91,-777.83 761.71,-767.24 755.15,-769.68"/>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#9300ff" d="M264.19,-593.35C290.63,-592.95 329.01,-588.11 353,-566 393.01,-529.13 346.06,-482.41 389,-449 434.72,-413.42 597.12,-417.92 693.22,-424.11"/>
<polygon fill="#9300ff" stroke="#9300ff" points="693.24,-427.62 703.45,-424.8 693.7,-420.64 693.24,-427.62"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="587.5,-402 441.5,-402 441.5,-378 587.5,-378 587.5,-402"/>
<text text-anchor="middle" x="514.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#9300ff" d="M264,-593.69C290.69,-593.59 329.57,-589 353,-566 401.93,-517.98 339.81,-463.75 389,-416 400.61,-404.73 415.78,-397.78 431.51,-393.6"/>
<polygon fill="#9300ff" stroke="#9300ff" points="432.39,-396.99 441.36,-391.35 430.83,-390.17 432.39,-396.99"/>
</g>
<!-- proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~cenitrfugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/cenitrfugal_matrix.html" xlink:title="cenitrfugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="569.5,-482 459.5,-482 459.5,-458 569.5,-458 569.5,-482"/>
<text text-anchor="middle" x="514.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cenitrfugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~numerov&#45;&gt;proc~cenitrfugal_matrix</title>
<path fill="none" stroke="#9300ff" d="M264.21,-592.46C290.12,-591.4 327.68,-586.06 353,-566 381.98,-543.04 359.46,-513.23 389,-491 406.08,-478.14 428.22,-472.03 449.08,-469.4"/>
<polygon fill="#9300ff" stroke="#9300ff" points="449.6,-472.86 459.2,-468.37 448.89,-465.9 449.6,-472.86"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="565,-524 464,-524 464,-500 565,-500 565,-524"/>
<text text-anchor="middle" x="514.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#9300ff" d="M264.29,-589.2C288.9,-586 324.52,-579.37 353,-566 371.35,-557.39 370.6,-546.51 389,-538 409.24,-528.63 432.89,-522.61 454.11,-518.75"/>
<polygon fill="#9300ff" stroke="#9300ff" points="454.71,-522.2 463.98,-517.07 453.54,-515.3 454.71,-522.2"/>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#9300ff" d="M264.16,-584.17C291.54,-575.23 331.44,-557.85 353,-528 406.14,-454.43 319.4,-385.24 389,-327 434.33,-289.07 602.93,-314.02 698.59,-332.07"/>
<polygon fill="#9300ff" stroke="#9300ff" points="697.99,-335.52 708.47,-333.96 699.3,-328.64 697.99,-335.52"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#e400ff" d="M245.53,-1439.76C269.07,-1412.96 328.64,-1348.2 389,-1307 414.72,-1289.44 446.49,-1274.48 471.5,-1264.02"/>
<polygon fill="#e400ff" stroke="#e400ff" points="473.14,-1267.12 481.07,-1260.09 470.49,-1260.65 473.14,-1267.12"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1086,-1494 894,-1494 894,-1470 1086,-1470 1086,-1494"/>
<text text-anchor="middle" x="990" y="-1479.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#e400ff" d="M281.03,-1453.83C399.41,-1458.54 716.8,-1471.17 883.47,-1477.8"/>
<polygon fill="#e400ff" stroke="#e400ff" points="883.61,-1481.31 893.74,-1478.21 883.89,-1474.31 883.61,-1481.31"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="611,-1546 418,-1546 418,-1522 611,-1522 611,-1546"/>
<text text-anchor="middle" x="514.5" y="-1531.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#e400ff" d="M281.26,-1463.22C303.51,-1469.43 330.24,-1478.12 353,-1489 370.35,-1497.29 371.12,-1505.91 389,-1513 395.16,-1515.44 401.6,-1517.6 408.17,-1519.51"/>
<polygon fill="#e400ff" stroke="#e400ff" points="407.31,-1522.9 417.88,-1522.13 409.13,-1516.14 407.31,-1522.9"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="640,-1504 389,-1504 389,-1480 640,-1480 640,-1504"/>
<text text-anchor="middle" x="514.5" y="-1489.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#e400ff" d="M281.3,-1458.65C318.91,-1464.05 373.17,-1471.84 419.78,-1478.54"/>
<polygon fill="#e400ff" stroke="#e400ff" points="419.51,-1482.04 429.91,-1479.99 420.51,-1475.11 419.51,-1482.04"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#ff00a1" d="M314.81,-861.96C349.77,-856.69 390.9,-850.49 426.63,-845.1"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="427.19,-848.56 436.56,-843.6 426.15,-841.63 427.19,-848.56"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff00a1" d="M323.09,-865.3C333.56,-862.27 343.79,-858.27 353,-853 374.35,-840.8 367.6,-823.1 389,-811 416,-795.73 451.19,-790.93 477.27,-789.68"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="477.6,-793.17 487.48,-789.35 477.37,-786.18 477.6,-793.17"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M587.28,-819.96C633.93,-812.14 692.76,-802.28 729.89,-796.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="730.48,-799.5 739.76,-794.4 729.32,-792.6 730.48,-799.5"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M592.18,-835.03C608.9,-838.31 625.81,-843.86 640,-853 703.13,-893.69 742.41,-978.42 758.12,-1018.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="754.94,-1019.79 761.77,-1027.89 761.48,-1017.3 754.94,-1019.79"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1062.5,-204 917.5,-204 917.5,-180 1062.5,-180 1062.5,-204"/>
<text text-anchor="middle" x="990" y="-189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ffc700" d="M851.55,-180.18C869.81,-181.75 889.11,-183.41 907.29,-184.97"/>
<polygon fill="#ffc700" stroke="#ffc700" points="907,-188.46 917.26,-185.83 907.6,-181.49 907,-188.46"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1030,-162 950,-162 950,-138 1030,-138 1030,-162"/>
<text text-anchor="middle" x="990" y="-147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ffc700" d="M851.55,-164.3C881.33,-161.21 913.9,-157.82 939.85,-155.11"/>
<polygon fill="#ffc700" stroke="#ffc700" points="940.23,-158.59 949.82,-154.08 939.51,-151.63 940.23,-158.59"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#f3ff00" d="M1086.15,-1492.68C1155.11,-1496.23 1248.72,-1492.14 1322,-1456 1352.71,-1440.85 1377.13,-1408.54 1390.84,-1387.04"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1393.96,-1388.65 1396.2,-1378.3 1387.99,-1384.99 1393.96,-1388.65"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1265.5,-1266 1178.5,-1266 1178.5,-1242 1265.5,-1242 1265.5,-1266"/>
<text text-anchor="middle" x="1222" y="-1251.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#f3ff00" d="M1018.62,-1469.91C1039.98,-1459.2 1068.75,-1441.6 1086,-1418 1119.62,-1372.02 1083.95,-1337.39 1122,-1295 1134.26,-1281.34 1151.77,-1272.12 1168.66,-1265.95"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1170.12,-1269.15 1178.49,-1262.66 1167.9,-1262.51 1170.12,-1269.15"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#b1ff00" d="M584.8,-1324.68C604.2,-1320.94 624.26,-1314.13 640,-1302 668.34,-1280.16 648.5,-1252.89 676,-1230 681.76,-1225.21 688.36,-1221.3 695.31,-1218.11"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="697.01,-1221.19 704.96,-1214.19 694.38,-1214.71 697.01,-1221.19"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="794,-1296 740,-1296 740,-1272 794,-1272 794,-1296"/>
<text text-anchor="middle" x="767" y="-1281.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#b1ff00" d="M583.95,-1315.98C631.09,-1307.7 691.84,-1297.03 729.87,-1290.35"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="730.72,-1293.75 739.96,-1288.57 729.5,-1286.86 730.72,-1293.75"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#b1ff00" d="M584.79,-1321.35C603.56,-1317.51 623.29,-1311.47 640,-1302 660.52,-1290.37 654.47,-1272.64 676,-1263 762.76,-1224.16 1048.97,-1240.74 1168.17,-1249.67"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="1167.92,-1253.16 1178.16,-1250.43 1168.46,-1246.18 1167.92,-1253.16"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#2cff00" d="M552.68,-1032.34C585.14,-1027.7 633.56,-1021.5 676,-1019 965.89,-1001.9 1111.23,-917.24 1322,-1117 1387.66,-1179.23 1400.18,-1295.17 1402.51,-1343.72"/>
<polygon fill="#2cff00" stroke="#2cff00" points="1399.01,-1343.92 1402.88,-1353.78 1406.01,-1343.65 1399.01,-1343.92"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#2cff00" d="M552.6,-1034.49C579.98,-1033.99 616.43,-1038.01 640,-1059 682.85,-1097.17 634.35,-1143.52 676,-1183 681.52,-1188.24 688.09,-1192.25 695.12,-1195.32"/>
<polygon fill="#2cff00" stroke="#2cff00" points="694.36,-1198.77 704.95,-1198.95 696.78,-1192.2 694.36,-1198.77"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#2cff00" d="M552.73,-1038.3C597.81,-1038.66 673.64,-1039.26 721.68,-1039.65"/>
<polygon fill="#2cff00" stroke="#2cff00" points="721.76,-1043.15 731.79,-1039.73 721.82,-1036.15 721.76,-1043.15"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#2cff00" d="M552.57,-1044.12C577.34,-1048.24 610.64,-1053.84 640,-1059 662.88,-1063.02 688.06,-1067.59 709.87,-1071.59"/>
<polygon fill="#2cff00" stroke="#2cff00" points="709.48,-1075.07 719.95,-1073.44 710.74,-1068.19 709.48,-1075.07"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff16" d="M802.26,-1043.59C895.75,-1054.99 1159.11,-1097.95 1322,-1233 1358.7,-1263.43 1383.28,-1315.04 1395.01,-1344.22"/>
<polygon fill="#00ff16" stroke="#00ff16" points="1391.88,-1345.82 1398.76,-1353.87 1398.4,-1343.28 1391.88,-1345.82"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff58" d="M541.7,-1077.6C569.05,-1076.53 611.82,-1079.03 640,-1101 671.39,-1125.47 645.38,-1157.57 676,-1183 681.69,-1187.72 688.24,-1191.43 695.16,-1194.32"/>
<polygon fill="#00ff58" stroke="#00ff58" points="694.19,-1197.69 704.79,-1197.79 696.57,-1191.11 694.19,-1197.69"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff58" d="M541.83,-1075.79C584.58,-1068.97 669.54,-1055.4 721.71,-1047.07"/>
<polygon fill="#00ff58" stroke="#00ff58" points="722.36,-1050.51 731.68,-1045.48 721.25,-1043.6 722.36,-1050.51"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ff9b" d="M587.62,-401.52C620.76,-406.81 659.99,-413.07 693.21,-418.38"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="692.89,-421.87 703.31,-419.99 693.99,-414.96 692.89,-421.87"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ff9b" d="M587.62,-389.42C634.06,-389.05 692.45,-388.59 729.52,-388.29"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="729.87,-391.79 739.84,-388.21 729.81,-384.79 729.87,-391.79"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00ff9b" d="M587.62,-378C604.79,-375.1 623.05,-371.98 640,-369 656.41,-366.12 674.02,-362.95 690.7,-359.92"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="691.75,-363.28 700.96,-358.05 690.49,-356.4 691.75,-363.28"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ddff" d="M541.83,-790C586.75,-790 678.26,-790 729.38,-790"/>
<polygon fill="#00ddff" stroke="#00ddff" points="729.64,-793.5 739.64,-790 729.64,-786.5 729.64,-793.5"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0058ff" d="M562.12,-988.42C716.44,-964.45 1207.41,-897.41 1322,-995 1375.84,-1040.85 1396.32,-1270.38 1401.55,-1343.55"/>
<polygon fill="#0058ff" stroke="#0058ff" points="1398.08,-1344.16 1402.26,-1353.9 1405.07,-1343.68 1398.08,-1344.16"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0058ff" d="M562.22,-991.97C588.34,-992.34 619.63,-997.55 640,-1017 694.61,-1069.13 623.04,-1129.2 676,-1183 681.54,-1188.63 688.28,-1192.87 695.54,-1196.05"/>
<polygon fill="#0058ff" stroke="#0058ff" points="694.39,-1199.35 704.99,-1199.53 696.81,-1192.78 694.39,-1199.35"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#0058ff" d="M562.18,-991.03C586.19,-987.3 615.48,-980.89 640,-970 653.7,-963.91 850.46,-823.96 858,-811 929.5,-688.04 806.28,-604.97 894,-493 957.55,-411.88 1081.19,-385.14 1156.89,-376.33"/>
<polygon fill="#0058ff" stroke="#0058ff" points="1157.69,-379.76 1167.25,-375.2 1156.93,-372.8 1157.69,-379.76"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#0058ff" d="M562.28,-997.83C588.41,-996.3 619.7,-989.82 640,-970 690.29,-920.89 627.6,-866.97 676,-816 689.83,-801.44 711.25,-794.88 729.72,-791.98"/>
<polygon fill="#0058ff" stroke="#0058ff" points="730.42,-795.42 739.9,-790.7 729.54,-788.48 730.42,-795.42"/>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0016ff" d="M569.55,-461.37C605.67,-455.6 653.62,-447.95 693.1,-441.64"/>
<polygon fill="#0016ff" stroke="#0016ff" points="693.89,-445.06 703.21,-440.03 692.78,-438.15 693.89,-445.06"/>
</g>
<!-- dfloat -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>dfloat</title>
<polygon fill="#777777" stroke="#777777" points="794,-484 740,-484 740,-460 794,-460 794,-484"/>
<text text-anchor="middle" x="767" y="-469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfloat</text>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;dfloat -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;dfloat</title>
<path fill="none" stroke="#0016ff" d="M569.55,-470.43C617.94,-470.82 687.58,-471.37 729.63,-471.71"/>
<polygon fill="#0016ff" stroke="#0016ff" points="729.67,-475.21 739.7,-471.79 729.73,-468.21 729.67,-475.21"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#2c00ff" d="M565.27,-511.13C589.11,-508.89 617.33,-503.46 640,-491 660.96,-479.48 655.41,-463.17 676,-451 681.44,-447.79 687.33,-445.06 693.42,-442.76"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="694.75,-446 703.09,-439.47 692.5,-439.38 694.75,-446"/>
</g>
<!-- proc~get_radial_coupling_term_value -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~get_radial_coupling_term_value</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/get_radial_coupling_term_value.html" xlink:title="get_radial_coupling_term_value">
<polygon fill="#d9534f" stroke="#d9534f" points="858,-526 676,-526 676,-502 858,-502 858,-526"/>
<text text-anchor="middle" x="767" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_radial_coupling_term_value</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~get_radial_coupling_term_value -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~get_radial_coupling_term_value</title>
<path fill="none" stroke="#2c00ff" d="M565.29,-512.4C593.99,-512.63 631.12,-512.92 665.62,-513.2"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="665.72,-516.7 675.75,-513.28 665.78,-509.7 665.72,-516.7"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#6e00ff" d="M562.56,-1122.62C586.95,-1124.7 616.47,-1130.07 640,-1143 660.96,-1154.52 655.41,-1170.83 676,-1183 681.94,-1186.51 688.42,-1189.43 695.1,-1191.87"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="694.39,-1195.32 704.98,-1195.1 696.56,-1188.66 694.39,-1195.32"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="794,-1174 740,-1174 740,-1150 794,-1150 794,-1174"/>
<text text-anchor="middle" x="767" y="-1159.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#6e00ff" d="M562.62,-1129.52C611.16,-1137.28 685.79,-1149.19 729.86,-1156.23"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="729.42,-1159.7 739.85,-1157.82 730.52,-1152.79 729.42,-1159.7"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#6e00ff" d="M562.74,-1120.97C629.2,-1120.34 753.83,-1122.19 858,-1141 978.78,-1162.8 1115.63,-1212.55 1181.47,-1238.15"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1180.45,-1241.51 1191.04,-1241.89 1183,-1234.99 1180.45,-1241.51"/>
</g>
<!-- proc~process_single_matrix_element&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~process_single_matrix_element&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#b100ff" d="M604.17,-160.73C626.26,-162.4 650.02,-164.2 672.34,-165.9"/>
<polygon fill="#b100ff" stroke="#b100ff" points="672.25,-169.4 682.48,-166.67 672.78,-162.42 672.25,-169.4"/>
</g>
<!-- proc~percival_seaton_coefficient -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~percival_seaton_coefficient</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/percival_seaton_coefficient.html" xlink:title="percival_seaton_coefficient">
<polygon fill="#d94e8f" stroke="#d94e8f" points="846,-141 688,-141 688,-117 846,-117 846,-141"/>
<text text-anchor="middle" x="767" y="-126.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">percival_seaton_coefficient</text>
</a>
</g>
</g>
<!-- proc~process_single_matrix_element&#45;&gt;proc~percival_seaton_coefficient -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~process_single_matrix_element&#45;&gt;proc~percival_seaton_coefficient</title>
<path fill="none" stroke="#b100ff" d="M604.17,-145.15C628.06,-142.77 653.9,-140.19 677.77,-137.81"/>
<polygon fill="#b100ff" stroke="#b100ff" points="678.26,-141.27 687.86,-136.8 677.56,-134.31 678.26,-141.27"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00c7" d="M561.27,-1372.58C586.9,-1371.69 618.02,-1366.44 640,-1349 672.46,-1323.25 649.51,-1294.87 676,-1263 690.64,-1245.38 711.91,-1231.1 730.09,-1221.01"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="732.09,-1223.91 739.27,-1216.12 728.8,-1217.73 732.09,-1223.91"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="794,-1338 740,-1338 740,-1314 794,-1314 794,-1338"/>
<text text-anchor="middle" x="767" y="-1323.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#ff00c7" d="M561.06,-1362.47C584.63,-1358.53 613.88,-1353.59 640,-1349 670.41,-1343.66 704.91,-1337.34 730.11,-1332.68"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="730.76,-1336.12 739.96,-1330.86 729.49,-1329.24 730.76,-1336.12"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff00c7" d="M561.18,-1373.28C680.11,-1381.04 996.32,-1396.32 1086,-1347 1110.63,-1333.46 1100.12,-1312.65 1122,-1295 1135.55,-1284.07 1152.42,-1275.65 1168.37,-1269.37"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1170,-1272.5 1178.15,-1265.73 1167.56,-1265.94 1170,-1272.5"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1017,-1296 963,-1296 963,-1272 1017,-1272 1017,-1296"/>
<text text-anchor="middle" x="990" y="-1281.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ffaa00" d="M794.22,-1284C833.6,-1284 908.13,-1284 952.7,-1284"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="952.81,-1287.5 962.81,-1284 952.81,-1280.5 952.81,-1287.5"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node75" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node75"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1017,-1338 963,-1338 963,-1314 1017,-1314 1017,-1338"/>
<text text-anchor="middle" x="990" y="-1323.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ffaa00" d="M794.22,-1288.98C833.68,-1296.48 908.44,-1310.69 952.99,-1319.16"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="952.34,-1322.59 962.81,-1321.02 953.64,-1315.72 952.34,-1322.59"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1017,-526 963,-526 963,-502 1017,-502 1017,-526"/>
<text text-anchor="middle" x="990" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~get_radial_coupling_term_value&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~get_radial_coupling_term_value&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#aaff00" d="M858.21,-514C891.36,-514 927.03,-514 952.73,-514"/>
<polygon fill="#aaff00" stroke="#aaff00" points="952.75,-517.5 962.75,-514 952.75,-510.5 952.75,-517.5"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="1017,-120 963,-120 963,-96 1017,-96 1017,-120"/>
<text text-anchor="middle" x="990" y="-105.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~percival_seaton_coefficient&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~percival_seaton_coefficient&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#00ffa9" d="M846.23,-121.57C882.61,-118.11 924.11,-114.17 952.96,-111.43"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="953.35,-114.9 962.98,-110.47 952.69,-107.93 953.35,-114.9"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#00a9ff" d="M794.22,-1321.02C833.68,-1313.52 908.44,-1299.31 952.99,-1290.84"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="953.64,-1294.28 962.81,-1288.98 952.34,-1287.41 953.64,-1294.28"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#00a9ff" d="M794.22,-1326C833.6,-1326 908.13,-1326 952.7,-1326"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="952.81,-1329.5 962.81,-1326 952.81,-1322.5 952.81,-1329.5"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0000ff" d="M1260.13,-1266.09C1279.34,-1273.14 1302.72,-1283.02 1322,-1295 1345.4,-1309.54 1368.69,-1330.86 1384.25,-1346.34"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1382.13,-1349.17 1391.64,-1353.84 1387.11,-1344.26 1382.13,-1349.17"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node76" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node76"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1249,-1328 1195,-1328 1195,-1304 1249,-1304 1249,-1328"/>
<text text-anchor="middle" x="1222" y="-1313.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1017.38,-1287.67C1058.63,-1293.41 1138.47,-1304.52 1184.97,-1310.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1184.54,-1314.46 1194.92,-1312.37 1185.5,-1307.53 1184.54,-1314.46"/>
</g>
<!-- proc~ispline&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~ispline&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#00ffff" d="M1017.15,-510.06C1036.92,-506.34 1064.26,-499.56 1086,-488 1133.77,-462.61 1179.33,-417.71 1203.37,-391.84"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1206.23,-393.91 1210.4,-384.17 1201.06,-389.18 1206.23,-393.91"/>
</g>
<!-- proc~ispline&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~ispline&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ffff" d="M994.8,-526.23C1021.37,-611.7 1179.25,-1119.69 1214.17,-1232.02"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1210.93,-1233.38 1217.24,-1241.89 1217.61,-1231.31 1210.93,-1233.38"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#7f00ff" d="M1017.38,-1324.85C1058.54,-1323.06 1138.13,-1319.6 1184.68,-1317.58"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1185.09,-1321.06 1194.92,-1317.13 1184.78,-1314.07 1185.09,-1321.06"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~14">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~4">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~4">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~5">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~5">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~8">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~5">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~5">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~2">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~4">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~2">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_indices~14"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_l_values~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~2"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~8"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~2"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">coupling_matrix_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">check_cross_section_thresholds</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-04 12:17            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>