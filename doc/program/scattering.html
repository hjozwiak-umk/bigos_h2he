<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">214 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen~4">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2~4">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~8">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/potential.html'>POTENTIAL</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/pes_coupling_matrix.html'>PES_COUPLING_MATRIX</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/statetostatexs.html'>statetostateXS</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="416pt"
 viewBox="0.00 0.00 641.00 415.56" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.34 1.34) rotate(0) translate(4 554.83)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-554.83 858,-554.83 858,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="854,-326.34 775,-326.34 775,-302.34 854,-302.34 854,-326.34"/>
<text text-anchor="middle" x="814.5" y="-311.94" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~potential -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~potential</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/potential.html" xlink:title="POTENTIAL">
<polygon fill="#337ab7" stroke="#337ab7" points="571,-251.34 500,-251.34 500,-227.34 571,-227.34 571,-251.34"/>
<text text-anchor="middle" x="535.5" y="-236.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POTENTIAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~potential</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-161.34C666.97,-150.46 598.02,-195.15 560.92,-221.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="558.74,-218.66 552.65,-227.33 562.82,-224.36 558.74,-218.66"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-212.34 134,-212.34 134,-188.34 259,-188.34 259,-212.34"/>
<text text-anchor="middle" x="196.5" y="-197.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-161.34C624.94,-132.54 435.21,-155.46 362,-161.34"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-367.34 130,-367.34 130,-343.34 263,-343.34 263,-367.34"/>
<text text-anchor="middle" x="196.5" y="-352.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-467.34C654.22,-487.64 651.06,-503.59 612,-522.34 580.38,-537.52 571.04,-539.23 536.5,-545.34"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-545.34C465.51,-557.54 285.14,-423.66 220.76,-373.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="222.84,-370.89 212.81,-367.5 218.54,-376.41 222.84,-370.89"/>
</g>
<!-- module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~pes_coupling_matrix</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/pes_coupling_matrix.html" xlink:title="PES_COUPLING_MATRIX">
<polygon fill="#337ab7" stroke="#337ab7" points="603.5,-91.34 467.5,-91.34 467.5,-67.34 603.5,-67.34 603.5,-91.34"/>
<text text-anchor="middle" x="535.5" y="-76.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PES_COUPLING_MATRIX</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~pes_coupling_matrix</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M808.95,-302.22C796.47,-271.03 758.27,-188.52 694.5,-161.34"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-161.34C651.2,-143.74 652.23,-120.26 612,-100.34 607.98,-98.35 603.75,-96.52 599.42,-94.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="600.43,-91.5 589.84,-91.44 598.09,-98.09 600.43,-91.5"/>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="739,-326.34 648,-326.34 648,-302.34 739,-302.34 739,-326.34"/>
<text text-anchor="middle" x="693.5" y="-311.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.86,-314.34C766.67,-314.34 757.87,-314.34 749.21,-314.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="749.14,-310.84 739.14,-314.34 749.14,-317.84 749.14,-310.84"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-327.34 0,-327.34 0,-303.34 94,-303.34 94,-327.34"/>
<text text-anchor="middle" x="47" y="-312.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-545.34C458.39,-554.57 438.53,-549.99 362,-545.34"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-479.34 490.5,-479.34 490.5,-455.34 580.5,-455.34 580.5,-479.34"/>
<text text-anchor="middle" x="535.5" y="-464.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-467.34C661.57,-483.87 622.02,-483.68 590.48,-479.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="590.95,-475.98 580.54,-477.95 589.91,-482.9 590.95,-475.98"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-327.34 334,-327.34 334,-303.34 388,-303.34 388,-327.34"/>
<text text-anchor="middle" x="361" y="-312.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M808.26,-326.71C794.66,-357.04 755.04,-434.98 694.5,-467.34"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-467.34C691.02,-468.13 460.3,-404.4 459,-403.34 431.59,-380.97 450.36,-354.77 423,-332.34 415.9,-326.52 406.93,-322.68 398.08,-320.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="398.77,-316.73 388.23,-317.84 397.16,-323.54 398.77,-316.73"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="612,-133.34 459,-133.34 459,-109.34 612,-109.34 612,-133.34"/>
<text text-anchor="middle" x="535.5" y="-118.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-161.34C666.96,-150.45 637.75,-141.99 611.58,-135.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.24,-132.28 601.7,-133.42 610.65,-139.09 612.24,-132.28"/>
</g>
<!-- module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~statetostatexs</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/statetostatexs.html" xlink:title="statetostateXS">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-293.34 490.5,-293.34 490.5,-269.34 580.5,-269.34 580.5,-293.34"/>
<text text-anchor="middle" x="535.5" y="-278.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">statetostateXS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~statetostatexs</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-161.34C640.33,-139.11 659.45,-229.28 612,-260.34 605.44,-264.64 598,-268.06 590.42,-270.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="589.23,-267.5 580.79,-273.89 591.38,-274.16 589.23,-267.5"/>
</g>
<!-- module~potential&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~potential&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.85,-228.7C486.86,-224.38 472.08,-219.06 459,-213.34 414.18,-193.76 410.76,-157.42 362,-161.34"/>
</g>
<!-- module~potential&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~potential&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.72,-247.59C416.71,-267.21 212.75,-315.09 197.5,-315.34"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M195.5,-315.34C165.42,-315.71 131.88,-315.74 104.39,-315.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="104.19,-312.16 94.17,-315.63 104.16,-319.16 104.19,-312.16"/>
</g>
<!-- module~potential&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~potential&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.95,-245.82C486.69,-249.1 471.71,-253.81 459,-260.34 440.73,-269.73 440.62,-278.77 423,-289.34 415.11,-294.07 406.2,-298.39 397.68,-302.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="396.19,-298.91 388.3,-305.97 398.87,-305.37 396.19,-298.91"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-133.34 299,-133.34 299,-109.34 423,-109.34 423,-133.34"/>
<text text-anchor="middle" x="361" y="-118.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~potential&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>module~potential&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.82,-233.11C485.94,-229.25 470.54,-223.09 459,-213.34 433.48,-191.77 447.74,-169.8 423,-147.34 419.16,-143.85 414.77,-140.78 410.16,-138.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="411.58,-134.89 401.09,-133.39 408.36,-141.11 411.58,-134.89"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M179.99,-212.43C154.17,-232.57 102.18,-273.1 71.72,-296.84"/>
<polygon fill="#ff9900" stroke="#ff9900" points="69.48,-294.16 63.74,-303.07 73.78,-299.68 69.48,-294.16"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M151.25,-343.34C135.86,-339.16 118.41,-334.43 102.31,-330.07"/>
<polygon fill="#cbff00" stroke="#cbff00" points="103.05,-326.64 92.48,-327.4 101.21,-333.4 103.05,-326.64"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M360,-1.34C331.89,-5.34 318.93,-0.11 299,-20.34 259.33,-60.61 293.34,-94.64 263,-142.34 253.1,-157.9 237.86,-171.75 224.57,-182"/>
<polygon fill="#33ff00" stroke="#33ff00" points="222.15,-179.44 216.2,-188.21 226.31,-185.07 222.15,-179.44"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M521.02,-67C493.01,-42.8 425.78,7.75 362,-1.34"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M360,-1.34C280.3,-12.69 266.52,-39.91 197.5,-81.34"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M195.5,-81.34C169.51,-96.94 152.29,-79.8 130,-100.34 72.83,-153 55.2,-249.8 50.02,-293.23"/>
<polygon fill="#33ff00" stroke="#33ff00" points="46.53,-292.98 48.94,-303.3 53.49,-293.73 46.53,-292.98"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M472.77,-91.39C467.81,-93.85 463.13,-96.8 459,-100.34 455.01,-103.76 395.05,-239.93 371.45,-293.76"/>
<polygon fill="#33ff00" stroke="#33ff00" points="368.17,-292.52 367.36,-303.09 374.58,-295.33 368.17,-292.52"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M485.07,-91.37C465.22,-96.21 442.17,-101.82 421.42,-106.87"/>
<polygon fill="#33ff00" stroke="#33ff00" points="420.33,-103.54 411.44,-109.3 421.98,-110.34 420.33,-103.54"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-53.34 334,-53.34 334,-29.34 388,-29.34 388,-53.34"/>
<text text-anchor="middle" x="361" y="-38.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M479.92,-67.32C453.27,-61.44 421.93,-54.54 398.26,-49.33"/>
<polygon fill="#33ff00" stroke="#33ff00" points="398.81,-45.86 388.29,-47.13 397.31,-52.7 398.81,-45.86"/>
</g>
<!-- module~propagators&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~propagators&#45;&gt;module~potential</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M677.64,-302.23C662.11,-290.1 636.62,-271.66 612,-260.34 602.26,-255.86 591.36,-252.15 580.94,-249.15"/>
<polygon fill="#00ff66" stroke="#00ff66" points="581.71,-245.74 571.15,-246.5 579.89,-252.5 581.71,-245.74"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M534.5,-389.34C435.24,-406.98 317.78,-385.74 251.02,-369.79"/>
<polygon fill="#00ff66" stroke="#00ff66" points="251.69,-366.35 241.15,-367.38 250.03,-373.15 251.69,-366.35"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M690.58,-326.72C684.94,-358.81 665.28,-445.18 612,-488.34 589.86,-506.27 390.44,-547.03 362,-545.34"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M360,-545.34C285.97,-540.84 262.37,-543.29 197.5,-507.34"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M675.34,-326.5C647.71,-345.15 590.94,-379.66 536.5,-389.34"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M534.5,-389.34C477.02,-399.55 415.51,-359.23 383.76,-334.1"/>
<polygon fill="#00ff66" stroke="#00ff66" points="385.59,-331.07 375.62,-327.47 381.16,-336.5 385.59,-331.07"/>
</g>
<!-- module~propagators&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~propagators&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M685.31,-302.34C672.78,-282.33 645.07,-242.02 612,-218.34 554.63,-177.25 477.56,-150.81 424.23,-136.08"/>
<polygon fill="#00ff66" stroke="#00ff66" points="425.12,-132.7 414.56,-133.47 423.3,-139.46 425.12,-132.7"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M493.39,-455.25C482.02,-451.36 469.83,-446.65 459,-441.34 382.64,-403.87 360.93,-394.64 299,-336.34 261.03,-300.6 227.05,-249.27 209.69,-220.99"/>
<polygon fill="#0066ff" stroke="#0066ff" points="212.62,-219.09 204.45,-212.34 206.64,-222.71 212.62,-219.09"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M490.44,-478.47C411.19,-497.53 248.12,-532.08 197.5,-507.34"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M195.5,-507.34C124.17,-467.81 76.24,-377.93 57.21,-336.71"/>
<polygon fill="#0066ff" stroke="#0066ff" points="60.39,-335.25 53.1,-327.56 54.01,-338.12 60.39,-335.25"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M490.23,-457.92C479.22,-454.08 467.99,-448.74 459,-441.34 434.39,-421.1 442.12,-404.83 423,-379.34 410.95,-363.28 395.28,-346.91 382.84,-334.75"/>
<polygon fill="#0066ff" stroke="#0066ff" points="385.21,-332.18 375.57,-327.77 380.36,-337.22 385.21,-332.18"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M342.92,-303.25C314.34,-283.03 256.7,-242.23 223.21,-218.53"/>
<polygon fill="#3200ff" stroke="#3200ff" points="225.03,-215.53 214.84,-212.61 220.98,-221.25 225.03,-215.53"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M333.89,-321.77C313.05,-326.9 283.04,-334.28 256.47,-340.82"/>
<polygon fill="#3200ff" stroke="#3200ff" points="255.36,-337.49 246.49,-343.28 257.03,-344.29 255.36,-337.49"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M333.83,-315.34C301.71,-315.34 245.6,-315.34 197.5,-315.34"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M496.98,-133.42C462.37,-143.75 409.34,-157.54 362,-161.34"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M360,-161.34C319.77,-164.57 275.28,-175.81 243.04,-185.39"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="241.99,-182.05 233.44,-188.3 244.03,-188.75 241.99,-182.05"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M516.44,-133.34C476.12,-160.41 376.25,-228.95 299,-294.34 281.97,-308.76 281.73,-317.21 263,-329.34 257.27,-333.05 250.93,-336.37 244.52,-339.31"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="242.95,-336.17 235.13,-343.33 245.7,-342.61 242.95,-336.17"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M489.68,-109.3C409.58,-88.88 245.71,-52.33 197.5,-81.34"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M523.71,-133.48C494.73,-166.07 414.99,-255.75 379.47,-295.7"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="376.82,-293.41 372.79,-303.21 382.05,-298.06 376.82,-293.41"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M458.84,-121.34C450.34,-121.34 441.71,-121.34 433.27,-121.34"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="433.1,-117.84 423.1,-121.34 433.1,-124.84 433.1,-117.84"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M479.26,-109.27C472.24,-106.79 465.31,-103.84 459,-100.34 440.02,-89.81 441.25,-79.1 423,-67.34 415.2,-62.31 406.25,-57.87 397.67,-54.15"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="398.78,-50.82 388.2,-50.25 396.12,-57.29 398.78,-50.82"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~statetostatexs&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M490.44,-270.75C430.88,-256.43 324.44,-230.85 257.58,-214.78"/>
<polygon fill="#ff0098" stroke="#ff0098" points="258.15,-211.32 247.61,-212.38 256.51,-218.12 258.15,-211.32"/>
</g>
<!-- module~statetostatexs&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~statetostatexs&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M516.55,-293.45C495.3,-306.99 458.31,-328.1 423,-336.34 369.33,-348.86 353.82,-341.95 299,-336.34 253.17,-331.65 243.57,-315.34 197.5,-315.34"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~statetostatexs&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M490.08,-290.1C461.52,-295.72 424.9,-302.94 398.14,-308.22"/>
<polygon fill="#ff0098" stroke="#ff0098" points="397.18,-304.84 388.04,-310.21 398.53,-311.71 397.18,-304.84"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M330.32,-133.44C320.3,-137.67 309.09,-142.56 299,-147.34 274.96,-158.72 248.32,-172.68 228.37,-183.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="226.56,-180.42 219.43,-188.26 229.89,-186.58 226.56,-180.42"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M331.46,-109.29C291.14,-93.11 219.91,-67.86 197.5,-81.34"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-133.34 130,-133.34 130,-109.34 263,-109.34 263,-133.34"/>
<text text-anchor="middle" x="196.5" y="-118.94" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.57,-121.34C290.32,-121.34 281.79,-121.34 273.34,-121.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.09,-117.84 263.09,-121.34 273.09,-124.84 273.09,-117.84"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="884pt"
 viewBox="0.00 0.00 641.00 884.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.03 2.03) rotate(0) translate(4 1792.95)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1792.95 1299,-1792.95 1299,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-783 0,-783 0,-759 79,-759 79,-783"/>
<text text-anchor="middle" x="39.5" y="-768.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="587.5,-1497 442.5,-1497 442.5,-1473 587.5,-1473 587.5,-1497"/>
<text text-anchor="middle" x="515" y="-1482.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.87,-783.28C43.71,-872.32 63.12,-1417.1 115,-1466 159.08,-1507.54 328.78,-1501.24 432.14,-1493.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="432.56,-1496.52 442.24,-1492.22 431.99,-1489.54 432.56,-1496.52"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="379.5,-403 141.5,-403 141.5,-379 379.5,-379 379.5,-403"/>
<text text-anchor="middle" x="260.5" y="-388.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.22,-758.64C44.82,-701.21 62.86,-461.09 115,-412 120.15,-407.15 125.89,-403.12 132.03,-399.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="133.78,-402.81 141.29,-395.33 130.76,-396.49 133.78,-402.81"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="1007,-1739 913,-1739 913,-1715 1007,-1715 1007,-1739"/>
<text text-anchor="middle" x="960" y="-1724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.59,-783.24C41.46,-885.47 49.83,-1595.12 115,-1660 225.5,-1770.02 732.55,-1743.7 902.96,-1731.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="903.25,-1734.94 912.97,-1730.73 902.75,-1727.96 903.25,-1734.94"/>
</g>
<!-- proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~set_channels_l_values</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/set_channels_l_values.html" xlink:title="set_channels_l_values">
<polygon fill="#d9534f" stroke="#d9534f" points="325.5,-1457 195.5,-1457 195.5,-1433 325.5,-1433 325.5,-1457"/>
<text text-anchor="middle" x="260.5" y="-1442.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_l_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_l_values</title>
<path fill="none" stroke="#ff0000" d="M41,-783.03C44.67,-868.01 68.43,-1375.98 115,-1424 133.07,-1442.64 159.81,-1449.72 185.39,-1451.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.34,-1455.02 195.49,-1451.97 185.65,-1448.03 185.34,-1455.02"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-587 478,-587 478,-563 552,-563 552,-587"/>
<text text-anchor="middle" x="515" y="-572.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M41.38,-758.86C44.5,-725.75 58.16,-633.73 115,-594 222.25,-519.04 388.15,-544.26 467.99,-562.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="467.21,-566.11 477.75,-565.02 468.83,-559.3 467.21,-566.11"/>
</g>
<!-- proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~potential_reduction</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/potential_reduction.html" xlink:title="potential_reduction">
<polygon fill="#d9534f" stroke="#d9534f" points="800.5,-1577 685.5,-1577 685.5,-1553 800.5,-1553 800.5,-1577"/>
<text text-anchor="middle" x="743" y="-1562.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_reduction</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~potential_reduction</title>
<path fill="none" stroke="#ff0000" d="M40.75,-783.27C42.79,-877.24 58.05,-1480.79 115,-1535 154.84,-1572.92 521.7,-1569.69 675.08,-1566.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="675.38,-1570.12 685.31,-1566.42 675.24,-1563.13 675.38,-1570.12"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="586.5,-667 443.5,-667 443.5,-643 586.5,-643 586.5,-667"/>
<text text-anchor="middle" x="515" y="-652.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M46.29,-758.99C56.78,-738.75 81.04,-698.35 115,-681 215.4,-629.72 348.98,-633.04 433.25,-642.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="432.94,-645.81 443.27,-643.48 433.74,-638.85 432.94,-645.81"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="783.5,-1337 702.5,-1337 702.5,-1313 783.5,-1313 783.5,-1337"/>
<text text-anchor="middle" x="743" y="-1322.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M40.78,-783.16C42.53,-846.87 53.84,-1141.46 115,-1203 207.62,-1296.18 277.01,-1230.04 406,-1255 507.9,-1274.71 626.68,-1300.01 692.2,-1314.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="691.73,-1317.64 702.25,-1316.33 693.21,-1310.8 691.73,-1317.64"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1295,-1505 1203,-1505 1203,-1481 1295,-1481 1295,-1505"/>
<text text-anchor="middle" x="1249" y="-1490.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.56,-783.25C41.2,-888.7 48.08,-1641.08 115,-1712 237.86,-1842.19 334.99,-1767 514,-1767 514,-1767 514,-1767 961,-1767 1053.94,-1767 1096.39,-1791.43 1167,-1731 1232.7,-1674.77 1245.22,-1563.03 1247.53,-1515.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1251.03,-1515.34 1247.9,-1505.21 1244.03,-1515.07 1251.03,-1515.34"/>
</g>
<!-- proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~print_bf_channels</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/print_bf_channels.html" xlink:title="print_bf_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="796,-621 690,-621 690,-597 796,-597 796,-621"/>
<text text-anchor="middle" x="743" y="-606.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_bf_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~print_bf_channels</title>
<path fill="none" stroke="#ff0000" d="M79.06,-763.11C90.59,-760.93 103.28,-758.69 115,-757 219.57,-741.9 502.71,-771.36 588,-709 620.46,-685.27 592.05,-650.41 624,-626 639.76,-613.96 660.25,-608.55 679.72,-606.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="680.08,-609.98 689.78,-605.71 679.54,-603 680.08,-609.98"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1022,-1215 898,-1215 898,-1191 1022,-1191 1022,-1215"/>
<text text-anchor="middle" x="960" y="-1200.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M43.66,-783.16C51.32,-810.34 73.38,-876.56 115,-914 156.98,-951.77 543.08,-1065.78 588,-1100 609.21,-1116.16 601.03,-1134.46 624,-1148 716,-1202.22 756.94,-1161.84 862,-1181 874.33,-1183.25 887.47,-1185.99 899.97,-1188.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="899.3,-1192.2 909.82,-1190.99 900.84,-1185.38 899.3,-1192.2"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1167,-916 1058,-916 1058,-892 1167,-892 1167,-916"/>
<text text-anchor="middle" x="1112.5" y="-901.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M79.19,-769.79C145.91,-767.64 286.92,-762.83 406,-757 507.25,-752.04 764.72,-715.49 862,-744 957.63,-772.03 1051.35,-849.21 1091.33,-885.14"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1089.06,-887.81 1098.81,-891.95 1093.77,-882.63 1089.06,-887.81"/>
</g>
<!-- proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~potential_interpolation</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/potential_interpolation.html" xlink:title="potential_interpolation">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-1373 194,-1373 194,-1349 327,-1349 327,-1373"/>
<text text-anchor="middle" x="260.5" y="-1358.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_interpolation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~potential_interpolation</title>
<path fill="none" stroke="#ff0000" d="M40.19,-783.38C38.58,-858.98 34.04,-1257.88 115,-1340 132.75,-1358.01 158.61,-1365.17 183.57,-1367.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.63,-1370.71 193.8,-1367.77 184.01,-1363.72 183.63,-1370.71"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~set_number_of_open_channels_wavmax</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/set_number_of_open_channels_wavmax.html" xlink:title="set_number_of_open_channels_wavmax">
<polygon fill="#d9534f" stroke="#d9534f" points="373.5,-627 147.5,-627 147.5,-603 373.5,-603 373.5,-627"/>
<text text-anchor="middle" x="260.5" y="-612.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_open_channels_wavmax</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax</title>
<path fill="none" stroke="#ff0000" d="M43.8,-758.69C51.49,-732.57 73.2,-671.58 115,-642 122.11,-636.97 129.9,-632.79 138.05,-629.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.32,-632.61 147.4,-625.75 136.81,-626.07 139.32,-632.61"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-895 459,-895 459,-871 571,-871 571,-895"/>
<text text-anchor="middle" x="515" y="-880.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M79.25,-780.17C161.57,-799.64 354.41,-845.25 453.25,-868.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="452.55,-872.06 463.09,-870.96 454.16,-865.25 452.55,-872.06"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-305 459,-305 459,-281 571,-281 571,-305"/>
<text text-anchor="middle" x="515" y="-290.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.96,-758.83C48.09,-709.91 73.35,-528.52 115,-492 213.07,-406.01 308.33,-540.44 406,-454 454.11,-411.42 397.31,-360.15 442,-314 444.36,-311.57 446.97,-309.41 449.78,-307.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="451.69,-310.45 458.68,-302.49 448.25,-304.35 451.69,-310.45"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="307.5,-277 213.5,-277 213.5,-253 307.5,-253 307.5,-277"/>
<text text-anchor="middle" x="260.5" y="-262.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.5,-758.7C40.76,-690.04 45.6,-354.84 115,-286 137.62,-263.56 172.86,-258.09 202.87,-258.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.14,-261.85 213.24,-258.65 203.35,-254.85 203.14,-261.85"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="784,-1661 702,-1661 702,-1637 784,-1637 784,-1661"/>
<text text-anchor="middle" x="743" y="-1646.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M40.73,-783.1C42.7,-878.44 57.76,-1506.48 115,-1565 188.99,-1640.65 483.66,-1602.39 588,-1620 604.16,-1622.73 607.93,-1624.79 624,-1628 646.18,-1632.44 670.8,-1636.89 691.79,-1640.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="691.33,-1644.02 701.78,-1642.28 692.52,-1637.12 691.33,-1644.02"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-1194 215,-1194 215,-1170 306,-1170 306,-1194"/>
<text text-anchor="middle" x="260.5" y="-1179.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M41.4,-783.3C45.81,-840.49 66.94,-1079.89 115,-1134 137.63,-1159.48 174.12,-1171.47 204.76,-1177.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="204.47,-1180.59 214.9,-1178.77 205.61,-1173.69 204.47,-1180.59"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-235 209.5,-235 209.5,-211 311.5,-211 311.5,-235"/>
<text text-anchor="middle" x="260.5" y="-220.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.33,-758.6C39.63,-686.27 39.84,-319.45 115,-244 136.6,-222.31 169.98,-216.41 199.22,-216.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.3,-219.73 209.36,-216.39 199.41,-212.73 199.3,-219.73"/>
</g>
<!-- proc~potential_read -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~potential_read</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/potential_read.html" xlink:title="potential_read">
<polygon fill="#d9534f" stroke="#d9534f" points="559.5,-1133 470.5,-1133 470.5,-1109 559.5,-1109 559.5,-1133"/>
<text text-anchor="middle" x="515" y="-1118.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_read</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_read -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~potential_read</title>
<path fill="none" stroke="#ff0000" d="M41.42,-783.32C45.74,-837.43 65.87,-1053.21 115,-1095 212.68,-1178.1 377.16,-1154.8 461.17,-1135.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="462.09,-1138.77 471,-1133.05 460.47,-1131.96 462.09,-1138.77"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-1331 478,-1331 478,-1307 552,-1307 552,-1331"/>
<text text-anchor="middle" x="515" y="-1316.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M40.51,-783.27C40.8,-851.78 45.81,-1186.22 115,-1255 161.36,-1301.08 341.57,-1286.98 406,-1298 426.27,-1301.47 448.59,-1305.73 467.65,-1309.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="467.09,-1312.97 477.58,-1311.49 468.46,-1306.1 467.09,-1312.97"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="305,-193 216,-193 216,-169 305,-169 305,-193"/>
<text text-anchor="middle" x="260.5" y="-178.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.19,-758.62C38.58,-683.02 34.04,-284.12 115,-202 138.11,-178.56 174.94,-173.5 205.63,-174.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.64,-177.7 215.78,-174.64 205.94,-170.71 205.64,-177.7"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="578.5,-1653 451.5,-1653 451.5,-1629 578.5,-1629 578.5,-1653"/>
<text text-anchor="middle" x="515" y="-1638.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.64,-783.25C41.9,-882.59 52.67,-1554.08 115,-1615 208.51,-1706.38 380.39,-1677.37 464.72,-1655.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="465.78,-1659 474.56,-1653.06 463.99,-1652.23 465.78,-1659"/>
</g>
<!-- proc~bf_to_sf_transformation -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~bf_to_sf_transformation</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/bf_to_sf_transformation.html" xlink:title="bf_to_sf_transformation">
<polygon fill="#d9534f" stroke="#d9534f" points="329.5,-319 191.5,-319 191.5,-295 329.5,-295 329.5,-319"/>
<text text-anchor="middle" x="260.5" y="-304.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bf_to_sf_transformation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~bf_to_sf_transformation -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~bf_to_sf_transformation</title>
<path fill="none" stroke="#ff0000" d="M40.69,-758.92C41.96,-694.32 51.3,-390.3 115,-328 132.37,-311.02 156.97,-303.81 180.97,-301.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="181.47,-304.9 191.19,-300.69 180.97,-297.92 181.47,-304.9"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="287.5,-151 233.5,-151 233.5,-127 287.5,-127 287.5,-151"/>
<text text-anchor="middle" x="260.5" y="-136.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M41.1,-758.97C45.3,-677.17 71.35,-204.66 115,-160 142.66,-131.7 190.32,-130.1 223.3,-133.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="223.12,-136.67 233.45,-134.3 223.9,-129.71 223.12,-136.67"/>
</g>
<!-- proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~print_largest_partial_xs</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/print_largest_partial_xs.html" xlink:title="print_largest_partial_xs">
<polygon fill="#d9534f" stroke="#d9534f" points="811,-1139 675,-1139 675,-1115 811,-1115 811,-1139"/>
<text text-anchor="middle" x="743" y="-1124.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_xs</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_xs</title>
<path fill="none" stroke="#ff0000" d="M52.34,-783.11C66.4,-797.05 90.97,-820.06 115,-836 309.94,-965.35 400.33,-927.31 588,-1067 606.92,-1081.08 603.31,-1094.68 624,-1106 636.53,-1112.86 650.83,-1117.55 665.04,-1120.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="664.35,-1124.17 674.85,-1122.72 665.74,-1117.31 664.35,-1124.17"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="304.5,-109 216.5,-109 216.5,-85 304.5,-85 304.5,-109"/>
<text text-anchor="middle" x="260.5" y="-94.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M41,-758.97C44.67,-673.99 68.43,-166.02 115,-118 138.07,-94.21 175.26,-89.24 206.13,-90.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="206.17,-93.58 216.33,-90.56 206.5,-86.59 206.17,-93.58"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="329.5,-445 191.5,-445 191.5,-421 329.5,-421 329.5,-445"/>
<text text-anchor="middle" x="260.5" y="-430.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M41.65,-758.91C46.83,-706.74 69.87,-501.65 115,-459 132.67,-442.3 157.23,-434.44 181.09,-431.14"/>
<polygon fill="#ff0000" stroke="#ff0000" points="181.71,-434.59 191.25,-430 180.93,-427.64 181.71,-434.59"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-361 161,-361 161,-337 360,-337 360,-361"/>
<text text-anchor="middle" x="260.5" y="-346.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.92,-758.87C43.3,-697.91 57.06,-425.7 115,-370 125.07,-360.32 137.51,-353.83 150.82,-349.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="151.92,-352.94 160.65,-346.93 150.08,-346.18 151.92,-352.94"/>
</g>
<!-- proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~check_dtol_otol</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/check_dtol_otol.html" xlink:title="check_dtol_otol">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-67 213,-67 213,-43 308,-43 308,-67"/>
<text text-anchor="middle" x="260.5" y="-52.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_dtol_otol</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~check_dtol_otol</title>
<path fill="none" stroke="#ff0000" d="M40.92,-758.77C44.11,-670.08 65.54,-127.35 115,-76 137.2,-52.95 172.64,-47.53 202.86,-47.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.77,-51.45 212.89,-48.3 203.02,-44.45 202.77,-51.45"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~set_channels_level_indices_channels_omega_values</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/set_channels_level_indices_channels_omega_values.html" xlink:title="set_channels_level_indices_channels_omega_values">
<polygon fill="#d9534f" stroke="#d9534f" points="406,-1415 115,-1415 115,-1391 406,-1391 406,-1415"/>
<text text-anchor="middle" x="260.5" y="-1400.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_level_indices_channels_omega_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values</title>
<path fill="none" stroke="#ff0000" d="M41.1,-783.03C45.3,-864.83 71.35,-1337.34 115,-1382 115.82,-1382.84 116.66,-1383.65 117.51,-1384.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="115.63,-1387.43 125.62,-1390.97 120.02,-1381.98 115.63,-1387.43"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="862,-1535 624,-1535 624,-1511 862,-1511 862,-1535"/>
<text text-anchor="middle" x="743" y="-1520.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.81,-783.22C43.27,-874.28 60.78,-1444.91 115,-1496 184.95,-1561.92 456.29,-1549.8 618.21,-1535.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="618.58,-1539.38 628.23,-1535.03 617.97,-1532.41 618.58,-1539.38"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-525 230.5,-525 230.5,-501 290.5,-501 290.5,-525"/>
<text text-anchor="middle" x="260.5" y="-510.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M41.21,-758.86C43.96,-723.25 56.84,-618 115,-561 143.37,-533.2 188.21,-521.5 220.41,-516.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="220.96,-520.03 230.39,-515.2 220.01,-513.1 220.96,-520.03"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="987,-467 933,-467 933,-443 987,-443 987,-467"/>
<text text-anchor="middle" x="960" y="-452.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M70.91,-758.91C84.26,-753.99 100.23,-748.62 115,-745 140.79,-738.68 568.62,-694.16 588,-676 644.04,-623.49 567.45,-558.96 624,-507 663.25,-470.93 809.5,-486.24 862,-477 882.28,-473.43 904.72,-468.41 922.9,-464.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="923.9,-467.43 932.79,-461.67 922.25,-460.63 923.9,-467.43"/>
</g>
<!-- proc~crosssection -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~crosssection</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/crosssection.html" xlink:title="CROSSSECTION">
<polygon fill="#d9534f" stroke="#d9534f" points="308.5,-1331 212.5,-1331 212.5,-1307 308.5,-1307 308.5,-1331"/>
<text text-anchor="middle" x="260.5" y="-1316.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CROSSSECTION</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~crosssection -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~crosssection</title>
<path fill="none" stroke="#ff0000" d="M40.39,-783.25C40.01,-854.68 41.76,-1217.06 115,-1293 137.08,-1315.9 171.97,-1322.65 201.93,-1323.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.26,-1327.06 212.3,-1323.65 202.33,-1320.06 202.26,-1327.06"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="307,-25 214,-25 214,-1 307,-1 307,-25"/>
<text text-anchor="middle" x="260.5" y="-10.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.84,-758.92C43.53,-667.68 62.58,-88.75 115,-34 137.37,-10.64 173.33,-5.35 203.78,-5.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.73,-9.42 213.87,-6.32 204.01,-2.42 203.73,-9.42"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="995,-1419 925,-1419 925,-1395 995,-1395 995,-1419"/>
<text text-anchor="middle" x="960" y="-1404.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_number_of_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>proc~set_number_of_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M587.78,-1488.17C658.84,-1489.34 770.04,-1485.8 862,-1459 887.7,-1451.51 914.31,-1436.65 933.15,-1424.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="935.25,-1427.53 941.74,-1419.15 931.44,-1421.66 935.25,-1427.53"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="587.5,-104 442.5,-104 442.5,-80 587.5,-80 587.5,-104"/>
<text text-anchor="middle" x="515" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ff2900" d="M379.52,-387.48C389.34,-383.32 398.4,-377.64 406,-370 487.35,-288.23 366.55,-200.23 442,-113 442.86,-112 443.77,-111.05 444.72,-110.14"/>
<polygon fill="#ff2900" stroke="#ff2900" points="446.88,-112.89 452.66,-104.02 442.61,-107.35 446.88,-112.89"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="555,-146 475,-146 475,-122 555,-122 555,-146"/>
<text text-anchor="middle" x="515" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ff2900" d="M379.63,-387.09C389.36,-382.99 398.38,-377.43 406,-370 473.81,-303.9 381.21,-232.61 442,-160 448.08,-152.74 456.35,-147.51 465.12,-143.74"/>
<polygon fill="#ff2900" stroke="#ff2900" points="466.58,-146.93 474.75,-140.19 464.16,-140.36 466.58,-146.93"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff5200" d="M1007.42,-1733.78C1052.86,-1737.75 1121.67,-1736.36 1167,-1701 1226.45,-1654.62 1242.32,-1558.6 1246.52,-1515.18"/>
<polygon fill="#ff5200" stroke="#ff5200" points="1250.01,-1515.36 1247.37,-1505.1 1243.04,-1514.77 1250.01,-1515.36"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1156,-1135 1069,-1135 1069,-1111 1156,-1111 1156,-1135"/>
<text text-anchor="middle" x="1112.5" y="-1120.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff5200" d="M970.76,-1714.97C984.47,-1697.41 1009.19,-1663.22 1022,-1630 1090.68,-1451.89 1107.06,-1218.09 1110.6,-1145.48"/>
<polygon fill="#ff5200" stroke="#ff5200" points="1114.11,-1145.4 1111.06,-1135.25 1107.11,-1145.08 1114.11,-1145.4"/>
</g>
<!-- proc~set_channels_l_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~set_channels_l_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff7c00" d="M325.59,-1443.9C435.52,-1441.65 667.02,-1435.26 862,-1419 879.36,-1417.55 898.41,-1415.34 914.98,-1413.2"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="915.49,-1416.66 924.95,-1411.89 914.58,-1409.72 915.49,-1416.66"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffce00" d="M800.52,-1560.99C882.02,-1554.6 1037.05,-1540.19 1167,-1515 1177.3,-1513 1188.21,-1510.39 1198.58,-1507.67"/>
<polygon fill="#ffce00" stroke="#ffce00" points="1199.57,-1511.02 1208.31,-1505.03 1197.74,-1504.27 1199.57,-1511.02"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ffce00" d="M800.69,-1568.54C822.79,-1566.81 846.48,-1560.54 862,-1544 959.91,-1439.61 808.49,-1335.68 898,-1224 898.7,-1223.13 899.44,-1222.29 900.21,-1221.49"/>
<polygon fill="#ffce00" stroke="#ffce00" points="902.44,-1224.18 907.99,-1215.16 898.02,-1218.76 902.44,-1224.18"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#fff800" d="M569,-642.89C576.13,-639.37 582.77,-634.84 588,-629 633.72,-577.91 571.71,-523.34 624,-479 668.17,-441.54 845.52,-447.77 922.75,-452.43"/>
<polygon fill="#fff800" stroke="#fff800" points="922.76,-455.94 932.96,-453.08 923.2,-448.96 922.76,-455.94"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#dcff00" d="M776.29,-1312.98C801.21,-1302.76 835.73,-1286.51 862,-1266 881.38,-1250.87 877.67,-1237.82 898,-1224 900.39,-1222.38 902.91,-1220.87 905.53,-1219.47"/>
<polygon fill="#dcff00" stroke="#dcff00" points="907.14,-1222.57 914.66,-1215.11 904.13,-1216.26 907.14,-1222.57"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#dcff00" d="M783.55,-1328.2C806.96,-1331.03 836.86,-1336.29 862,-1346 889.07,-1356.46 916.79,-1374.81 935.63,-1388.66"/>
<polygon fill="#dcff00" stroke="#dcff00" points="933.77,-1391.64 943.87,-1394.85 937.98,-1386.05 933.77,-1391.64"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#89ff00" d="M796.26,-604.99C897.7,-598.45 1115.8,-590.78 1167,-641 1228.07,-700.9 1244.81,-1342.55 1247.56,-1470.77"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1244.07,-1471.03 1247.77,-1480.95 1251.06,-1470.88 1244.07,-1471.03"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#89ff00" d="M777.95,-596.92C803.59,-586.42 838.3,-569.09 862,-545 886.26,-520.35 871.79,-498.57 898,-476 905.09,-469.89 914.05,-465.54 922.91,-462.44"/>
<polygon fill="#89ff00" stroke="#89ff00" points="924.2,-465.7 932.75,-459.45 922.17,-459 924.2,-465.7"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="770,-1379 716,-1379 716,-1355 770,-1355 770,-1379"/>
<text text-anchor="middle" x="743" y="-1364.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~potential_interpolation&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~potential_interpolation&#45;&gt;proc~spline</title>
<path fill="none" stroke="#0dff00" d="M327.05,-1361.82C429.66,-1363.1 624.83,-1365.54 705.6,-1366.55"/>
<polygon fill="#0dff00" stroke="#0dff00" points="705.73,-1370.05 715.77,-1366.67 705.81,-1363.05 705.73,-1370.05"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff1b" d="M373.79,-622.28C455.21,-625.06 556.36,-622.55 588,-596 641.18,-551.37 569.55,-487.06 624,-444 711.7,-374.65 856.46,-415.59 923.23,-440.34"/>
<polygon fill="#00ff1b" stroke="#00ff1b" points="922.29,-443.73 932.88,-444.01 924.77,-437.18 922.29,-443.73"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff44" d="M553.34,-870.88C565.76,-865.28 578.77,-857.49 588,-847 620.04,-810.6 591.66,-780.13 624,-744 702.23,-656.61 788.54,-721.43 862,-630 906.03,-575.21 850.89,-528.17 898,-476 904.63,-468.66 913.95,-463.88 923.3,-460.78"/>
<polygon fill="#00ff44" stroke="#00ff44" points="924.26,-464.14 932.96,-458.11 922.39,-457.4 924.26,-464.14"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="813,-937 673,-937 673,-913 813,-913 813,-937"/>
<text text-anchor="middle" x="743" y="-922.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#00ff44" d="M571.19,-893.91C588.12,-897.21 606.82,-900.8 624,-904 636.71,-906.37 650.21,-908.82 663.36,-911.18"/>
<polygon fill="#00ff44" stroke="#00ff44" points="662.87,-914.65 673.33,-912.97 664.1,-907.76 662.87,-914.65"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="791,-1257 695,-1257 695,-1233 791,-1233 791,-1257"/>
<text text-anchor="middle" x="743" y="-1242.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#00ff44" d="M518.68,-895.15C527.84,-934.73 560.95,-1062.4 624,-1148 648.59,-1181.38 687.15,-1210.16 713.45,-1227.52"/>
<polygon fill="#00ff44" stroke="#00ff44" points="711.56,-1230.46 721.86,-1232.95 715.36,-1224.59 711.56,-1230.46"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="770,-305 716,-305 716,-281 770,-281 770,-305"/>
<text text-anchor="middle" x="743" y="-290.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ff44" d="M557.64,-870.96C569.33,-865.53 580.8,-857.82 588,-847 653.78,-748.18 544.74,-402.38 624,-314 644.05,-291.64 679.01,-287.82 705.68,-288.74"/>
<polygon fill="#00ff44" stroke="#00ff44" points="705.63,-292.24 715.81,-289.32 706.03,-285.25 705.63,-292.24"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="770,-1097 716,-1097 716,-1073 770,-1073 770,-1097"/>
<text text-anchor="middle" x="743" y="-1082.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#00ff44" d="M528.35,-895.14C543.91,-910.98 570.72,-940.08 588,-969 610.1,-1005.98 591.15,-1031.13 624,-1059 646.63,-1078.2 680.3,-1084.12 705.89,-1085.57"/>
<polygon fill="#00ff44" stroke="#00ff44" points="705.83,-1089.07 715.95,-1085.94 706.09,-1082.08 705.83,-1089.07"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="789.5,-895 696.5,-895 696.5,-871 789.5,-871 789.5,-895"/>
<text text-anchor="middle" x="743" y="-880.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#00ff44" d="M571.29,-883C606.25,-883 651.3,-883 686.34,-883"/>
<polygon fill="#00ff44" stroke="#00ff44" points="686.4,-886.5 696.4,-883 686.4,-879.5 686.4,-886.5"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ff6e" d="M571.29,-293C613.15,-293 669.47,-293 705.75,-293"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="705.88,-296.5 715.88,-293 705.88,-289.5 705.88,-296.5"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="806.5,-347 679.5,-347 679.5,-323 806.5,-323 806.5,-347"/>
<text text-anchor="middle" x="743" y="-332.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ff6e" d="M571.19,-303.91C588.12,-307.21 606.82,-310.8 624,-314 638.54,-316.71 654.11,-319.53 669.01,-322.2"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="668.74,-325.7 679.2,-324.01 669.97,-318.81 668.74,-325.7"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="815.5,-263 670.5,-263 670.5,-239 815.5,-239 815.5,-263"/>
<text text-anchor="middle" x="743" y="-248.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00ff6e" d="M571.19,-282.09C588.12,-278.79 606.82,-275.2 624,-272 636.71,-269.63 650.21,-267.18 663.36,-264.82"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="664.1,-268.24 673.33,-263.03 662.87,-261.35 664.1,-268.24"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffc0" d="M784.31,-1650.78C839.05,-1652.17 939.52,-1651.11 1022,-1630 1090.78,-1612.4 1107.34,-1601.47 1167,-1563 1189.88,-1548.25 1213.09,-1527.46 1228.77,-1512.38"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="1231.54,-1514.56 1236.24,-1505.07 1226.64,-1509.56 1231.54,-1514.56"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1007,-1621 913,-1621 913,-1597 1007,-1597 1007,-1621"/>
<text text-anchor="middle" x="960" y="-1606.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ffc0" d="M784.17,-1642.03C807.01,-1638.02 836.13,-1632.84 862,-1628 875.17,-1625.54 889.34,-1622.81 902.66,-1620.21"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="903.51,-1623.61 912.65,-1618.25 902.17,-1616.74 903.51,-1623.61"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ffc0" d="M784.2,-1650.98C809.02,-1650.15 840.17,-1645.18 862,-1628 895.28,-1601.81 936.48,-1479.21 952.34,-1428.77"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="955.7,-1429.75 955.33,-1419.16 949.02,-1427.67 955.7,-1429.75"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00ffea" d="M306.3,-1183.1C384.95,-1185.85 543.77,-1195.28 588,-1227 617.08,-1247.85 595.78,-1277.01 624,-1299 643.23,-1313.98 669.31,-1320.72 692.07,-1323.61"/>
<polygon fill="#00ffea" stroke="#00ffea" points="691.94,-1327.12 702.25,-1324.69 692.67,-1320.16 691.94,-1327.12"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#00ffea" d="M283.91,-1194.16C329.02,-1218.63 430.87,-1273.9 482.59,-1301.96"/>
<polygon fill="#00ffea" stroke="#00ffea" points="481.18,-1305.18 491.64,-1306.87 484.52,-1299.02 481.18,-1305.18"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-1175 478,-1175 478,-1151 552,-1151 552,-1175"/>
<text text-anchor="middle" x="515" y="-1160.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#00ffea" d="M306.06,-1178.65C351.47,-1175.23 421.59,-1169.95 467.64,-1166.49"/>
<polygon fill="#00ffea" stroke="#00ffea" points="467.94,-1169.98 477.65,-1165.73 467.42,-1163 467.94,-1169.98"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="781,-1619 705,-1619 705,-1595 781,-1595 781,-1619"/>
<text text-anchor="middle" x="743" y="-1604.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#00ffea" d="M306.05,-1191.76C386.69,-1210.35 551.87,-1253.04 588,-1298 668.8,-1398.56 535.18,-1492.46 624,-1586 641.8,-1604.75 670.12,-1610.24 694.55,-1610.94"/>
<polygon fill="#00ffea" stroke="#00ffea" points="694.74,-1614.44 704.74,-1610.96 694.75,-1607.44 694.74,-1614.44"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-838 467.5,-838 467.5,-814 562.5,-814 562.5,-838"/>
<text text-anchor="middle" x="515" y="-823.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#00ffea" d="M265.38,-1169.91C280.65,-1124.01 340.79,-958.28 442,-862 450.22,-854.18 460.46,-847.7 470.62,-842.5"/>
<polygon fill="#00ffea" stroke="#00ffea" points="472.35,-845.55 479.87,-838.08 469.33,-839.24 472.35,-845.55"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~potential_read&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00c0ff" d="M559.67,-1125.93C570.16,-1129.05 580.5,-1134.04 588,-1142 637.12,-1194.08 573.16,-1248.6 624,-1299 641.78,-1316.63 668.62,-1323.47 692.22,-1325.75"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="692.22,-1329.26 702.44,-1326.49 692.72,-1322.28 692.22,-1329.26"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~potential_read&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00c0ff" d="M559.88,-1129.7C569.57,-1132.72 579.48,-1136.72 588,-1142 608.05,-1154.42 602.71,-1170.84 624,-1181 707.84,-1221.03 817.17,-1219.74 887.73,-1213.07"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="888.25,-1216.53 897.85,-1212.05 887.55,-1209.57 888.25,-1216.53"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~potential_read&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#00c0ff" d="M521.74,-1108.6C535.23,-1081.03 571.76,-1014.66 624,-984 716.38,-929.78 756.29,-963.34 862,-946 925.26,-935.63 997.48,-923.43 1047.89,-914.86"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="1048.71,-918.27 1057.98,-913.14 1047.54,-911.37 1048.71,-918.27"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~potential_read&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00c0ff" d="M559.74,-1126.33C570.11,-1129.46 580.36,-1134.35 588,-1142 628.55,-1182.6 580.98,-1228.02 624,-1266 704.3,-1336.9 767.33,-1253.88 862,-1304 898.77,-1323.46 929.34,-1362.25 945.82,-1386.28"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="942.97,-1388.32 951.43,-1394.7 948.8,-1384.43 942.97,-1388.32"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0044ff" d="M551.52,-1653.06C572.36,-1659.5 599.36,-1666.75 624,-1670 799.53,-1693.16 848.94,-1690.39 1022,-1653 1088.35,-1638.67 1112.24,-1645.11 1167,-1605 1199.98,-1580.84 1224.94,-1539.23 1237.95,-1514.1"/>
<polygon fill="#0044ff" stroke="#0044ff" points="1241.14,-1515.55 1242.49,-1505.04 1234.88,-1512.41 1241.14,-1515.55"/>
</g>
<!-- proc~transform_summation -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~transform_summation</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/transform_summation.html" xlink:title="transform_summation">
<polygon fill="#d9534f" stroke="#d9534f" points="580,-24 450,-24 450,0 580,0 580,-24"/>
<text text-anchor="middle" x="515" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transform_summation</text>
</a>
</g>
</g>
<!-- proc~bf_to_sf_transformation&#45;&gt;proc~transform_summation -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~bf_to_sf_transformation&#45;&gt;proc~transform_summation</title>
<path fill="none" stroke="#001bff" d="M329.65,-313.54C356.83,-312.37 386.28,-305.72 406,-286 484.75,-207.24 371.6,-124.31 442,-38 444.62,-34.79 447.67,-31.98 451,-29.51"/>
<polygon fill="#001bff" stroke="#001bff" points="453.14,-32.3 459.8,-24.07 449.45,-26.35 453.14,-32.3"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#3700ff" d="M811.12,-1126.81C870.81,-1129.61 958.27,-1141.25 1022,-1182 1138.46,-1256.46 1214.4,-1414 1239.16,-1471.45"/>
<polygon fill="#3700ff" stroke="#3700ff" points="1236.07,-1473.12 1243.19,-1480.97 1242.52,-1470.4 1236.07,-1473.12"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#3700ff" d="M811.19,-1137.3C828.16,-1141.11 846.08,-1146.22 862,-1153 879.69,-1160.53 881.08,-1167.86 898,-1177 904.48,-1180.5 911.52,-1183.87 918.45,-1186.96"/>
<polygon fill="#3700ff" stroke="#3700ff" points="917.19,-1190.23 927.76,-1190.99 919.97,-1183.81 917.19,-1190.23"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#3700ff" d="M811.3,-1118.46C828.09,-1115.4 845.9,-1111.33 862,-1106 937.47,-1081 961.23,-1077.26 1022,-1026 1056.69,-996.73 1085.32,-951.4 1100.27,-925.02"/>
<polygon fill="#3700ff" stroke="#3700ff" points="1103.36,-926.66 1105.15,-916.22 1097.24,-923.27 1103.36,-926.66"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#8900ff" d="M329.81,-439.31C356.85,-438.05 386.15,-431.41 406,-412 474.96,-344.57 368.53,-260.49 442,-198 462.95,-180.18 831.97,-176.21 862,-197 941.54,-252.07 955.95,-381.06 958.49,-432.88"/>
<polygon fill="#8900ff" stroke="#8900ff" points="954.99,-433.12 958.88,-442.98 961.99,-432.85 954.99,-433.12"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="987,-44 933,-44 933,-20 987,-20 987,-44"/>
<text text-anchor="middle" x="960" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#b300ff" d="M360.05,-351.69C377.24,-347.75 393.57,-340.49 406,-328 487.35,-246.23 357.88,-149.91 442,-71 459.55,-54.54 808.47,-38.37 922.96,-33.49"/>
<polygon fill="#b300ff" stroke="#b300ff" points="923.13,-36.98 932.98,-33.06 922.84,-29.99 923.13,-36.98"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#b300ff" d="M360.15,-351.34C377.24,-347.4 393.5,-340.23 406,-328 475.24,-260.23 377.65,-185.43 442,-113 442.88,-112.01 443.79,-111.07 444.75,-110.18"/>
<polygon fill="#b300ff" stroke="#b300ff" points="446.91,-112.93 452.77,-104.11 442.68,-107.35 446.91,-112.93"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#b300ff" d="M360.09,-350.8C377.08,-346.88 393.32,-339.86 406,-328 461.77,-275.84 391.78,-217.53 442,-160 448.23,-152.87 456.56,-147.69 465.35,-143.94"/>
<polygon fill="#b300ff" stroke="#b300ff" points="466.81,-147.13 474.99,-140.39 464.4,-140.56 466.81,-147.13"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff00f8" d="M406.02,-1403.83C565.96,-1404.75 814.37,-1406.17 914.72,-1406.75"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="914.79,-1410.25 924.81,-1406.8 914.83,-1403.25 914.79,-1410.25"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00ce" d="M862.17,-1515.97C966.31,-1509.77 1113.4,-1501.01 1192.5,-1496.3"/>
<polygon fill="#ff00ce" stroke="#ff00ce" points="1192.96,-1499.78 1202.74,-1495.69 1192.55,-1492.79 1192.96,-1499.78"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00ce" d="M758.57,-1510.89C783.81,-1489.08 835.5,-1440.53 862,-1388 895.61,-1321.37 848.37,-1279.72 898,-1224 898.88,-1223.01 899.81,-1222.07 900.78,-1221.17"/>
<polygon fill="#ff00ce" stroke="#ff00ce" points="902.99,-1223.89 908.95,-1215.13 898.83,-1218.26 902.99,-1223.89"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff00a5" d="M290.96,-520.23C334.5,-530.92 416.42,-551.04 467.94,-563.69"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="467.28,-567.13 477.82,-566.12 468.94,-560.33 467.28,-567.13"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00a5" d="M290.77,-507.9C326.37,-501.97 388.38,-492.55 442,-489 506.75,-484.71 523.52,-481.71 588,-489 728.45,-504.88 759.2,-533.3 898,-560 957.41,-571.43 1125.61,-557.87 1167,-602 1228.3,-667.37 1244.9,-1338.94 1247.58,-1470.65"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="1244.08,-1470.84 1247.78,-1480.77 1251.08,-1470.7 1244.08,-1470.84"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff00a5" d="M290.69,-508.63C361.79,-498.66 541.53,-477.59 588,-512 632.07,-544.63 583.69,-592.83 624,-630 757.11,-752.75 880.06,-604.59 1022,-717 1075.65,-759.48 1098.97,-842.01 1107.43,-881.66"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="1104.03,-882.53 1109.43,-891.64 1110.89,-881.15 1104.03,-882.53"/>
</g>
<!-- proc~numerov&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~numerov&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff00a5" d="M290.67,-509.58C324.02,-504.03 377.65,-489.79 406,-454 469.7,-373.58 364.01,-292.64 442,-226 462.24,-208.7 818.12,-200.67 862,-230 932.07,-276.83 951.78,-385.93 957.11,-432.88"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="953.64,-433.31 958.14,-442.9 960.6,-432.6 953.64,-433.31"/>
</g>
<!-- proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~cenitrfugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/cenitrfugal_matrix.html" xlink:title="cenitrfugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="570,-427 460,-427 460,-403 570,-403 570,-427"/>
<text text-anchor="middle" x="515" y="-412.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cenitrfugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~numerov&#45;&gt;proc~cenitrfugal_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.77,-513.69C321.56,-513.12 370.41,-508.45 406,-487 428.24,-473.6 420.97,-456.22 442,-441 447.16,-437.27 452.91,-434.02 458.84,-431.21"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="460.48,-434.32 468.27,-427.14 457.7,-427.89 460.48,-434.32"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="588,-347 442,-347 442,-323 588,-323 588,-347"/>
<text text-anchor="middle" x="515" y="-332.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.59,-516.13C322.87,-517.9 374.52,-515.47 406,-487 449.19,-447.93 402.25,-403.56 442,-361 445.15,-357.63 448.76,-354.7 452.66,-352.14"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="454.58,-355.08 461.58,-347.14 451.15,-348.98 454.58,-355.08"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="565.5,-545 464.5,-545 464.5,-521 565.5,-521 565.5,-545"/>
<text text-anchor="middle" x="515" y="-530.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#ff00a5" d="M290.96,-515.33C330.84,-518.49 402.93,-524.2 454.35,-528.28"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="454.1,-531.77 464.35,-529.07 454.65,-524.79 454.1,-531.77"/>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.71,-515.61C322.6,-516.85 373.46,-513.84 406,-487 440.19,-458.8 408.21,-422.68 442,-394 459.23,-379.38 586.34,-358.09 669.48,-345.49"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="670.02,-348.94 679.39,-343.99 668.98,-342.02 670.02,-348.94"/>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.72,-509.33C323.87,-503.56 377.05,-489.13 406,-454 458.44,-390.36 380.16,-326.54 442,-272 508.95,-212.96 620.29,-223.41 686.86,-236.87"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="686.24,-240.32 696.74,-238.96 687.68,-233.47 686.24,-240.32"/>
</g>
<!-- proc~crosssection&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~crosssection&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0052" d="M308.7,-1319C354.12,-1319 422.38,-1319 467.55,-1319"/>
<polygon fill="#ff0052" stroke="#ff0052" points="467.66,-1322.5 477.66,-1319 467.66,-1315.5 467.66,-1322.5"/>
</g>
<!-- proc~crosssection&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~crosssection&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0052" d="M308.66,-1313.07C340.14,-1311.87 380.33,-1316.05 406,-1340 461.2,-1391.5 415.99,-1435.13 442,-1506 457.65,-1548.64 484.52,-1594.55 500.63,-1620.34"/>
<polygon fill="#ff0052" stroke="#ff0052" points="497.74,-1622.31 506.04,-1628.88 503.65,-1618.56 497.74,-1622.31"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M788.76,-937.05C813.84,-946.04 843.66,-960.84 862,-984 905.1,-1038.42 865.6,-1074.6 898,-1136 907.67,-1154.32 923.53,-1171.52 936.65,-1183.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="934.64,-1186.81 944.39,-1190.96 939.36,-1181.64 934.64,-1186.81"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0000" d="M783.11,-937.07C808.27,-946.48 840.21,-961.74 862,-984 888.15,-1010.71 869.6,-1035.7 898,-1060 943.42,-1098.85 1011.88,-1113.75 1058.96,-1119.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1058.64,-1122.95 1068.97,-1120.58 1059.41,-1115.99 1058.64,-1122.95"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-551 933,-551 933,-527 987,-527 987,-551"/>
<text text-anchor="middle" x="960" y="-536.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#ff0000" d="M813.26,-925.6C830.98,-922.53 848.75,-916.18 862,-904 913.65,-856.5 946.74,-633.26 956.2,-561.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="959.71,-561.54 957.51,-551.18 952.76,-560.65 959.71,-561.54"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#91ff00" d="M791.18,-1235.78C819.4,-1230.27 855.82,-1223.16 887.52,-1216.96"/>
<polygon fill="#91ff00" stroke="#91ff00" points="888.48,-1220.34 897.62,-1214.99 887.14,-1213.47 888.48,-1220.34"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#91ff00" d="M791.17,-1254.71C859.9,-1267.83 983.58,-1287.28 1022,-1266 1068.93,-1240.01 1094.52,-1178 1105.29,-1144.82"/>
<polygon fill="#91ff00" stroke="#91ff00" points="1108.67,-1145.73 1108.27,-1135.15 1101.98,-1143.67 1108.67,-1145.73"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-1257 933,-1257 933,-1233 987,-1233 987,-1257"/>
<text text-anchor="middle" x="960" y="-1242.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#91ff00" d="M791.18,-1245C830.78,-1245 886.53,-1245 922.72,-1245"/>
<polygon fill="#91ff00" stroke="#91ff00" points="922.82,-1248.5 932.82,-1245 922.82,-1241.5 922.82,-1248.5"/>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ff91" d="M558.03,-402.98C568.2,-399.22 578.79,-394.57 588,-389 606.57,-377.76 604.54,-365.62 624,-356 637.92,-349.12 653.76,-344.46 669.21,-341.32"/>
<polygon fill="#00ff91" stroke="#00ff91" points="670.08,-344.72 679.29,-339.47 668.82,-337.84 670.08,-344.72"/>
</g>
<!-- dfloat -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>dfloat</title>
<polygon fill="#777777" stroke="#777777" points="770,-389 716,-389 716,-365 770,-365 770,-389"/>
<text text-anchor="middle" x="743" y="-374.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfloat</text>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;dfloat -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;dfloat</title>
<path fill="none" stroke="#00ff91" d="M570.13,-405.9C612.09,-398.84 669.06,-389.26 705.69,-383.11"/>
<polygon fill="#00ff91" stroke="#00ff91" points="706.63,-386.5 715.91,-381.39 705.46,-379.59 706.63,-386.5"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ffda" d="M577.08,-322.95C592.39,-319.97 608.79,-316.83 624,-314 651.32,-308.91 682.25,-303.42 705.58,-299.33"/>
<polygon fill="#00ffda" stroke="#00ffda" points="706.49,-302.72 715.73,-297.55 705.28,-295.83 706.49,-302.72"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ffda" d="M588.13,-335C614.02,-335 643.21,-335 669.16,-335"/>
<polygon fill="#00ffda" stroke="#00ffda" points="669.31,-338.5 679.31,-335 669.31,-331.5 669.31,-338.5"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00ffda" d="M570.21,-322.95C576.45,-320.48 582.53,-317.53 588,-314 608.66,-300.67 602.65,-284.2 624,-272 635.16,-265.62 647.8,-261.1 660.56,-257.91"/>
<polygon fill="#00ffda" stroke="#00ffda" points="661.33,-261.33 670.32,-255.72 659.79,-254.5 661.33,-261.33"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00daff" d="M781.04,-1602.48C870.33,-1591.32 1095.37,-1561.6 1167,-1537 1185.93,-1530.5 1205.69,-1519.85 1220.96,-1510.66"/>
<polygon fill="#00daff" stroke="#00daff" points="1223.17,-1513.41 1229.83,-1505.17 1219.49,-1507.45 1223.17,-1513.41"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00daff" d="M781.14,-1611.11C807.58,-1611.8 841.86,-1607.76 862,-1586 916.92,-1526.68 847.85,-1287.41 898,-1224 898.69,-1223.12 899.43,-1222.28 900.2,-1221.47"/>
<polygon fill="#00daff" stroke="#00daff" points="902.43,-1224.17 907.94,-1215.12 897.99,-1218.76 902.43,-1224.17"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00daff" d="M781.45,-1607.35C814.77,-1607.66 864,-1608.12 902.17,-1608.47"/>
<polygon fill="#00daff" stroke="#00daff" points="902.59,-1611.98 912.62,-1608.57 902.65,-1604.98 902.59,-1611.98"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00daff" d="M781.26,-1608.44C806.25,-1607.59 838.72,-1602.8 862,-1586 916.23,-1546.86 943.29,-1467.79 953.71,-1429.2"/>
<polygon fill="#00daff" stroke="#00daff" points="957.12,-1430.01 956.22,-1419.46 950.34,-1428.27 957.12,-1430.01"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0091ff" d="M789.68,-879.77C814.12,-880.57 843,-885.94 862,-904 913.57,-953.02 875.95,-992.35 898,-1060 912.45,-1104.34 935.18,-1153.97 948.43,-1181.55"/>
<polygon fill="#0091ff" stroke="#0091ff" points="945.34,-1183.19 952.85,-1190.66 951.64,-1180.14 945.34,-1183.19"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0091ff" d="M789.56,-880.23C813.8,-881.2 842.54,-886.59 862,-904 904.13,-941.7 857.64,-986.41 898,-1026 938.8,-1066.02 970.31,-1035.63 1022,-1060 1046.96,-1071.77 1072.41,-1090.46 1089.75,-1104.43"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1087.63,-1107.22 1097.58,-1110.86 1092.07,-1101.81 1087.63,-1107.22"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-509 933,-509 933,-485 987,-485 987,-509"/>
<text text-anchor="middle" x="960" y="-494.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#0091ff" d="M767.58,-870.85C795.23,-855.24 840.06,-825.39 862,-786 920.48,-681 821.84,-610.96 898,-518 904.32,-510.28 913.63,-505.39 923.08,-502.3"/>
<polygon fill="#0091ff" stroke="#0091ff" points="924.1,-505.65 932.86,-499.68 922.29,-498.89 924.1,-505.65"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0048ff" d="M526.47,-520.74C541.37,-502.9 569,-468.38 588,-436 607.73,-402.37 593.25,-379.97 624,-356 636.98,-345.88 653.2,-340.01 669.42,-336.73"/>
<polygon fill="#0048ff" stroke="#0048ff" points="670.23,-340.15 679.49,-335.01 669.05,-333.25 670.23,-340.15"/>
</g>
<!-- proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~radtermvalue</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/radtermvalue.html" xlink:title="RADTERMVALUE">
<polygon fill="#d9534f" stroke="#d9534f" points="791.5,-1017 694.5,-1017 694.5,-993 791.5,-993 791.5,-1017"/>
<text text-anchor="middle" x="743" y="-1002.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RADTERMVALUE</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~radtermvalue</title>
<path fill="none" stroke="#0048ff" d="M565.61,-539.01C574.19,-542.21 582.2,-546.97 588,-554 643.63,-621.51 574.65,-873.77 624,-946 638.25,-966.85 662.11,-980.68 684.66,-989.68"/>
<polygon fill="#0048ff" stroke="#0048ff" points="683.62,-993.03 694.21,-993.24 686.07,-986.47 683.62,-993.03"/>
</g>
<!-- proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~p_coeff</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/p_coeff.html" xlink:title="p_coeff">
<polygon fill="#d94e8f" stroke="#d94e8f" points="770,-24 716,-24 716,0 770,0 770,-24"/>
<text text-anchor="middle" x="743" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_coeff</text>
</a>
</g>
</g>
<!-- proc~transform_summation&#45;&gt;proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~transform_summation&#45;&gt;proc~p_coeff</title>
<path fill="none" stroke="#0000ff" d="M580.16,-12C620.78,-12 671.84,-12 705.62,-12"/>
<polygon fill="#0000ff" stroke="#0000ff" points="705.95,-15.5 715.95,-12 705.95,-8.5 705.95,-15.5"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#4800ff" d="M995.05,-1417.2C1045.3,-1432.26 1139.63,-1460.53 1197.82,-1477.96"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1196.96,-1481.36 1207.54,-1480.88 1198.97,-1474.65 1196.96,-1481.36"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#9100ff" d="M1149.76,-1135.14C1156.26,-1138.73 1162.42,-1143.28 1167,-1149 1207.67,-1199.83 1236.57,-1402.73 1245.27,-1470.69"/>
<polygon fill="#9100ff" stroke="#9100ff" points="1241.81,-1471.25 1246.53,-1480.73 1248.76,-1470.38 1241.81,-1471.25"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#da00ff" d="M770.38,-1369.7C796.8,-1370.89 837.04,-1368.34 862,-1346 904.13,-1308.3 858.93,-1264.86 898,-1224 899.06,-1222.89 900.19,-1221.83 901.37,-1220.83"/>
<polygon fill="#da00ff" stroke="#da00ff" points="903.55,-1223.58 909.79,-1215.02 899.57,-1217.82 903.55,-1223.58"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#da00ff" d="M770.36,-1371.9C806.38,-1378.61 871.47,-1390.71 914.96,-1398.81"/>
<polygon fill="#da00ff" stroke="#da00ff" points="914.51,-1402.28 924.98,-1400.67 915.79,-1395.4 914.51,-1402.28"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0048" d="M562.53,-822.61C697.39,-813.9 1084.13,-797.02 1167,-883 1249.99,-969.1 1249.77,-1371.11 1248.41,-1470.66"/>
<polygon fill="#ff0048" stroke="#ff0048" points="1244.91,-1470.73 1248.26,-1480.78 1251.91,-1470.84 1244.91,-1470.73"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0048" d="M555.18,-838.03C567.32,-843.55 579.67,-851.3 588,-862 633.85,-920.88 569.73,-974.78 624,-1026 701.9,-1099.52 771.24,-1007.11 862,-1064 885.36,-1078.64 926.49,-1146.32 946.86,-1181.55"/>
<polygon fill="#ff0048" stroke="#ff0048" points="944.02,-1183.62 952.03,-1190.56 950.09,-1180.14 944.02,-1183.62"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0048" d="M562.56,-829.9C629.11,-835.7 755.18,-847.47 862,-862 925.32,-870.61 997.24,-883 1047.55,-892.09"/>
<polygon fill="#ff0048" stroke="#ff0048" points="1047.16,-895.58 1057.63,-893.92 1048.41,-888.69 1047.16,-895.58"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0048" d="M524.9,-813.96C539.77,-793.38 569.8,-749.72 588,-709 610.9,-657.78 585.1,-628.44 624,-588 701.46,-507.47 765,-562.47 862,-507 880.33,-496.52 879.69,-486.51 898,-476 905.75,-471.55 914.59,-467.83 923.1,-464.83"/>
<polygon fill="#ff0048" stroke="#ff0048" points="924.43,-468.07 932.84,-461.62 922.24,-461.42 924.43,-468.07"/>
</g>
<!-- proc~wavenumberekin -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~wavenumberekin</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/wavenumberekin.html" xlink:title="WAVENUMBEREKIN">
<polygon fill="#d94e8f" stroke="#d94e8f" points="799,-777 687,-777 687,-753 799,-753 799,-777"/>
<text text-anchor="middle" x="743" y="-762.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">WAVENUMBEREKIN</text>
</a>
</g>
</g>
<!-- proc~input_summary&#45;&gt;proc~wavenumberekin -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~input_summary&#45;&gt;proc~wavenumberekin</title>
<path fill="none" stroke="#ff0048" d="M550.28,-813.95C571.39,-806.77 599.08,-797.77 624,-791 641.01,-786.38 659.56,-781.99 676.81,-778.18"/>
<polygon fill="#ff0048" stroke="#ff0048" points="677.77,-781.56 686.8,-776.01 676.28,-774.72 677.77,-781.56"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1139.5,-509 1085.5,-509 1085.5,-485 1139.5,-485 1139.5,-509"/>
<text text-anchor="middle" x="1112.5" y="-494.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ff0000" d="M987.22,-531.68C1011.63,-524.87 1048.26,-514.65 1075.43,-507.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1076.64,-510.36 1085.33,-504.3 1074.76,-503.62 1076.64,-510.36"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1139.5,-551 1085.5,-551 1085.5,-527 1139.5,-527 1139.5,-551"/>
<text text-anchor="middle" x="1112.5" y="-536.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ff0000" d="M987.22,-539C1011.53,-539 1047.93,-539 1075.07,-539"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1075.33,-542.5 1085.33,-539 1075.33,-535.5 1075.33,-542.5"/>
</g>
<!-- proc~p_coeff&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~p_coeff&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#48ff00" d="M770.36,-14.45C808.59,-18.01 879.53,-24.61 922.68,-28.62"/>
<polygon fill="#48ff00" stroke="#48ff00" points="922.48,-32.12 932.76,-29.56 923.12,-25.15 922.48,-32.12"/>
</g>
<!-- proc~wavenumberekin&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~wavenumberekin&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff91" d="M765.31,-752.86C792.38,-736.25 838.42,-703.79 862,-663 904.35,-589.72 842.53,-539.92 898,-476 904.48,-468.53 913.75,-463.71 923.12,-460.61"/>
<polygon fill="#00ff91" stroke="#00ff91" points="924.08,-463.98 932.79,-457.96 922.22,-457.23 924.08,-463.98"/>
</g>
<!-- proc~wavenumberekin&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~wavenumberekin&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff91" d="M768.37,-777.26C796.35,-792.79 841.07,-822.37 862,-862 904.09,-941.7 875.82,-1178.64 898,-1266 909.28,-1310.44 932.91,-1358.77 947.23,-1385.73"/>
<polygon fill="#00ff91" stroke="#00ff91" points="944.21,-1387.51 952.04,-1394.65 950.37,-1384.19 944.21,-1387.51"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#4800ff" d="M987.22,-497C1011.53,-497 1047.93,-497 1075.07,-497"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1075.33,-500.5 1085.33,-497 1075.33,-493.5 1075.33,-500.5"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#4800ff" d="M987.22,-504.32C1011.63,-511.13 1048.26,-521.35 1075.43,-528.93"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1074.76,-532.38 1085.33,-531.7 1076.64,-525.64 1074.76,-532.38"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00da" d="M791.74,-1004.93C815.44,-1007.31 842.98,-1014.03 862,-1031 898.81,-1063.85 872.87,-1093.55 898,-1136 908.62,-1153.94 924.58,-1171.25 937.52,-1183.79"/>
<polygon fill="#ff00da" stroke="#ff00da" points="935.43,-1186.63 945.11,-1190.94 940.23,-1181.53 935.43,-1186.63"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff00da" d="M790.43,-1017.1C815.41,-1026 844.59,-1040.7 862,-1064 916.59,-1137.05 871.72,-1178.68 898,-1266 911.28,-1310.13 934.42,-1358.92 948.06,-1385.98"/>
<polygon fill="#ff00da" stroke="#ff00da" points="944.96,-1387.6 952.62,-1394.91 951.2,-1384.42 944.96,-1387.6"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="987,-1017 933,-1017 933,-993 987,-993 987,-1017"/>
<text text-anchor="middle" x="960" y="-1002.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#ff00da" d="M791.72,-1005C831.35,-1005 886.88,-1005 922.9,-1005"/>
<polygon fill="#ff00da" stroke="#ff00da" points="922.96,-1008.5 932.96,-1005 922.96,-1001.5 922.96,-1008.5"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1276,-530 1222,-530 1222,-506 1276,-506 1276,-530"/>
<text text-anchor="middle" x="1249" y="-515.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1139.75,-501.1C1160.3,-504.31 1189.12,-508.81 1211.85,-512.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1211.39,-515.83 1221.81,-513.91 1212.47,-508.91 1211.39,-515.83"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ff00" d="M1139.75,-534.9C1160.3,-531.69 1189.12,-527.19 1211.85,-523.64"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1212.47,-527.09 1221.81,-522.09 1211.39,-520.17 1212.47,-527.09"/>
</g>
<!-- proc~ispline&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~ispline&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#0000ff" d="M987.06,-995.86C998.19,-991.46 1011.11,-985.68 1022,-979 1048.22,-962.91 1074.81,-939.54 1092.11,-923.18"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1094.59,-925.65 1099.37,-916.2 1089.74,-920.61 1094.59,-925.65"/>
</g>
<!-- proc~ispline&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge140" class="edge">
<title>proc~ispline&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0000ff" d="M987.06,-1014.01C998.32,-1018.53 1011.33,-1024.62 1022,-1032 1051.34,-1052.3 1079.17,-1083.06 1095.79,-1103.09"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1093.17,-1105.42 1102.2,-1110.96 1098.6,-1100.99 1093.17,-1105.42"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen~4">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2~4">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~8">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_level_indices~13"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_level_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~3"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij~10"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~8"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~15"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_index"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_index</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_indextmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_indextmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate~2"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavmax~2"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">POTENTIAL</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PES_COUPLING_MATRIX</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">statetostateXS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w"> </span><span class="n">write_message</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_indextmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wavmax</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channels_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_read</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_reduction</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_interpolation</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_index</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_index</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channels_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channels_level_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channels_level_indices and channels_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_level_indices_channels_omega_values</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_l_values</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_bf_channels</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">! and the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_number_of_open_channels_wavmax</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">wavmax</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">wavmax</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">bf_to_sf_transformation</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">CROSSSECTION</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_xs</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_dtol_otol</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2023 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-12-29 14:32            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>