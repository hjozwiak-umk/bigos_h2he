<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">202 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-count_blocks">count_blocks</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~3">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/propagator_mod.html'>propagator_mod</a></li>
                <li><a href='../module/data_mod.html'>data_mod</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/pes_matrix_mod.html'>pes_matrix_mod</a></li>
                <li><a href='../module/save_s_matrix_mod.html'>save_s_matrix_mod</a></li>
                <li><a href='../module/radial_coupling_terms_mod.html'>radial_coupling_terms_mod</a></li>
                <li><a href='../module/state_to_state_cross_sections_mod.html'>state_to_state_cross_sections_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="492pt"
 viewBox="0.00 0.00 641.00 492.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.89 1.89) rotate(0) translate(4 926.48)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-926.48 1208,-926.48 1208,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="1204,-371.2 1125,-371.2 1125,-347.2 1204,-347.2 1204,-371.2"/>
<text text-anchor="middle" x="1164.5" y="-356.8" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~pes_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/pes_matrix_mod.html" xlink:title="pes_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="952,-371.2 852,-371.2 852,-347.2 952,-347.2 952,-371.2"/>
<text text-anchor="middle" x="902" y="-356.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1124.72,-370.07C1094.2,-378.93 1054.41,-391.23 1039.5,-399.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-399.2C1020.24,-408.42 971.68,-390.32 937.9,-375.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="938.93,-372.18 928.37,-371.31 936.08,-378.58 938.93,-372.18"/>
</g>
<!-- module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~radial_coupling_terms_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/radial_coupling_terms_mod.html" xlink:title="radial_coupling_terms_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="798,-717.2 638,-717.2 638,-693.2 798,-693.2 798,-717.2"/>
<text text-anchor="middle" x="718" y="-702.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-399.2C884.27,-481.05 1042.35,-662.47 903,-766.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-766.2C895.15,-770.56 812.05,-740.38 760.19,-720.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="761.17,-717.52 750.58,-717.27 758.7,-724.07 761.17,-717.52"/>
</g>
<!-- module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~save_s_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/save_s_matrix_mod.html" xlink:title="save_s_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="416,-831.2 299,-831.2 299,-807.2 416,-807.2 416,-831.2"/>
<text text-anchor="middle" x="357.5" y="-816.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~save_s_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-825.2C490.47,-818.26 455.88,-816.2 426.49,-816.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="426.32,-812.61 416.33,-816.15 426.35,-819.61 426.32,-812.61"/>
</g>
<!-- module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~state_to_state_cross_sections_mod</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/state_to_state_cross_sections_mod.html" xlink:title="state_to_state_cross_sections_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="816,-451.2 620,-451.2 620,-427.2 816,-427.2 816,-451.2"/>
<text text-anchor="middle" x="718" y="-436.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~state_to_state_cross_sections_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-399.2C888.61,-398.53 825.7,-413.03 777.27,-424.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="776.38,-421.37 767.49,-427.14 778.03,-428.18 776.38,-421.37"/>
</g>
<!-- module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~propagator_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/propagator_mod.html" xlink:title="propagator_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="1089,-371.2 988,-371.2 988,-347.2 1089,-347.2 1089,-371.2"/>
<text text-anchor="middle" x="1038.5" y="-356.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">propagator_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~propagator_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1124.95,-359.2C1116.87,-359.2 1108.18,-359.2 1099.53,-359.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1099.45,-355.7 1089.45,-359.2 1099.45,-362.7 1099.45,-355.7"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="255,-601.2 130,-601.2 130,-577.2 255,-577.2 255,-601.2"/>
<text text-anchor="middle" x="192.5" y="-586.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-766.2C827.48,-820.93 807.98,-841.18 719,-863.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-863.2C631.71,-884.31 608.67,-844.68 523,-825.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-825.2C493.31,-818.9 485.91,-817.82 460,-806.2 411.98,-784.67 407.72,-763.84 358.5,-745.2"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="419,-873.2 296,-873.2 296,-849.2 419,-849.2 419,-873.2"/>
<text text-anchor="middle" x="357.5" y="-858.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-863.2C631.71,-884.31 610.81,-898.1 523,-901.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-901.2C477.45,-902.74 429.15,-888.74 396.62,-876.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="397.64,-873.54 387.05,-873.3 395.18,-880.09 397.64,-873.54"/>
</g>
<!-- module~data_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~data_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/data_mod.html" xlink:title="data_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="225.5,-485.2 159.5,-485.2 159.5,-461.2 225.5,-461.2 225.5,-485.2"/>
<text text-anchor="middle" x="192.5" y="-470.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">data_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-399.2C733.22,-390.56 690.87,-392.58 523,-399.2"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="794.5,-778.2 641.5,-778.2 641.5,-754.2 794.5,-754.2 794.5,-778.2"/>
<text text-anchor="middle" x="718" y="-763.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-766.2C862.8,-794.64 806.49,-789.59 766.64,-780.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="767.42,-777.22 756.88,-778.28 765.79,-784.02 767.42,-777.22"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-525.2 0,-525.2 0,-501.2 94,-501.2 94,-525.2"/>
<text text-anchor="middle" x="47" y="-510.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-901.2C448.82,-903.75 427.25,-879.09 358.5,-901.2"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="549,-333.2 495,-333.2 495,-309.2 549,-309.2 549,-333.2"/>
<text text-anchor="middle" x="522" y="-318.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-399.2C984.77,-427.37 962.69,-402.44 903,-399.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-399.2C877.68,-397.94 871.06,-393.7 852,-380.2 831.93,-366 838.03,-349.12 816,-338.2 731.97,-296.56 617.33,-306.01 559.52,-314.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="558.74,-311.18 549.4,-316.19 559.82,-318.1 558.74,-311.18"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node13"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-215.2 291,-215.2 291,-191.2 424,-191.2 424,-215.2"/>
<text text-anchor="middle" x="357.5" y="-200.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1158.76,-346.89C1140.41,-301.13 1069.21,-140.05 952,-73.2 861.57,-21.62 822.97,-54.55 719,-49.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-49.2C601.97,-41.73 561.17,-28.94 460,-84.2 418.22,-107.02 386.06,-154.4 369.94,-182"/>
<polygon fill="#ff0000" stroke="#ff0000" points="366.8,-180.43 364.92,-190.86 372.89,-183.88 366.8,-180.43"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="763,-371.2 673,-371.2 673,-347.2 763,-347.2 763,-371.2"/>
<text text-anchor="middle" x="718" y="-356.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-399.2C876.52,-397.87 817.25,-384.1 772.95,-373.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="773.73,-369.67 763.18,-370.64 772.03,-376.46 773.73,-369.67"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M867.54,-371.33C861.52,-374.93 855.93,-379.49 852,-385.2 777.41,-493.67 902.34,-579.83 816,-679.2 813.17,-682.46 809.98,-685.33 806.53,-687.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="804.67,-684.89 798.04,-693.15 808.37,-690.83 804.67,-684.89"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M870.93,-371.29C864.12,-375.02 857.34,-379.64 852,-385.2 826.39,-411.87 844.3,-436.41 816,-460.2 654.29,-596.15 567.41,-557.76 358.5,-589.2"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M886.29,-347.1C870.05,-334.35 842.66,-314.56 816,-303.2 775.33,-285.87 762.71,-287.79 719,-281.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-281.2C631.74,-268.35 608.36,-269.04 523,-281.2"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~pes_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M893.97,-346.97C881.37,-326.33 852.75,-285.11 816,-267.2 698.54,-209.98 653.03,-256.01 523,-243.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-243.2C449.65,-232.02 430.23,-251.59 358.5,-243.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-243.2C284.55,-234.79 252.18,-200.71 193.5,-243.2"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-281.2C661.44,-272.82 597.77,-291.44 558.98,-306"/>
<polygon fill="#ff0000" stroke="#ff0000" points="557.26,-302.91 549.2,-309.78 559.79,-309.44 557.26,-302.91"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901.37,-347.17C901.93,-305.22 897.45,-164.76 816,-106.2 677.58,-6.69 458.46,-135.66 384.13,-185.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="382.12,-182.4 375.8,-190.9 386.05,-188.2 382.12,-182.4"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="584,-679.2 460,-679.2 460,-655.2 584,-655.2 584,-679.2"/>
<text text-anchor="middle" x="522" y="-664.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M868.84,-371.29C862.51,-374.94 856.46,-379.52 852,-385.2 811.79,-436.41 857.28,-476.85 816,-527.2 758.63,-597.18 658.02,-634.44 590.94,-652.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="589.67,-649.22 580.89,-655.14 591.45,-655.99 589.67,-649.22"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M637.88,-695.48C602.01,-693.72 559.54,-695.41 523,-707.2"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M521,-707.2C485.71,-718.59 393.32,-757.96 358.5,-745.2"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M708.18,-693.05C688.78,-667.23 639.65,-606.67 584,-575.2 468.52,-509.88 310.24,-485.39 235.65,-477.06"/>
<polygon fill="#ff7500" stroke="#ff7500" points="236.01,-473.58 225.69,-475.99 235.26,-480.54 236.01,-473.58"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M521,-707.2C485.69,-718.6 479.64,-732.72 460,-764.2 430.98,-810.72 463.04,-843.7 424,-882.2 402.42,-903.49 387.38,-892.01 358.5,-901.2"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M711.86,-693.08C696.87,-657.58 652.28,-550.68 620,-460.2 602.29,-410.56 619.47,-386.19 584,-347.2 577.22,-339.74 567.93,-334.34 558.66,-330.47"/>
<polygon fill="#ff7500" stroke="#ff7500" points="559.69,-327.12 549.1,-326.96 557.28,-333.69 559.69,-327.12"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M655.62,-693.18C636.15,-689.36 614.46,-685.12 594.35,-681.18"/>
<polygon fill="#ff7500" stroke="#ff7500" points="594.8,-677.7 584.32,-679.21 593.46,-684.57 594.8,-677.7"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M340.66,-807.05C326.53,-795.69 305.84,-777.74 291,-759.2 252.08,-710.57 218.97,-644.56 203.26,-610.89"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="206.31,-609.16 198.95,-601.54 199.95,-612.09 206.31,-609.16"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M349.44,-806.88C336.55,-784.05 308.9,-733.35 291,-688.2 270.47,-636.44 278.36,-618.74 255,-568.2 242.33,-540.8 222.71,-512.06 209.05,-493.47"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="211.85,-491.36 203.06,-485.44 206.24,-495.55 211.85,-491.36"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M313.63,-831.25C305.96,-833.88 298.15,-836.88 291,-840.2 244.64,-861.73 238.72,-925.04 193.5,-901.2"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M191.5,-901.2C55.81,-829.66 46.65,-607.44 47.34,-535.74"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="50.84,-535.64 47.51,-525.58 43.84,-535.51 50.84,-535.64"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M521,-475.2C493.23,-484.01 484.84,-483.97 460,-499.2 408.6,-530.72 418.12,-580.23 358.5,-589.2"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M356.5,-589.2C326.97,-593.65 294.08,-594.43 265.63,-593.81"/>
<polygon fill="#9cff00" stroke="#9cff00" points="265.45,-590.3 255.36,-593.52 265.26,-597.3 265.45,-590.3"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M669.89,-427.2C622.01,-415.42 551.03,-399.2 523,-399.2"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M626.52,-451.22C593.5,-456.85 556.14,-464.69 523,-475.2"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M521,-475.2C376.2,-521.14 194.6,-520.61 104.33,-516.73"/>
<polygon fill="#9cff00" stroke="#9cff00" points="104.46,-513.23 94.31,-516.27 104.14,-520.22 104.46,-513.23"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M694.24,-427.03C674.05,-415.85 644.11,-398.31 620,-380.2 602.65,-367.17 602.25,-358.96 584,-347.2 576.2,-342.17 567.25,-337.73 558.67,-334.01"/>
<polygon fill="#9cff00" stroke="#9cff00" points="559.78,-330.68 549.2,-330.11 557.12,-337.15 559.78,-330.68"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~propagator_mod&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M987.8,-359.2C979.5,-359.2 970.82,-359.2 962.31,-359.2"/>
<polygon fill="#27ff00" stroke="#27ff00" points="962.05,-355.7 952.05,-359.2 962.05,-362.7 962.05,-355.7"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~propagator_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M1012.27,-371.22C1004.31,-375.33 995.62,-380.17 988,-385.2 946.87,-412.35 859.94,-502.87 816,-525.2 720.95,-573.5 689.64,-571.83 584,-586.2 484.68,-599.71 458.3,-579.88 358.5,-589.2"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~propagator_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M901,-87.2C859.66,-65.9 858.93,-130.32 816,-148.2 734.45,-182.16 690.45,-127.91 620,-181.2 590.19,-203.75 611.31,-231.68 584,-257.2 562.72,-277.09 551.84,-277.09 523,-281.2"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M521,-281.2C449.52,-291.55 422.99,-248.7 358.5,-281.2"/>
</g>
<!-- module~propagator_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~propagator_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M1036.31,-347.12C1031.06,-301.56 1005.5,-140.15 903,-87.2"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M901,-87.2C861.65,-66.88 858.63,-47.21 816,-35.2 619.02,20.27 536.31,14.1 358.5,-87.2"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M356.5,-87.2C268.81,-135.85 274.72,-184.39 193.5,-243.2"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M191.5,-243.2C104.39,-306.27 65.29,-438.61 52.76,-491.08"/>
<polygon fill="#27ff00" stroke="#27ff00" points="49.3,-490.49 50.48,-501.01 56.13,-492.05 49.3,-490.49"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~propagator_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M901,-87.2C850.67,-61.91 861.69,-148.27 816,-181.2 738.83,-236.83 701.73,-218.52 620,-267.2 602.59,-277.57 601.47,-284.92 584,-295.2 576.07,-299.87 567.15,-304.15 558.62,-307.84"/>
<polygon fill="#27ff00" stroke="#27ff00" points="557.13,-304.67 549.24,-311.74 559.82,-311.14 557.13,-304.67"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~propagator_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M901,-87.2C827.54,-49.36 801.52,-53.45 719,-49.2"/>
</g>
<!-- module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node16" class="node">
<title>module~centrifugal_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node16"><a xlink:href=".././module/centrifugal_matrix_mod.html" xlink:title="centrifugal_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="787.5,-139.2 648.5,-139.2 648.5,-115.2 787.5,-115.2 787.5,-139.2"/>
<text text-anchor="middle" x="718" y="-124.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">centrifugal_matrix_mod</text>
</a>
</g>
</g>
<!-- module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M901,-87.2C850.37,-61.76 783.82,-89.86 746.84,-110.14"/>
<polygon fill="#27ff00" stroke="#27ff00" points="745.08,-107.12 738.1,-115.09 748.53,-113.21 745.08,-107.12"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M168.76,-577.16C144.87,-564.5 107.08,-544.49 80.14,-530.22"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="81.58,-527.03 71.11,-525.44 78.31,-533.21 81.58,-527.03"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M303.69,-849.09C299.07,-846.65 294.74,-843.72 291,-840.2 223.27,-776.43 201.92,-660.13 195.77,-611.51"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="199.23,-610.96 194.6,-601.43 192.28,-611.77 199.23,-610.96"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M301.23,-849.03C297.4,-846.59 293.91,-843.68 291,-840.2 212.81,-746.62 297.16,-682.62 255,-568.2 244.67,-540.16 224.9,-511.9 210.56,-493.58"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="213.01,-491.04 204.02,-485.44 207.55,-495.43 213.01,-491.04"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M327.05,-873.31C286.68,-889.1 216.5,-913.33 193.5,-901.2"/>
</g>
<!-- module~data_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~data_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M159.3,-482.18C142.12,-486.97 120.54,-492.98 100.97,-498.44"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="99.95,-495.09 91.25,-501.14 101.83,-501.83 99.95,-495.09"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge48" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M641.4,-764.1C544.05,-761.03 384.26,-754.64 358.5,-745.2"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge47" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M667.91,-754.05C651.1,-747.93 633.21,-739 620,-726.2 592,-699.07 611.64,-673.7 584,-646.2 570.5,-632.77 327.17,-529.48 231.59,-489.21"/>
<polygon fill="#004eff" stroke="#004eff" points="232.86,-485.94 222.28,-485.29 230.14,-492.39 232.86,-485.94"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge49" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M698.31,-778.3C673.18,-794.13 626.72,-821.88 584,-839.2 487.67,-878.25 457.55,-869.68 358.5,-901.2"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge50" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M659.84,-754.18C644.64,-748.23 629.75,-739.38 620,-726.2 519.34,-590.2 683.86,-483.79 584,-347.2 577.83,-338.77 568.37,-333.05 558.73,-329.17"/>
<polygon fill="#004eff" stroke="#004eff" points="559.74,-325.82 549.14,-325.88 557.46,-332.44 559.74,-325.82"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge51" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M659.93,-754.11C644.73,-748.17 629.82,-739.33 620,-726.2 528.69,-604.18 678.77,-504.55 584,-385.2 547.73,-339.52 500.72,-383.97 460,-342.2 423.2,-304.46 459.95,-267.74 424,-229.2 420.86,-225.84 417.24,-222.9 413.33,-220.34"/>
<polygon fill="#004eff" stroke="#004eff" points="414.85,-217.18 404.42,-215.31 411.41,-223.28 414.85,-217.18"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M679.11,-754.09C660.54,-747.3 638.29,-737.84 620,-726.2 601.69,-714.55 602.25,-704.96 584,-693.2 578.54,-689.68 572.52,-686.45 566.46,-683.55"/>
<polygon fill="#004eff" stroke="#004eff" points="567.52,-680.19 556.96,-679.27 564.64,-686.57 567.52,-680.19"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node17" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="549,-797.2 495,-797.2 495,-773.2 549,-773.2 549,-797.2"/>
<text text-anchor="middle" x="522" y="-782.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M641.44,-773.6C613.21,-776.37 582.43,-779.38 559.32,-781.64"/>
<polygon fill="#004eff" stroke="#004eff" points="558.89,-778.17 549.28,-782.63 559.57,-785.14 558.89,-778.17"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge54" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M505.86,-333.24C477.76,-355.29 415.23,-403.07 358.5,-437.2"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M356.5,-437.2C295.02,-474.19 237.09,-537.34 209.82,-569.35"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="207.02,-567.24 203.26,-577.14 212.37,-571.74 207.02,-567.24"/>
</g>
<!-- module~io_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge52" class="edge">
<title>module~io_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M494.69,-310.38C455.08,-294.82 382.24,-269.24 358.5,-281.2"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge56" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M505.06,-309.06C477.18,-288.9 416.93,-250.03 358.5,-243.2"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge55" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M510.84,-308.92C494.36,-289.66 459.99,-252.19 424,-229.2 418.25,-225.53 411.9,-222.22 405.48,-219.3"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="406.66,-215.99 396.08,-215.28 403.91,-222.43 406.66,-215.99"/>
</g>
<!-- module~input_validation -->
<g id="program~~scattering~~UsesGraph_node18" class="node">
<title>module~input_validation</title>
<g id="a_program~~scattering~~UsesGraph_node18"><a xlink:href=".././module/input_validation.html" xlink:title="input_validation">
<polygon fill="#337ab7" stroke="#337ab7" points="406,-333.2 309,-333.2 309,-309.2 406,-309.2 406,-333.2"/>
<text text-anchor="middle" x="357.5" y="-318.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_validation</text>
</a>
</g>
</g>
<!-- module~io_mod&#45;&gt;module~input_validation -->
<g id="program~~scattering~~UsesGraph_edge53" class="edge">
<title>module~io_mod&#45;&gt;module~input_validation</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M494.89,-321.2C473.73,-321.2 443.12,-321.2 416.26,-321.2"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="416.17,-317.7 406.17,-321.2 416.17,-324.7 416.17,-317.7"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge57" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M290.95,-207.77C259.09,-212.71 221.7,-222.78 193.5,-243.2"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge59" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M693.17,-371.26C667.08,-383.89 623.64,-403.25 584,-413.2 559.56,-419.33 380.09,-424.21 358.5,-437.2"/>
</g>
<!-- module~channels_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge60" class="edge">
<title>module~channels_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M672.94,-370.45C625.08,-382.28 551.63,-399.2 523,-399.2"/>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M521,-399.2C418.22,-399.2 389.52,-393.92 291,-423.2 265.93,-430.65 239.66,-444.52 220.72,-455.77"/>
<polygon fill="#ff0075" stroke="#ff0075" points="218.77,-452.86 212.04,-461.04 222.41,-458.84 218.77,-452.86"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge61" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M697.75,-347.12C677.96,-334.56 646.4,-314.13 620,-295.2 603.53,-283.39 601.61,-277.24 584,-267.2 558.69,-252.78 551.99,-246.06 523,-243.2"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge58" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M672.98,-350.58C638.58,-343.84 591.36,-334.59 559.15,-328.28"/>
<polygon fill="#ff0075" stroke="#ff0075" points="559.74,-324.83 549.26,-326.34 558.4,-331.7 559.74,-324.83"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge63" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M491.65,-679.22C481.55,-683.48 470.22,-688.41 460,-693.2 414.1,-714.71 406.09,-762.65 358.5,-745.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-745.2C286.95,-719.71 231.21,-646.76 206.83,-610.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.46,-608 201.05,-601.55 203.6,-611.83 209.46,-608"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge64" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M477.64,-679.29C470.94,-682.83 464.69,-687.37 460,-693.2 406.36,-759.8 481.55,-818.96 424,-882.2 403.6,-904.62 387.38,-892.01 358.5,-901.2"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-901.2C287.47,-923.17 257.58,-934.99 193.5,-901.2"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node19" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node19"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-679.2 291,-679.2 291,-655.2 424,-655.2 424,-679.2"/>
<text text-anchor="middle" x="357.5" y="-664.8" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge62" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.57,-667.2C451.32,-667.2 442.79,-667.2 434.34,-667.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="434.09,-663.7 424.09,-667.2 434.09,-670.7 434.09,-663.7"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge66" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M521,-205.2C474.27,-219.66 468.63,-237.18 424,-257.2 395.71,-269.89 386.19,-267.25 358.5,-281.2"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M356.5,-281.2C329.43,-294.84 314.76,-281.38 291,-300.2 240.33,-340.34 211.58,-414.48 199.82,-451.29"/>
<polygon fill="#7fff00" stroke="#7fff00" points="196.42,-450.44 196.83,-461.03 203.11,-452.49 196.42,-450.44"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge68" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M691.67,-115.04C630.32,-87.48 470.54,-27.12 358.5,-87.2"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge65" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M703.28,-139.43C683.34,-157.67 645.91,-193.65 620,-229.2 600.32,-256.2 608.74,-272.74 584,-295.2 576.8,-301.74 567.71,-306.79 558.77,-310.63"/>
<polygon fill="#7fff00" stroke="#7fff00" points="557.27,-307.45 549.21,-314.33 559.8,-313.98 557.27,-307.45"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge67" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M663.42,-139.2C649.1,-143.05 633.78,-147.75 620,-153.2 574.52,-171.21 569.73,-190.75 523,-205.2"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M521,-205.2C493.51,-213.7 462.14,-215.11 434.34,-213.73"/>
<polygon fill="#7fff00" stroke="#7fff00" points="434.47,-210.24 424.27,-213.11 434.03,-217.22 434.47,-210.24"/>
</g>
<!-- module~input_validation&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge70" class="edge">
<title>module~input_validation&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M348.02,-333.51C335.11,-352.43 310.03,-389.96 291,-423.2 273.42,-453.9 272.64,-463.53 255,-494.2 239.85,-520.55 220.55,-549.74 207.65,-568.72"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="204.64,-566.93 201.88,-577.16 210.42,-570.88 204.64,-566.93"/>
</g>
<!-- module~input_validation&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge71" class="edge">
<title>module~input_validation&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M343.44,-333.38C315.18,-359.73 248.2,-422.2 214.14,-453.95"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="211.55,-451.58 206.63,-460.96 216.33,-456.7 211.55,-451.58"/>
</g>
<!-- module~input_validation&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge69" class="edge">
<title>module~input_validation&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M346.27,-309.1C319.49,-278.9 245.84,-205.3 193.5,-243.2"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="950pt"
 viewBox="0.00 0.00 641.00 949.84" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(1.93 1.93) rotate(0) translate(4 1829)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1829 1233,-1829 1233,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-873 0,-873 0,-849 79,-849 79,-873"/>
<text text-anchor="middle" x="39.5" y="-858.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="267,-1825 179,-1825 179,-1801 267,-1801 267,-1825"/>
<text text-anchor="middle" x="223" y="-1810.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.6,-873.09C41.58,-977.19 50.77,-1720.01 115,-1792 128.41,-1807.04 149.17,-1813.2 168.85,-1815.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.77,-1818.77 178.99,-1816 169.27,-1811.79 168.77,-1818.77"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="267.5,-1783 178.5,-1783 178.5,-1759 267.5,-1759 267.5,-1783"/>
<text text-anchor="middle" x="223" y="-1768.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.68,-873.09C42.28,-974.11 55.51,-1675.55 115,-1745 128.13,-1760.33 148.63,-1767.44 168.19,-1770.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.94,-1773.99 178.29,-1771.75 168.8,-1767.05 167.94,-1773.99"/>
</g>
<!-- proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~save_partial_xs_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/save_partial_xs_file_header.html" xlink:title="save_partial_xs_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-1012 143.5,-1012 143.5,-988 302.5,-988 302.5,-1012"/>
<text text-anchor="middle" x="223" y="-997.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_file_header</title>
<path fill="none" stroke="#ff0000" d="M44.93,-873.06C54.16,-896.4 77.72,-947.77 115,-974 120.86,-978.12 127.29,-981.59 134.01,-984.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.73,-987.78 143.32,-988.18 135.29,-981.26 132.73,-987.78"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-1682 429,-1682 429,-1658 556,-1658 556,-1682"/>
<text text-anchor="middle" x="492.5" y="-1667.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.89,-873.13C43.93,-963.5 64.92,-1529.98 115,-1585 180.89,-1657.39 237.7,-1598.39 331,-1628 347.69,-1633.3 350.34,-1638.62 367,-1644 383.51,-1649.33 401.62,-1653.83 418.78,-1657.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="418.26,-1660.99 428.76,-1659.6 419.68,-1654.13 418.26,-1660.99"/>
</g>
<!-- proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~interpolate_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/interpolate_radial_coupling_terms.html" xlink:title="interpolate_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="589.5,-928 395.5,-928 395.5,-904 589.5,-904 589.5,-928"/>
<text text-anchor="middle" x="492.5" y="-913.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M48.04,-873.25C59.79,-891.03 84.33,-923.24 115,-936 165.14,-956.87 308.49,-942.28 403.14,-929.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="403.85,-932.86 413.28,-928.03 402.9,-925.93 403.85,-932.86"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="834,-479 685,-479 685,-455 834,-455 834,-479"/>
<text text-anchor="middle" x="759.5" y="-464.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M41.86,-848.68C47.69,-798.3 72.19,-608.77 115,-570 186.98,-504.81 255.16,-597.66 331,-537 365.29,-509.57 330.73,-469.75 367,-445 459.14,-382.11 506.78,-436.35 618,-445 639.99,-446.71 663.75,-449.91 685.36,-453.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="685.02,-456.84 695.45,-454.99 686.14,-449.93 685.02,-456.84"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="312,-768 134,-768 134,-744 312,-744 312,-768"/>
<text text-anchor="middle" x="223" y="-753.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M47.67,-848.72C59.27,-830.02 84.04,-794.71 115,-777 118.27,-775.13 121.69,-773.42 125.2,-771.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.69,-775.03 134.68,-768.08 124.1,-768.53 126.69,-775.03"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-1176 177.5,-1176 177.5,-1152 268.5,-1152 268.5,-1176"/>
<text text-anchor="middle" x="223" y="-1161.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M42.13,-873.29C48.83,-921.86 75.71,-1099.65 115,-1138 128.92,-1151.58 148.67,-1158.47 167.42,-1161.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.98,-1165.32 177.39,-1163.35 168.02,-1158.4 166.98,-1165.32"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-726 177.5,-726 177.5,-702 268.5,-702 268.5,-726"/>
<text text-anchor="middle" x="223" y="-711.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M44.03,-848.61C52.04,-822.93 74.12,-763.9 115,-735 130.13,-724.31 149.32,-718.72 167.26,-715.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.9,-719.35 177.35,-714.57 166.98,-712.41 167.9,-719.35"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1063,-1199 939,-1199 939,-1175 1063,-1175 1063,-1199"/>
<text text-anchor="middle" x="1001" y="-1184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.48,-873.25C46.07,-927.05 67.18,-1141.72 115,-1185 238.75,-1296.99 699.66,-1247.83 865,-1225 896.55,-1220.64 931.1,-1210.82 957.35,-1202.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="958.6,-1205.53 966.98,-1199.04 956.38,-1198.88 958.6,-1205.53"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="260,-486 186,-486 186,-462 260,-462 260,-486"/>
<text text-anchor="middle" x="223" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M41.21,-848.85C44.83,-791.26 63.12,-546.52 115,-495 130.76,-479.35 154.54,-473.64 175.69,-472.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.98,-475.52 185.81,-471.55 175.65,-468.53 175.98,-475.52"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-646 167,-646 167,-622 279,-622 279,-646"/>
<text text-anchor="middle" x="223" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.2,-848.89C43.88,-813.92 56.61,-711.95 115,-660 126.66,-649.63 141.76,-643.23 156.92,-639.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.87,-642.69 166.86,-637.09 156.34,-635.86 157.87,-642.69"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="269.5,-444 176.5,-444 176.5,-420 269.5,-420 269.5,-444"/>
<text text-anchor="middle" x="223" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.94,-848.72C43.42,-786.98 57.59,-511.17 115,-453 128.35,-439.47 147.69,-433.32 166.26,-430.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.86,-434.31 176.46,-429.83 166.16,-427.34 166.86,-434.31"/>
</g>
<!-- proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~calculate_state_to_state_cross_section</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/calculate_state_to_state_cross_section.html" xlink:title="calculate_state_to_state_cross_section">
<polygon fill="#d9534f" stroke="#d9534f" points="331,-1703 115,-1703 115,-1679 331,-1679 331,-1703"/>
<text text-anchor="middle" x="223" y="-1688.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_state_to_state_cross_section</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section</title>
<path fill="none" stroke="#ff0000" d="M40.76,-873.29C42.9,-970.12 59.11,-1608.1 115,-1670 115.76,-1670.84 116.55,-1671.66 117.35,-1672.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="115.19,-1675.2 125.15,-1678.83 119.63,-1669.78 115.19,-1675.2"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="800.5,-761 718.5,-761 718.5,-737 800.5,-737 800.5,-761"/>
<text text-anchor="middle" x="759.5" y="-746.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M41.56,-848.85C45.1,-816.63 59.64,-729.01 115,-693 195.47,-640.65 235.2,-686.75 331,-693 349.63,-694.22 599,-727.57 708.05,-742.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="707.77,-745.71 718.15,-743.57 708.7,-738.77 707.77,-745.71"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="292,-810 154,-810 154,-786 292,-786 292,-810"/>
<text text-anchor="middle" x="223" y="-795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M58.08,-848.94C72.71,-839.46 94.38,-826.61 115,-819 124.19,-815.61 134.04,-812.73 143.9,-810.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="144.8,-813.68 153.75,-808.01 143.21,-806.86 144.8,-813.68"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295.5,-402 150.5,-402 150.5,-378 295.5,-378 295.5,-402"/>
<text text-anchor="middle" x="223" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.71,-848.78C42.11,-783.46 51.98,-475.92 115,-411 122.12,-403.66 131,-398.49 140.57,-394.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.87,-398.15 150.34,-391.79 139.75,-391.48 141.87,-398.15"/>
</g>
<!-- proc~print_short_block_summary -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~print_short_block_summary</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/print_short_block_summary.html" xlink:title="print_short_block_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="839,-1602 680,-1602 680,-1578 839,-1578 839,-1602"/>
<text text-anchor="middle" x="759.5" y="-1587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_short_block_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_short_block_summary -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~print_short_block_summary</title>
<path fill="none" stroke="#ff0000" d="M41.13,-873.11C45.6,-956.46 73.36,-1443.57 115,-1493 179.51,-1569.58 235.12,-1528.15 331,-1557 347.02,-1561.82 350.53,-1565.07 367,-1568 469.83,-1586.32 590.04,-1590.59 669.85,-1591.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="669.85,-1594.56 679.87,-1591.1 669.88,-1587.56 669.85,-1594.56"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="311.5,-852 134.5,-852 134.5,-828 311.5,-828 311.5,-852"/>
<text text-anchor="middle" x="223" y="-837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M79.44,-856.49C92.68,-854.96 108.14,-853.17 123.89,-851.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="124.74,-854.78 134.27,-850.15 123.93,-847.82 124.74,-854.78"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-360 122.5,-360 122.5,-336 323.5,-336 323.5,-360"/>
<text text-anchor="middle" x="223" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.53,-848.58C40.93,-779.24 46.44,-440.61 115,-369 115.92,-368.04 116.87,-367.11 117.85,-366.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="120.05,-368.95 125.86,-360.09 115.79,-363.39 120.05,-368.95"/>
</g>
<!-- proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~print_largest_partial_cross_sections</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/print_largest_partial_cross_sections.html" xlink:title="print_largest_partial_cross_sections">
<polygon fill="#d9534f" stroke="#d9534f" points="1101,-1640 901,-1640 901,-1616 1101,-1616 1101,-1640"/>
<text text-anchor="middle" x="1001" y="-1625.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_cross_sections</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_cross_sections</title>
<path fill="none" stroke="#ff0000" d="M40.99,-873.17C44.62,-960.33 68.39,-1487.46 115,-1539 180.83,-1611.8 235.09,-1564.13 331,-1585 347.02,-1588.48 350.77,-1590.7 367,-1593 493.54,-1610.92 526.39,-1603.86 654,-1611 733.11,-1615.42 822.42,-1619.8 890.49,-1623"/>
<polygon fill="#ff0000" stroke="#ff0000" points="890.65,-1626.51 900.8,-1623.48 890.98,-1619.52 890.65,-1626.51"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="786.5,-841 732.5,-841 732.5,-817 786.5,-817 786.5,-841"/>
<text text-anchor="middle" x="759.5" y="-826.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M56.3,-873.13C70.71,-883.36 93.03,-897.23 115,-903 207.86,-927.37 235.57,-913.48 331,-903 347.29,-901.21 350.89,-898.01 367,-895 477.91,-874.31 506.87,-876.48 618,-857 628.13,-855.22 683.85,-844.05 722,-836.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="723.13,-839.71 732.24,-834.3 721.75,-832.85 723.13,-839.71"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="250,-318 196,-318 196,-294 250,-294 250,-318"/>
<text text-anchor="middle" x="223" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.37,-848.96C39.83,-777.13 40.69,-405.53 115,-327 132.72,-308.28 161.85,-303.53 185.25,-303.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.5,-306.69 195.54,-303.31 185.58,-299.69 185.5,-306.69"/>
</g>
<!-- proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~save_partial_xs_single_block</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/save_partial_xs_single_block.html" xlink:title="save_partial_xs_single_block">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-562 410.5,-562 410.5,-538 574.5,-538 574.5,-562"/>
<text text-anchor="middle" x="492.5" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_single_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_single_block</title>
<path fill="none" stroke="#ff0000" d="M40.04,-848.87C39.23,-808.39 42.49,-676.91 115,-613 125.7,-603.57 292.22,-578.34 400.18,-562.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="400.72,-566.28 410.12,-561.4 399.72,-559.35 400.72,-566.28"/>
</g>
<!-- proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~read_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/read_radial_coupling_terms.html" xlink:title="read_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-1096 143,-1096 143,-1072 303,-1072 303,-1096"/>
<text text-anchor="middle" x="223" y="-1081.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~read_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M41.05,-873.04C43.34,-908.29 55.11,-1011.97 115,-1063 120.55,-1067.73 126.85,-1071.51 133.55,-1074.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.31,-1077.79 142.9,-1078.16 134.85,-1071.27 132.31,-1077.79"/>
</g>
<!-- proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~print_pes_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/print_pes_matrix_elements_summary.html" xlink:title="print_pes_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="865,-1477 654,-1477 654,-1453 865,-1453 865,-1477"/>
<text text-anchor="middle" x="759.5" y="-1462.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_pes_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.59,-873.32C41.34,-942.1 48.41,-1278.1 115,-1351 150.26,-1389.6 468.26,-1431.7 643.63,-1452.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="643.34,-1455.75 653.68,-1453.44 644.15,-1448.8 643.34,-1455.75"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="253,-1661 193,-1661 193,-1637 253,-1637 253,-1661"/>
<text text-anchor="middle" x="223" y="-1646.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M40.85,-873.14C43.65,-966.16 63.59,-1563.78 115,-1623 131.52,-1642.03 159.39,-1648.35 182.55,-1650.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.65,-1653.52 192.8,-1650.48 182.97,-1646.53 182.65,-1653.52"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-528 167,-528 167,-504 279,-504 279,-528"/>
<text text-anchor="middle" x="223" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.67,-848.71C46.96,-795.67 70.36,-587.04 115,-542 126.15,-530.75 141.29,-524.06 156.67,-520.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.74,-523.5 166.77,-517.97 156.26,-516.66 157.74,-523.5"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-1484 176,-1484 176,-1460 270,-1460 270,-1484"/>
<text text-anchor="middle" x="223" y="-1469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.25,-873.13C38.97,-948.95 35.84,-1357.46 115,-1446 127.85,-1460.38 147.19,-1467.46 165.91,-1470.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="165.5,-1474.24 175.89,-1472.2 166.49,-1467.31 165.5,-1474.24"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="270,-276 176,-276 176,-252 270,-252 270,-276"/>
<text text-anchor="middle" x="223" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.22,-848.52C38.8,-772.33 35.2,-370.17 115,-285 127.94,-271.19 147.1,-264.96 165.64,-262.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.22,-265.96 175.83,-261.5 165.53,-258.99 166.22,-265.96"/>
</g>
<!-- proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~save_s_matrix_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/save_s_matrix_file_header.html" xlink:title="save_s_matrix_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="299.5,-1054 146.5,-1054 146.5,-1030 299.5,-1030 299.5,-1054"/>
<text text-anchor="middle" x="223" y="-1039.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_file_header</title>
<path fill="none" stroke="#ff0000" d="M42.38,-873.35C47.7,-903.74 65.79,-982.46 115,-1021 121.52,-1026.1 128.93,-1030.08 136.74,-1033.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.84,-1036.55 146.43,-1036.49 138.11,-1029.93 135.84,-1036.55"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-234 151,-234 151,-210 295,-210 295,-234"/>
<text text-anchor="middle" x="223" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M41.12,-848.85C45.42,-766.29 72.02,-289.27 115,-243 122.18,-235.27 131.29,-229.92 141.17,-226.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.32,-229.57 150.83,-223.26 140.24,-222.88 142.32,-229.57"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1229,-1393 1137,-1393 1137,-1369 1229,-1369 1229,-1393"/>
<text text-anchor="middle" x="1183" y="-1378.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.62,-873.04C41.74,-972.15 51.66,-1650.96 115,-1712 175.32,-1770.13 407.73,-1731 491.5,-1731 491.5,-1731 491.5,-1731 760.5,-1731 913.33,-1731 986.55,-1784.28 1101,-1683 1143.66,-1645.25 1170.82,-1466.38 1179.22,-1403.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1182.71,-1403.47 1180.53,-1393.11 1175.77,-1402.57 1182.71,-1403.47"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1055.5,-1353 946.5,-1353 946.5,-1329 1055.5,-1329 1055.5,-1353"/>
<text text-anchor="middle" x="1001" y="-1338.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.13,-873.35C44.37,-931.85 61.2,-1180.37 115,-1231 233.42,-1342.44 753.31,-1345.06 936.14,-1342.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="936.45,-1345.91 946.4,-1342.25 936.34,-1338.91 936.45,-1345.91"/>
</g>
<!-- proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~save_s_matrix_block_info</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/save_s_matrix_block_info.html" xlink:title="save_s_matrix_block_info">
<polygon fill="#d9534f" stroke="#d9534f" points="296.5,-192 149.5,-192 149.5,-168 296.5,-168 296.5,-192"/>
<text text-anchor="middle" x="223" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_block_info</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_block_info</title>
<path fill="none" stroke="#ff0000" d="M41.02,-848.87C44.79,-763.14 69.18,-250.71 115,-201 121.83,-193.59 130.45,-188.35 139.82,-184.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="140.98,-188.01 149.4,-181.57 138.81,-181.35 140.98,-188.01"/>
</g>
<!-- proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~check_cross_section_thresholds</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/check_cross_section_thresholds.html" xlink:title="check_cross_section_thresholds">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-150 133,-150 133,-126 313,-126 313,-150"/>
<text text-anchor="middle" x="223" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cross_section_thresholds</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~check_cross_section_thresholds</title>
<path fill="none" stroke="#ff0000" d="M40.93,-848.96C44.2,-760.43 66.32,-212.16 115,-159 117.8,-155.95 120.9,-153.26 124.23,-150.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.15,-153.83 132.94,-145.69 122.56,-147.82 126.15,-153.83"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="274,-108 172,-108 172,-84 274,-84 274,-108"/>
<text text-anchor="middle" x="223" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.86,-848.83C43.67,-756.9 63.5,-173.58 115,-117 126.88,-103.95 144.29,-97.62 161.63,-94.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.29,-98.29 171.79,-93.6 161.44,-91.34 162.29,-98.29"/>
</g>
<!-- proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~reduce_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/reduce_radial_coupling_terms.html" xlink:title="reduce_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="845.5,-1393 673.5,-1393 673.5,-1369 845.5,-1369 845.5,-1393"/>
<text text-anchor="middle" x="759.5" y="-1378.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduce_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;proc~reduce_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.51,-873.36C40.84,-940.83 46.05,-1264.1 115,-1328 119.97,-1332.61 485.05,-1360.53 663.03,-1373.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="662.95,-1377.39 673.18,-1374.65 663.47,-1370.41 662.95,-1377.39"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="294.5,-894 151.5,-894 151.5,-870 294.5,-870 294.5,-894"/>
<text text-anchor="middle" x="223" y="-879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M79.44,-865.51C97.51,-867.6 119.71,-870.16 141.16,-872.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="140.94,-876.14 151.27,-873.82 141.74,-869.19 140.94,-876.14"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-1050 455.5,-1050 455.5,-1026 529.5,-1026 529.5,-1050"/>
<text text-anchor="middle" x="492.5" y="-1035.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M42.28,-873.01C49.21,-918.09 76.02,-1076.14 115,-1105 192.16,-1162.12 245.56,-1148.77 331,-1105 355.37,-1092.52 343.53,-1069.11 367,-1055 390.31,-1040.99 420.45,-1036.59 445.24,-1035.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.55,-1039.26 455.49,-1035.62 445.44,-1032.27 445.55,-1039.26"/>
</g>
<!-- proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~check_nonzero_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/check_nonzero_pes_matrix_elements.html" xlink:title="check_nonzero_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-66 117.5,-66 117.5,-42 328.5,-42 328.5,-66"/>
<text text-anchor="middle" x="223" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.79,-848.76C43.17,-753.66 60.67,-135.02 115,-75 115.76,-74.16 116.55,-73.34 117.35,-72.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="119.63,-75.22 125.16,-66.18 115.2,-69.8 119.63,-75.22"/>
</g>
<!-- proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~prepare_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/prepare_pes_matrix_elements.html" xlink:title="prepare_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="309,-24 137,-24 137,0 309,0 309,-24"/>
<text text-anchor="middle" x="223" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.73,-848.74C42.68,-750.7 57.82,-96.46 115,-33 118.8,-28.78 123.18,-25.26 127.95,-22.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="129.65,-25.4 136.92,-17.69 126.43,-19.18 129.65,-25.4"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff4800" d="M290.88,-987.98C314.86,-983.76 342.13,-979.06 367,-975 478.36,-956.84 507.37,-959.15 618,-937 634.17,-933.76 637.63,-930.02 654,-928 747.08,-916.54 771.23,-927.21 865,-928 969.9,-928.89 1021.08,-864.05 1101,-932 1166.92,-988.04 1179.32,-1275.4 1181.54,-1358.48"/>
<polygon fill="#ff4800" stroke="#ff4800" points="1178.04,-1358.69 1181.78,-1368.6 1185.04,-1358.52 1178.04,-1358.69"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="533,-1008 452,-1008 452,-984 533,-984 533,-1008"/>
<text text-anchor="middle" x="492.5" y="-993.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff4800" d="M302.81,-998.82C347.8,-998.15 402.82,-997.33 441.82,-996.74"/>
<polygon fill="#ff4800" stroke="#ff4800" points="441.92,-1000.24 451.87,-996.59 441.82,-993.24 441.92,-1000.24"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff6d00" d="M556.24,-1676.69C694.03,-1690.01 1017.42,-1713.32 1101,-1649 1140.9,-1618.3 1169.26,-1461.8 1178.64,-1403.2"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1182.12,-1403.57 1180.21,-1393.15 1175.2,-1402.48 1182.12,-1403.57"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-883 732.5,-883 732.5,-859 786.5,-859 786.5,-883"/>
<text text-anchor="middle" x="759.5" y="-868.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline</title>
<path fill="none" stroke="#ff9100" d="M564.17,-904C615.08,-895.35 681.71,-884.04 722.24,-877.16"/>
<polygon fill="#ff9100" stroke="#ff9100" points="722.93,-880.59 732.2,-875.47 721.76,-873.69 722.93,-880.59"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1036,-722 966,-722 966,-698 1036,-698 1036,-722"/>
<text text-anchor="middle" x="1001" y="-707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ffb600" d="M834.21,-473.79C845.16,-477.01 855.83,-481.57 865,-488 883.95,-501.28 959.28,-635.94 988.41,-688.83"/>
<polygon fill="#ffb600" stroke="#ffb600" points="985.41,-690.63 993.29,-697.71 991.54,-687.26 985.41,-690.63"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="519.5,-848 465.5,-848 465.5,-824 519.5,-824 519.5,-848"/>
<text text-anchor="middle" x="492.5" y="-833.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ffda00" d="M310.36,-768.01C317.55,-770.48 324.53,-773.44 331,-777 351.38,-788.22 346.47,-804.06 367,-815 394.2,-829.5 429.09,-834.41 455,-835.88"/>
<polygon fill="#ffda00" stroke="#ffda00" points="455.02,-839.39 465.16,-836.32 455.32,-832.39 455.02,-839.39"/>
</g>
<!-- proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~wavenumber_squared_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/wavenumber_squared_from_energy.html" xlink:title="wavenumber_squared_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="594,-806 391,-806 391,-782 594,-782 594,-806"/>
<text text-anchor="middle" x="492.5" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_squared_from_energy</text>
</a>
</g>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ffda00" d="M308.64,-768.02C336.71,-772.01 368.13,-776.47 396.9,-780.56"/>
<polygon fill="#ffda00" stroke="#ffda00" points="396.56,-784.05 406.95,-781.99 397.54,-777.12 396.56,-784.05"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ffff00" d="M268.71,-1161.78C289.53,-1158.73 313.51,-1152.09 331,-1138 359.48,-1115.05 338.15,-1086.48 367,-1064 389.04,-1046.82 419.72,-1040.28 445.11,-1038.05"/>
<polygon fill="#ffff00" stroke="#ffff00" points="445.52,-1041.52 455.26,-1037.35 445.05,-1034.54 445.52,-1041.52"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ffff00" d="M258.58,-1151.99C281.74,-1142.41 311.46,-1126.94 331,-1105 359.1,-1073.44 334,-1043.4 367,-1017 387.83,-1000.33 417.01,-994.77 441.87,-993.51"/>
<polygon fill="#ffff00" stroke="#ffff00" points="441.98,-997.01 451.87,-993.22 441.78,-990.02 441.98,-997.01"/>
</g>
<!-- proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~check_namelist_input</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/check_namelist_input.html" xlink:title="check_namelist_input">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1001 696,-1001 696,-977 823,-977 823,-1001"/>
<text text-anchor="middle" x="759.5" y="-986.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_input</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_input</title>
<path fill="none" stroke="#ffff00" d="M268.51,-1159.39C288.69,-1155.79 312.19,-1149.38 331,-1138 351.75,-1125.44 345.72,-1108.63 367,-1097 466,-1042.88 510.42,-1093.01 618,-1059 658.85,-1046.08 702.52,-1022.63 730.14,-1006.45"/>
<polygon fill="#ffff00" stroke="#ffff00" points="732.05,-1009.39 738.86,-1001.27 728.48,-1003.37 732.05,-1009.39"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-1130 455.5,-1130 455.5,-1106 529.5,-1106 529.5,-1130"/>
<text text-anchor="middle" x="492.5" y="-1115.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#ffff00" d="M268.75,-1156.11C296.94,-1151.15 334.09,-1144.65 367,-1139 392.88,-1134.56 421.79,-1129.67 445.24,-1125.74"/>
<polygon fill="#ffff00" stroke="#ffff00" points="445.98,-1129.16 455.26,-1124.05 444.82,-1122.26 445.98,-1129.16"/>
</g>
<!-- proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~check_namelist_basis</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/check_namelist_basis.html" xlink:title="check_namelist_basis">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1157 696,-1157 696,-1133 823,-1133 823,-1157"/>
<text text-anchor="middle" x="759.5" y="-1142.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_basis</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_basis</title>
<path fill="none" stroke="#ffff00" d="M268.55,-1172.77C342.13,-1185.74 493.29,-1205.94 618,-1181 635,-1177.6 637.42,-1171.07 654,-1166 664.23,-1162.87 675.17,-1160.09 685.97,-1157.65"/>
<polygon fill="#ffff00" stroke="#ffff00" points="686.8,-1161.05 695.83,-1155.51 685.32,-1154.21 686.8,-1161.05"/>
</g>
<!-- proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~check_namelist_potential</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/check_namelist_potential.html" xlink:title="check_namelist_potential">
<polygon fill="#d9534f" stroke="#d9534f" points="833.5,-1199 685.5,-1199 685.5,-1175 833.5,-1175 833.5,-1199"/>
<text text-anchor="middle" x="759.5" y="-1184.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_potential</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_potential</title>
<path fill="none" stroke="#ffff00" d="M261.16,-1176.04C289.74,-1184.64 330.41,-1195.47 367,-1200 472.82,-1213.12 595.88,-1205.29 675.36,-1197.25"/>
<polygon fill="#ffff00" stroke="#ffff00" points="675.73,-1200.73 685.32,-1196.22 675.01,-1193.77 675.73,-1200.73"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1172 445,-1172 445,-1148 540,-1148 540,-1172"/>
<text text-anchor="middle" x="492.5" y="-1157.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#ffff00" d="M268.77,-1163.33C314.32,-1162.65 385.05,-1161.59 434.56,-1160.85"/>
<polygon fill="#ffff00" stroke="#ffff00" points="434.83,-1164.35 444.78,-1160.7 434.73,-1157.35 434.83,-1164.35"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#daff00" d="M268.92,-719.33C395.11,-734.51 751.02,-778.74 865,-808 973.43,-835.83 1029.77,-809.64 1101,-896 1160.65,-968.32 1177.57,-1273.55 1181.17,-1358.8"/>
<polygon fill="#daff00" stroke="#daff00" points="1177.68,-1359.06 1181.58,-1368.91 1184.67,-1358.78 1177.68,-1359.06"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#daff00" d="M268.5,-713.62C289.4,-715.57 313.5,-721.11 331,-735 361.54,-759.24 336.14,-791.17 367,-815 391.97,-834.28 428.2,-838.52 455.15,-838.54"/>
<polygon fill="#daff00" stroke="#daff00" points="455.41,-842.03 465.34,-838.34 455.28,-835.03 455.41,-842.03"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#daff00" d="M268.73,-717.27C288.62,-720.08 311.82,-725.31 331,-735 350.37,-744.79 347.69,-758.09 367,-768 375.53,-772.38 384.75,-776.01 394.18,-779.04"/>
<polygon fill="#daff00" stroke="#daff00" points="393.47,-782.48 404.06,-781.98 395.47,-775.77 393.47,-782.48"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#6dff00" d="M260.84,-646.02C284.07,-655.38 313,-670.59 331,-693 366.41,-737.07 324.7,-777.49 367,-815 390.92,-836.21 428,-840.07 455.48,-839.46"/>
<polygon fill="#6dff00" stroke="#6dff00" points="455.65,-842.96 465.49,-839.04 455.35,-835.97 455.65,-842.96"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="539,-604 446,-604 446,-580 539,-580 539,-604"/>
<text text-anchor="middle" x="492.5" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#6dff00" d="M279.1,-625.35C324.89,-618.16 389.74,-607.98 435.72,-600.76"/>
<polygon fill="#6dff00" stroke="#6dff00" points="436.47,-604.18 445.81,-599.17 435.38,-597.27 436.47,-604.18"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-646 465.5,-646 465.5,-622 519.5,-622 519.5,-646"/>
<text text-anchor="middle" x="492.5" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#6dff00" d="M279.1,-634C331.77,-634 409.69,-634 455.05,-634"/>
<polygon fill="#6dff00" stroke="#6dff00" points="455.3,-637.5 465.3,-634 455.3,-630.5 455.3,-637.5"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#6dff00" d="M246.76,-646.06C268.57,-657.73 302.31,-676.08 331,-693 378.49,-721.01 432.53,-755.59 464.23,-776.17"/>
<polygon fill="#6dff00" stroke="#6dff00" points="462.65,-779.31 472.94,-781.83 466.46,-773.44 462.65,-779.31"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-520 422.5,-520 422.5,-496 562.5,-496 562.5,-520"/>
<text text-anchor="middle" x="492.5" y="-505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#6dff00" d="M249.23,-621.78C271.87,-610.16 305.39,-591.34 331,-570 349.63,-554.48 345.82,-540.81 367,-529 380.74,-521.34 396.56,-516.32 412.22,-513.07"/>
<polygon fill="#6dff00" stroke="#6dff00" points="413.27,-516.44 422.46,-511.18 411.99,-509.55 413.27,-516.44"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="540.5,-688 444.5,-688 444.5,-664 540.5,-664 540.5,-688"/>
<text text-anchor="middle" x="492.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#6dff00" d="M279.1,-642.65C324.32,-649.75 388.13,-659.77 433.99,-666.97"/>
<polygon fill="#6dff00" stroke="#6dff00" points="433.65,-670.46 444.07,-668.55 434.74,-663.54 433.65,-670.46"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-478 465.5,-478 465.5,-454 519.5,-454 519.5,-478"/>
<text text-anchor="middle" x="492.5" y="-463.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#6dff00" d="M254.74,-621.86C278.28,-611.23 310.15,-593.75 331,-570 357.53,-539.78 335.34,-511.79 367,-487 391.83,-467.55 428.09,-463.33 455.07,-463.37"/>
<polygon fill="#6dff00" stroke="#6dff00" points="455.21,-466.87 465.28,-463.58 455.36,-459.87 455.21,-466.87"/>
</g>
<!-- proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#24ff00" d="M331.26,-1682.58C360.65,-1680.27 391.81,-1677.83 418.77,-1675.71"/>
<polygon fill="#24ff00" stroke="#24ff00" points="419.18,-1679.19 428.88,-1674.92 418.63,-1672.21 419.18,-1679.19"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff00" d="M800.58,-746.06C881.16,-741.07 1058.72,-735.05 1101,-775 1144.45,-816.06 1174.16,-1254.18 1180.66,-1358.7"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1177.17,-1359 1181.28,-1368.77 1184.16,-1358.57 1177.17,-1359"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff00" d="M800.59,-742.47C843.58,-735.47 911.64,-724.39 956.06,-717.15"/>
<polygon fill="#00ff00" stroke="#00ff00" points="956.68,-720.6 965.99,-715.54 955.56,-713.69 956.68,-720.6"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1048,-1128 954,-1128 954,-1104 1048,-1104 1048,-1128"/>
<text text-anchor="middle" x="1001" y="-1113.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ff00" d="M793.38,-761.04C816.02,-770.74 845.44,-786.36 865,-808 944.84,-896.33 983.15,-1039.41 995.43,-1093.93"/>
<polygon fill="#00ff00" stroke="#00ff00" points="992.05,-1094.87 997.6,-1103.9 998.89,-1093.38 992.05,-1094.87"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#00ff24" d="M292.22,-799.09C306.65,-802.43 320.63,-808.49 331,-819 393.8,-882.68 303.35,-954.16 367,-1017 387.24,-1036.99 418.96,-1042.11 445.31,-1042.3"/>
<polygon fill="#00ff24" stroke="#00ff24" points="445.54,-1045.79 455.48,-1042.13 445.42,-1038.79 445.54,-1045.79"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ff24" d="M292.19,-807.69C344.14,-815.07 413.6,-824.93 455.31,-830.86"/>
<polygon fill="#00ff24" stroke="#00ff24" points="454.9,-834.34 465.29,-832.28 455.88,-827.41 454.9,-834.34"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#00ff24" d="M292.19,-796.98C319.1,-796.58 350.72,-796.11 380.74,-795.66"/>
<polygon fill="#00ff24" stroke="#00ff24" points="380.9,-799.15 390.85,-795.51 380.8,-792.16 380.9,-799.15"/>
</g>
<!-- proc~print_short_block_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~print_short_block_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff6d" d="M778,-1577.76C801.62,-1560.25 843.25,-1525.74 865,-1486 901.24,-1419.77 869.75,-1388.72 901,-1320 921.34,-1275.27 958.57,-1231.06 981.13,-1206.56"/>
<polygon fill="#00ff6d" stroke="#00ff6d" points="983.89,-1208.73 988.17,-1199.03 978.78,-1203.95 983.89,-1208.73"/>
</g>
<!-- proc~print_short_block_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~print_short_block_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff6d" d="M839.13,-1593.08C926.4,-1594.96 1060.33,-1592.74 1101,-1564 1155.21,-1525.7 1173.62,-1442.65 1179.47,-1402.97"/>
<polygon fill="#00ff6d" stroke="#00ff6d" points="1182.95,-1403.38 1180.81,-1393 1176.01,-1402.45 1182.95,-1403.38"/>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ff91" d="M311.59,-838.69C360.41,-837.96 418.57,-837.09 455.27,-836.54"/>
<polygon fill="#00ff91" stroke="#00ff91" points="455.54,-840.04 465.49,-836.39 455.43,-833.04 455.54,-840.04"/>
</g>
<!-- proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffda" d="M1078.87,-1615.99C1086.96,-1612.43 1094.56,-1607.86 1101,-1602 1160.08,-1548.26 1176.16,-1447.77 1180.46,-1403.23"/>
<polygon fill="#00ffda" stroke="#00ffda" points="1183.96,-1403.44 1181.32,-1393.18 1176.98,-1402.84 1183.96,-1403.44"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00b6ff" d="M574.67,-549.32C590.78,-552.86 606.31,-559.44 618,-571 681.93,-634.18 601.93,-696.74 654,-770 670.58,-793.33 699.46,-808.61 722.66,-817.76"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="721.61,-821.11 732.2,-821.32 724.05,-814.55 721.61,-821.11"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00b6ff" d="M574.62,-542.88C722.85,-531.81 1028.88,-518.53 1101,-590 1157.22,-645.71 1177.72,-1236.43 1181.38,-1358.86"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="1177.88,-1359.04 1181.67,-1368.93 1184.88,-1358.83 1177.88,-1359.04"/>
</g>
<!-- proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#0091ff" d="M303.01,-1075.22C312.85,-1072.22 322.45,-1068.25 331,-1063 353.13,-1049.42 344.69,-1030.28 367,-1017 389.41,-1003.66 417.89,-998.18 441.95,-996.14"/>
<polygon fill="#0091ff" stroke="#0091ff" points="442.22,-999.63 451.96,-995.47 441.75,-992.65 442.22,-999.63"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#006dff" d="M852.93,-1452.77C857.26,-1450.28 861.32,-1447.38 865,-1444 907.25,-1405.17 875.46,-1371.39 901,-1320 922.87,-1276 959.59,-1231.54 981.64,-1206.8"/>
<polygon fill="#006dff" stroke="#006dff" points="984.4,-1208.96 988.51,-1199.2 979.2,-1204.27 984.4,-1208.96"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#006dff" d="M865.33,-1458.46C933.51,-1452.28 1023.78,-1440.44 1101,-1418 1118.17,-1413.01 1136.36,-1404.98 1151.14,-1397.67"/>
<polygon fill="#006dff" stroke="#006dff" points="1152.99,-1400.66 1160.32,-1393.01 1149.82,-1394.41 1152.99,-1400.66"/>
</g>
<!-- proc~numerov&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~numerov&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#0048ff" d="M253.14,-1651.29C292.51,-1654.38 364.03,-1659.99 418.5,-1664.27"/>
<polygon fill="#0048ff" stroke="#0048ff" points="418.56,-1667.78 428.8,-1665.08 419.11,-1660.81 418.56,-1667.78"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="556,-398 429,-398 429,-374 556,-374 556,-398"/>
<text text-anchor="middle" x="492.5" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0024ff" d="M279.17,-515.21C297.28,-512.49 316.47,-506.69 331,-495 362.32,-469.79 335.83,-437.4 367,-412 381.66,-400.06 400.43,-393.2 418.94,-389.35"/>
<polygon fill="#0024ff" stroke="#0024ff" points="419.64,-392.78 428.86,-387.56 418.4,-385.89 419.64,-392.78"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="565,-356 420,-356 420,-332 565,-332 565,-356"/>
<text text-anchor="middle" x="492.5" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#0024ff" d="M279.03,-516.48C297.55,-513.94 317.04,-507.93 331,-495 374.98,-454.26 322.48,-405.15 367,-365 378.93,-354.24 394.23,-347.92 410,-344.38"/>
<polygon fill="#0024ff" stroke="#0024ff" points="410.67,-347.81 419.85,-342.52 409.38,-340.94 410.67,-347.81"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#0024ff" d="M279.04,-505.47C295.74,-502.2 314.14,-498.53 331,-495 347.04,-491.64 350.91,-490.14 367,-487 396.55,-481.23 430.24,-475.6 455.11,-471.63"/>
<polygon fill="#0024ff" stroke="#0024ff" points="455.87,-475.05 465.2,-470.03 454.77,-468.14 455.87,-475.05"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0000ff" d="M270.25,-1471.94C290.1,-1473.72 312.85,-1478.31 331,-1489 353.37,-1502.17 343.66,-1523.63 367,-1535 440.4,-1570.76 1030.59,-1540.36 1101,-1499 1138.24,-1477.13 1162.25,-1430.57 1173.83,-1402.92"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1177.19,-1403.93 1177.66,-1393.34 1170.69,-1401.33 1177.19,-1403.93"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="589,-1484 396,-1484 396,-1460 589,-1460 589,-1484"/>
<text text-anchor="middle" x="492.5" y="-1469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#0000ff" d="M270.29,-1472C302.13,-1472 345.76,-1472 385.85,-1472"/>
<polygon fill="#0000ff" stroke="#0000ff" points="385.96,-1475.5 395.96,-1472 385.96,-1468.5 385.96,-1475.5"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="618,-1526 367,-1526 367,-1502 618,-1502 618,-1526"/>
<text text-anchor="middle" x="492.5" y="-1511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#0000ff" d="M270.29,-1479.27C307.27,-1485.07 360.13,-1493.37 404.91,-1500.4"/>
<polygon fill="#0000ff" stroke="#0000ff" points="404.5,-1503.88 414.92,-1501.98 405.58,-1496.97 404.5,-1503.88"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="588.5,-1404 396.5,-1404 396.5,-1380 588.5,-1380 588.5,-1404"/>
<text text-anchor="middle" x="492.5" y="-1389.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#0000ff" d="M264.34,-1459.94C311.68,-1445.78 390.21,-1422.29 441.41,-1406.98"/>
<polygon fill="#0000ff" stroke="#0000ff" points="442.69,-1410.25 451.27,-1404.03 440.69,-1403.54 442.69,-1410.25"/>
</g>
<!-- proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#4800ff" d="M292.36,-1029.96C316,-1025.82 342.66,-1021.18 367,-1017 391.64,-1012.77 419.03,-1008.14 441.83,-1004.31"/>
<polygon fill="#4800ff" stroke="#4800ff" points="442.68,-1007.72 451.96,-1002.61 441.52,-1000.81 442.68,-1007.72"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00b6" d="M783.44,-1368.85C805.26,-1356.87 838.57,-1337.43 865,-1317 910.49,-1281.84 957.51,-1233.27 982.27,-1206.56"/>
<polygon fill="#ff00b6" stroke="#ff00b6" points="985.01,-1208.75 989.21,-1199.02 979.86,-1204.01 985.01,-1208.75"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00b6" d="M845.54,-1381C929.43,-1381 1055.2,-1381 1126.83,-1381"/>
<polygon fill="#ff00b6" stroke="#ff00b6" points="1127,-1384.5 1137,-1381 1127,-1377.5 1127,-1384.5"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff0091" d="M293.93,-869.97C345.74,-861.07 414.22,-849.29 455.45,-842.2"/>
<polygon fill="#ff0091" stroke="#ff0091" points="456.06,-845.65 465.32,-840.5 454.87,-838.75 456.06,-845.65"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="577,-66 408,-66 408,-42 577,-42 577,-66"/>
<text text-anchor="middle" x="492.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#ff0048" d="M328.57,-54C351.32,-54 375.25,-54 397.55,-54"/>
<polygon fill="#ff0048" stroke="#ff0048" points="397.68,-57.5 407.68,-54 397.68,-50.5 397.68,-57.5"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M533.27,-994.2C559.5,-994.93 593.43,-999.73 618,-1017 644.7,-1035.77 627.62,-1061.78 654,-1081 731.35,-1137.36 774.12,-1094 865,-1124 902.13,-1136.26 942.48,-1156.01 969.31,-1170.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="967.73,-1173.25 978.2,-1174.86 971.02,-1167.07 967.73,-1173.25"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M533.06,-987.5C561.15,-979.35 597.39,-964.15 618,-937 675,-861.93 583.52,-790.58 654,-728 697.46,-689.41 872.45,-698.82 955.64,-705.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="955.53,-709.26 965.79,-706.63 956.13,-702.29 955.53,-709.26"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ffd000" d="M519.88,-835.3C567.5,-834.05 667.9,-831.39 722.04,-829.96"/>
<polygon fill="#ffd000" stroke="#ffd000" points="722.32,-833.46 732.23,-829.69 722.14,-826.46 722.32,-833.46"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#e7ff00" d="M823.27,-993.73C838.51,-997.6 853.66,-1004.14 865,-1015 905.83,-1054.1 864.8,-1093.58 901,-1137 913.59,-1152.1 931.88,-1163.11 949.33,-1170.89"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="948.32,-1174.25 958.89,-1174.88 951.01,-1167.8 948.32,-1174.25"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#e7ff00" d="M823.06,-990.84C899.52,-996.56 1027.74,-1017.92 1101,-1095 1173.02,-1170.78 1181.78,-1305.73 1182.3,-1358.74"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1178.8,-1358.76 1182.3,-1368.76 1185.8,-1358.76 1178.8,-1358.76"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#e7ff00" d="M775.15,-976.91C796.13,-959.28 835.44,-925.01 865,-892 914.15,-837.12 963.63,-765.14 986.66,-730.45"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="989.6,-732.35 992.18,-722.08 983.75,-728.5 989.6,-732.35"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~check_namelist_input&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#e7ff00" d="M823.25,-1000.31C837.36,-1004.02 851.99,-1008.83 865,-1015 910.1,-1036.4 955.02,-1074.11 979.99,-1096.9"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="977.65,-1099.51 987.37,-1103.74 982.41,-1094.38 977.65,-1099.51"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#a2ff00" d="M539.3,-587.06C566.1,-586.89 598.41,-591.85 618,-613 678.19,-677.99 593.42,-945.37 654,-1010 718.91,-1079.25 791.2,-983.31 865,-1043 899.78,-1071.13 871.02,-1103.8 901,-1137 914.5,-1151.95 933.5,-1163.03 951.25,-1170.91"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="950.37,-1174.34 960.94,-1174.96 953.07,-1167.88 950.37,-1174.34"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="803,-601 716,-601 716,-577 803,-577 803,-601"/>
<text text-anchor="middle" x="759.5" y="-586.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#a2ff00" d="M539.06,-591.48C585.34,-590.96 656.96,-590.15 705.69,-589.6"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="705.77,-593.1 715.73,-589.48 705.69,-586.1 705.77,-593.1"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-437 732.5,-437 732.5,-413 786.5,-413 786.5,-437"/>
<text text-anchor="middle" x="759.5" y="-422.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#a2ff00" d="M539.14,-595.53C565.21,-595.06 596.82,-589.9 618,-571 661.13,-532.5 611.48,-485.17 654,-446 672.21,-429.22 699.94,-424.25 722.25,-423.32"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="722.45,-426.82 732.39,-423.15 722.33,-419.82 722.45,-426.82"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="799.5,-45 719.5,-45 719.5,-21 799.5,-21 799.5,-45"/>
<text text-anchor="middle" x="759.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#5cff00" d="M577.35,-47.36C620.73,-43.92 672.19,-39.84 709.16,-36.91"/>
<polygon fill="#5cff00" stroke="#5cff00" points="709.49,-40.39 719.18,-36.12 708.94,-33.42 709.49,-40.39"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="832,-87 687,-87 687,-63 832,-63 832,-87"/>
<text text-anchor="middle" x="759.5" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#5cff00" d="M577.35,-60.64C609.09,-63.16 645.16,-66.02 676.71,-68.52"/>
<polygon fill="#5cff00" stroke="#5cff00" points="676.54,-72.02 686.79,-69.32 677.09,-65.04 676.54,-72.02"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#17ff00" d="M1036.37,-709.8C1058.13,-711.62 1085.07,-717.82 1101,-736 1184.6,-831.42 1183.83,-1256.7 1182.41,-1358.88"/>
<polygon fill="#17ff00" stroke="#17ff00" points="1178.91,-1358.92 1182.25,-1368.97 1185.91,-1359.03 1178.91,-1358.92"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff73" d="M584.7,-806.05C631.91,-812.28 686.91,-819.54 722.18,-824.2"/>
<polygon fill="#00ff73" stroke="#00ff73" points="722.09,-827.72 732.46,-825.56 723.01,-820.78 722.09,-827.72"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff73" d="M507.24,-781.75C533.48,-759.26 593.53,-712.15 654,-695 758.87,-665.26 888.74,-685.17 955.6,-699.32"/>
<polygon fill="#00ff73" stroke="#00ff73" points="955.26,-702.82 965.78,-701.53 956.75,-695.98 955.26,-702.82"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffff" d="M779.67,-883.23C803.57,-899.55 843.86,-930.76 865,-968 902.91,-1034.79 854.13,-1076.17 901,-1137 912.8,-1152.31 930.57,-1163.31 947.82,-1171.01"/>
<polygon fill="#00ffff" stroke="#00ffff" points="946.73,-1174.35 957.3,-1174.96 949.42,-1167.89 946.73,-1174.35"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ffff" d="M786.89,-870.04C808.96,-868.25 840.65,-863.33 865,-850 919.18,-820.33 964.87,-761.57 986.53,-730.45"/>
<polygon fill="#00ffff" stroke="#00ffff" points="989.48,-732.33 992.23,-722.1 983.7,-728.39 989.48,-732.33"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~check_namelist_basis&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00b9ff" d="M823.11,-1155.98C855.52,-1161.66 895.22,-1168.62 928.79,-1174.51"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="928.54,-1178.02 938.99,-1176.3 929.75,-1171.13 928.54,-1178.02"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~check_namelist_basis&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00b9ff" d="M823.11,-1137.42C860.33,-1132.91 907.15,-1127.24 943.28,-1122.87"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="944.14,-1126.29 953.64,-1121.61 943.3,-1119.34 944.14,-1126.29"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~check_namelist_potential&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0073ff" d="M833.66,-1187C863.81,-1187 898.62,-1187 928.59,-1187"/>
<polygon fill="#0073ff" stroke="#0073ff" points="928.97,-1190.5 938.97,-1187 928.97,-1183.5 928.97,-1190.5"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~check_namelist_potential&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#0073ff" d="M828.33,-1174.98C840.61,-1172.35 853.25,-1169.33 865,-1166 898.41,-1156.52 935.32,-1142.6 962.09,-1131.86"/>
<polygon fill="#0073ff" stroke="#0073ff" points="963.51,-1135.06 971.47,-1128.06 960.88,-1128.57 963.51,-1135.06"/>
</g>
<!-- proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~modified_bessel_temme_algorithm</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/modified_bessel_temme_algorithm.html" xlink:title="modified_bessel_temme_algorithm">
<polygon fill="#d9534f" stroke="#d9534f" points="859,-521 660,-521 660,-497 859,-497 859,-521"/>
<text text-anchor="middle" x="759.5" y="-506.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_temme_algorithm</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm</title>
<path fill="none" stroke="#002eff" d="M562.78,-508.26C589.32,-508.36 620.29,-508.48 649.65,-508.59"/>
<polygon fill="#002eff" stroke="#002eff" points="649.95,-512.09 659.96,-508.63 649.98,-505.09 649.95,-512.09"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#1700ff" d="M518.88,-688.08C548.08,-703.42 594.96,-732.83 618,-773 678.23,-878.02 570.37,-955.47 654,-1043 719.82,-1111.9 785.76,-1028.08 865,-1081 889.61,-1097.43 879.02,-1117.19 901,-1137 916.96,-1151.38 937.8,-1162.72 956.25,-1170.94"/>
<polygon fill="#1700ff" stroke="#1700ff" points="955.07,-1174.25 965.64,-1174.96 957.82,-1167.81 955.07,-1174.25"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#1700ff" d="M540.58,-675.95C565.11,-674.05 594.76,-668.67 618,-655 640.08,-642.02 632.13,-623.33 654,-610 669.46,-600.58 688.36,-595.3 705.81,-592.36"/>
<polygon fill="#1700ff" stroke="#1700ff" points="706.5,-595.8 715.88,-590.89 705.48,-588.87 706.5,-595.8"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-643 732.5,-643 732.5,-619 786.5,-619 786.5,-643"/>
<text text-anchor="middle" x="759.5" y="-628.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#1700ff" d="M540.5,-668.1C563.81,-664.17 592.39,-659.35 618,-655 653.53,-648.97 694.1,-642.03 722.48,-637.17"/>
<polygon fill="#1700ff" stroke="#1700ff" points="723.08,-640.62 732.35,-635.48 721.9,-633.72 723.08,-640.62"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00d0" d="M523.97,-1172.01C555.81,-1183.88 607.52,-1201.2 654,-1208 748.35,-1221.81 858.47,-1210.48 928.68,-1199.84"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="929.4,-1203.27 938.74,-1198.28 928.32,-1196.35 929.4,-1203.27"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff00d0" d="M540.27,-1164.7C566.74,-1164.63 598.37,-1159.5 618,-1139 707.53,-1045.52 565.94,-944.87 654,-850 671.03,-831.65 699.24,-826.83 722.07,-826.37"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="722.09,-829.87 732.11,-826.42 722.13,-822.87 722.09,-829.87"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00d0" d="M540.27,-1164.08C566.4,-1163.73 597.68,-1158.51 618,-1139 674.02,-1085.2 593.69,-1016.94 654,-968 731.31,-905.27 1027.78,-930.55 1101,-998 1154.85,-1047.6 1175.43,-1284.97 1180.6,-1358.94"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="1177.11,-1359.25 1181.28,-1368.99 1184.1,-1358.78 1177.11,-1359.25"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff00d0" d="M521.71,-1172.04C553.6,-1185.5 607.19,-1207.69 654,-1225 759.27,-1263.92 884.54,-1304.53 951.71,-1325.84"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="951,-1329.29 961.59,-1328.97 953.11,-1322.62 951,-1329.29"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0045" d="M526.28,-1404.07C552.35,-1414.47 589.12,-1430.95 618,-1451 636.33,-1463.73 633.32,-1477.61 654,-1486 838.7,-1560.99 919.55,-1531.55 1101,-1449 1125.91,-1437.67 1149.26,-1416.49 1164.44,-1400.76"/>
<polygon fill="#ff0045" stroke="#ff0045" points="1167.31,-1402.81 1171.59,-1393.12 1162.2,-1398.03 1167.31,-1402.81"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0045" d="M503.67,-1379.69C528.59,-1348.68 592.52,-1263.94 618,-1181 636.67,-1120.23 612.19,-657.89 654,-610 666.79,-595.35 686.7,-589.19 705.72,-587.02"/>
<polygon fill="#ff0045" stroke="#ff0045" points="706.15,-590.49 715.84,-586.2 705.59,-583.51 706.15,-590.49"/>
</g>
<!-- proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~print_sum_of_squares</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/print_sum_of_squares.html" xlink:title="print_sum_of_squares">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1435 696,-1435 696,-1411 823,-1411 823,-1435"/>
<text text-anchor="middle" x="759.5" y="-1420.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_sum_of_squares</text>
</a>
</g>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares</title>
<path fill="none" stroke="#ff0045" d="M588.8,-1403.15C620.79,-1406.89 655.94,-1411 685.9,-1414.51"/>
<polygon fill="#ff0045" stroke="#ff0045" points="685.52,-1417.99 695.86,-1415.67 686.33,-1411.03 685.52,-1417.99"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M803.18,-587.39C876.98,-587.18 1027.59,-598.61 1101,-689 1144.32,-742.33 1174.55,-1246.05 1180.8,-1358.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1177.32,-1359.11 1181.36,-1368.91 1184.31,-1358.73 1177.32,-1359.11"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node73"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-416 974,-416 974,-392 1028,-392 1028,-416"/>
<text text-anchor="middle" x="1001" y="-401.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#00ff91" d="M786.59,-422.71C829.51,-418.95 915.11,-411.44 963.84,-407.17"/>
<polygon fill="#00ff91" stroke="#00ff91" points="964.29,-410.64 973.95,-406.28 963.68,-403.67 964.29,-410.64"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node75" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node75"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-458 974,-458 974,-434 1028,-434 1028,-458"/>
<text text-anchor="middle" x="1001" y="-443.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#00ff91" d="M786.59,-427.29C829.51,-431.05 915.11,-438.56 963.84,-442.83"/>
<polygon fill="#00ff91" stroke="#00ff91" points="963.68,-446.33 973.95,-443.72 964.29,-439.36 963.68,-446.33"/>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#4800ff" d="M786.74,-521.08C808.71,-531.83 840.36,-548.78 865,-568 913.34,-605.7 960.52,-660.69 984.22,-689.94"/>
<polygon fill="#4800ff" stroke="#4800ff" points="981.54,-692.2 990.53,-697.81 987,-687.82 981.54,-692.2"/>
</g>
<!-- proc~rgamma -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~rgamma</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/rgamma.html" xlink:title="rgamma">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1030,-521 972,-521 972,-497 1030,-497 1030,-521"/>
<text text-anchor="middle" x="1001" y="-506.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rgamma</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma</title>
<path fill="none" stroke="#4800ff" d="M859.3,-509C895.4,-509 934.13,-509 961.8,-509"/>
<polygon fill="#4800ff" stroke="#4800ff" points="961.83,-512.5 971.83,-509 961.83,-505.5 961.83,-512.5"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00da" d="M823.05,-1420.33C838.03,-1417.16 853.11,-1411.57 865,-1402 896.01,-1377.04 880.99,-1354.41 901,-1320 925.83,-1277.3 961.86,-1232.09 982.91,-1206.91"/>
<polygon fill="#ff00da" stroke="#ff00da" points="985.67,-1209.08 989.44,-1199.18 980.32,-1204.56 985.67,-1209.08"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00da" d="M823.12,-1419.53C891.56,-1415.34 1004.36,-1407.3 1101,-1395 1109.34,-1393.94 1118.14,-1392.62 1126.74,-1391.23"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1127.41,-1394.66 1136.7,-1389.56 1126.26,-1387.76 1127.41,-1394.66"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff00da" d="M823.26,-1412.79C837.16,-1409.86 851.7,-1406.28 865,-1402 901.57,-1390.23 941.43,-1371.42 968.29,-1357.8"/>
<polygon fill="#ff00da" stroke="#ff00da" points="969.92,-1360.9 977.22,-1353.22 966.72,-1354.67 969.92,-1360.9"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node76" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node76"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1210,-437 1156,-437 1156,-413 1210,-413 1210,-437"/>
<text text-anchor="middle" x="1183" y="-422.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1028.17,-407.05C1059.1,-410.66 1110.75,-416.69 1145.57,-420.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1145.46,-424.26 1155.79,-421.94 1146.27,-417.31 1145.46,-424.26"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#0000ff" d="M1028.17,-442.95C1059.1,-439.34 1110.75,-433.31 1145.57,-429.25"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1146.27,-432.69 1155.79,-428.06 1145.46,-425.74 1146.27,-432.69"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-count_blocks">count_blocks</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~3">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_indices~12"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~8"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholddiag</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholdoff"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholdoff</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-count_blocks"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>count_blocks</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_algebraic_coefficients~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_algebraic_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~2"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_algebraic_coefficients~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_algebraic_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_pes_matrix_elements~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_pes_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">data_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_short_block_summary</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">pes_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">prepare_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="n">print_pes_matrix_elements_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">propagator_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">numerov</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">save_s_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">save_s_matrix_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_s_matrix_block_info</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">check_cross_section_thresholds</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">save_partial_xs_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_partial_xs_single_block</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">save_s_matrix_file_header</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">save_partial_xs_file_header</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize arrays that save the state-to-state cross-sections</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;jtot_loop&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_blocks</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">print_short_block_summary</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">count_blocks</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the PES matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_pes_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">save_s_matrix_block_info</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w"> </span><span class="n">wv</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">s_matrix_real</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">save_partial_xs_single_block</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if elastic_xs_threshold/inelastic_xs_threshold condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-10 11:10            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>