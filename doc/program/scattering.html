<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">202 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-count_blocks">count_blocks</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~3">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/propagator_mod.html'>propagator_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/data_mod.html'>data_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/pes_matrix_mod.html'>pes_matrix_mod</a></li>
                <li><a href='../module/save_s_matrix_mod.html'>save_s_matrix_mod</a></li>
                <li><a href='../module/radial_coupling_terms_mod.html'>radial_coupling_terms_mod</a></li>
                <li><a href='../module/state_to_state_cross_sections_mod.html'>state_to_state_cross_sections_mod</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="458pt"
 viewBox="0.00 0.00 641.00 458.41" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.89 1.89) rotate(0) translate(4 862.76)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-862.76 1208,-862.76 1208,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="1204,-453.42 1125,-453.42 1125,-429.42 1204,-429.42 1204,-453.42"/>
<text text-anchor="middle" x="1164.5" y="-439.02" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~data_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~data_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/data_mod.html" xlink:title="data_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="225.5,-477.42 159.5,-477.42 159.5,-453.42 225.5,-453.42 225.5,-477.42"/>
<text text-anchor="middle" x="192.5" y="-463.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">data_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-849.42C557.24,-839.78 498.24,-893.46 358.5,-815.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-815.42C323.14,-796.02 312.4,-790.53 291,-758.42 231.16,-668.66 205.15,-538.97 196.76,-487.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="200.2,-486.93 195.19,-477.59 193.29,-488.01 200.2,-486.93"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="419,-555.42 296,-555.42 296,-531.42 419,-531.42 419,-555.42"/>
<text text-anchor="middle" x="357.5" y="-541.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1163.58,-453.63C1163.19,-504.7 1154.1,-702.28 1039.5,-782.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-782.42C1007.8,-803.19 458.62,-571.15 424,-560.42 421.59,-559.68 419.13,-558.94 416.64,-558.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="417.51,-554.81 406.93,-555.45 415.6,-561.55 417.51,-554.81"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="549,-517.42 495,-517.42 495,-493.42 549,-493.42 549,-517.42"/>
<text text-anchor="middle" x="522" y="-503.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-298.42C963.63,-260.85 918.99,-268.62 852,-317.42 819.83,-340.86 845.07,-372.23 816,-399.42 742.22,-468.45 620.12,-493.18 559.49,-501.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="558.73,-498.07 549.26,-502.83 559.63,-505.02 558.73,-498.07"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-363.42 0,-363.42 0,-339.42 94,-339.42 94,-363.42"/>
<text text-anchor="middle" x="47" y="-349.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-815.42C293.87,-779.01 262.1,-838.72 193.5,-815.42"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-749.42 291,-749.42 291,-725.42 424,-725.42 424,-749.42"/>
<text text-anchor="middle" x="357.5" y="-735.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-782.42C923.5,-871.47 862.99,-863.25 719,-849.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-849.42C654.09,-843.9 481.11,-782.6 400.67,-753.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="401.46,-749.67 390.87,-749.5 399.04,-756.24 401.46,-749.67"/>
</g>
<!-- module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~propagator_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/propagator_mod.html" xlink:title="propagator_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="1089,-453.42 988,-453.42 988,-429.42 1089,-429.42 1089,-453.42"/>
<text text-anchor="middle" x="1038.5" y="-439.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">propagator_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~propagator_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1124.95,-441.42C1116.87,-441.42 1108.18,-441.42 1099.53,-441.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1099.45,-437.92 1089.45,-441.42 1099.45,-444.92 1099.45,-437.92"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="763,-310.42 673,-310.42 673,-286.42 763,-286.42 763,-310.42"/>
<text text-anchor="middle" x="718" y="-296.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-220.42C870.47,-212.81 790.53,-255.97 747.46,-281.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="745.44,-278.31 738.61,-286.42 749,-284.34 745.44,-278.31"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="255,-249.42 130,-249.42 130,-225.42 255,-225.42 255,-249.42"/>
<text text-anchor="middle" x="192.5" y="-235.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1157.16,-429.05C1141.63,-400.21 1098.59,-328.66 1039.5,-298.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-298.42C975.98,-266.95 970.05,-237.14 903,-220.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-220.42C854.86,-208.92 855.31,-182.19 816,-155.42 694.41,-72.61 669.67,9.95 523,-1.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-1.42C465.71,-2.45 334.04,-61.7 291,-96.42 249.58,-129.83 218.46,-185.35 203.45,-215.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="200.16,-214.56 198.99,-225.09 206.47,-217.59 200.16,-214.56"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="794.5,-188.42 641.5,-188.42 641.5,-164.42 794.5,-164.42 794.5,-188.42"/>
<text text-anchor="middle" x="718" y="-174.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-220.42C863.03,-210.95 854.03,-206.68 816,-197.42 806.52,-195.11 796.49,-192.8 786.61,-190.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="787.33,-187.17 776.81,-188.43 785.82,-194.01 787.33,-187.17"/>
</g>
<!-- module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~pes_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/pes_matrix_mod.html" xlink:title="pes_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="952,-350.42 852,-350.42 852,-326.42 952,-326.42 952,-350.42"/>
<text text-anchor="middle" x="902" y="-336.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-298.42C1020.11,-289.58 971.82,-307.46 938.11,-322.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="936.33,-319.05 928.6,-326.3 939.16,-325.45 936.33,-319.05"/>
</g>
<!-- module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~save_s_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/save_s_matrix_mod.html" xlink:title="save_s_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="416,-129.42 299,-129.42 299,-105.42 416,-105.42 416,-129.42"/>
<text text-anchor="middle" x="357.5" y="-115.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~save_s_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-1.42C488.23,-3.96 414.83,-66.41 378.98,-98.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="376.59,-96.04 371.53,-105.35 381.29,-101.23 376.59,-96.04"/>
</g>
<!-- module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>module~radial_coupling_terms_mod</title>
<g id="a_program~~scattering~~UsesGraph_node13"><a xlink:href=".././module/radial_coupling_terms_mod.html" xlink:title="radial_coupling_terms_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="798,-230.42 638,-230.42 638,-206.42 798,-206.42 798,-230.42"/>
<text text-anchor="middle" x="718" y="-216.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-220.42C871.52,-213.07 838.5,-210.96 808.77,-211.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="808.34,-207.7 798.4,-211.36 808.46,-214.7 808.34,-207.7"/>
</g>
<!-- module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~state_to_state_cross_sections_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/state_to_state_cross_sections_mod.html" xlink:title="state_to_state_cross_sections_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="816,-390.42 620,-390.42 620,-366.42 816,-366.42 816,-390.42"/>
<text text-anchor="middle" x="718" y="-376.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;module~state_to_state_cross_sections_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-220.42C833.3,-203.54 870.57,-308.93 816,-352.42 811.28,-356.18 806.07,-359.4 800.58,-362.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="798.83,-359.1 791.12,-366.36 801.68,-365.49 798.83,-359.1"/>
</g>
<!-- module~data_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~data_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M176.14,-453.22C151,-433.25 100.92,-393.46 71.36,-369.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="73.25,-367.01 63.25,-363.53 68.9,-372.49 73.25,-367.01"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M331.39,-531.41C303.63,-518.12 258.75,-496.65 227.77,-481.82"/>
<polygon fill="#ff7500" stroke="#ff7500" points="229.17,-478.61 218.64,-477.45 226.15,-484.93 229.17,-478.61"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M341.18,-555.6C326.82,-567.61 305.46,-587.07 291,-607.42 231.87,-690.65 290.23,-848.09 193.5,-815.42"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M191.5,-815.42C103.4,-785.66 60.59,-462.74 50.42,-373.92"/>
<polygon fill="#ff7500" stroke="#ff7500" points="53.89,-373.4 49.3,-363.85 46.93,-374.17 53.89,-373.4"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M350.29,-531.17C338.58,-508.03 312.48,-456.26 291,-412.42 274.73,-379.22 272.71,-369.88 255,-337.42 239.66,-309.31 219.99,-278.04 207.07,-258.07"/>
<polygon fill="#ff7500" stroke="#ff7500" points="209.88,-255.97 201.49,-249.5 204.01,-259.79 209.88,-255.97"/>
</g>
<!-- module~io_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~io_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M494.99,-493.82C463.27,-480.9 407.79,-462.2 358.5,-465.42"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M502.01,-517.48C460.76,-544.21 361.07,-611.76 291,-683.42 240.01,-735.57 262.6,-838.76 193.5,-815.42"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M512.49,-517.57C486.17,-555.15 405.83,-669.85 372.86,-716.92"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="369.79,-715.2 366.92,-725.4 375.53,-719.21 369.79,-715.2"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M517.31,-493.19C504.11,-451.94 454.78,-318.21 358.5,-275.42"/>
</g>
<!-- module~input_validation -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~input_validation</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/input_validation.html" xlink:title="input_validation">
<polygon fill="#337ab7" stroke="#337ab7" points="406,-403.42 309,-403.42 309,-379.42 406,-379.42 406,-403.42"/>
<text text-anchor="middle" x="357.5" y="-389.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_validation</text>
</a>
</g>
</g>
<!-- module~io_mod&#45;&gt;module~input_validation -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~io_mod&#45;&gt;module~input_validation</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M503.61,-493.22C474.9,-473.08 417.45,-432.78 384.09,-409.38"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="385.96,-406.41 375.77,-403.53 381.94,-412.14 385.96,-406.41"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M323.88,-749.54C313.28,-753.69 301.55,-758.54 291,-763.42 246.44,-784.07 240.03,-831.14 193.5,-815.42"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~propagator_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-545.42C630.88,-549.59 607.86,-560.69 523,-545.42"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~propagator_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1017.72,-453.51C968.75,-482.17 837.22,-551.44 719,-545.42"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-545.42C660.87,-548.14 597.36,-531.09 558.76,-518.4"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="559.62,-515 549.03,-515.12 557.38,-521.63 559.62,-515"/>
</g>
<!-- module~propagator_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~propagator_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-811.42C558.55,-788.85 517.87,-762.73 358.5,-777.42"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~propagator_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M901,-811.42C830.38,-850.87 799.08,-822.83 719,-811.42"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-811.42C668.36,-804.49 662.37,-783.29 620,-758.42 576.08,-732.64 573.92,-696.72 523,-697.42"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~propagator_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1033.52,-429.32C1024.18,-403.12 998.07,-341.62 952,-317.42 859.95,-269.08 822.84,-343.73 719,-338.42"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-338.42C673.37,-333.33 661.84,-332.81 620,-319.42 574.91,-305 569.39,-284.84 523,-275.42"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M521,-275.42C450.22,-261.05 424.5,-304.75 358.5,-275.42"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M356.5,-275.42C327.88,-262.7 294.46,-253.96 265.36,-248.09"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="265.75,-244.6 255.26,-246.14 264.42,-251.47 265.75,-244.6"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~propagator_mod&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1021.81,-429.4C998.55,-411.59 954.72,-378.03 927.29,-357.02"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="929.08,-353.98 919.01,-350.68 924.82,-359.54 929.08,-353.98"/>
</g>
<!-- module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node18" class="node">
<title>module~centrifugal_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node18"><a xlink:href=".././module/centrifugal_matrix_mod.html" xlink:title="centrifugal_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="787.5,-749.42 648.5,-749.42 648.5,-725.42 787.5,-725.42 787.5,-749.42"/>
<text text-anchor="middle" x="718" y="-735.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">centrifugal_matrix_mod</text>
</a>
</g>
</g>
<!-- module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1037.98,-453.45C1039.4,-508.46 1036.96,-736.59 903,-811.42"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M901,-811.42C873.41,-826.84 790.39,-781.16 746.65,-754.76"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="748.31,-751.67 737.95,-749.44 744.66,-757.64 748.31,-751.67"/>
</g>
<!-- module~channels_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~channels_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M688.08,-310.43C649.59,-326.75 579.79,-357.58 523,-389.42"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M687.34,-310.52C666.18,-320.44 638.34,-336.28 620,-357.42 593.38,-388.1 606.37,-407.52 584,-441.42 572.94,-458.19 557.25,-474.53 544.55,-486.51"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="542.09,-484.02 537.1,-493.37 546.83,-489.17 542.09,-484.02"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M672.97,-286.97C656.34,-282.55 637.26,-277.37 620,-272.42 603.92,-267.81 600.39,-264.77 584,-261.42 485.25,-241.27 456.73,-259.98 358.5,-237.42"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M356.5,-237.42C327.4,-228.95 315.6,-236.13 291,-218.42 229.17,-173.9 262.03,-44.14 193.5,-77.42"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M356.5,-237.42C327.27,-230.71 294.3,-229.55 265.71,-230.51"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="265.22,-227.02 255.38,-230.95 265.52,-234.02 265.22,-227.02"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M176.14,-249.62C151,-269.59 100.92,-309.38 71.36,-332.87"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="68.9,-330.35 63.25,-339.31 73.25,-335.83 68.9,-330.35"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M641.42,-184.86C633.64,-187.97 626.3,-192.06 620,-197.42 586.57,-225.89 611.22,-254.97 584,-289.42 542.42,-342.05 511.18,-332.07 460,-375.42 442.49,-390.25 440.95,-396.96 424,-412.42 396.34,-437.66 395.81,-462.16 358.5,-465.42"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M356.5,-465.42C315.63,-468.53 268.84,-468.12 235.9,-467.18"/>
<polygon fill="#004eff" stroke="#004eff" points="235.82,-463.68 225.72,-466.86 235.6,-470.67 235.82,-463.68"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M641.09,-183.11C633.17,-186.49 625.89,-191.13 620,-197.42 545.12,-277.48 632.07,-342.9 584,-441.42 575.36,-459.13 560.05,-475.17 546.93,-486.76"/>
<polygon fill="#004eff" stroke="#004eff" points="544.49,-484.24 539.12,-493.38 549.01,-489.58 544.49,-484.24"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M707.01,-164.31C686.52,-140.3 637.2,-86.57 584,-58.42 538.31,-34.25 410.12,-4.03 358.5,-1.42"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M356.5,-1.42C276.67,2.62 265.4,-42.5 193.5,-77.42"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M191.5,-77.42C92.33,-125.59 59.93,-272.73 50.99,-329.12"/>
<polygon fill="#004eff" stroke="#004eff" points="47.51,-328.72 49.5,-339.12 54.43,-329.75 47.51,-328.72"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M641.25,-183.26C633.31,-186.62 625.97,-191.21 620,-197.42 555.61,-264.45 635.14,-325.81 584,-403.42 547.78,-458.39 501.74,-433.52 460,-484.42 452.18,-493.96 389.78,-655.76 366.88,-715.49"/>
<polygon fill="#004eff" stroke="#004eff" points="363.52,-714.5 363.21,-725.09 370.05,-717.01 363.52,-714.5"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M679.05,-164.39C652.69,-156.68 616.59,-147.4 584,-143.42 484.33,-131.24 456.41,-135.15 358.5,-157.42"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M356.5,-157.42C326.81,-163.52 318.67,-164.04 291,-176.42 264.72,-188.18 237.12,-206.04 218.02,-219.4"/>
<polygon fill="#004eff" stroke="#004eff" points="215.75,-216.72 209.62,-225.37 219.8,-222.43 215.75,-216.72"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node16" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="549,-91.42 495,-91.42 495,-67.42 549,-67.42 549,-91.42"/>
<text text-anchor="middle" x="522" y="-77.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M695.64,-164.27C669.61,-149.64 624.13,-124.64 584,-105.42 575.78,-101.48 566.8,-97.49 558.33,-93.86"/>
<polygon fill="#004eff" stroke="#004eff" points="559.62,-90.61 549.05,-89.93 556.89,-97.05 559.62,-90.61"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node17" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node17"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="584,-209.42 460,-209.42 460,-185.42 584,-185.42 584,-209.42"/>
<text text-anchor="middle" x="522" y="-195.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M641.44,-184.6C625.9,-186.28 609.6,-188.05 594.22,-189.71"/>
<polygon fill="#004eff" stroke="#004eff" points="593.84,-186.23 584.27,-190.79 594.59,-193.19 593.84,-186.23"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M717,-507.42C696.92,-516.32 544.62,-549.31 523,-545.42"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M521,-545.42C493.05,-540.39 485.91,-538.04 460,-526.42 411.98,-504.89 410.98,-461.43 358.5,-465.42"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M892.52,-350.65C869.23,-383.08 800.6,-471.25 719,-507.42"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M717,-507.42C665.87,-530.09 599.45,-522.51 559.09,-514.38"/>
<polygon fill="#2700ff" stroke="#2700ff" points="559.68,-510.93 549.17,-512.27 558.22,-517.78 559.68,-510.93"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge47" class="edge">
<title>module~pes_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M900,-350.52C896.27,-387.51 879.94,-500.2 816,-559.42 726.66,-642.17 395.33,-653.63 291,-716.42 238.09,-748.27 251.96,-835.32 193.5,-815.42"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M901.58,-350.53C903.04,-395.65 901.72,-555.52 816,-635.42 718.63,-726.18 656.1,-698.59 523,-697.42"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M521,-697.42C478.48,-698.01 431.46,-711 398.99,-722.02"/>
<polygon fill="#2700ff" stroke="#2700ff" points="397.69,-718.76 389.4,-725.36 400,-725.37 397.69,-718.76"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge48" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M851.91,-339.78C815.27,-340.46 763.97,-340.72 719,-338.42"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge49" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M893.45,-326.29C880.28,-306.15 851.1,-265.88 816,-244.42 809.18,-240.25 801.69,-236.74 793.99,-233.79"/>
<polygon fill="#2700ff" stroke="#2700ff" points="795.12,-230.47 784.52,-230.45 792.79,-237.08 795.12,-230.47"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M887.99,-326.28C872.2,-312.26 844.19,-289.57 816,-277.42 734.51,-242.3 704.64,-266.06 620,-239.42 603.3,-234.17 600.05,-230.41 584,-223.42 576.58,-220.19 568.63,-216.77 561.01,-213.52"/>
<polygon fill="#2700ff" stroke="#2700ff" points="562.16,-210.2 551.59,-209.5 559.42,-216.64 562.16,-210.2"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge50" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M337.3,-129.53C322.27,-140.05 302.11,-156.69 291,-176.42 249.04,-250.93 285.91,-285.69 255,-365.42 243.5,-395.09 223.16,-425.75 209.04,-445.17"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="206.18,-443.14 203.04,-453.26 211.81,-447.31 206.18,-443.14"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge51" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M326.83,-105.41C286.54,-89.91 216.87,-66.18 193.5,-77.42"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge52" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M318.89,-129.46C309.42,-133.25 299.54,-137.92 291,-143.42 258.72,-164.22 227.95,-196.74 209.89,-217.56"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="207.22,-215.3 203.4,-225.18 212.55,-219.84 207.22,-215.3"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge53" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M691.21,-230.49C670.49,-240.99 641.41,-257.61 620,-277.42 599.9,-296.02 601.65,-306.49 584,-327.42 559.08,-356.97 556.72,-370.52 523,-389.42"/>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M521,-389.42C496.74,-403.02 485.76,-392.92 460,-403.42 411.05,-423.37 411.16,-460.82 358.5,-465.42"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge55" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M683.78,-230.57C662.37,-240.1 635.69,-255.45 620,-277.42 576.63,-338.15 619.04,-375.53 584,-441.42 574.75,-458.82 559.44,-474.86 546.47,-486.53"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="544.04,-484.01 538.78,-493.21 548.62,-489.3 544.04,-484.01"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge56" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M648.36,-206.4C638.69,-203.89 628.99,-200.92 620,-197.42 602.73,-190.71 600.95,-183.89 584,-176.42 558.01,-164.97 549.45,-167.75 523,-157.42"/>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M521,-157.42C427.74,-121.01 458.49,-6.48 358.5,-1.42"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge57" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M521,-157.42C453.72,-131.15 428.92,-141.4 358.5,-157.42"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge54" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M637.81,-209.85C623.4,-208.29 608.44,-206.67 594.27,-205.14"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="594.42,-201.63 584.11,-204.04 593.67,-208.59 594.42,-201.63"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge58" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M671.29,-390.45C581.85,-413.85 389.7,-463.38 358.5,-465.42"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge61" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M643.67,-390.61C635.12,-394.12 626.98,-398.63 620,-404.42 591.54,-428.03 610.72,-453.87 584,-479.42 576.84,-486.27 567.59,-491.46 558.48,-495.32"/>
<polygon fill="#ff0075" stroke="#ff0075" points="557.22,-492.05 549.12,-498.88 559.71,-498.59 557.22,-492.05"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge59" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M619.52,-373.91C514.37,-368.92 342.02,-360.39 193.5,-351.42"/>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M191.5,-351.42C162.88,-349.27 130.96,-349.05 104.5,-349.47"/>
<polygon fill="#ff0075" stroke="#ff0075" points="104.21,-345.97 94.27,-349.66 104.34,-352.97 104.21,-345.97"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge60" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M656.85,-366.41C644.31,-362.78 631.45,-358.18 620,-352.42 570.84,-327.67 576.94,-286.37 523,-275.42"/>
</g>
<!-- module~input_validation&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge62" class="edge">
<title>module~input_validation&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M329.95,-403.48C302.6,-415.89 259.79,-435.33 229.43,-449.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="227.7,-446.05 220.04,-453.37 230.59,-452.43 227.7,-446.05"/>
</g>
<!-- module~input_validation&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge63" class="edge">
<title>module~input_validation&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322.71,-379.34C290.12,-368.6 239.16,-354.18 193.5,-351.42"/>
</g>
<!-- module~input_validation&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge64" class="edge">
<title>module~input_validation&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M343.71,-379.34C315.5,-352.69 247.76,-288.68 213.73,-256.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="215.9,-253.77 206.23,-249.45 211.1,-258.86 215.9,-253.77"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge66" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M481.05,-185.31C473.44,-181.71 465.99,-177.15 460,-171.42 433.28,-145.87 454.46,-117.38 424,-96.42 339.32,-38.15 286.13,-32.85 193.5,-77.42"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge67" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M487.51,-185.42C447.47,-171.72 382.79,-151.89 358.5,-157.42"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node19" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node19"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-209.42 291,-209.42 291,-185.42 424,-185.42 424,-209.42"/>
<text text-anchor="middle" x="357.5" y="-195.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge65" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M459.57,-197.42C451.32,-197.42 442.79,-197.42 434.34,-197.42"/>
<polygon fill="#00ffff" stroke="#00ffff" points="434.09,-193.92 424.09,-197.42 434.09,-200.92 434.09,-193.92"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge68" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M687.4,-725.41C590.87,-686.22 291.28,-564.61 291,-564.42 257.89,-542.29 226.94,-507.53 209.13,-485.64"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="211.73,-483.29 202.76,-477.66 206.26,-487.65 211.73,-483.29"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge71" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M712.18,-725.19C697.85,-690.26 652.2,-588.89 584,-531.42 576.63,-525.21 567.56,-520.28 558.68,-516.46"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="559.81,-513.14 549.22,-512.74 557.25,-519.66 559.81,-513.14"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge69" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M648.2,-744.51C575.98,-752.09 459.16,-764.74 358.5,-777.42"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M356.5,-777.42C282.43,-784.25 263.92,-839.39 193.5,-815.42"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge70" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M669.45,-725.41C621.58,-713.72 550.94,-697.67 523,-697.42"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="1120pt"
 viewBox="0.00 0.00 641.00 1119.75" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(1.93 1.93) rotate(0) translate(4 2156.89)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2156.89 1233,-2156.89 1233,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-881 0,-881 0,-857 79,-857 79,-881"/>
<text text-anchor="middle" x="39.5" y="-866.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~read_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/read_radial_coupling_terms.html" xlink:title="read_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-1508 143,-1508 143,-1484 303,-1484 303,-1508"/>
<text text-anchor="middle" x="223" y="-1493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~read_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M41.15,-881.17C45.61,-962.88 72.84,-1429.71 115,-1475 120.23,-1480.62 126.49,-1484.99 133.32,-1488.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.37,-1491.75 142.95,-1492.36 135.06,-1485.29 132.37,-1491.75"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-695 429,-695 429,-671 556,-671 556,-695"/>
<text text-anchor="middle" x="492.5" y="-680.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M41.65,-856.99C45.43,-825.13 60.51,-738.32 115,-701 162.6,-668.4 323.24,-672.17 418.62,-677.67"/>
<polygon fill="#ff0000" stroke="#ff0000" points="418.59,-681.18 428.78,-678.28 419.01,-674.19 418.59,-681.18"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="834,-1067 685,-1067 685,-1043 834,-1043 834,-1067"/>
<text text-anchor="middle" x="759.5" y="-1052.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M40.59,-881.09C41.6,-917.41 50.14,-1025.79 115,-1071 193.76,-1125.9 235.02,-1072.8 331,-1071 450.34,-1068.77 588.33,-1063.03 674.52,-1059.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="674.94,-1062.56 684.77,-1058.6 674.61,-1055.56 674.94,-1062.56"/>
</g>
<!-- proc~print_short_block_summary -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~print_short_block_summary</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/print_short_block_summary.html" xlink:title="print_short_block_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="839,-2102 680,-2102 680,-2078 839,-2078 839,-2102"/>
<text text-anchor="middle" x="759.5" y="-2087.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_short_block_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_short_block_summary -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~print_short_block_summary</title>
<path fill="none" stroke="#ff0000" d="M40.82,-881.35C44.11,-1004.28 72.11,-2004.72 115,-2049 275.25,-2214.45 593.59,-2140.43 712.38,-2105"/>
<polygon fill="#ff0000" stroke="#ff0000" points="713.7,-2108.26 722.25,-2102.01 711.66,-2101.56 713.7,-2108.26"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1055.5,-1430 946.5,-1430 946.5,-1406 1055.5,-1406 1055.5,-1430"/>
<text text-anchor="middle" x="1001" y="-1415.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.89,-881.4C43.19,-946.35 56.85,-1246.97 115,-1315 124.59,-1326.22 352.47,-1396.42 367,-1399 572.43,-1435.51 821.14,-1428.33 936.07,-1422.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="936.32,-1425.67 946.11,-1421.62 935.93,-1418.68 936.32,-1425.67"/>
</g>
<!-- proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~calculate_state_to_state_cross_section</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/calculate_state_to_state_cross_section.html" xlink:title="calculate_state_to_state_cross_section">
<polygon fill="#d9534f" stroke="#d9534f" points="331,-654 115,-654 115,-630 331,-630 331,-654"/>
<text text-anchor="middle" x="223" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_state_to_state_cross_section</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section</title>
<path fill="none" stroke="#ff0000" d="M41.2,-856.89C43.88,-821.92 56.61,-719.95 115,-668 118.96,-664.48 123.32,-661.41 127.94,-658.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="129.78,-661.74 137.12,-654.1 126.62,-655.49 129.78,-661.74"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="292,-944 154,-944 154,-920 292,-920 292,-944"/>
<text text-anchor="middle" x="223" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M58.08,-881.06C72.71,-890.54 94.38,-903.39 115,-911 124.19,-914.39 134.04,-917.27 143.9,-919.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.21,-923.14 153.75,-921.99 144.8,-916.32 143.21,-923.14"/>
</g>
<!-- proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~print_pes_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/print_pes_matrix_elements_summary.html" xlink:title="print_pes_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="865,-2060 654,-2060 654,-2036 865,-2036 865,-2060"/>
<text text-anchor="middle" x="759.5" y="-2045.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_pes_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.35,-881.17C39.01,-998.34 31.1,-1923.93 115,-2008 186.54,-2079.69 478.48,-2070.01 643.49,-2058.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="643.96,-2061.66 653.68,-2057.44 643.45,-2054.68 643.96,-2061.66"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-570 122.5,-570 122.5,-546 323.5,-546 323.5,-570"/>
<text text-anchor="middle" x="223" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.91,-856.77C47.94,-806.75 73.14,-618.52 115,-579 116.12,-577.94 117.27,-576.93 118.46,-575.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="120.54,-578.79 126.75,-570.21 116.54,-573.04 120.54,-578.79"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-612 167,-612 167,-588 279,-588 279,-612"/>
<text text-anchor="middle" x="223" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.11,-856.95C39.51,-816.72 43.39,-685.92 115,-621 126.51,-610.57 141.62,-604.67 156.86,-601.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.6,-604.89 166.85,-599.73 156.4,-597.99 157.6,-604.89"/>
</g>
<!-- proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~save_partial_xs_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/save_partial_xs_file_header.html" xlink:title="save_partial_xs_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-1550 143.5,-1550 143.5,-1526 302.5,-1526 302.5,-1550"/>
<text text-anchor="middle" x="223" y="-1535.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_file_header</title>
<path fill="none" stroke="#ff0000" d="M41.05,-881.18C44.98,-966.15 70,-1468.28 115,-1517 120.42,-1522.87 126.96,-1527.37 134.1,-1530.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.85,-1534.07 143.43,-1534.59 135.48,-1527.59 132.85,-1534.07"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-1306 176,-1306 176,-1282 270,-1282 270,-1306"/>
<text text-anchor="middle" x="223" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M41.03,-881.01C43.42,-924.61 55.81,-1077.64 115,-1185 135.61,-1222.39 172.63,-1255.87 197.25,-1275.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.37,-1278.53 205.4,-1281.94 199.68,-1273.02 195.37,-1278.53"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="270,-528 176,-528 176,-504 270,-504 270,-528"/>
<text text-anchor="middle" x="223" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M41.48,-856.9C46.11,-802.72 67.59,-583.15 115,-537 128.45,-523.91 147.53,-517.81 165.86,-515.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.36,-518.71 175.93,-514.17 165.61,-511.75 166.36,-518.71"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="267,-486 179,-486 179,-462 267,-462 267,-486"/>
<text text-anchor="middle" x="223" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M41.15,-856.97C44.52,-798.86 62.02,-547.83 115,-495 129.1,-480.94 149.67,-474.89 169.02,-472.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.32,-476.13 178.98,-471.79 168.72,-469.15 169.32,-476.13"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="274,-444 172,-444 172,-420 274,-420 274,-444"/>
<text text-anchor="middle" x="223" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.89,-856.89C43.13,-794.78 56.48,-512.5 115,-453 127.26,-440.53 144.61,-434.33 161.77,-431.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.35,-434.95 171.81,-430.19 161.44,-428 162.35,-434.95"/>
</g>
<!-- proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~interpolate_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/interpolate_radial_coupling_terms.html" xlink:title="interpolate_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="589.5,-1470 395.5,-1470 395.5,-1446 589.5,-1446 589.5,-1470"/>
<text text-anchor="middle" x="492.5" y="-1455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.39,-881.22C40.04,-952.52 41.91,-1314.19 115,-1390 120.12,-1395.31 299.55,-1426.01 408.82,-1444.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="408.4,-1447.78 418.84,-1445.97 409.56,-1440.87 408.4,-1447.78"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-902 455.5,-902 455.5,-878 529.5,-878 529.5,-902"/>
<text text-anchor="middle" x="492.5" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M46.75,-881.07C57.59,-900.52 81.93,-938.13 115,-953 202.55,-992.38 242.56,-990.34 331,-953 352.14,-944.07 346.89,-927.05 367,-916 390.96,-902.83 420.87,-896.32 445.36,-893.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.97,-896.56 455.49,-891.92 445.16,-889.61 445.97,-896.56"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="312,-902 134,-902 134,-878 312,-878 312,-902"/>
<text text-anchor="middle" x="223" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M79.44,-873.51C92.59,-875.03 107.94,-876.8 123.59,-878.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="123.56,-882.13 133.9,-879.81 124.37,-875.18 123.56,-882.13"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="253,-734 193,-734 193,-710 253,-710 253,-734"/>
<text text-anchor="middle" x="223" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M44.03,-856.61C52.04,-830.93 74.12,-771.9 115,-743 134.53,-729.2 160.84,-723.9 182.48,-722.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.92,-725.56 192.68,-721.44 182.48,-718.57 182.92,-725.56"/>
</g>
<!-- proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~save_partial_xs_single_block</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/save_partial_xs_single_block.html" xlink:title="save_partial_xs_single_block">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-1184 410.5,-1184 410.5,-1160 574.5,-1160 574.5,-1184"/>
<text text-anchor="middle" x="492.5" y="-1169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_single_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_single_block</title>
<path fill="none" stroke="#ff0000" d="M41.91,-881.16C47.86,-930 72.51,-1111.04 115,-1146 156.96,-1180.53 302.62,-1181.23 399.98,-1177.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="400.28,-1180.93 410.12,-1177.02 399.99,-1173.94 400.28,-1180.93"/>
</g>
<!-- proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~print_largest_partial_cross_sections</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/print_largest_partial_cross_sections.html" xlink:title="print_largest_partial_cross_sections">
<polygon fill="#d9534f" stroke="#d9534f" points="1101,-1923 901,-1923 901,-1899 1101,-1899 1101,-1923"/>
<text text-anchor="middle" x="1001" y="-1908.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_cross_sections</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_cross_sections</title>
<path fill="none" stroke="#ff0000" d="M40.79,-881.1C43.3,-982.17 62.59,-1684.19 115,-1760 308.77,-2040.28 524.41,-1929.08 865,-1919 873.35,-1918.75 881.99,-1918.42 890.67,-1918.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="891.04,-1921.52 900.87,-1917.55 890.71,-1914.52 891.04,-1921.52"/>
</g>
<!-- proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>proc~check_cross_section_thresholds</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././proc/check_cross_section_thresholds.html" xlink:title="check_cross_section_thresholds">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-402 133,-402 133,-378 313,-378 313,-402"/>
<text text-anchor="middle" x="223" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cross_section_thresholds</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;proc~check_cross_section_thresholds</title>
<path fill="none" stroke="#ff0000" d="M40.68,-856.57C41.89,-790.09 50.99,-477.13 115,-411 117.73,-408.18 120.72,-405.68 123.9,-403.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="125.92,-406.34 132.76,-398.25 122.37,-400.31 125.92,-406.34"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="267.5,-360 178.5,-360 178.5,-336 267.5,-336 267.5,-360"/>
<text text-anchor="middle" x="223" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.49,-856.83C40.7,-787.42 45.29,-441.99 115,-369 128.7,-354.66 149.1,-348.54 168.42,-346.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.72,-349.8 178.39,-345.48 168.13,-342.83 168.72,-349.8"/>
</g>
<!-- proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~reduce_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/reduce_radial_coupling_terms.html" xlink:title="reduce_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="845.5,-2018 673.5,-2018 673.5,-1994 845.5,-1994 845.5,-2018"/>
<text text-anchor="middle" x="759.5" y="-2003.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduce_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~reduce_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.36,-881.24C39.1,-997.19 32.07,-1899.25 115,-1980 153.29,-2017.29 493.41,-2013.38 663.09,-2009.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="663.37,-2012.51 673.27,-2008.74 663.18,-2005.51 663.37,-2012.51"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="294.5,-860 151.5,-860 151.5,-836 294.5,-836 294.5,-860"/>
<text text-anchor="middle" x="223" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M79.44,-864.49C97.51,-862.4 119.71,-859.84 141.16,-857.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.74,-860.81 151.27,-856.18 140.94,-853.86 141.74,-860.81"/>
</g>
<!-- proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~prepare_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/prepare_pes_matrix_elements.html" xlink:title="prepare_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="309,-318 137,-318 137,-294 309,-294 309,-318"/>
<text text-anchor="middle" x="223" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.34,-856.78C39.63,-783.89 39.68,-406.76 115,-327 118.86,-322.91 123.26,-319.49 128.03,-316.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="129.65,-319.74 136.97,-312.09 126.47,-313.5 129.65,-319.74"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="260,-276 186,-276 186,-252 260,-252 260,-276"/>
<text text-anchor="middle" x="223" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M40.21,-856.85C38.63,-780.87 34.01,-371.6 115,-285 130.28,-268.66 154.25,-262.93 175.63,-261.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.01,-264.99 185.87,-261.11 175.75,-257.99 176.01,-264.99"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="786.5,-942 732.5,-942 732.5,-918 786.5,-918 786.5,-942"/>
<text text-anchor="middle" x="759.5" y="-927.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M44.21,-881.01C52.42,-905.21 74.65,-959.38 115,-981 199.62,-1026.34 241.27,-1015.12 331,-981 351.01,-973.39 347.18,-957.09 367,-949 488.95,-899.22 650.3,-913.86 721.76,-923.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="721.63,-927.47 732.03,-925.47 722.65,-920.55 721.63,-927.47"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="269.5,-234 176.5,-234 176.5,-210 269.5,-210 269.5,-234"/>
<text text-anchor="middle" x="223" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M41.09,-856.97C45.27,-774.1 71.46,-289.95 115,-243 128.04,-228.94 147.51,-222.72 166.29,-220.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.67,-223.81 176.3,-219.4 166.02,-216.84 166.67,-223.81"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-192 151,-192 151,-168 295,-168 295,-192"/>
<text text-anchor="middle" x="223" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M41,-857C44.65,-771.07 68.62,-251.39 115,-201 122.14,-193.24 131.24,-187.87 141.11,-184.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.26,-187.51 150.76,-181.19 140.17,-180.83 142.26,-187.51"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1229,-1390 1137,-1390 1137,-1366 1229,-1366 1229,-1390"/>
<text text-anchor="middle" x="1183" y="-1375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.86,-881.21C43.58,-969.8 62.33,-1511.71 115,-1559 177.03,-1614.69 782.66,-1552.03 865,-1539 971.48,-1522.16 1010.44,-1541.48 1101,-1483 1133.47,-1462.03 1158.19,-1423.42 1171.35,-1399.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1174.56,-1400.73 1176.13,-1390.26 1168.37,-1397.47 1174.56,-1400.73"/>
</g>
<!-- proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~check_nonzero_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/check_nonzero_pes_matrix_elements.html" xlink:title="check_nonzero_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-150 117.5,-150 117.5,-126 328.5,-126 328.5,-150"/>
<text text-anchor="middle" x="223" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.92,-856.82C44.11,-767.29 65.81,-212.79 115,-159 115.77,-158.16 116.56,-157.35 117.37,-156.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="119.63,-159.24 125.2,-150.22 115.23,-153.8 119.63,-159.24"/>
</g>
<!-- proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~save_s_matrix_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/save_s_matrix_file_header.html" xlink:title="save_s_matrix_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="299.5,-1466 146.5,-1466 146.5,-1442 299.5,-1442 299.5,-1466"/>
<text text-anchor="middle" x="223" y="-1451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_file_header</title>
<path fill="none" stroke="#ff0000" d="M40.33,-881.06C39.57,-954.75 39.22,-1343.74 115,-1428 121.08,-1434.76 128.6,-1439.91 136.81,-1443.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.76,-1447.16 146.34,-1447.7 138.41,-1440.68 135.76,-1447.16"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="800.5,-1112 718.5,-1112 718.5,-1088 800.5,-1088 800.5,-1112"/>
<text text-anchor="middle" x="759.5" y="-1097.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M40.17,-881.26C39.85,-920.34 44.72,-1042.55 115,-1097 206.67,-1168.02 572.81,-1125.83 708.01,-1107.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="708.67,-1110.78 718.09,-1105.94 707.71,-1103.85 708.67,-1110.78"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="311.5,-776 134.5,-776 134.5,-752 311.5,-752 311.5,-776"/>
<text text-anchor="middle" x="223" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M47.67,-856.72C59.27,-838.02 84.04,-802.71 115,-785 118.27,-783.13 121.69,-781.42 125.2,-779.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.69,-783.03 134.68,-776.08 124.1,-776.53 126.69,-783.03"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1063,-1826 939,-1826 939,-1802 1063,-1802 1063,-1826"/>
<text text-anchor="middle" x="1001" y="-1811.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.91,-881.22C44.19,-976.15 67.32,-1593.94 115,-1660 268.16,-1872.19 397.9,-1843.18 654,-1897 745.77,-1916.29 774.76,-1922.52 865,-1897 909.24,-1884.49 953.25,-1852.94 978.48,-1832.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="980.8,-1835.17 986.28,-1826.1 976.34,-1829.77 980.8,-1835.17"/>
</g>
<!-- proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~save_s_matrix_block_info</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/save_s_matrix_block_info.html" xlink:title="save_s_matrix_block_info">
<polygon fill="#d9534f" stroke="#d9534f" points="296.5,-108 149.5,-108 149.5,-84 296.5,-84 296.5,-108"/>
<text text-anchor="middle" x="223" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_block_info</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_block_info</title>
<path fill="none" stroke="#ff0000" d="M40.84,-857C43.55,-765.04 62.93,-174.27 115,-117 121.78,-109.54 130.37,-104.28 139.72,-100.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="140.89,-103.92 149.29,-97.47 138.7,-97.27 140.89,-103.92"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="250,-66 196,-66 196,-42 250,-42 250,-66"/>
<text text-anchor="middle" x="223" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.78,-856.94C43.05,-761.89 60.09,-135.71 115,-75 132.48,-55.68 162.09,-51.06 185.74,-50.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.72,-54.42 195.78,-51.12 185.86,-47.43 185.72,-54.42"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-1651 177.5,-1651 177.5,-1627 268.5,-1627 268.5,-1651"/>
<text text-anchor="middle" x="223" y="-1636.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M41.01,-881.01C44.95,-970.54 71.24,-1531.96 115,-1592 127.63,-1609.33 148.07,-1620.36 167.72,-1627.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.68,-1630.68 177.27,-1630.45 168.85,-1624.03 166.68,-1630.68"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295.5,-24 150.5,-24 150.5,0 295.5,0 295.5,-24"/>
<text text-anchor="middle" x="223" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.72,-856.93C42.57,-759.04 57.24,-97.17 115,-33 122.01,-25.22 130.98,-19.82 140.75,-16.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.84,-19.46 150.31,-13.11 139.72,-12.79 141.84,-19.46"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-818 177.5,-818 177.5,-794 268.5,-794 268.5,-818"/>
<text text-anchor="middle" x="223" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M58.08,-856.94C72.71,-847.46 94.38,-834.61 115,-827 131.63,-820.86 150.4,-816.41 167.53,-813.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.16,-816.67 177.4,-811.49 166.95,-809.77 168.16,-816.67"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-1062 167,-1062 167,-1038 279,-1038 279,-1062"/>
<text text-anchor="middle" x="223" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M42.7,-881.28C48.65,-910.74 67.89,-985.86 115,-1024 127.01,-1033.72 142.09,-1039.89 157.12,-1043.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.42,-1047.22 166.95,-1046.04 157.98,-1040.4 156.42,-1047.22"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="533,-1512 452,-1512 452,-1488 533,-1488 533,-1512"/>
<text text-anchor="middle" x="492.5" y="-1497.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M303.17,-1497.18C348.15,-1497.86 403.05,-1498.68 441.95,-1499.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="441.93,-1502.76 451.98,-1499.41 442.03,-1495.76 441.93,-1502.76"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff2400" d="M556.25,-694.13C585.84,-699.13 621.66,-704.83 654,-709 752.97,-721.76 1029.29,-682.6 1101,-752 1145.45,-795.02 1174.5,-1249.06 1180.74,-1355.68"/>
<polygon fill="#ff2400" stroke="#ff2400" points="1177.26,-1356.13 1181.33,-1365.91 1184.25,-1355.73 1177.26,-1356.13"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1036,-1116 966,-1116 966,-1092 1036,-1092 1036,-1116"/>
<text text-anchor="middle" x="1001" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff4800" d="M819.4,-1067.05C861.61,-1075.69 917.56,-1087.13 955.93,-1094.98"/>
<polygon fill="#ff4800" stroke="#ff4800" points="955.28,-1098.42 965.78,-1097 956.68,-1091.57 955.28,-1098.42"/>
</g>
<!-- proc~print_short_block_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~print_short_block_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff6d00" d="M839.1,-2101.62C917.05,-2108.28 1034.22,-2104.33 1101,-2035 1146.14,-1988.13 1174.81,-1509.96 1180.82,-1400.32"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1184.33,-1400.27 1181.37,-1390.1 1177.34,-1399.89 1184.33,-1400.27"/>
</g>
<!-- proc~print_short_block_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~print_short_block_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff6d00" d="M839.03,-2084.9C848.71,-2081.36 857.74,-2076.26 865,-2069 922.39,-2011.62 858.08,-1958.87 901,-1890 916.91,-1864.46 944.69,-1844.27 966.78,-1831.13"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="968.61,-1834.12 975.54,-1826.11 965.13,-1828.05 968.61,-1834.12"/>
</g>
<!-- proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ffb600" d="M302.45,-654.02C339.23,-659.66 382.78,-666.34 418.81,-671.86"/>
<polygon fill="#ffb600" stroke="#ffb600" points="418.34,-675.33 428.75,-673.38 419.4,-668.41 418.34,-675.33"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ffda00" d="M292.19,-921.29C340.24,-913.75 403.29,-903.85 445.48,-897.23"/>
<polygon fill="#ffda00" stroke="#ffda00" points="446.14,-900.66 455.48,-895.66 445.05,-893.75 446.14,-900.66"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="519.5,-818 465.5,-818 465.5,-794 519.5,-794 519.5,-818"/>
<text text-anchor="middle" x="492.5" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ffda00" d="M292.27,-928.74C306.2,-925.42 319.96,-919.93 331,-911 362.59,-885.46 335.08,-852.11 367,-827 391.79,-807.5 428.05,-803.29 455.05,-803.34"/>
<polygon fill="#ffda00" stroke="#ffda00" points="455.19,-806.84 465.26,-803.56 455.34,-799.84 455.19,-806.84"/>
</g>
<!-- proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~wavenumber_squared_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/wavenumber_squared_from_energy.html" xlink:title="wavenumber_squared_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="594,-860 391,-860 391,-836 594,-836 594,-860"/>
<text text-anchor="middle" x="492.5" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_squared_from_energy</text>
</a>
</g>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ffda00" d="M292.12,-925.69C305.61,-922.53 319.23,-917.87 331,-911 352.24,-898.61 345.6,-881.1 367,-869 371.53,-866.44 376.3,-864.17 381.22,-862.16"/>
<polygon fill="#ffda00" stroke="#ffda00" points="382.66,-865.36 390.83,-858.62 380.24,-858.79 382.66,-865.36"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffff00" d="M865.14,-2058.41C941.41,-2059.78 1041.45,-2047.62 1101,-1985 1183.01,-1898.76 1183.53,-1499.15 1182.37,-1400.21"/>
<polygon fill="#ffff00" stroke="#ffff00" points="1185.87,-1400.09 1182.23,-1390.14 1178.87,-1400.19 1185.87,-1400.09"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ffff00" d="M853.03,-2035.88C857.33,-2033.37 861.36,-2030.43 865,-2027 910.8,-1983.81 866.16,-1942.43 901,-1890 917.76,-1864.78 945.72,-1844.45 967.66,-1831.18"/>
<polygon fill="#ffff00" stroke="#ffff00" points="969.48,-1834.18 976.34,-1826.11 965.94,-1828.13 969.48,-1834.18"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="565,-633 420,-633 420,-609 565,-609 565,-633"/>
<text text-anchor="middle" x="492.5" y="-618.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#b6ff00" d="M279.1,-604.33C316.77,-607.28 367.33,-611.25 409.68,-614.58"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="409.45,-618.07 419.7,-615.36 410,-611.09 409.45,-618.07"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="556,-591 429,-591 429,-567 556,-567 556,-591"/>
<text text-anchor="middle" x="492.5" y="-576.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#b6ff00" d="M279.1,-595.67C319.54,-592.5 374.86,-588.16 418.9,-584.7"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="419.28,-588.18 428.97,-583.91 418.73,-581.2 419.28,-588.18"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-738 465.5,-738 465.5,-714 519.5,-714 519.5,-738"/>
<text text-anchor="middle" x="492.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#b6ff00" d="M279.17,-600.79C297.28,-603.51 316.47,-609.31 331,-621 362.32,-646.21 335.44,-679.09 367,-704 391.79,-723.57 428.05,-728.09 455.05,-728.3"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="455.31,-731.79 465.26,-728.18 455.22,-724.79 455.31,-731.79"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#91ff00" d="M302.61,-1543.94C460.91,-1552.78 826.42,-1557.3 1101,-1439 1124.4,-1428.92 1147.24,-1410.73 1162.67,-1396.83"/>
<polygon fill="#91ff00" stroke="#91ff00" points="1165.07,-1399.38 1170.02,-1390.02 1160.31,-1394.25 1165.07,-1399.38"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#91ff00" d="M302.81,-1526.8C347.8,-1520.41 402.82,-1512.6 441.82,-1507.06"/>
<polygon fill="#91ff00" stroke="#91ff00" points="442.46,-1510.5 451.87,-1505.63 441.47,-1503.57 442.46,-1510.5"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#6dff00" d="M270.18,-1285.47C298.1,-1280.75 334.47,-1275.38 367,-1273 694.19,-1249.1 782.42,-1272.72 1101,-1351 1113.84,-1354.15 1127.56,-1358.39 1139.99,-1362.56"/>
<polygon fill="#6dff00" stroke="#6dff00" points="1139.05,-1365.94 1149.64,-1365.88 1141.32,-1359.32 1139.05,-1365.94"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="589,-1348 396,-1348 396,-1324 589,-1324 589,-1348"/>
<text text-anchor="middle" x="492.5" y="-1333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#6dff00" d="M270.29,-1301.27C307.27,-1307.07 360.13,-1315.37 404.91,-1322.4"/>
<polygon fill="#6dff00" stroke="#6dff00" points="404.5,-1325.88 414.92,-1323.98 405.58,-1318.97 404.5,-1325.88"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="588.5,-1390 396.5,-1390 396.5,-1366 588.5,-1366 588.5,-1390"/>
<text text-anchor="middle" x="492.5" y="-1375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#6dff00" d="M246.61,-1306.07C274.26,-1320.33 322.82,-1343.77 367,-1357 375.56,-1359.56 384.55,-1361.84 393.61,-1363.86"/>
<polygon fill="#6dff00" stroke="#6dff00" points="392.95,-1367.3 403.46,-1365.96 394.41,-1360.46 392.95,-1367.3"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="618,-1306 367,-1306 367,-1282 618,-1282 618,-1306"/>
<text text-anchor="middle" x="492.5" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#6dff00" d="M270.29,-1294C294.51,-1294 325.54,-1294 356.66,-1294"/>
<polygon fill="#6dff00" stroke="#6dff00" points="356.75,-1297.5 366.75,-1294 356.75,-1290.5 356.75,-1297.5"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-1470 732.5,-1470 732.5,-1446 786.5,-1446 786.5,-1470"/>
<text text-anchor="middle" x="759.5" y="-1455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline</title>
<path fill="none" stroke="#00ff24" d="M589.55,-1458C635.52,-1458 687.85,-1458 721.93,-1458"/>
<polygon fill="#00ff24" stroke="#00ff24" points="722.32,-1461.5 732.32,-1458 722.32,-1454.5 722.32,-1461.5"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ff6d" d="M311.66,-877.94C318.41,-875.48 324.95,-872.53 331,-869 352.24,-856.61 345.6,-839.1 367,-827 394,-811.73 429.19,-806.93 455.27,-805.68"/>
<polygon fill="#00ff6d" stroke="#00ff6d" points="455.6,-809.17 465.48,-805.35 455.37,-802.18 455.6,-809.17"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#00ff6d" d="M300.65,-877.96C333.11,-872.87 371.1,-866.9 404.59,-861.65"/>
<polygon fill="#00ff6d" stroke="#00ff6d" points="405.5,-865.05 414.83,-860.04 404.41,-858.13 405.5,-865.05"/>
</g>
<!-- proc~numerov&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~numerov&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#00ff91" d="M253.14,-717.75C292.59,-712 364.33,-701.54 418.84,-693.59"/>
<polygon fill="#00ff91" stroke="#00ff91" points="419.41,-697.05 428.8,-692.14 418.4,-690.12 419.41,-697.05"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ffb6" d="M542.1,-1159.93C568.18,-1151.07 598.8,-1136.39 618,-1113 659.59,-1062.35 610.49,-1019.02 654,-970 671.45,-950.35 699.63,-940.29 722.34,-935.18"/>
<polygon fill="#00ffb6" stroke="#00ffb6" points="723.22,-938.58 732.33,-933.17 721.84,-931.72 723.22,-938.58"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffb6" d="M574.67,-1173.04C720.05,-1176.35 1017.46,-1190.22 1101,-1248 1139.57,-1274.67 1163.44,-1326.29 1174.56,-1355.82"/>
<polygon fill="#00ffb6" stroke="#00ffb6" points="1171.4,-1357.39 1178.08,-1365.62 1177.99,-1355.02 1171.4,-1357.39"/>
</g>
<!-- proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffda" d="M1026.6,-1898.98C1049.68,-1886.35 1083.23,-1864.26 1101,-1835 1146.54,-1760.01 1173.21,-1481.93 1180.17,-1400.53"/>
<polygon fill="#00ffda" stroke="#00ffda" points="1183.67,-1400.64 1181.02,-1390.39 1176.69,-1400.06 1183.67,-1400.64"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00b6ff" d="M845.55,-2012.52C923.53,-2013.45 1036.4,-2001.21 1101,-1932 1174.62,-1853.14 1181.47,-1494.51 1181.99,-1400.58"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="1185.49,-1400.48 1182.03,-1390.47 1178.49,-1400.46 1185.49,-1400.48"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00b6ff" d="M786.59,-1993.89C809.07,-1982.61 841.5,-1964.22 865,-1942 885.43,-1922.69 881.62,-1910.36 901,-1890 922.57,-1867.34 951.3,-1846.07 972.25,-1831.82"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="974.34,-1834.64 980.71,-1826.17 970.45,-1828.82 974.34,-1834.64"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#0091ff" d="M294.63,-836.91C346.32,-828.79 414.33,-818.12 455.38,-811.67"/>
<polygon fill="#0091ff" stroke="#0091ff" points="456.13,-815.1 465.46,-810.09 455.04,-808.18 456.13,-815.1"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="577,-150 408,-150 408,-126 577,-126 577,-150"/>
<text text-anchor="middle" x="492.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#6d00ff" d="M328.57,-138C351.32,-138 375.25,-138 397.55,-138"/>
<polygon fill="#6d00ff" stroke="#6d00ff" points="397.68,-141.5 407.68,-138 397.68,-134.5 397.68,-141.5"/>
</g>
<!-- proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#9100ff" d="M292.36,-1466.04C316,-1470.18 342.66,-1474.82 367,-1479 391.64,-1483.23 419.03,-1487.86 441.83,-1491.69"/>
<polygon fill="#9100ff" stroke="#9100ff" points="441.52,-1495.19 451.96,-1493.39 442.68,-1488.28 441.52,-1495.19"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#b600ff" d="M800.55,-1091.78C880.23,-1076.41 1054.93,-1047.88 1101,-1083 1145.23,-1116.72 1171.3,-1292.69 1179.32,-1355.61"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1175.87,-1356.17 1180.57,-1365.66 1182.81,-1355.31 1175.87,-1356.17"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#b600ff" d="M800.59,-1100.67C843.49,-1101.39 911.36,-1102.52 955.78,-1103.26"/>
<polygon fill="#b600ff" stroke="#b600ff" points="955.93,-1106.76 965.99,-1103.43 956.05,-1099.77 955.93,-1106.76"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1048,-1705 954,-1705 954,-1681 1048,-1681 1048,-1705"/>
<text text-anchor="middle" x="1001" y="-1690.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#b600ff" d="M800.74,-1097.41C822.86,-1098.3 848.98,-1103.55 865,-1121 913.09,-1173.39 883.94,-1369.96 901,-1439 923.12,-1528.54 968.93,-1628.95 989.55,-1671.79"/>
<polygon fill="#b600ff" stroke="#b600ff" points="986.48,-1673.48 993.99,-1680.95 992.77,-1670.42 986.48,-1673.48"/>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#da00ff" d="M300.65,-776.04C351.53,-784.02 415.98,-794.14 455.45,-800.34"/>
<polygon fill="#da00ff" stroke="#da00ff" points="454.98,-803.81 465.41,-801.9 456.07,-796.89 454.98,-803.81"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0091" d="M251.4,-1626.99C276.94,-1614.18 313.63,-1591.27 331,-1559 395.37,-1439.43 291.05,-1061.56 367,-949 384.87,-922.51 418,-907.6 445.59,-899.4"/>
<polygon fill="#ff0091" stroke="#ff0091" points="446.76,-902.71 455.46,-896.67 444.89,-895.96 446.76,-902.71"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-1672 455.5,-1672 455.5,-1648 529.5,-1648 529.5,-1672"/>
<text text-anchor="middle" x="492.5" y="-1657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#ff0091" d="M268.77,-1642.51C317.65,-1646.35 395.54,-1652.47 445.06,-1656.35"/>
<polygon fill="#ff0091" stroke="#ff0091" points="444.94,-1659.86 455.18,-1657.15 445.48,-1652.88 444.94,-1659.86"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0091" d="M247.27,-1626.91C295.09,-1602.06 404.51,-1545.2 459.18,-1516.8"/>
<polygon fill="#ff0091" stroke="#ff0091" points="460.83,-1519.88 468.09,-1512.16 457.61,-1513.67 460.83,-1519.88"/>
</g>
<!-- proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~check_namelist_basis</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/check_namelist_basis.html" xlink:title="check_namelist_basis">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1706 696,-1706 696,-1682 823,-1682 823,-1706"/>
<text text-anchor="middle" x="759.5" y="-1691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_basis</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_basis</title>
<path fill="none" stroke="#ff0091" d="M244.92,-1651.13C272.03,-1666.08 321.25,-1690.65 367,-1700 476.15,-1722.31 606,-1713.59 685.32,-1704.43"/>
<polygon fill="#ff0091" stroke="#ff0091" points="686.17,-1707.86 695.69,-1703.2 685.34,-1700.91 686.17,-1707.86"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1630 445,-1630 445,-1606 540,-1606 540,-1630"/>
<text text-anchor="middle" x="492.5" y="-1615.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#ff0091" d="M268.77,-1635.49C314.32,-1631.91 385.05,-1626.36 434.56,-1622.47"/>
<polygon fill="#ff0091" stroke="#ff0091" points="435.09,-1625.94 444.78,-1621.67 434.54,-1618.96 435.09,-1625.94"/>
</g>
<!-- proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~check_namelist_input</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/check_namelist_input.html" xlink:title="check_namelist_input">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1664 696,-1664 696,-1640 823,-1640 823,-1664"/>
<text text-anchor="middle" x="759.5" y="-1649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_input</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_input</title>
<path fill="none" stroke="#ff0091" d="M255.51,-1651.09C284.11,-1661.37 327.69,-1675.35 367,-1681 477.42,-1696.88 507.11,-1693.17 618,-1681 634.29,-1679.21 637.96,-1676.39 654,-1673 664.92,-1670.69 676.5,-1668.3 687.82,-1666"/>
<polygon fill="#ff0091" stroke="#ff0091" points="688.57,-1669.42 697.67,-1664.01 687.18,-1662.56 688.57,-1669.42"/>
</g>
<!-- proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~check_namelist_potential</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/check_namelist_potential.html" xlink:title="check_namelist_potential">
<polygon fill="#d9534f" stroke="#d9534f" points="833.5,-1748 685.5,-1748 685.5,-1724 833.5,-1724 833.5,-1748"/>
<text text-anchor="middle" x="759.5" y="-1733.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_potential</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_potential</title>
<path fill="none" stroke="#ff0091" d="M239.15,-1651.05C264.09,-1670.08 316.11,-1706.4 367,-1721 470.14,-1750.6 594.83,-1749.41 675.34,-1744.15"/>
<polygon fill="#ff0091" stroke="#ff0091" points="675.69,-1747.63 685.43,-1743.45 675.21,-1740.65 675.69,-1747.63"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0048" d="M268.53,-796.62C418.43,-767.97 906.19,-699.18 1101,-970 1146.43,-1033.15 1172.76,-1278.97 1179.97,-1355.28"/>
<polygon fill="#ff0048" stroke="#ff0048" points="1176.52,-1356 1180.92,-1365.64 1183.49,-1355.36 1176.52,-1356"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff0048" d="M268.77,-806C321.15,-806 406.85,-806 455.25,-806"/>
<polygon fill="#ff0048" stroke="#ff0048" points="455.27,-809.5 465.27,-806 455.27,-802.5 455.27,-809.5"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ff0048" d="M268.77,-813.03C305.76,-818.84 359.37,-827.25 404.72,-834.37"/>
<polygon fill="#ff0048" stroke="#ff0048" points="404.43,-837.87 414.85,-835.97 405.52,-830.96 404.43,-837.87"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-982 422.5,-982 422.5,-958 562.5,-958 562.5,-982"/>
<text text-anchor="middle" x="492.5" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#ff0024" d="M279.27,-1042.11C296.51,-1038.21 315.15,-1032.46 331,-1024 350.15,-1013.78 347.5,-1000.53 367,-991 380.97,-984.17 396.77,-979.51 412.3,-976.35"/>
<polygon fill="#ff0024" stroke="#ff0024" points="413.24,-979.74 422.44,-974.48 411.97,-972.85 413.24,-979.74"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff0024" d="M242.81,-1037.92C266.81,-1021.55 307.96,-990.05 331,-953 361.76,-903.54 323.59,-865.83 367,-827 390.83,-805.68 427.92,-801.84 455.43,-802.48"/>
<polygon fill="#ff0024" stroke="#ff0024" points="455.31,-805.98 465.45,-802.92 455.62,-798.98 455.31,-805.98"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="539,-1104 446,-1104 446,-1080 539,-1080 539,-1104"/>
<text text-anchor="middle" x="492.5" y="-1089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#ff0024" d="M279.1,-1058.65C324.89,-1065.84 389.74,-1076.02 435.72,-1083.24"/>
<polygon fill="#ff0024" stroke="#ff0024" points="435.38,-1086.73 445.81,-1084.83 436.47,-1079.82 435.38,-1086.73"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-1024 465.5,-1024 465.5,-1000 519.5,-1000 519.5,-1024"/>
<text text-anchor="middle" x="492.5" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#ff0024" d="M279.1,-1042.17C331.89,-1034.67 410.01,-1023.58 455.34,-1017.14"/>
<polygon fill="#ff0024" stroke="#ff0024" points="455.9,-1020.59 465.3,-1015.72 454.91,-1013.66 455.9,-1020.59"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff0024" d="M243.62,-1037.87C268.09,-1021.67 309.34,-990.58 331,-953 369.12,-886.84 319.6,-844.87 367,-785 388.95,-757.27 427.07,-741.9 455.36,-733.85"/>
<polygon fill="#ff0024" stroke="#ff0024" points="456.53,-737.16 465.29,-731.21 454.73,-730.4 456.53,-737.16"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ff0024" d="M241.7,-1037.74C264.87,-1020.93 305.52,-988.72 331,-953 354.59,-919.93 335.08,-894.11 367,-869 371.47,-865.49 376.31,-862.47 381.4,-859.88"/>
<polygon fill="#ff0024" stroke="#ff0024" points="383.11,-862.95 390.81,-855.68 380.26,-856.56 383.11,-862.95"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="540.5,-1226 444.5,-1226 444.5,-1202 540.5,-1202 540.5,-1226"/>
<text text-anchor="middle" x="492.5" y="-1211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#ff0024" d="M231.99,-1062.06C251.37,-1090.25 303.97,-1160.49 367,-1193 387.52,-1203.58 412.22,-1209.01 434.2,-1211.74"/>
<polygon fill="#ff0024" stroke="#ff0024" points="434.09,-1215.25 444.41,-1212.84 434.84,-1208.29 434.09,-1215.25"/>
</g>
<!-- proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~modified_bessel_temme_algorithm</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/modified_bessel_temme_algorithm.html" xlink:title="modified_bessel_temme_algorithm">
<polygon fill="#d9534f" stroke="#d9534f" points="859,-1003 660,-1003 660,-979 859,-979 859,-1003"/>
<text text-anchor="middle" x="759.5" y="-988.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_temme_algorithm</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm</title>
<path fill="none" stroke="#ff0000" d="M562.78,-975.49C589.32,-977.59 620.29,-980.05 649.65,-982.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="649.72,-985.89 659.96,-983.19 650.27,-978.91 649.72,-985.89"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff8b00" d="M519.75,-806.92C545.64,-808.62 585.9,-813.43 618,-827 666.01,-847.29 713.06,-886.95 738.68,-910.69"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="736.54,-913.49 746.22,-917.8 741.34,-908.39 736.54,-913.49"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#a2ff00" d="M569.64,-1365.98C596.25,-1362.32 626.38,-1358.8 654,-1357 826.24,-1345.78 1030.5,-1362.39 1126.68,-1371.99"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="1126.46,-1375.49 1136.76,-1373.01 1127.16,-1368.52 1126.46,-1375.49"/>
</g>
<!-- proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~print_sum_of_squares</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/print_sum_of_squares.html" xlink:title="print_sum_of_squares">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1390 696,-1390 696,-1366 823,-1366 823,-1390"/>
<text text-anchor="middle" x="759.5" y="-1375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_sum_of_squares</text>
</a>
</g>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares</title>
<path fill="none" stroke="#a2ff00" d="M588.8,-1378C620.65,-1378 655.63,-1378 685.51,-1378"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="685.86,-1381.5 695.86,-1378 685.86,-1374.5 685.86,-1381.5"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="803,-1154 716,-1154 716,-1130 803,-1130 803,-1154"/>
<text text-anchor="middle" x="759.5" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#a2ff00" d="M588.56,-1374.25C599.45,-1370.43 609.62,-1364.89 618,-1357 669.79,-1308.21 611.4,-1258 654,-1201 668.55,-1181.54 691.53,-1167.56 712.24,-1158.11"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="713.77,-1161.27 721.56,-1154.09 710.99,-1154.84 713.77,-1161.27"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#5cff00" d="M518.47,-1512.03C547.51,-1527.42 594.45,-1556.97 618,-1597 670.69,-1686.56 575.07,-1760.42 654,-1828 693.79,-1862.07 839.77,-1843.26 928.91,-1827.78"/>
<polygon fill="#5cff00" stroke="#5cff00" points="929.71,-1831.2 938.95,-1826.01 928.49,-1824.3 929.71,-1831.2"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#5cff00" d="M533.17,-1503.52C560.21,-1503.7 595.12,-1499.29 618,-1479 660.3,-1441.49 618.4,-1400.92 654,-1357 721.12,-1274.2 780,-1307.31 865,-1243 913.1,-1206.61 960.05,-1153.01 983.86,-1124.16"/>
<polygon fill="#5cff00" stroke="#5cff00" points="986.6,-1126.33 990.21,-1116.37 981.18,-1121.91 986.6,-1126.33"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#17ff00" d="M539.16,-1101.33C566.8,-1109.52 600.07,-1124.44 618,-1151 693.48,-1262.81 563.29,-1657.15 654,-1757 685.91,-1792.13 818.19,-1782.18 865,-1790 885.78,-1793.47 908.33,-1797.41 928.94,-1801.08"/>
<polygon fill="#17ff00" stroke="#17ff00" points="928.43,-1804.55 938.89,-1802.86 929.66,-1797.65 928.43,-1804.55"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#17ff00" d="M539.06,-1100.6C585.34,-1109.33 656.96,-1122.84 705.69,-1132.04"/>
<polygon fill="#17ff00" stroke="#17ff00" points="705.25,-1135.52 715.73,-1133.93 706.55,-1128.64 705.25,-1135.52"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-700 732.5,-700 732.5,-676 786.5,-676 786.5,-700"/>
<text text-anchor="middle" x="759.5" y="-685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#17ff00" d="M539.03,-1080.6C565.56,-1071.75 597.69,-1056.86 618,-1033 655.21,-989.31 633.67,-962.66 654,-909 682.57,-833.58 726.3,-748.36 746.95,-709.45"/>
<polygon fill="#17ff00" stroke="#17ff00" points="750.28,-710.63 751.9,-700.16 744.11,-707.34 750.28,-710.63"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff2e" d="M1036.22,-1104.96C1057.36,-1107.31 1083.67,-1113.66 1101,-1130 1166.58,-1191.83 1179.15,-1307.39 1181.5,-1355.79"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1178,-1355.96 1181.88,-1365.82 1184.99,-1355.69 1178,-1355.96"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffb9" d="M768.69,-1470.26C787.14,-1498.12 832.82,-1568.63 865,-1631 883.44,-1666.73 878.47,-1680.7 901,-1714 922.61,-1745.94 955.2,-1776.51 977.02,-1795.25"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="974.92,-1798.06 984.81,-1801.84 979.44,-1792.71 974.92,-1798.06"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ffb9" d="M786.71,-1448.62C809.89,-1439.18 843.29,-1422.63 865,-1399 942.19,-1314.97 981.75,-1179.19 994.9,-1126.19"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="998.37,-1126.73 997.31,-1116.19 991.57,-1125.09 998.37,-1126.73"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~check_namelist_basis&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffff" d="M823.2,-1702.01C837.32,-1705.06 851.96,-1709.25 865,-1715 910.35,-1735.01 955.19,-1772.29 980.07,-1794.96"/>
<polygon fill="#00ffff" stroke="#00ffff" points="977.71,-1797.54 987.43,-1801.76 982.46,-1792.4 977.71,-1797.54"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~check_namelist_basis&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ffff" d="M823.11,-1693.74C860.33,-1693.58 907.15,-1693.39 943.28,-1693.24"/>
<polygon fill="#00ffff" stroke="#00ffff" points="943.66,-1696.74 953.64,-1693.19 943.63,-1689.74 943.66,-1696.74"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#0073ff" d="M528.11,-1605.92C594.15,-1582.67 742.45,-1529.55 865,-1479 899.45,-1464.79 938.16,-1447.12 965.26,-1434.46"/>
<polygon fill="#0073ff" stroke="#0073ff" points="966.77,-1437.62 974.34,-1430.21 963.8,-1431.28 966.77,-1437.62"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#0073ff" d="M519.88,-1605.91C549.57,-1590.74 596.45,-1561.68 618,-1521 675.43,-1412.56 581.19,-1068.77 654,-970 669.86,-948.48 698.88,-938.54 722.31,-933.94"/>
<polygon fill="#0073ff" stroke="#0073ff" points="723.02,-937.37 732.29,-932.24 721.84,-930.47 723.02,-937.37"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0073ff" d="M540.46,-1618.58C675.16,-1619.86 1056.02,-1620.52 1101,-1588 1162.89,-1543.25 1177.49,-1444.44 1180.94,-1400.19"/>
<polygon fill="#0073ff" stroke="#0073ff" points="1184.43,-1400.38 1181.59,-1390.18 1177.45,-1399.93 1184.43,-1400.38"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0073ff" d="M540.02,-1613.54C566.4,-1613.69 598.03,-1618.83 618,-1639 689.88,-1711.58 576.32,-1799.67 654,-1866 746.68,-1945.14 906.61,-1868.29 971.45,-1831.35"/>
<polygon fill="#0073ff" stroke="#0073ff" points="973.42,-1834.26 980.31,-1826.21 969.9,-1828.2 973.42,-1834.26"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#1700ff" d="M581.19,-860.03C593.65,-862.54 606.23,-865.51 618,-869 628.63,-872.15 685.1,-897.11 723.13,-914.11"/>
<polygon fill="#1700ff" stroke="#1700ff" points="721.8,-917.35 732.36,-918.24 724.66,-910.96 721.8,-917.35"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#1700ff" d="M594.04,-838.26C676.05,-835.91 790.18,-846.15 865,-909 902.13,-940.19 874.46,-971.41 901,-1012 920.61,-1041.99 952.06,-1068.94 974.24,-1085.81"/>
<polygon fill="#1700ff" stroke="#1700ff" points="972.42,-1088.81 982.53,-1091.97 976.6,-1083.2 972.42,-1088.81"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="832,-129 687,-129 687,-105 832,-105 832,-129"/>
<text text-anchor="middle" x="759.5" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#a200ff" d="M577.35,-131.36C609.09,-128.84 645.16,-125.98 676.71,-123.48"/>
<polygon fill="#a200ff" stroke="#a200ff" points="677.09,-126.96 686.79,-122.68 676.54,-119.98 677.09,-126.96"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="799.5,-171 719.5,-171 719.5,-147 799.5,-147 799.5,-171"/>
<text text-anchor="middle" x="759.5" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#a200ff" d="M577.35,-144.64C620.73,-148.08 672.19,-152.16 709.16,-155.09"/>
<polygon fill="#a200ff" stroke="#a200ff" points="708.94,-158.58 719.18,-155.88 709.49,-151.61 708.94,-158.58"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00d0" d="M540.62,-1223.86C567.9,-1232.16 600.27,-1247.02 618,-1273 682.92,-1368.12 572.55,-1708.58 654,-1790 691.21,-1827.2 838.87,-1824.79 928.83,-1819.52"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="929.2,-1823.01 938.97,-1818.9 928.77,-1816.02 929.2,-1823.01"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff00d0" d="M540.63,-1208.11C564.1,-1204.65 592.78,-1199.65 618,-1193 653.47,-1183.65 692.6,-1169.08 720.53,-1157.9"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="721.97,-1161.1 729.93,-1154.11 719.34,-1154.61 721.97,-1161.1"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-1234 732.5,-1234 732.5,-1210 786.5,-1210 786.5,-1234"/>
<text text-anchor="middle" x="759.5" y="-1219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#ff00d0" d="M540.57,-1215.42C592.56,-1216.99 675.14,-1219.48 722.31,-1220.91"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="722.28,-1224.41 732.38,-1221.21 722.49,-1217.41 722.28,-1224.41"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff008b" d="M823.06,-1655.25C909.42,-1658.42 1059.27,-1658.77 1101,-1626 1172.22,-1570.08 1181.6,-1450.24 1182.3,-1400.43"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1185.8,-1400.14 1182.32,-1390.13 1178.8,-1400.12 1185.8,-1400.14"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff008b" d="M823.14,-1657.74C837.55,-1660.88 852.34,-1665.68 865,-1673 885.99,-1685.14 884.46,-1696.26 901,-1714 927.77,-1742.71 959.93,-1774.77 980.18,-1794.67"/>
<polygon fill="#ff008b" stroke="#ff008b" points="977.98,-1797.41 987.57,-1801.91 982.88,-1792.42 977.98,-1797.41"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff008b" d="M768.98,-1639.88C788.02,-1612.31 834.82,-1542.36 865,-1479 926.62,-1349.62 976.9,-1184.14 993.85,-1125.65"/>
<polygon fill="#ff008b" stroke="#ff008b" points="997.22,-1126.59 996.63,-1116.01 990.5,-1124.65 997.22,-1126.59"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~check_namelist_input&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff008b" d="M823.11,-1662.72C860.49,-1669.12 907.56,-1677.17 943.74,-1683.37"/>
<polygon fill="#ff008b" stroke="#ff008b" points="943.2,-1686.83 953.64,-1685.06 944.38,-1679.93 943.2,-1686.83"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~check_namelist_potential&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0045" d="M814.29,-1748.03C830.69,-1752.06 848.69,-1756.85 865,-1762 898.38,-1772.54 935.43,-1787.02 962.26,-1798.02"/>
<polygon fill="#ff0045" stroke="#ff0045" points="961.08,-1801.32 971.66,-1801.9 963.75,-1794.85 961.08,-1801.32"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~check_namelist_potential&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff0045" d="M827.53,-1723.96C864.18,-1717.38 909.07,-1709.33 943.86,-1703.08"/>
<polygon fill="#ff0045" stroke="#ff0045" points="944.63,-1706.5 953.85,-1701.29 943.39,-1699.61 944.63,-1706.5"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M823.11,-1388.46C857.93,-1394.27 901.16,-1401.49 936.17,-1407.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="935.84,-1410.83 946.28,-1409.03 937,-1403.93 935.84,-1410.83"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M823.15,-1378C905.34,-1378 1048.31,-1378 1126.69,-1378"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1126.84,-1381.5 1136.84,-1378 1126.84,-1374.5 1126.84,-1381.5"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M799.48,-1390.07C822.33,-1399.22 849.63,-1414.19 865,-1437 934.38,-1539.95 846.46,-1602.47 901,-1714 917.73,-1748.21 950.78,-1777.83 974.08,-1795.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="972.08,-1798.64 982.18,-1801.84 976.28,-1793.04 972.08,-1798.64"/>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ffda00" d="M791.9,-1003.09C812.82,-1011.34 840.8,-1022.77 865,-1034 901.21,-1050.8 941.73,-1072.17 968.84,-1086.85"/>
<polygon fill="#ffda00" stroke="#ffda00" points="967.39,-1090.04 977.85,-1091.75 970.73,-1083.89 967.39,-1090.04"/>
</g>
<!-- proc~rgamma -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>proc~rgamma</title>
<g id="a_program~~scattering~~CallsGraph_node73"><a xlink:href=".././proc/rgamma.html" xlink:title="rgamma">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1030,-1003 972,-1003 972,-979 1030,-979 1030,-1003"/>
<text text-anchor="middle" x="1001" y="-988.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rgamma</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma</title>
<path fill="none" stroke="#ffda00" d="M859.3,-991C895.4,-991 934.13,-991 961.8,-991"/>
<polygon fill="#ffda00" stroke="#ffda00" points="961.83,-994.5 971.83,-991 961.83,-987.5 961.83,-994.5"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#48ff00" d="M803.25,-1139.77C883.99,-1136.43 1054.97,-1133.77 1101,-1168 1162.15,-1213.48 1177.14,-1311.54 1180.81,-1355.67"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1177.34,-1356.17 1181.54,-1365.9 1184.32,-1355.68 1177.34,-1356.17"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-700 974,-700 974,-676 1028,-676 1028,-700"/>
<text text-anchor="middle" x="1001" y="-685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#00ff91" d="M786.59,-688C829.51,-688 915.11,-688 963.84,-688"/>
<polygon fill="#00ff91" stroke="#00ff91" points="963.95,-691.5 973.95,-688 963.95,-684.5 963.95,-691.5"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node75" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node75"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-658 974,-658 974,-634 1028,-634 1028,-658"/>
<text text-anchor="middle" x="1001" y="-643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#00ff91" d="M786.59,-683.43C829.51,-675.9 915.11,-660.89 963.84,-652.34"/>
<polygon fill="#00ff91" stroke="#00ff91" points="964.7,-655.74 973.95,-650.57 963.49,-648.85 964.7,-655.74"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node76" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node76"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1210,-679 1156,-679 1156,-655 1210,-655 1210,-679"/>
<text text-anchor="middle" x="1183" y="-664.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ff00" d="M1028.17,-684.95C1059.1,-681.34 1110.75,-675.31 1145.57,-671.25"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1146.27,-674.69 1155.79,-670.06 1145.46,-667.74 1146.27,-674.69"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#0000ff" d="M1028.17,-649.05C1059.1,-652.66 1110.75,-658.69 1145.57,-662.75"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1145.46,-666.26 1155.79,-663.94 1146.27,-659.31 1145.46,-666.26"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-count_blocks">count_blocks</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~3">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_indices~12"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~8"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholddiag</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholdoff"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholdoff</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-count_blocks"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>count_blocks</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_algebraic_coefficients~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_algebraic_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~2"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_algebraic_coefficients~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_algebraic_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_pes_matrix_elements~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_pes_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">data_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_short_block_summary</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">pes_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">prepare_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="n">print_pes_matrix_elements_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">propagator_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">numerov</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">save_s_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">save_s_matrix_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_s_matrix_block_info</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">check_cross_section_thresholds</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">save_partial_xs_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_partial_xs_single_block</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">save_s_matrix_file_header</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">save_partial_xs_file_header</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize arrays that save the state-to-state cross-sections</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;jtot_loop&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_blocks</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">print_short_block_summary</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">count_blocks</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the PES matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_pes_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">save_s_matrix_block_info</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w"> </span><span class="n">wv</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">s_matrix_real</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">save_partial_xs_single_block</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if elastic_xs_threshold/inelastic_xs_threshold condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-10 11:20            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>