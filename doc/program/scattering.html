<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">216 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~15">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~4">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~2">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~5">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~5">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~9">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~5">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~5">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~4">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/coupling_matrix_mod.html'>coupling_matrix_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/statetostatexs.html'>statetostateXS</a></li>
                <li><a href='../module/potential.html'>POTENTIAL</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="373pt"
 viewBox="0.00 0.00 641.00 373.44" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.34 1.34) rotate(0) translate(4 498.2)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-498.2 858,-498.2 858,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="854,-196.68 775,-196.68 775,-172.68 854,-172.68 854,-196.68"/>
<text text-anchor="middle" x="814.5" y="-182.28" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-374.68 130,-374.68 130,-350.68 263,-350.68 263,-374.68"/>
<text text-anchor="middle" x="196.5" y="-360.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-478.68C630.66,-510.03 605.73,-482.44 536.5,-478.68"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-478.68C456.11,-474.42 438.64,-457.7 362,-440.68"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="612,-412.68 459,-412.68 459,-388.68 612,-388.68 612,-412.68"/>
<text text-anchor="middle" x="535.5" y="-398.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M813.52,-196.9C812.82,-245.34 802.8,-423.78 694.5,-478.68"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-478.68C667.68,-491.26 598.11,-445.58 560.82,-418.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="562.67,-415.82 552.52,-412.77 558.55,-421.48 562.67,-415.82"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="597,-136.68 474,-136.68 474,-112.68 597,-112.68 597,-136.68"/>
<text text-anchor="middle" x="535.5" y="-122.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-144.68C665.01,-138.35 634.31,-133.88 607.45,-130.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="607.69,-127.29 597.37,-129.67 606.92,-134.25 607.69,-127.29"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-176.68 334,-176.68 334,-152.68 388,-152.68 388,-176.68"/>
<text text-anchor="middle" x="361" y="-162.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-144.68C624.38,-129.01 606.4,-164.68 536.5,-164.68"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-164.68C487.41,-164.68 433.09,-164.68 398.19,-164.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="398.01,-161.18 388.01,-164.68 398.01,-168.18 398.01,-161.18"/>
</g>
<!-- module~coupling_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~coupling_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/coupling_matrix_mod.html" xlink:title="coupling_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="599,-216.68 472,-216.68 472,-192.68 599,-192.68 599,-216.68"/>
<text text-anchor="middle" x="535.5" y="-202.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">coupling_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~coupling_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~coupling_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-144.68C654.65,-135.97 648.27,-164.79 612,-178.68 602.58,-182.28 592.42,-185.94 582.7,-189.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="581.48,-186.05 573.16,-192.61 583.76,-192.66 581.48,-186.05"/>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="739,-196.68 648,-196.68 648,-172.68 739,-172.68 739,-196.68"/>
<text text-anchor="middle" x="693.5" y="-182.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.86,-184.68C766.67,-184.68 757.87,-184.68 749.21,-184.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="749.14,-181.18 739.14,-184.68 749.14,-188.18 749.14,-181.18"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-94.68 490.5,-94.68 490.5,-70.68 580.5,-70.68 580.5,-94.68"/>
<text text-anchor="middle" x="535.5" y="-80.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-144.68C653.37,-135.68 649.42,-118.24 612,-103.68 605.11,-101 597.75,-98.51 590.42,-96.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="591.09,-92.8 580.5,-93.32 589.1,-99.51 591.09,-92.8"/>
</g>
<!-- module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~statetostatexs</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/statetostatexs.html" xlink:title="statetostateXS">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-52.68 490.5,-52.68 490.5,-28.68 580.5,-28.68 580.5,-52.68"/>
<text text-anchor="middle" x="535.5" y="-38.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">statetostateXS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~statetostatexs</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-144.68C642.42,-133.16 656.18,-87.92 612,-61.68 605.34,-57.72 597.9,-54.49 590.37,-51.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="591.42,-48.51 580.82,-48.81 589.29,-55.18 591.42,-48.51"/>
</g>
<!-- module~potential -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~potential</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/potential.html" xlink:title="POTENTIAL">
<polygon fill="#337ab7" stroke="#337ab7" points="571,-258.68 500,-258.68 500,-234.68 571,-234.68 571,-258.68"/>
<text text-anchor="middle" x="535.5" y="-244.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POTENTIAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~potential</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-144.68C671.54,-139.86 664.11,-149.43 648,-163.68 624.13,-184.79 637.21,-206.19 612,-225.68 603.1,-232.56 592.07,-237.18 581.22,-240.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="580.23,-236.94 571.37,-242.75 581.92,-243.73 580.23,-236.94"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-214.68 134,-214.68 134,-190.68 259,-190.68 259,-214.68"/>
<text text-anchor="middle" x="196.5" y="-200.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M783.15,-172.64C759.39,-163.66 725.3,-151.77 694.5,-144.68"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-144.68C628.1,-129.86 670.01,-51.32 612,-19.68 552.3,12.88 524.74,-2.29 459,-19.68 353.03,-47.71 254.69,-141.68 215.46,-182.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.7,-180.78 208.42,-190.47 217.81,-185.57 212.7,-180.78"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-294.68 0,-294.68 0,-270.68 94,-270.68 94,-294.68"/>
<text text-anchor="middle" x="47" y="-280.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-478.68C457.95,-474.52 438.52,-483.45 362,-478.68"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M161.25,-350.61C151.01,-346.59 139.87,-341.82 130,-336.68 109.85,-326.18 88.44,-311.97 72.56,-300.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="74.52,-297.86 64.35,-294.89 70.45,-303.56 74.52,-297.86"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M511.37,-412.73C478.3,-428.43 415.57,-452.57 362,-440.68"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M360,-440.68C332.28,-434.52 324.99,-433.11 299,-421.68 272.46,-410.01 244.09,-393.1 224.1,-380.37"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="225.85,-377.33 215.55,-374.85 222.05,-383.21 225.85,-377.33"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M514.05,-388.57C496.79,-377.28 472.76,-358.88 459,-336.68 423.8,-279.87 466.3,-241.59 423,-190.68 416.41,-182.93 407.11,-177.44 397.75,-173.56"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="398.68,-170.18 388.09,-170.08 396.31,-176.76 398.68,-170.18"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M479.63,-388.64C414.29,-373.85 312.26,-349.21 299,-336.68 262.23,-301.92 297.76,-265.45 263,-228.68 259.71,-225.19 255.89,-222.17 251.78,-219.54"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="253.46,-216.47 243.02,-214.69 250.07,-222.6 253.46,-216.47"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M517.45,-412.83C487.66,-433.01 423.42,-471.9 362,-478.68"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M360,-478.68C329.47,-482.05 231.87,-460.05 130,-383.68 100.27,-361.39 74.89,-326.04 60.54,-303.62"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="63.35,-301.51 55.09,-294.88 57.41,-305.22 63.35,-301.51"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-412.68 334,-412.68 334,-388.68 388,-388.68 388,-412.68"/>
<text text-anchor="middle" x="361" y="-398.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M458.84,-400.68C437.85,-400.68 416.01,-400.68 398.39,-400.68"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="398.02,-397.18 388.02,-400.68 398.02,-404.18 398.02,-397.18"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-294.68 299,-294.68 299,-270.68 423,-270.68 423,-294.68"/>
<text text-anchor="middle" x="361" y="-280.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M520.31,-388.58C492.68,-365.09 433.45,-315.04 423,-308.68 417.18,-305.14 410.8,-301.85 404.42,-298.88"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="405.71,-295.63 395.15,-294.77 402.87,-302.02 405.71,-295.63"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M482.74,-136.68C455.48,-143 422.71,-150.6 398.19,-156.29"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="397.18,-152.93 388.23,-158.6 398.76,-159.75 397.18,-152.93"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M473.75,-114.96C439.92,-111.92 397.58,-112.11 362,-124.68"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M488.25,-112.65C445.86,-101.96 386.12,-87.85 362,-86.68"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M352.8,-176.88C337.76,-201.93 301.18,-260.45 263,-303.68 250,-318.4 233.57,-333.2 220.41,-344.28"/>
<polygon fill="#5cff00" stroke="#5cff00" points="218.17,-341.6 212.71,-350.68 222.64,-346.99 218.17,-341.6"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M333.89,-170.78C313.68,-175.51 284.86,-182.25 258.92,-188.32"/>
<polygon fill="#5cff00" stroke="#5cff00" points="258.08,-184.92 249.14,-190.6 259.67,-191.73 258.08,-184.92"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M343.23,-176.78C324.46,-189.86 292.77,-210.58 263,-223.68 235.25,-235.88 227.38,-237.58 197.5,-242.68"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M195.5,-242.68C161.11,-248.55 123.13,-258.95 94.33,-267.67"/>
<polygon fill="#5cff00" stroke="#5cff00" points="93.07,-264.39 84.54,-270.67 95.13,-271.08 93.07,-264.39"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M482.74,-192.68C455.48,-186.35 422.71,-178.76 398.19,-173.07"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="398.76,-169.61 388.23,-170.76 397.18,-176.43 398.76,-169.61"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M471.75,-206.66C439.01,-207.2 398.31,-207.08 362,-204.68"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M360,-204.68C330.41,-202.72 297.73,-202.04 269.48,-201.91"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="269.3,-198.41 259.29,-201.88 269.28,-205.41 269.3,-198.41"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M488.25,-216.71C445.86,-227.39 386.12,-241.51 362,-242.68"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M360,-242.68C287.86,-246.18 268.69,-230.52 197.5,-242.68"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M479.76,-216.8C472.58,-219.28 465.48,-222.21 459,-225.68 440.38,-235.64 440.92,-245.52 423,-256.68 417.29,-260.24 411,-263.52 404.71,-266.48"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="403.25,-263.3 395.54,-270.57 406.1,-269.69 403.25,-263.3"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M360,-322.68C318.74,-325.18 273.15,-337.25 240.78,-347.49"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="239.62,-344.19 231.18,-350.6 241.77,-350.85 239.62,-344.19"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M647.98,-175.91C616.88,-170.53 574.32,-164.68 536.5,-164.68"/>
</g>
<!-- module~propagators&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~propagators&#45;&gt;module~potential</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M671.51,-196.84C655.57,-205.7 632.9,-217.54 612,-225.68 602.1,-229.53 591.22,-232.99 580.88,-235.93"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="579.89,-232.57 571.18,-238.59 581.74,-239.32 579.89,-232.57"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M534.5,-322.68C461.3,-345.48 438.53,-318.04 362,-322.68"/>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M360,-322.68C257.62,-328.88 231.15,-320.68 130,-303.68 120,-302 109.43,-299.7 99.33,-297.23"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="99.98,-293.79 89.43,-294.73 98.26,-300.57 99.98,-293.79"/>
</g>
<!-- module~propagators&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~propagators&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M684.52,-196.73C664.17,-226.14 606.93,-300.75 536.5,-322.68"/>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M534.5,-322.68C510.74,-330.08 448.05,-312.12 405.16,-297.92"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="406.13,-294.55 395.53,-294.68 403.9,-301.19 406.13,-294.55"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M490.29,-91.01C479.62,-94.07 468.56,-98.19 459,-103.68 439.65,-114.79 441.58,-126.32 423,-138.68 415.27,-143.82 406.36,-148.3 397.77,-152.03"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="396.23,-148.88 388.3,-155.92 398.88,-155.36 396.23,-148.88"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M490.19,-90.9C454.92,-98.06 404.58,-109.64 362,-124.68"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M490.16,-85.45C455.31,-87.21 405.53,-88.79 362,-86.68"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M360,-86.68C287.86,-83.17 258.18,-47.52 197.5,-86.68"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~statetostatexs&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M490.26,-46.27C479.12,-49.38 467.83,-54.21 459,-61.68 430.16,-86.08 450.17,-112.43 423,-138.68 415.87,-145.57 406.64,-150.76 397.52,-154.62"/>
<polygon fill="#002eff" stroke="#002eff" points="396.26,-151.36 388.16,-158.18 398.75,-157.9 396.26,-151.36"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~statetostatexs&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M490.47,-48.54C479.69,-51.62 468.52,-55.86 459,-61.68 438.87,-73.97 442.47,-87.36 423,-100.68 398.96,-117.13 389.47,-114.98 362,-124.68"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M360,-124.68C333.22,-134.13 324.99,-132.25 299,-143.68 272.46,-155.35 244.09,-172.26 224.1,-184.99"/>
<polygon fill="#002eff" stroke="#002eff" points="222.05,-182.15 215.55,-190.51 225.85,-188.03 222.05,-182.15"/>
</g>
<!-- module~statetostatexs&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~statetostatexs&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M490.35,-35.5C421.85,-29.76 288.42,-28 197.5,-86.68"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M195.5,-86.68C124.07,-128.58 76.05,-219.92 57.09,-261.41"/>
<polygon fill="#002eff" stroke="#002eff" points="53.87,-260.04 52.99,-270.6 60.26,-262.89 53.87,-260.04"/>
</g>
<!-- module~potential&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~potential&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M499.99,-240.9C486.6,-237.7 471.51,-232.86 459,-225.68 439.65,-214.57 441.58,-203.04 423,-190.68 415.27,-185.54 406.36,-181.05 397.77,-177.32"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="398.88,-174 388.3,-173.44 396.23,-180.47 398.88,-174"/>
</g>
<!-- module~potential&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~potential&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M499.64,-237.51C453.3,-225.42 375.65,-205.58 362,-204.68"/>
</g>
<!-- module~potential&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~potential&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M499.79,-244.41C464.94,-242.48 409.72,-240.36 362,-242.68"/>
</g>
<!-- module~potential&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~potential&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M499.59,-253.96C479.52,-258.15 453.62,-263.56 429.71,-268.55"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="428.68,-265.19 419.61,-270.66 430.11,-272.04 428.68,-265.19"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M161.25,-214.75C151.01,-218.76 139.87,-223.54 130,-228.68 109.85,-239.17 88.44,-253.38 72.56,-264.59"/>
<polygon fill="#e700ff" stroke="#e700ff" points="70.45,-261.8 64.35,-270.47 74.52,-267.49 70.45,-261.8"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M339.97,-270.52C320.63,-259.02 290.34,-241.65 263,-228.68 255.53,-225.14 247.45,-221.65 239.59,-218.45"/>
<polygon fill="#00ffff" stroke="#00ffff" points="240.76,-215.14 230.17,-214.68 238.16,-221.64 240.76,-215.14"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge47" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M325.19,-270.64C285.14,-257.41 221.77,-238.53 197.5,-242.68"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-294.68 130,-294.68 130,-270.68 263,-270.68 263,-294.68"/>
<text text-anchor="middle" x="196.5" y="-280.28" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M298.57,-282.68C290.32,-282.68 281.79,-282.68 273.34,-282.68"/>
<polygon fill="#00ffff" stroke="#00ffff" points="273.09,-279.18 263.09,-282.68 273.09,-286.18 273.09,-279.18"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="820pt"
 viewBox="0.00 0.00 641.00 820.05" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.13 2.13) rotate(0) translate(4 1741)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1741 1360,-1741 1360,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-777 0,-777 0,-753 79,-753 79,-777"/>
<text text-anchor="middle" x="39.5" y="-762.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="306.5,-1737 161.5,-1737 161.5,-1713 306.5,-1713 306.5,-1737"/>
<text text-anchor="middle" x="234" y="-1722.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.61,-777.12C41.67,-881.46 51.42,-1626.03 115,-1699 124.57,-1709.99 137.64,-1716.93 151.6,-1721.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="150.81,-1724.62 161.37,-1723.76 152.58,-1717.84 150.81,-1724.62"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1049,-1160 925,-1160 925,-1136 1049,-1136 1049,-1160"/>
<text text-anchor="middle" x="987" y="-1145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.11,-777.2C44.3,-836.14 61.1,-1090.74 115,-1144 232.84,-1260.43 696.28,-1281.44 855,-1234 877.87,-1227.16 930.95,-1189.28 962.07,-1166.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="964.31,-1168.83 970.22,-1160.04 960.12,-1163.22 964.31,-1168.83"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="281,-444 187,-444 187,-420 281,-420 281,-444"/>
<text text-anchor="middle" x="234" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M41.75,-752.8C47.31,-701.08 71.4,-500.68 115,-458 131.24,-442.1 154.87,-435 176.72,-432.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.36,-435.55 186.94,-431.02 176.62,-428.59 177.36,-435.55"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="333.5,-360 134.5,-360 134.5,-336 333.5,-336 333.5,-360"/>
<text text-anchor="middle" x="234" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41,-752.66C43.71,-691.84 58.7,-424.74 115,-369 118.16,-365.87 121.62,-363.12 125.29,-360.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.26,-363.61 134.25,-355.65 123.82,-357.51 127.26,-363.61"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-562 204,-562 204,-538 264,-538 264,-562"/>
<text text-anchor="middle" x="234" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M41.49,-752.58C44.89,-718.62 59.18,-623.6 115,-576 136.65,-557.54 168.48,-551.34 193.63,-549.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="194.12,-553.07 203.94,-549.1 193.79,-546.08 194.12,-553.07"/>
</g>
<!-- proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~potential_interpolation</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/potential_interpolation.html" xlink:title="potential_interpolation">
<polygon fill="#d9534f" stroke="#d9534f" points="300.5,-1005 167.5,-1005 167.5,-981 300.5,-981 300.5,-1005"/>
<text text-anchor="middle" x="234" y="-990.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_interpolation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~potential_interpolation</title>
<path fill="none" stroke="#ff0000" d="M41.71,-777.21C45.68,-810.64 61.29,-904.53 115,-955 126.88,-966.17 142.07,-974.05 157.56,-979.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.63,-983 167.22,-982.8 158.82,-976.35 156.63,-983"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="305.5,-680 162.5,-680 162.5,-656 305.5,-656 305.5,-680"/>
<text text-anchor="middle" x="234" y="-665.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M49.65,-752.86C62.44,-736.79 87.24,-708.77 115,-694 126.58,-687.83 139.55,-683.13 152.54,-679.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="153.63,-682.87 162.45,-677.01 151.89,-676.09 153.63,-682.87"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="547.5,-794 409.5,-794 409.5,-770 547.5,-770 547.5,-794"/>
<text text-anchor="middle" x="478.5" y="-779.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M79.28,-766.51C150.93,-769.3 305.3,-775.3 399.4,-778.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="399.31,-782.46 409.44,-779.35 399.59,-775.47 399.31,-782.46"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1014,-714 960,-714 960,-690 1014,-690 1014,-714"/>
<text text-anchor="middle" x="987" y="-699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M77.28,-777.04C89.19,-780.49 102.55,-783.88 115,-786 235.29,-806.44 267.05,-799.22 389,-803 468.52,-805.46 496.66,-838.22 568,-803 591.59,-791.35 581.22,-769.16 604,-756 701.42,-699.71 743.66,-739.24 855,-723 887.19,-718.3 923.74,-712.4 950.04,-708.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="950.64,-711.49 959.94,-706.4 949.5,-704.59 950.64,-711.49"/>
</g>
<!-- proc~crosssection -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~crosssection</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/crosssection.html" xlink:title="CROSSSECTION">
<polygon fill="#d9534f" stroke="#d9534f" points="526.5,-1619 430.5,-1619 430.5,-1595 526.5,-1595 526.5,-1619"/>
<text text-anchor="middle" x="478.5" y="-1604.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CROSSSECTION</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~crosssection -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~crosssection</title>
<path fill="none" stroke="#ff0000" d="M40.68,-777.15C42.24,-874.24 54.89,-1522.04 115,-1581 156.86,-1622.05 328.97,-1617.2 420.17,-1611.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="420.59,-1614.94 430.34,-1610.8 420.13,-1607.96 420.59,-1614.94"/>
</g>
<!-- proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~print_largest_partial_xs</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/print_largest_partial_xs.html" xlink:title="print_largest_partial_xs">
<polygon fill="#d9534f" stroke="#d9534f" points="797.5,-1602 661.5,-1602 661.5,-1578 797.5,-1578 797.5,-1602"/>
<text text-anchor="middle" x="729.5" y="-1587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_xs</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_xs</title>
<path fill="none" stroke="#ff0000" d="M40.75,-777.06C42.85,-870.75 58.6,-1480.08 115,-1536 133.78,-1554.62 490.17,-1576.72 650.96,-1585.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="651.08,-1589.31 661.26,-1586.38 651.47,-1582.32 651.08,-1589.31"/>
</g>
<!-- proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~check_dtol_otol</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/check_dtol_otol.html" xlink:title="check_dtol_otol">
<polygon fill="#d9534f" stroke="#d9534f" points="281.5,-318 186.5,-318 186.5,-294 281.5,-294 281.5,-318"/>
<text text-anchor="middle" x="234" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_dtol_otol</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~check_dtol_otol</title>
<path fill="none" stroke="#ff0000" d="M40.76,-752.67C42.36,-688.08 53.06,-389.41 115,-327 130.82,-311.06 154.27,-304.83 176.1,-302.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.54,-306.43 186.32,-302.37 176.13,-299.44 176.54,-306.43"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="278.5,-276 189.5,-276 189.5,-252 278.5,-252 278.5,-276"/>
<text text-anchor="middle" x="234" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.55,-752.86C41.12,-685.09 47.34,-354.18 115,-285 131.47,-268.17 156.43,-262.11 179.17,-260.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.56,-264.08 189.42,-260.2 179.29,-257.09 179.56,-264.08"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="793,-1644 666,-1644 666,-1620 793,-1620 793,-1644"/>
<text text-anchor="middle" x="729.5" y="-1629.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.63,-777.3C41.83,-877.02 52.25,-1551.07 115,-1612 189.94,-1684.77 509.89,-1657.81 655.64,-1641.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="656.3,-1644.64 665.83,-1640.02 655.49,-1637.69 656.3,-1644.64"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1228,-1400 1119,-1400 1119,-1376 1228,-1376 1228,-1400"/>
<text text-anchor="middle" x="1173.5" y="-1385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.14,-777.18C45.63,-859.95 73.24,-1338.22 115,-1386 224.27,-1511.01 690.93,-1514.47 855,-1489 959.55,-1472.77 1076.79,-1428.17 1135.21,-1404.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1136.86,-1407.13 1144.74,-1400.05 1134.17,-1400.67 1136.86,-1407.13"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="261,-234 207,-234 207,-210 261,-210 261,-234"/>
<text text-anchor="middle" x="234" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.39,-752.75C40,-681.3 41.69,-318.87 115,-243 135.81,-221.47 170.5,-217.51 196.9,-218.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.77,-221.66 206.93,-218.64 197.1,-214.67 196.77,-221.66"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="524,-1320 433,-1320 433,-1296 524,-1296 524,-1320"/>
<text text-anchor="middle" x="478.5" y="-1305.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M40.29,-777.25C39.36,-848.68 38.5,-1210.79 115,-1282 198.86,-1360.07 346.16,-1340.46 424.69,-1322.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="425.92,-1325.78 434.84,-1320.07 424.3,-1318.97 425.92,-1325.78"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="353,-402 115,-402 115,-378 353,-378 353,-402"/>
<text text-anchor="middle" x="234" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.28,-752.85C45.16,-696.37 64.26,-460.17 115,-411 115.99,-410.04 117,-409.12 118.04,-408.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="120.47,-410.8 126.49,-402.08 116.35,-405.14 120.47,-410.8"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="278,-192 190,-192 190,-168 278,-168 278,-192"/>
<text text-anchor="middle" x="234" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.25,-752.76C38.95,-678.03 35.99,-283.63 115,-201 131.47,-183.77 156.83,-177.76 179.82,-176.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.96,-179.87 189.84,-176.04 179.73,-172.87 179.96,-179.87"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="770.5,-912 688.5,-912 688.5,-888 770.5,-888 770.5,-912"/>
<text text-anchor="middle" x="729.5" y="-897.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M43.94,-777.15C51.77,-802.24 73.53,-859.38 115,-883 163.28,-910.49 540.11,-904.47 678.09,-901.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="678.46,-904.79 688.38,-901.06 678.3,-897.79 678.46,-904.79"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="524,-710 433,-710 433,-686 524,-686 524,-710"/>
<text text-anchor="middle" x="478.5" y="-695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M76.95,-752.94C88.96,-749.32 102.46,-745.61 115,-743 222.85,-720.54 351.24,-707.84 422.64,-702"/>
<polygon fill="#ff0000" stroke="#ff0000" points="423.06,-705.48 432.75,-701.19 422.5,-698.5 423.06,-705.48"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="515.5,-344 441.5,-344 441.5,-320 515.5,-320 515.5,-344"/>
<text text-anchor="middle" x="478.5" y="-329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M40.29,-752.93C40.3,-713.85 45.99,-589.76 115,-529 195.68,-457.97 273.81,-558.69 353,-486 398.12,-444.59 345.02,-395.62 389,-353 400.15,-342.2 415.79,-336.59 430.82,-333.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="431.69,-337.2 441.07,-332.27 430.67,-330.27 431.69,-337.2"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="534.5,-508 422.5,-508 422.5,-484 534.5,-484 534.5,-508"/>
<text text-anchor="middle" x="478.5" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M42.59,-752.67C48.3,-723.12 67.04,-648.01 115,-612 200.83,-547.54 252.41,-608.45 353,-571 390.49,-557.04 429.29,-531.61 453.4,-514.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="455.59,-517.01 461.59,-508.28 451.45,-511.36 455.59,-517.01"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="534.5,-302 422.5,-302 422.5,-278 534.5,-278 534.5,-302"/>
<text text-anchor="middle" x="478.5" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.97,-752.84C48.13,-703.96 73.49,-522.69 115,-486 195.02,-415.28 273.43,-524.23 353,-453 401.51,-409.57 342.61,-356.68 389,-311 395.61,-304.49 403.85,-299.86 412.62,-296.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="413.8,-299.89 422.29,-293.56 411.7,-293.22 413.8,-299.89"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="766.5,-1560 692.5,-1560 692.5,-1536 766.5,-1536 766.5,-1560"/>
<text text-anchor="middle" x="729.5" y="-1545.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M40.8,-777.16C43.18,-869.06 60.38,-1452.01 115,-1505 155.43,-1544.22 546,-1548 682.05,-1548.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="682.15,-1551.62 692.15,-1548.12 682.15,-1544.62 682.15,-1551.62"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-150 133.5,-150 133.5,-126 334.5,-126 334.5,-150"/>
<text text-anchor="middle" x="234" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.14,-752.82C45.54,-671.05 72.44,-203.92 115,-159 117.9,-155.94 121.07,-153.24 124.46,-150.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.54,-153.69 133.31,-145.54 122.93,-147.69 126.54,-153.69"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="525.5,-954 431.5,-954 431.5,-930 525.5,-930 525.5,-954"/>
<text text-anchor="middle" x="478.5" y="-939.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M42.35,-777.04C47.59,-806.59 65.52,-882.72 115,-916 207.57,-978.26 345.19,-966.92 421.48,-953.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="422.13,-957.38 431.37,-952.2 420.91,-950.49 422.13,-957.38"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="280.5,-108 187.5,-108 187.5,-84 280.5,-84 280.5,-108"/>
<text text-anchor="middle" x="234" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M41.04,-752.81C44.9,-667.78 69.57,-165.32 115,-117 130.76,-100.24 154.92,-94.04 177.28,-92.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.56,-95.89 187.39,-91.95 177.24,-88.9 177.56,-95.89"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="770,-1160 689,-1160 689,-1136 770,-1136 770,-1160"/>
<text text-anchor="middle" x="729.5" y="-1145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M41.92,-777.02C47.96,-826.16 73.2,-1011.05 115,-1049 135.99,-1068.06 536.28,-1122.58 678.71,-1141.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="678.54,-1144.98 688.91,-1142.82 679.46,-1138.04 678.54,-1144.98"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1356,-1118 1264,-1118 1264,-1094 1356,-1094 1356,-1118"/>
<text text-anchor="middle" x="1310" y="-1103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.6,-777.18C41.58,-878.87 50.66,-1584.87 115,-1650 171.87,-1707.58 396.57,-1685 477.5,-1685 477.5,-1685 477.5,-1685 988,-1685 1019.58,-1685 1213.33,-1584.95 1228,-1565 1280.31,-1493.87 1302.3,-1210.45 1307.65,-1128.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1311.15,-1128.37 1308.29,-1118.17 1304.17,-1127.93 1311.15,-1128.37"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="567,-630 390,-630 390,-606 567,-606 567,-630"/>
<text text-anchor="middle" x="478.5" y="-615.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M44.16,-752.64C52.28,-727.68 74.36,-671.57 115,-647 158.03,-620.99 287.84,-616.12 379.79,-616.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="379.96,-619.65 389.97,-616.18 379.97,-612.65 379.96,-619.65"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="567.5,-752 389.5,-752 389.5,-728 567.5,-728 567.5,-752"/>
<text text-anchor="middle" x="478.5" y="-737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M79.28,-762.78C145.99,-758.97 284.42,-751.05 379.13,-745.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="379.53,-749.11 389.31,-745.05 379.13,-742.12 379.53,-749.11"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="848.5,-1480 610.5,-1480 610.5,-1456 848.5,-1456 848.5,-1480"/>
<text text-anchor="middle" x="729.5" y="-1465.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.49,-777.41C40.65,-851.52 44.9,-1235.27 115,-1324 195.85,-1426.33 262.33,-1397.98 389,-1429 457.65,-1445.81 535.92,-1455.42 600,-1460.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="599.9,-1464.4 610.16,-1461.74 600.48,-1457.42 599.9,-1464.4"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="285,-66 183,-66 183,-42 285,-42 285,-66"/>
<text text-anchor="middle" x="234" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.95,-752.88C44.3,-664.93 66.69,-126.74 115,-75 129.64,-59.32 151.64,-52.86 172.68,-50.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.17,-54.22 182.9,-50.03 172.68,-47.23 173.17,-54.22"/>
</g>
<!-- proc~potential_read -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~potential_read</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/potential_read.html" xlink:title="potential_read">
<polygon fill="#d9534f" stroke="#d9534f" points="523,-1160 434,-1160 434,-1136 523,-1136 523,-1160"/>
<text text-anchor="middle" x="478.5" y="-1145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_read</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_read -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~potential_read</title>
<path fill="none" stroke="#ff0000" d="M41.42,-777.16C45.8,-831.6 66.36,-1052.15 115,-1097 199.4,-1174.83 345.18,-1168.21 423.7,-1157.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="424.45,-1161 433.85,-1156.13 423.46,-1154.07 424.45,-1161"/>
</g>
<!-- proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~potential_reduction</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/potential_reduction.html" xlink:title="potential_reduction">
<polygon fill="#d9534f" stroke="#d9534f" points="787,-1118 672,-1118 672,-1094 787,-1094 787,-1118"/>
<text text-anchor="middle" x="729.5" y="-1103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_reduction</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~potential_reduction</title>
<path fill="none" stroke="#ff0000" d="M39.92,-777.02C38.68,-817.72 40.66,-951.32 115,-1014 192.53,-1079.36 470.26,-1042 568,-1069 584.88,-1073.66 587.24,-1079.95 604,-1085 622.41,-1090.55 642.83,-1094.76 661.71,-1097.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="661.3,-1101.38 671.72,-1099.49 662.39,-1094.46 661.3,-1101.38"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-24 162,-24 162,0 306,0 306,-24"/>
<text text-anchor="middle" x="234" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M40.87,-752.73C43.76,-661.29 63.84,-88.13 115,-33 124.83,-22.4 138.02,-16.01 152.01,-12.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.78,-15.74 161.8,-10.18 151.28,-8.9 152.78,-15.74"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="308.5,-874 159.5,-874 159.5,-850 308.5,-850 308.5,-874"/>
<text text-anchor="middle" x="234" y="-859.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M49.65,-777.14C62.44,-793.21 87.24,-821.23 115,-836 125.63,-841.66 137.43,-846.09 149.34,-849.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="148.78,-853.03 159.35,-852.24 150.6,-846.27 148.78,-853.03"/>
</g>
<!-- proc~process_single_matrix_element -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~process_single_matrix_element</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/process_single_matrix_element.html" xlink:title="process_single_matrix_element">
<polygon fill="#d9534f" stroke="#d9534f" points="568,-142 389,-142 389,-118 568,-118 568,-142"/>
<text text-anchor="middle" x="478.5" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">process_single_matrix_element</text>
</a>
</g>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~process_single_matrix_element -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~process_single_matrix_element</title>
<path fill="none" stroke="#ff7800" d="M333.62,-340.22C340.73,-336.83 347.32,-332.5 353,-327 408.77,-272.95 336.27,-213.02 389,-156 392,-152.76 395.37,-149.91 399.01,-147.42"/>
<polygon fill="#ff7800" stroke="#ff7800" points="401.07,-150.27 407.94,-142.21 397.54,-144.23 401.07,-150.27"/>
</g>
<!-- proc~numerov&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~numerov&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ffa100" d="M264.17,-547.82C322.35,-544.05 456.8,-538.21 568,-555 600.85,-559.96 823.98,-627.09 855,-639 890.04,-652.45 928.59,-671.54 954.73,-685.17"/>
<polygon fill="#ffa100" stroke="#ffa100" points="953.3,-688.37 963.78,-689.93 956.55,-682.17 953.3,-688.37"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ffa100" d="M259.62,-562.13C287.84,-577.54 332.79,-607 353,-647 421.43,-782.46 299.14,-1206.7 389,-1329 449.37,-1411.16 503.66,-1390.94 604,-1409 713.79,-1428.76 743.51,-1412.68 855,-1409 943,-1406.09 1044.48,-1398.67 1108.56,-1393.47"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1109.22,-1396.93 1118.9,-1392.63 1108.65,-1389.95 1109.22,-1396.93"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ffa100" d="M264.15,-551.84C290.94,-551.85 329.89,-547.32 353,-524 407.66,-468.82 334.79,-408.61 389,-353 400.03,-341.68 415.96,-336.01 431.28,-333.29"/>
<polygon fill="#ffa100" stroke="#ffa100" points="431.78,-336.75 441.19,-331.9 430.81,-329.82 431.78,-336.75"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffa100" d="M258.38,-537.74C285.83,-522.01 330.47,-492.05 353,-453 402.07,-367.94 315.31,-299.91 389,-235 409.92,-216.57 845.2,-222.79 855,-227 876.37,-236.19 873.37,-249.82 891,-265 1029.39,-384.12 1132.97,-344.08 1228,-500 1289.64,-601.13 1305.37,-986.46 1308.39,-1083.64"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1304.89,-1083.9 1308.69,-1093.79 1311.89,-1083.69 1304.89,-1083.9"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="551.5,-386 405.5,-386 405.5,-362 551.5,-362 551.5,-386"/>
<text text-anchor="middle" x="478.5" y="-371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#ffa100" d="M264.01,-551.44C290.52,-551.13 329.11,-546.37 353,-524 394.89,-484.78 348.49,-440.64 389,-400 392.42,-396.57 396.28,-393.58 400.41,-390.98"/>
<polygon fill="#ffa100" stroke="#ffa100" points="402.12,-394.04 409.23,-386.19 398.77,-387.89 402.12,-394.04"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="529,-588 428,-588 428,-564 529,-564 529,-588"/>
<text text-anchor="middle" x="478.5" y="-573.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#ffa100" d="M264.25,-553.14C302.12,-557.2 369.04,-564.37 417.83,-569.6"/>
<polygon fill="#ffa100" stroke="#ffa100" points="417.64,-573.1 427.95,-570.69 418.38,-566.14 417.64,-573.1"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="802,-260 657,-260 657,-236 802,-236 802,-260"/>
<text text-anchor="middle" x="729.5" y="-245.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ffa100" d="M257.7,-537.9C284.92,-522.14 329.76,-491.94 353,-453 395.7,-381.44 326.34,-323.93 389,-269 425.95,-236.61 558.32,-237.46 646.44,-242.02"/>
<polygon fill="#ffa100" stroke="#ffa100" points="646.52,-245.53 656.69,-242.57 646.9,-238.54 646.52,-245.53"/>
</g>
<!-- proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~cenitrfugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/cenitrfugal_matrix.html" xlink:title="cenitrfugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="533.5,-466 423.5,-466 423.5,-442 533.5,-442 533.5,-466"/>
<text text-anchor="middle" x="478.5" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cenitrfugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~numerov&#45;&gt;proc~cenitrfugal_matrix</title>
<path fill="none" stroke="#ffa100" d="M264.37,-549.23C289.69,-547.3 326.28,-541.39 353,-524 375.65,-509.26 366.47,-489.92 389,-475 396.37,-470.12 404.74,-466.37 413.33,-463.49"/>
<polygon fill="#ffa100" stroke="#ffa100" points="414.48,-466.8 423.07,-460.59 412.49,-460.09 414.48,-466.8"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="793,-344 666,-344 666,-320 793,-320 793,-344"/>
<text text-anchor="middle" x="729.5" y="-329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ffa100" d="M264.05,-550.9C290.21,-550.17 328.25,-545.08 353,-524 386.11,-495.8 355.78,-461.07 389,-433 451.12,-380.51 498.06,-436.51 568,-395 589.14,-382.45 582.6,-365.1 604,-353 619.55,-344.21 637.82,-338.88 655.5,-335.71"/>
<polygon fill="#ffa100" stroke="#ffa100" points="656.48,-339.1 665.82,-334.08 655.39,-332.19 656.48,-339.1"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="756.5,-1076 702.5,-1076 702.5,-1052 756.5,-1052 756.5,-1076"/>
<text text-anchor="middle" x="729.5" y="-1061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~potential_interpolation&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~potential_interpolation&#45;&gt;proc~spline</title>
<path fill="none" stroke="#ffc900" d="M300.76,-996.54C368.19,-1000.83 475.94,-1009.47 568,-1025 611.25,-1032.29 660.11,-1044.79 692.44,-1053.67"/>
<polygon fill="#ffc900" stroke="#ffc900" points="691.75,-1057.12 702.33,-1056.42 693.63,-1050.37 691.75,-1057.12"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="756.5,-672 702.5,-672 702.5,-648 756.5,-648 756.5,-672"/>
<text text-anchor="middle" x="729.5" y="-657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#fff100" d="M305.71,-666.85C412.32,-665.13 610.44,-661.91 691.99,-660.59"/>
<polygon fill="#fff100" stroke="#fff100" points="692.3,-664.09 702.25,-660.43 692.19,-657.09 692.3,-664.09"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#e4ff00" d="M547.81,-772.68C555.11,-769.74 562.03,-765.93 568,-761 598.06,-736.17 573.14,-704.83 604,-681 628.97,-661.72 665.2,-657.48 692.15,-657.46"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="692.28,-660.97 702.34,-657.66 692.41,-653.97 692.28,-660.97"/>
</g>
<!-- proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~wavenumber_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/wavenumber_from_energy.html" xlink:title="wavenumber_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="807,-714 652,-714 652,-690 807,-690 807,-714"/>
<text text-anchor="middle" x="729.5" y="-699.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_from_energy</text>
</a>
</g>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#e4ff00" d="M546.57,-769.97C554.01,-767.51 561.3,-764.55 568,-761 587.18,-750.83 584.69,-737.91 604,-728 615.74,-721.98 628.79,-717.35 641.89,-713.79"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="643.05,-717.11 651.9,-711.28 641.34,-710.32 643.05,-717.11"/>
</g>
<!-- proc~crosssection&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~crosssection&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#93ff00" d="M526.63,-1611.73C562.97,-1615.38 613.88,-1620.49 655.48,-1624.67"/>
<polygon fill="#93ff00" stroke="#93ff00" points="655.27,-1628.17 665.57,-1625.68 655.97,-1621.2 655.27,-1628.17"/>
</g>
<!-- proc~crosssection&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~crosssection&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#93ff00" d="M514.59,-1594.96C539.35,-1586.8 573.43,-1576.21 604,-1569 629.65,-1562.95 658.66,-1557.95 682.22,-1554.35"/>
<polygon fill="#93ff00" stroke="#93ff00" points="682.92,-1557.78 692.3,-1552.85 681.89,-1550.86 682.92,-1557.78"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#6bff00" d="M797.68,-1591.79C818.13,-1589.13 839.32,-1582.7 855,-1569 977.86,-1461.65 986.95,-1241.23 986.55,-1170.43"/>
<polygon fill="#6bff00" stroke="#6bff00" points="990.04,-1169.99 986.41,-1160.04 983.04,-1170.09 990.04,-1169.99"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#6bff00" d="M797.74,-1583.51C872.81,-1573.56 995.24,-1549.02 1083,-1490 1115.47,-1468.16 1143.49,-1431.72 1159.16,-1408.82"/>
<polygon fill="#6bff00" stroke="#6bff00" points="1162.27,-1410.46 1164.91,-1400.2 1156.45,-1406.57 1162.27,-1410.46"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#6bff00" d="M797.59,-1595.22C908.99,-1599.69 1129.63,-1589.77 1228,-1454 1303.22,-1350.18 1309.78,-1187.17 1309.52,-1128.21"/>
<polygon fill="#6bff00" stroke="#6bff00" points="1313.01,-1128.11 1309.4,-1118.15 1306.01,-1128.19 1313.01,-1128.11"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff0d" d="M793.17,-1639.07C903.06,-1647.48 1128.28,-1646.13 1228,-1510 1273.54,-1447.84 1299.8,-1204.18 1306.97,-1128.53"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="1310.49,-1128.54 1307.93,-1118.25 1303.52,-1127.89 1310.49,-1128.54"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#00ff86" d="M485.05,-1320.19C500.02,-1351.9 544.18,-1438.06 604,-1489 626.99,-1508.58 657.58,-1523.19 682.69,-1532.98"/>
<polygon fill="#00ff86" stroke="#00ff86" points="681.77,-1536.38 692.36,-1536.62 684.24,-1529.83 681.77,-1536.38"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00ff86" d="M486.37,-1295.86C502.74,-1268.2 546.97,-1200.43 604,-1169 626.58,-1156.56 654.68,-1151.11 678.47,-1148.87"/>
<polygon fill="#00ff86" stroke="#00ff86" points="679.02,-1152.33 688.72,-1148.07 678.48,-1145.36 679.02,-1152.33"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="767.5,-1202 691.5,-1202 691.5,-1178 767.5,-1178 767.5,-1202"/>
<text text-anchor="middle" x="729.5" y="-1187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#00ff86" d="M505.21,-1295.82C550.15,-1274.52 643.03,-1230.51 693.69,-1206.5"/>
<polygon fill="#00ff86" stroke="#00ff86" points="695.39,-1209.56 702.93,-1202.12 692.39,-1203.24 695.39,-1209.56"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="766.5,-1400 692.5,-1400 692.5,-1376 766.5,-1376 766.5,-1400"/>
<text text-anchor="middle" x="729.5" y="-1385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#00ff86" d="M503.27,-1320.05C527.93,-1332.12 567.85,-1350.52 604,-1362 629.39,-1370.06 658.5,-1376.3 682.18,-1380.64"/>
<polygon fill="#00ff86" stroke="#00ff86" points="681.85,-1384.14 692.31,-1382.45 683.08,-1377.25 681.85,-1384.14"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="777,-1320 682,-1320 682,-1296 777,-1296 777,-1320"/>
<text text-anchor="middle" x="729.5" y="-1305.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#00ff86" d="M524.02,-1308C565.29,-1308 626.89,-1308 671.69,-1308"/>
<polygon fill="#00ff86" stroke="#00ff86" points="671.83,-1311.5 681.83,-1308 671.83,-1304.5 671.83,-1311.5"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="814,-161 645,-161 645,-137 814,-137 814,-161"/>
<text text-anchor="middle" x="729.5" y="-146.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#00ffae" d="M341.53,-377.94C345.64,-375.37 349.5,-372.41 353,-369 409.9,-313.61 330.89,-248.12 389,-194 423.67,-161.71 546.73,-152.19 634.7,-149.59"/>
<polygon fill="#00ffae" stroke="#00ffae" points="634.81,-153.09 644.71,-149.32 634.62,-146.09 634.81,-153.09"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffff" d="M770.66,-905.05C795.23,-908.56 827.18,-913.89 855,-921 1024.96,-964.4 1071.52,-970.72 1228,-1050 1248.85,-1060.56 1270.52,-1075.81 1286.2,-1087.73"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1284.2,-1090.61 1294.25,-1093.96 1288.48,-1085.07 1284.2,-1090.61"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1034,-1078 940,-1078 940,-1054 1034,-1054 1034,-1078"/>
<text text-anchor="middle" x="987" y="-1063.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ffff" d="M770.78,-896.45C797.75,-896.32 832.33,-900.81 855,-921 897.85,-959.17 849.12,-1005.76 891,-1045 901.51,-1054.85 915.57,-1060.47 929.64,-1063.58"/>
<polygon fill="#00ffff" stroke="#00ffff" points="929.37,-1067.09 939.83,-1065.43 930.62,-1060.2 929.37,-1067.09"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1022,-1036 952,-1036 952,-1012 1022,-1012 1022,-1036"/>
<text text-anchor="middle" x="987" y="-1021.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ffff" d="M770.53,-900.71C795.92,-902.59 828.8,-907.72 855,-921 874.9,-931.09 873.88,-941.69 891,-956 913,-974.39 939.67,-993.2 959.14,-1006.36"/>
<polygon fill="#00ffff" stroke="#00ffff" points="957.28,-1009.33 967.54,-1011.99 961.18,-1003.52 957.28,-1009.33"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00d6ff" d="M498.36,-685.77C521.95,-671.29 564.1,-647.98 604,-639 812.5,-592.1 891.9,-585.35 1083,-681 1161.47,-720.28 1182.27,-740.11 1228,-815 1282.88,-904.88 1301.5,-1032.81 1306.98,-1083.79"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1303.52,-1084.39 1308.01,-1093.99 1310.49,-1083.69 1303.52,-1084.39"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00d6ff" d="M524.02,-691.21C572.06,-683.87 647.67,-672.34 692.23,-665.53"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="692.97,-668.96 702.33,-663.99 691.91,-662.04 692.97,-668.96"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#00d6ff" d="M524.02,-698.72C556.57,-699.24 601.78,-699.96 641.42,-700.6"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="641.57,-704.1 651.63,-700.77 641.69,-697.1 641.57,-704.1"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="756.5,-554 702.5,-554 702.5,-530 756.5,-530 756.5,-554"/>
<text text-anchor="middle" x="729.5" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#0086ff" d="M534.59,-507.44C556.2,-511.83 581.24,-516.8 604,-521 633.61,-526.47 667.29,-532.12 692.15,-536.17"/>
<polygon fill="#0086ff" stroke="#0086ff" points="691.79,-539.66 702.23,-537.81 692.92,-532.75 691.79,-539.66"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="776,-428 683,-428 683,-404 776,-404 776,-428"/>
<text text-anchor="middle" x="729.5" y="-413.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#0086ff" d="M534.74,-488.1C546.21,-485.05 557.87,-480.83 568,-475 588.16,-463.39 583.47,-447.94 604,-437 624.88,-425.87 650.3,-420.39 672.7,-417.78"/>
<polygon fill="#0086ff" stroke="#0086ff" points="673.16,-421.25 682.76,-416.77 672.46,-414.28 673.16,-421.25"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="777.5,-512 681.5,-512 681.5,-488 777.5,-488 777.5,-512"/>
<text text-anchor="middle" x="729.5" y="-497.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#0086ff" d="M534.76,-496.89C575.31,-497.54 630.23,-498.42 671.24,-499.08"/>
<polygon fill="#0086ff" stroke="#0086ff" points="671.29,-502.58 681.35,-499.24 671.41,-495.58 671.29,-502.58"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#0086ff" d="M497.81,-508.06C541.25,-536.67 650.71,-608.76 701.65,-642.31"/>
<polygon fill="#0086ff" stroke="#0086ff" points="699.89,-645.35 710.16,-647.92 703.74,-639.5 699.89,-645.35"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#0086ff" d="M507.32,-508.08C527,-517.98 552.54,-533.82 568,-555 602.34,-602.04 560.59,-642.17 604,-681 614.58,-690.47 627.78,-696.49 641.59,-700.2"/>
<polygon fill="#0086ff" stroke="#0086ff" points="641.2,-703.7 651.73,-702.51 642.76,-696.88 641.2,-703.7"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="756.5,-302 702.5,-302 702.5,-278 756.5,-278 756.5,-302"/>
<text text-anchor="middle" x="729.5" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#0086ff" d="M534.91,-492.64C547.18,-489.44 559.14,-484.01 568,-475 620.32,-421.79 549.96,-362.46 604,-311 627.23,-288.88 664.57,-285.19 692.31,-286.08"/>
<polygon fill="#0086ff" stroke="#0086ff" points="692.25,-289.58 702.42,-286.62 692.62,-282.59 692.25,-289.58"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="799.5,-470 659.5,-470 659.5,-446 799.5,-446 799.5,-470"/>
<text text-anchor="middle" x="729.5" y="-455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#0086ff" d="M534.76,-487.57C568.29,-482.45 611.64,-475.83 648.83,-470.16"/>
<polygon fill="#0086ff" stroke="#0086ff" points="649.78,-473.55 659.14,-468.59 648.73,-466.63 649.78,-473.55"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#005dff" d="M534.76,-290C582.74,-290 650.83,-290 692.2,-290"/>
<polygon fill="#005dff" stroke="#005dff" points="692.37,-293.5 702.37,-290 692.37,-286.5 692.37,-293.5"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#005dff" d="M534.76,-280.68C567.76,-275.11 610.28,-267.94 647.08,-261.73"/>
<polygon fill="#005dff" stroke="#005dff" points="648.01,-265.13 657.29,-260.01 646.85,-258.22 648.01,-265.13"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#005dff" d="M534.76,-299.32C570.4,-305.33 617.15,-313.22 655.79,-319.74"/>
<polygon fill="#005dff" stroke="#005dff" points="655.5,-323.24 665.94,-321.45 656.66,-316.33 655.5,-323.24"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#1a00ff" d="M525.75,-934.2C569.07,-926.89 633.64,-916 678.22,-908.48"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="678.98,-911.9 688.26,-906.79 677.81,-905 678.98,-911.9"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="826,-954 633,-954 633,-930 826,-930 826,-954"/>
<text text-anchor="middle" x="729.5" y="-939.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#1a00ff" d="M525.75,-942C553.03,-942 588.73,-942 622.56,-942"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="622.99,-945.5 632.99,-942 622.99,-938.5 622.99,-945.5"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1083,-791 891,-791 891,-767 1083,-767 1083,-791"/>
<text text-anchor="middle" x="987" y="-776.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#1a00ff" d="M489.77,-929.69C518.18,-895.7 596.27,-802.77 604,-799 699.61,-752.42 825.1,-756.29 905.66,-765.72"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="905.39,-769.21 915.74,-766.96 906.24,-762.27 905.39,-769.21"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="855,-996 604,-996 604,-972 855,-972 855,-996"/>
<text text-anchor="middle" x="729.5" y="-981.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#1a00ff" d="M525.75,-949.8C559.72,-955.53 606.76,-963.47 646.98,-970.25"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="646.6,-973.74 657.04,-971.95 647.77,-966.83 646.6,-973.74"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#6b00ff" d="M770.14,-1148C808.66,-1148 868.03,-1148 914.76,-1148"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="914.83,-1151.5 924.83,-1148 914.83,-1144.5 914.83,-1151.5"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#6b00ff" d="M770.26,-1150.58C796.83,-1150.25 831.14,-1145.6 855,-1127 886.39,-1102.53 860.24,-1070.25 891,-1045 905.19,-1033.35 924.45,-1027.81 941.92,-1025.29"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="942.42,-1028.75 951.95,-1024.13 941.61,-1021.8 942.42,-1028.75"/>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#bb00ff" d="M550.85,-630.04C597.02,-637.82 655.2,-647.64 692.14,-653.87"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="691.98,-657.39 702.42,-655.6 693.14,-650.49 691.98,-657.39"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#e400ff" d="M548.21,-727.95C555.12,-725.5 561.84,-722.55 568,-719 588.16,-707.39 583.47,-691.94 604,-681 631.2,-666.5 666.09,-661.59 692,-660.12"/>
<polygon fill="#e400ff" stroke="#e400ff" points="692.32,-663.61 702.16,-659.68 692.02,-656.61 692.32,-663.61"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#e400ff" d="M558.29,-727.98C584.93,-723.91 614.83,-719.35 642.04,-715.2"/>
<polygon fill="#e400ff" stroke="#e400ff" points="642.57,-718.65 651.93,-713.69 641.52,-711.73 642.57,-718.65"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00f1" d="M772.47,-1455.94C798.8,-1446.63 832,-1431.49 855,-1409 927.46,-1338.16 966.63,-1218.83 980.32,-1169.91"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="983.75,-1170.64 982.99,-1160.08 976.99,-1168.81 983.75,-1170.64"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00f1" d="M783.31,-1480.04C884.58,-1499.72 1106.79,-1525.76 1228,-1409 1269.16,-1369.36 1297.28,-1191.03 1306.07,-1128.08"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1309.55,-1128.43 1307.44,-1118.05 1302.62,-1127.48 1309.55,-1128.43"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~potential_read&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00a1" d="M497.02,-1160.24C520.22,-1175.63 563,-1201.22 604,-1211 712.51,-1236.89 746.23,-1235.79 855,-1211 893.13,-1202.31 933.1,-1181.05 958.71,-1165.63"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="960.78,-1168.47 967.47,-1160.25 957.11,-1162.5 960.78,-1168.47"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~potential_read&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff00a1" d="M487.04,-1160.18C511.24,-1199.1 586.46,-1318.58 604,-1329 646.61,-1354.3 968.85,-1376.04 1108.39,-1384.37"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="1108.33,-1387.87 1118.52,-1384.97 1108.75,-1380.89 1108.33,-1387.87"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~potential_read&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff00a1" d="M523.16,-1148C566.51,-1148 632.89,-1148 678.37,-1148"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="678.6,-1151.5 688.6,-1148 678.6,-1144.5 678.6,-1151.5"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~potential_read&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff00a1" d="M489.18,-1135.69C508.25,-1112.52 553.22,-1063 604,-1043 718.83,-997.78 868.27,-1008.2 941.55,-1017.31"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="941.42,-1020.83 951.79,-1018.64 942.32,-1013.88 941.42,-1020.83"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0078" d="M787.2,-1115.32C824.88,-1121.51 874.65,-1129.7 914.96,-1136.32"/>
<polygon fill="#ff0078" stroke="#ff0078" points="914.56,-1139.8 924.99,-1137.97 915.69,-1132.9 914.56,-1139.8"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0078" d="M787.02,-1106C898.02,-1106 1143.23,-1106 1253.44,-1106"/>
<polygon fill="#ff0078" stroke="#ff0078" points="1253.68,-1109.5 1263.68,-1106 1253.68,-1102.5 1253.68,-1109.5"/>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0028" d="M308.69,-856.89C451.41,-848.13 759.89,-835.18 855,-879 911.93,-905.23 954.92,-969.13 974.44,-1002.66"/>
<polygon fill="#ff0028" stroke="#ff0028" points="971.55,-1004.66 979.52,-1011.63 977.64,-1001.21 971.55,-1004.66"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M767.65,-1183.89C806.03,-1177.58 866.88,-1167.58 914.6,-1159.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="915.27,-1163.17 924.57,-1158.1 914.14,-1156.27 915.27,-1163.17"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M767.58,-1190.37C832.14,-1190.43 969.17,-1188.03 1083,-1169 1147.43,-1158.23 1219.83,-1136.23 1264.92,-1121.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1266.3,-1124.53 1274.67,-1118.04 1264.08,-1117.89 1266.3,-1124.53"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff0000" d="M767.57,-1190.28C793.56,-1188.97 828.29,-1184.11 855,-1169 876.4,-1156.9 872.46,-1143.15 891,-1127 910.52,-1110 935.19,-1094.3 954.49,-1083.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="956.27,-1086.11 963.22,-1078.11 952.8,-1080.03 956.27,-1086.11"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M767.6,-1193.51C794.98,-1194.01 831.43,-1189.99 855,-1169 897.85,-1130.83 849.12,-1084.24 891,-1045 904.5,-1032.35 923.83,-1026.68 941.54,-1024.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="942.12,-1027.79 951.72,-1023.31 941.42,-1020.83 942.12,-1027.79"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ffc700" d="M756.75,-1066.26C782.3,-1068.97 821.99,-1074.51 855,-1085 891.42,-1096.57 930.58,-1116.49 956.5,-1130.84"/>
<polygon fill="#ffc700" stroke="#ffc700" points="954.99,-1134 965.42,-1135.85 958.42,-1127.9 954.99,-1134"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ffc700" d="M756.88,-1059.87C800.51,-1053.04 888.16,-1039.32 941.51,-1030.97"/>
<polygon fill="#ffc700" stroke="#ffc700" points="942.36,-1034.38 951.69,-1029.37 941.27,-1027.46 942.36,-1034.38"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#b1ff00" d="M776.26,-410.83C803.22,-410.52 835.72,-415.43 855,-437 903.21,-490.92 854.58,-1024.51 891,-1087 902.76,-1107.17 924.15,-1121.78 943.65,-1131.64"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="942.2,-1134.82 952.74,-1135.96 945.21,-1128.5 942.2,-1134.82"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="1014,-214 960,-214 960,-190 1014,-190 1014,-214"/>
<text text-anchor="middle" x="987" y="-199.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#b1ff00" d="M776.06,-420.1C802.43,-419.9 834.38,-414.83 855,-395 911.3,-340.87 836.09,-278.53 891,-223 906.17,-207.66 929.85,-202.4 949.78,-200.98"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="949.95,-204.47 959.79,-200.55 949.65,-197.48 949.95,-204.47"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1217,-533 1130,-533 1130,-509 1217,-509 1217,-533"/>
<text text-anchor="middle" x="1173.5" y="-518.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#b1ff00" d="M776.17,-418.55C844.51,-423.43 976.71,-437.03 1083,-473 1105.12,-480.49 1128.32,-493.08 1145.55,-503.49"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="1144.12,-506.72 1154.46,-509 1147.8,-500.76 1144.12,-506.72"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#6eff00" d="M1060.92,-791.1C1068.57,-793.54 1076.07,-796.48 1083,-800 1159.63,-838.96 1176.85,-858.91 1228,-928 1265.35,-978.45 1291,-1048.86 1302.37,-1084.1"/>
<polygon fill="#6eff00" stroke="#6eff00" points="1299.09,-1085.35 1305.43,-1093.84 1305.77,-1083.25 1299.09,-1085.35"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#6eff00" d="M1018.74,-766.85C1039.19,-757.46 1065.43,-742.73 1083,-723 1131.61,-668.42 1157.44,-583.19 1167.47,-543.17"/>
<polygon fill="#6eff00" stroke="#6eff00" points="1170.89,-543.9 1169.84,-533.36 1164.09,-542.26 1170.89,-543.9"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#2cff00" d="M549.31,-361.92C555.86,-359.48 562.2,-356.54 568,-353 588.99,-340.2 582.6,-323.1 604,-311 631,-295.73 666.19,-290.93 692.27,-289.68"/>
<polygon fill="#2cff00" stroke="#2cff00" points="692.6,-293.17 702.48,-289.35 692.37,-286.18 692.6,-293.17"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#2cff00" d="M551.87,-363.06C557.68,-360.37 563.17,-357.07 568,-353 599.08,-326.85 572.08,-294.11 604,-269 616.3,-259.33 631.41,-253.42 646.82,-249.92"/>
<polygon fill="#2cff00" stroke="#2cff00" points="647.81,-253.3 656.96,-247.96 646.48,-246.42 647.81,-253.3"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#2cff00" d="M550.85,-361.96C583.67,-356.43 622.56,-349.87 655.57,-344.3"/>
<polygon fill="#2cff00" stroke="#2cff00" points="656.33,-347.72 665.61,-342.61 655.17,-340.82 656.33,-347.72"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ff16" d="M508.14,-563.99C527.96,-554.21 553.31,-538.5 568,-517 610.1,-455.39 549.96,-404.46 604,-353 617.86,-339.8 636.75,-333.16 655.62,-330.15"/>
<polygon fill="#00ff16" stroke="#00ff16" points="656.29,-333.59 665.77,-328.85 655.4,-326.65 656.29,-333.59"/>
</g>
<!-- proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~radtermvalue</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/radtermvalue.html" xlink:title="RADTERMVALUE">
<polygon fill="#d9534f" stroke="#d9534f" points="778,-832 681,-832 681,-808 778,-808 778,-832"/>
<text text-anchor="middle" x="729.5" y="-817.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RADTERMVALUE</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~radtermvalue</title>
<path fill="none" stroke="#00ff16" d="M529.46,-578.55C543.43,-581.55 557.61,-587.07 568,-597 610.11,-637.24 571.42,-674.72 604,-723 627.65,-758.05 668.02,-786.08 696.36,-802.83"/>
<polygon fill="#00ff16" stroke="#00ff16" points="694.69,-805.91 705.11,-807.87 698.19,-799.84 694.69,-805.91"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff58" d="M1022.39,-1031.2C1040.47,-1035.09 1062.99,-1040.09 1083,-1045 1142.94,-1059.71 1211.29,-1078.43 1256.98,-1091.23"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1256.09,-1094.61 1266.66,-1093.95 1257.98,-1087.87 1256.09,-1094.61"/>
</g>
<!-- proc~process_single_matrix_element&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~process_single_matrix_element&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#00ff9b" d="M568.34,-136.78C589.8,-138.42 612.81,-140.17 634.5,-141.83"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="634.45,-145.33 644.69,-142.61 634.99,-138.35 634.45,-145.33"/>
</g>
<!-- proc~percival_seaton_coefficient -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~percival_seaton_coefficient</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/percival_seaton_coefficient.html" xlink:title="percival_seaton_coefficient">
<polygon fill="#d94e8f" stroke="#d94e8f" points="808.5,-109 650.5,-109 650.5,-85 808.5,-85 808.5,-109"/>
<text text-anchor="middle" x="729.5" y="-94.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">percival_seaton_coefficient</text>
</a>
</g>
</g>
<!-- proc~process_single_matrix_element&#45;&gt;proc~percival_seaton_coefficient -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~process_single_matrix_element&#45;&gt;proc~percival_seaton_coefficient</title>
<path fill="none" stroke="#00ff9b" d="M568.34,-118.23C591.7,-115.13 616.89,-111.79 640.22,-108.7"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="640.99,-112.13 650.44,-107.35 640.07,-105.19 640.99,-112.13"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ddff" d="M777.73,-494.87C804.36,-494.79 835.99,-499.92 855,-521 939.39,-614.61 827.1,-978.37 891,-1087 902.84,-1107.13 924.23,-1121.73 943.72,-1131.59"/>
<polygon fill="#00ddff" stroke="#00ddff" points="942.26,-1134.78 952.8,-1135.93 945.28,-1128.46 942.26,-1134.78"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="1014,-552 960,-552 960,-528 1014,-528 1014,-552"/>
<text text-anchor="middle" x="987" y="-537.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#00ddff" d="M777.66,-507.38C827.42,-515.17 904.76,-527.28 949.89,-534.35"/>
<polygon fill="#00ddff" stroke="#00ddff" points="949.4,-537.81 959.82,-535.9 950.48,-530.9 949.4,-537.81"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ddff" d="M777.8,-502.25C860.94,-506.2 1032.68,-514.36 1119.62,-518.49"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1119.63,-521.99 1129.79,-518.97 1119.96,-515 1119.63,-521.99"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#009bff" d="M756.88,-664.34C802.8,-671.89 897.5,-687.45 949.63,-696.02"/>
<polygon fill="#009bff" stroke="#009bff" points="949.33,-699.52 959.76,-697.69 950.46,-692.61 949.33,-699.52"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#0058ff" d="M807.16,-702C854.38,-702 912.76,-702 949.7,-702"/>
<polygon fill="#0058ff" stroke="#0058ff" points="949.98,-705.5 959.98,-702 949.98,-698.5 949.98,-705.5"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0058ff" d="M750.53,-714.14C776.86,-730.82 823.45,-762.89 855,-799 912.83,-865.2 958.39,-960.66 976.96,-1002.72"/>
<polygon fill="#0058ff" stroke="#0058ff" points="973.79,-1004.22 980.99,-1011.99 980.21,-1001.43 973.79,-1004.22"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1059.5,-172 914.5,-172 914.5,-148 1059.5,-148 1059.5,-172"/>
<text text-anchor="middle" x="987" y="-157.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#0016ff" d="M814.16,-152.6C843.06,-153.85 875.39,-155.24 904.15,-156.48"/>
<polygon fill="#0016ff" stroke="#0016ff" points="904.02,-159.97 914.16,-156.91 904.32,-152.98 904.02,-159.97"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1027,-130 947,-130 947,-106 1027,-106 1027,-130"/>
<text text-anchor="middle" x="987" y="-115.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#0016ff" d="M814.16,-138.85C854.65,-133.94 901.88,-128.21 936.56,-124"/>
<polygon fill="#0016ff" stroke="#0016ff" points="937.4,-127.42 946.9,-122.74 936.56,-120.47 937.4,-127.42"/>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#f300ff" d="M533.63,-445.8C545.94,-441.95 558.24,-436.3 568,-428 596.17,-404.05 574.46,-375.23 604,-353 618.85,-341.82 637.52,-335.75 655.86,-332.62"/>
<polygon fill="#f300ff" stroke="#f300ff" points="656.58,-336.05 665.98,-331.17 655.59,-329.12 656.58,-336.05"/>
</g>
<!-- dfloat -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>dfloat</title>
<polygon fill="#777777" stroke="#777777" points="756.5,-386 702.5,-386 702.5,-362 756.5,-362 756.5,-386"/>
<text text-anchor="middle" x="729.5" y="-371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfloat</text>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;dfloat -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;dfloat</title>
<path fill="none" stroke="#f300ff" d="M533.51,-442.39C545.3,-438.7 557.4,-433.98 568,-428 586.9,-417.33 584.5,-404.53 604,-395 631.7,-381.47 666.53,-376.46 692.31,-374.71"/>
<polygon fill="#f300ff" stroke="#f300ff" points="692.61,-378.19 702.4,-374.15 692.22,-371.2 692.61,-378.19"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0085" d="M777.18,-1306.02C801.89,-1303.13 831.82,-1296.58 855,-1282 877.27,-1267.99 873.23,-1254.4 891,-1235 914.1,-1209.78 943.5,-1183.64 963.43,-1166.69"/>
<polygon fill="#ff0085" stroke="#ff0085" points="965.71,-1169.35 971.09,-1160.23 961.19,-1164 965.71,-1169.35"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0085" d="M756.52,-1296C786.09,-1280.81 833.1,-1251.65 855,-1211 902.89,-1122.09 837.47,-843.63 891,-758 904.41,-736.56 929.27,-722.33 950.19,-713.59"/>
<polygon fill="#ff0085" stroke="#ff0085" points="951.74,-716.74 959.78,-709.84 949.19,-710.22 951.74,-716.74"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0085" d="M777.14,-1304.67C845.87,-1301.25 977.6,-1300.44 1083,-1334 1107.3,-1341.74 1131.88,-1357.25 1149.12,-1369.67"/>
<polygon fill="#ff0085" stroke="#ff0085" points="1147.31,-1372.68 1157.43,-1375.82 1151.48,-1367.06 1147.31,-1372.68"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0085" d="M777.19,-1299.49C800.68,-1294.89 829.5,-1288.78 855,-1282 1023.43,-1237.23 1071.46,-1237.61 1228,-1161 1248.74,-1150.85 1270.28,-1135.99 1285.93,-1124.27"/>
<polygon fill="#ff0085" stroke="#ff0085" points="1288.14,-1126.98 1293.97,-1118.13 1283.9,-1121.41 1288.14,-1126.98"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0042" d="M799.79,-454.08C820.36,-456.61 841.09,-463.5 855,-479 945.4,-579.73 822.63,-970.19 891,-1087 902.8,-1107.15 924.19,-1121.76 943.69,-1131.62"/>
<polygon fill="#ff0042" stroke="#ff0042" points="942.23,-1134.8 952.76,-1135.95 945.25,-1128.48 942.23,-1134.8"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="1014,-256 960,-256 960,-232 1014,-232 1014,-256"/>
<text text-anchor="middle" x="987" y="-241.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#ff0042" d="M799.69,-456.26C818.76,-453.23 838.68,-447.48 855,-437 920.83,-394.73 961.91,-306.35 978.1,-265.52"/>
<polygon fill="#ff0042" stroke="#ff0042" points="981.44,-266.59 981.76,-256 974.9,-264.08 981.44,-266.59"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0042" d="M799.57,-465.81C870.76,-474.15 984.89,-488.29 1083,-504 1094.96,-505.91 1107.77,-508.2 1119.85,-510.47"/>
<polygon fill="#ff0042" stroke="#ff0042" points="1119.32,-513.93 1129.8,-512.37 1120.63,-507.06 1119.32,-513.93"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1200.5,-256 1146.5,-256 1146.5,-232 1200.5,-232 1200.5,-256"/>
<text text-anchor="middle" x="1173.5" y="-241.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ff0000" d="M1014.23,-207.7C1033.32,-211.88 1059.78,-217.71 1083,-223 1100.49,-226.98 1119.87,-231.52 1136.11,-235.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1135.74,-238.86 1146.28,-237.75 1137.36,-232.05 1135.74,-238.86"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1200.5,-214 1146.5,-214 1146.5,-190 1200.5,-190 1200.5,-214"/>
<text text-anchor="middle" x="1173.5" y="-199.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ff0000" d="M1014.04,-202C1045.96,-202 1100.21,-202 1136.21,-202"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1136.29,-205.5 1146.29,-202 1136.29,-198.5 1136.29,-205.5"/>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#00a9ff" d="M1014.04,-244C1045.96,-244 1100.21,-244 1136.21,-244"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1136.29,-247.5 1146.29,-244 1136.29,-240.5 1136.29,-247.5"/>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#00a9ff" d="M1014.23,-238.3C1033.32,-234.12 1059.78,-228.29 1083,-223 1100.49,-219.02 1119.87,-214.48 1136.11,-210.65"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1137.36,-213.95 1146.28,-208.25 1135.74,-207.14 1137.36,-213.95"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0000ff" d="M1194.23,-533.13C1205.99,-541.45 1220.12,-553.57 1228,-568 1278.02,-659.63 1302.05,-994.14 1307.68,-1083.77"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1304.19,-1084.13 1308.3,-1093.89 1311.18,-1083.7 1304.19,-1084.13"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge140" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#aa00ff" d="M778.24,-831.02C804.86,-839.64 836.33,-854.43 855,-879 911.76,-953.7 839.14,-1008.82 891,-1087 904.09,-1106.74 926,-1121.44 945.48,-1131.45"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="943.98,-1134.62 954.5,-1135.86 947.05,-1128.33 943.98,-1134.62"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge141" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#aa00ff" d="M778.19,-821.91C802.76,-824.8 832.24,-831.38 855,-846 916.34,-885.41 958.79,-964.39 976.6,-1002.48"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="973.45,-1004 980.78,-1011.65 979.82,-1001.1 973.45,-1004"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node75" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node75"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1014,-833 960,-833 960,-809 1014,-809 1014,-833"/>
<text text-anchor="middle" x="987" y="-818.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge142" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#aa00ff" d="M778.26,-820.19C828,-820.38 904.82,-820.68 949.78,-820.86"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="949.94,-824.36 959.95,-820.9 949.96,-817.36 949.94,-824.36"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="1014,-88 960,-88 960,-64 1014,-64 1014,-88"/>
<text text-anchor="middle" x="987" y="-73.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~percival_seaton_coefficient&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge143" class="edge">
<title>proc~percival_seaton_coefficient&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#ff00aa" d="M808.55,-90.59C855.56,-86.72 913.22,-81.98 949.79,-78.98"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="950.3,-82.45 959.98,-78.14 949.72,-75.47 950.3,-82.45"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node76" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node76"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1337,-235 1283,-235 1283,-211 1337,-211 1337,-235"/>
<text text-anchor="middle" x="1310" y="-220.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge144" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1200.75,-239.9C1221.3,-236.69 1250.12,-232.19 1272.85,-228.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1273.47,-232.09 1282.81,-227.09 1272.39,-225.17 1273.47,-232.09"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge145" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ffff" d="M1200.75,-206.1C1221.3,-209.31 1250.12,-213.81 1272.85,-217.36"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1272.39,-220.83 1282.81,-218.91 1273.47,-213.91 1272.39,-220.83"/>
</g>
<!-- proc~ispline&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge146" class="edge">
<title>proc~ispline&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#7f00ff" d="M995.82,-833.29C1013.74,-861.94 1058.12,-935.82 1083,-1003 1132.26,-1136 1160.32,-1305.19 1169.3,-1365.45"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1165.89,-1366.31 1170.8,-1375.7 1172.82,-1365.3 1165.89,-1366.31"/>
</g>
<!-- proc~ispline&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge147" class="edge">
<title>proc~ispline&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#7f00ff" d="M1014.17,-821.94C1035.27,-821.28 1064.4,-816.95 1083,-800 1159.17,-730.59 1170.84,-596.31 1172.39,-543.3"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1175.89,-543.34 1172.58,-533.28 1168.89,-543.21 1175.89,-543.34"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~15">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~4">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~2">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~5">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~5">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~9">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~5">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~5">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~4">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_level_indices~15"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_level_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~3"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~9"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate~2"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">POTENTIAL</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">coupling_matrix_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">statetostateXS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channels_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_read</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_reduction</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_interpolation</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channels_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channels_level_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channels_level_indices and channels_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">CROSSSECTION</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_xs</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_dtol_otol</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-03 16:16            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>