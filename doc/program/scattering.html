<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">205 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~2">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/radial_coupling_terms_mod.html'>radial_coupling_terms_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/data_mod.html'>data_mod</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/pes_matrix_mod.html'>pes_matrix_mod</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/propagator_mod.html'>propagator_mod</a></li>
                <li><a href='../module/save_s_matrix_mod.html'>save_s_matrix_mod</a></li>
                <li><a href='../module/state_to_state_cross_sections_mod.html'>state_to_state_cross_sections_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="464pt"
 viewBox="0.00 0.00 641.00 464.45" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.89 1.89) rotate(0) translate(4 874.17)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-874.17 1208,-874.17 1208,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="1204,-616.85 1125,-616.85 1125,-592.85 1204,-592.85 1204,-616.85"/>
<text text-anchor="middle" x="1164.5" y="-602.45" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~radial_coupling_terms_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/radial_coupling_terms_mod.html" xlink:title="radial_coupling_terms_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="798,-448.85 638,-448.85 638,-424.85 798,-424.85 798,-448.85"/>
<text text-anchor="middle" x="718" y="-434.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-456.85C870.76,-455.16 837.83,-451.96 808.39,-448.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="808.47,-445.09 798.13,-447.41 807.66,-452.04 808.47,-445.09"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-409.85 0,-409.85 0,-385.85 94,-385.85 94,-409.85"/>
<text text-anchor="middle" x="47" y="-395.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-862.85C630.84,-859.57 609.13,-866.82 523,-862.85"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="419,-60.85 296,-60.85 296,-36.85 419,-36.85 419,-60.85"/>
<text text-anchor="middle" x="357.5" y="-46.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1154.73,-592.51C1135.56,-566.02 1087.79,-502.38 1039.5,-456.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-456.85C916.55,-342.82 1034.93,-208.98 903,-107.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-107.85C867.56,-82.22 857.03,-75.44 816,-65.85 731.17,-46.04 706.42,-54.89 620,-65.85 575.83,-71.45 567.26,-86.03 523,-90.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-90.85C509.74,-91.68 452.59,-76.13 409.22,-63.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="409.94,-60.28 399.37,-60.88 408.01,-67 409.94,-60.28"/>
</g>
<!-- module~data_mod -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~data_mod</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/data_mod.html" xlink:title="data_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="225.5,-331.85 159.5,-331.85 159.5,-307.85 225.5,-307.85 225.5,-331.85"/>
<text text-anchor="middle" x="192.5" y="-317.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">data_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-90.85C502.46,-92.22 375.57,-123.47 358.5,-130.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-130.85C278.82,-164.46 224.78,-256.82 203.53,-298.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="200.36,-297.23 199.06,-307.75 206.63,-300.34 200.36,-297.23"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="255,-448.85 130,-448.85 130,-424.85 255,-424.85 255,-448.85"/>
<text text-anchor="middle" x="192.5" y="-434.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-807.85C919.52,-889.8 862.48,-869.79 719,-862.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-862.85C668.55,-860.64 326.42,-800.97 291,-767.85 244.58,-724.44 208.13,-525.59 197.01,-458.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="200.46,-458.23 195.39,-448.93 193.56,-459.36 200.46,-458.23"/>
</g>
<!-- module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~propagator_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/propagator_mod.html" xlink:title="propagator_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="1089,-616.85 988,-616.85 988,-592.85 1089,-592.85 1089,-616.85"/>
<text text-anchor="middle" x="1038.5" y="-602.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">propagator_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~propagator_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1124.95,-604.85C1116.87,-604.85 1108.18,-604.85 1099.53,-604.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1099.45,-601.35 1089.45,-604.85 1099.45,-608.35 1099.45,-601.35"/>
</g>
<!-- module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~save_s_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/save_s_matrix_mod.html" xlink:title="save_s_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="416,-102.85 299,-102.85 299,-78.85 416,-78.85 416,-102.85"/>
<text text-anchor="middle" x="357.5" y="-88.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~save_s_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-90.85C490.02,-94.22 455.51,-94.68 426.3,-94.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="426.28,-90.62 416.2,-93.88 426.11,-97.62 426.28,-90.62"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="794.5,-406.85 641.5,-406.85 641.5,-382.85 794.5,-382.85 794.5,-406.85"/>
<text text-anchor="middle" x="718" y="-392.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-456.85C994.01,-415.84 962.68,-460.19 903,-456.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-456.85C859.12,-454.51 855.66,-429.49 816,-415.85 809.17,-413.5 801.97,-411.36 794.71,-409.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="795.36,-405.97 784.8,-406.89 793.63,-412.75 795.36,-405.97"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="763,-98.85 673,-98.85 673,-74.85 763,-74.85 763,-98.85"/>
<text text-anchor="middle" x="718" y="-84.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-107.85C865.08,-80.32 812.87,-76.9 773.57,-79.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="773.07,-75.83 763.36,-80.07 773.6,-82.81 773.07,-75.83"/>
</g>
<!-- module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~pes_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/pes_matrix_mod.html" xlink:title="pes_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="952,-508.85 852,-508.85 852,-484.85 952,-484.85 952,-508.85"/>
<text text-anchor="middle" x="902" y="-494.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-456.85C1022.8,-442.99 970.66,-463.89 935.79,-480.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="933.95,-477.32 926.46,-484.81 936.99,-483.63 933.95,-477.32"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="549,-530.85 495,-530.85 495,-506.85 549,-506.85 549,-530.85"/>
<text text-anchor="middle" x="522" y="-516.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-456.85C774.06,-449.74 625.9,-487.83 559.01,-507.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="557.94,-504.24 549.37,-510.46 559.95,-510.95 557.94,-504.24"/>
</g>
<!-- module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>module~state_to_state_cross_sections_mod</title>
<g id="a_program~~scattering~~UsesGraph_node13"><a xlink:href=".././module/state_to_state_cross_sections_mod.html" xlink:title="state_to_state_cross_sections_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="816,-140.85 620,-140.85 620,-116.85 816,-116.85 816,-140.85"/>
<text text-anchor="middle" x="718" y="-126.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;module~state_to_state_cross_sections_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-107.85C892.36,-101.23 840.88,-107.7 794.86,-115.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="794.14,-111.72 784.84,-116.8 795.28,-118.63 794.14,-111.72"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-758.85 291,-758.85 291,-734.85 424,-734.85 424,-758.85"/>
<text text-anchor="middle" x="357.5" y="-744.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1160.55,-617.01C1150.84,-654 1116.01,-765.29 1039.5,-807.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-807.85C911.97,-877.68 862.51,-746.54 719,-752.85"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M703.91,-449C681.02,-469.78 631.61,-512.51 584,-539.85 490.28,-593.67 449.85,-573.1 358.5,-630.85"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.99,-427.03C572.96,-417.57 487.22,-401.52 460,-379.85 431.07,-356.82 451.37,-329.71 424,-304.85 401.05,-284.01 389.48,-282 358.5,-280.85"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.95,-445.91C602.29,-447.7 559.96,-446.6 523,-436.85"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M653.32,-448.93C641.81,-452.48 630.23,-457.04 620,-462.85 600.6,-473.87 603.01,-486.16 584,-497.85 576.24,-502.63 567.25,-506.49 558.59,-509.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="557.48,-506.21 549.05,-512.63 559.64,-512.87 557.48,-506.21"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="584,-488.85 460,-488.85 460,-464.85 584,-464.85 584,-488.85"/>
<text text-anchor="middle" x="522" y="-474.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M658.79,-448.85C637.6,-453.22 613.44,-458.2 591.44,-462.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="590.59,-459.34 581.5,-464.79 592,-466.2 590.59,-459.34"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M314,-36.78C278.75,-29.41 228.87,-25.38 193.5,-48.85"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M303.69,-60.97C299.07,-63.41 294.74,-66.33 291,-69.85 223.46,-133.36 202.01,-249.19 195.8,-297.63"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="192.32,-297.33 194.62,-307.67 199.27,-298.15 192.32,-297.33"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M301.23,-61.03C297.4,-63.46 293.91,-66.37 291,-69.85 213.07,-163.07 296.77,-226.75 255,-340.85 244.54,-369.41 224.48,-398.27 210.11,-416.79"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="207.26,-414.75 203.78,-424.76 212.74,-419.11 207.26,-414.75"/>
</g>
<!-- module~data_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~data_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M169.39,-331.87C145.34,-344.94 106.69,-365.95 79.48,-380.74"/>
<polygon fill="#9cff00" stroke="#9cff00" points="77.48,-377.84 70.37,-385.69 80.83,-383.99 77.48,-377.84"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M147.27,-424.83C133.09,-420.98 117.21,-416.66 102.39,-412.63"/>
<polygon fill="#27ff00" stroke="#27ff00" points="102.89,-409.14 92.33,-409.9 101.06,-415.9 102.89,-409.14"/>
</g>
<!-- module~propagator_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~propagator_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1032.35,-616.87C1021.27,-641.27 992.86,-696.85 952,-726.85 871.38,-786.03 622.89,-858.02 523,-862.85"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M521,-862.85C415.41,-868.76 385.88,-848.56 291,-801.85 241.95,-777.7 240.55,-754.7 193.5,-726.85"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~propagator_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1033.94,-592.72C1024.82,-563.47 998.02,-488.13 952,-442.85 757.11,-251.07 631.74,-290.97 358.5,-280.85"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M356.5,-280.85C313.02,-279.12 264.73,-292.72 232.07,-304.33"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="230.65,-301.12 222.46,-307.85 233.05,-307.69 230.65,-301.12"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~propagator_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-634.85C627.64,-602.8 370.77,-654.31 291,-602.85 238.34,-568.88 210.52,-495.63 199.4,-458.85"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="202.72,-457.74 196.58,-449.1 195.99,-459.68 202.72,-457.74"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~propagator_mod&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1022.33,-592.67C998.92,-573.87 953.82,-537.66 926.26,-515.53"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="928.31,-512.68 918.32,-509.15 923.92,-518.14 928.31,-512.68"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~propagator_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M1028.04,-617.01C1008.12,-641.4 959.07,-695.49 903,-712.85"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M901,-712.85C858.97,-725.87 760.42,-649.7 719,-634.85"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-634.85C675.2,-619.86 658.96,-632.17 620,-610.85 586.72,-592.64 556.39,-560.17 538.81,-539.08"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="541.32,-536.62 532.3,-531.08 535.89,-541.04 541.32,-536.62"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~propagator_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M901,-712.85C821.89,-737.35 801.74,-749.21 719,-752.85"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M717,-752.85C630.84,-756.64 606.31,-726.55 523,-748.85"/>
</g>
<!-- module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node17" class="node">
<title>module~centrifugal_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node17"><a xlink:href=".././module/centrifugal_matrix_mod.html" xlink:title="centrifugal_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="787.5,-724.85 648.5,-724.85 648.5,-700.85 787.5,-700.85 787.5,-724.85"/>
<text text-anchor="middle" x="718" y="-710.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">centrifugal_matrix_mod</text>
</a>
</g>
</g>
<!-- module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M901,-712.85C868.32,-722.97 830.72,-724.53 798.22,-722.96"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="798.04,-719.44 787.85,-722.35 797.63,-726.43 798.04,-719.44"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M315.84,-78.77C269.27,-65.18 198.69,-45.41 193.5,-48.85"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M312.59,-102.99C304.78,-106.55 297.17,-111.09 291,-116.85 236.14,-168.01 208.75,-256.5 198.46,-297.64"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="195.03,-296.93 196.11,-307.47 201.84,-298.56 195.03,-296.93"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M339.12,-102.97C323.96,-114.51 302.61,-133.3 291,-154.85 251.07,-228.98 286.27,-262.67 255,-340.85 243.71,-369.09 223.81,-398.02 209.71,-416.63"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="206.85,-414.6 203.5,-424.66 212.39,-418.89 206.85,-414.6"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M690.83,-382.68C664.24,-370.55 621.71,-351.76 584,-337.85 557.36,-328.02 546.57,-334.69 523,-318.85"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M521,-318.85C464.42,-280.83 473.14,-75.09 424,-27.85 402.15,-6.84 387.53,-17.58 358.5,-8.85"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M521,-318.85C490.22,-298.17 395.56,-282.22 358.5,-280.85"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M661.41,-406.89C604.08,-419.3 523,-436.85 523,-436.85"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M521,-436.85C492.83,-429.42 481.34,-432.69 460,-412.85 432.92,-387.67 452.21,-361.75 424,-337.85 400.87,-318.26 387.42,-309.77 358.5,-318.85"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M641.15,-403.74C633.51,-406.78 626.27,-410.73 620,-415.85 589.18,-441.04 613.28,-470.89 584,-497.85 576.98,-504.31 567.88,-508.8 558.86,-511.91"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="557.79,-508.58 549.2,-514.78 559.78,-515.29 557.79,-508.58"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M641.41,-402.54C633.54,-405.77 626.17,-410.09 620,-415.85 563.64,-468.43 597.48,-729.02 523,-748.85"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M521,-748.85C493.32,-756.22 462.03,-757.43 434.36,-756.21"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="434.52,-752.71 424.34,-755.65 434.13,-759.7 434.52,-752.71"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M641.36,-406.83C633.93,-409.3 626.68,-412.27 620,-415.85 600.33,-426.4 602.58,-438.49 584,-450.85 578.65,-454.41 572.74,-457.65 566.76,-460.54"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="565.04,-457.48 557.39,-464.8 567.94,-463.85 565.04,-457.48"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node16" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="549,-370.85 495,-370.85 495,-346.85 549,-346.85 549,-370.85"/>
<text text-anchor="middle" x="522" y="-356.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M652.13,-382.81C621.34,-377.1 585.69,-370.48 559.66,-365.65"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="559.95,-362.15 549.48,-363.77 558.68,-369.03 559.95,-362.15"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M672.95,-81.54C633.29,-76.18 573.62,-66.72 523,-52.85"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M521,-52.85C448.84,-33.08 430.15,-30.4 358.5,-8.85"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M356.5,-8.85C285.07,12.63 255.65,-7.61 193.5,-48.85"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M191.5,-48.85C76.92,-124.88 53.76,-310.85 49.14,-375.37"/>
<polygon fill="#004eff" stroke="#004eff" points="45.63,-375.43 48.49,-385.63 52.61,-375.87 45.63,-375.43"/>
</g>
<!-- module~channels_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~channels_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M672.98,-96.38C615.74,-108.77 523,-128.85 523,-128.85"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M521,-128.85C448.9,-133.14 426.2,-105.67 358.5,-130.85"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M672.7,-91.14C655.49,-94.13 636.1,-99.22 620,-107.85 600.33,-118.4 601.92,-129.56 584,-142.85 464.49,-231.5 402.89,-206.75 291,-304.85 253.44,-337.78 221.6,-387.52 205.25,-415.6"/>
<polygon fill="#004eff" stroke="#004eff" points="202.06,-414.14 200.14,-424.56 208.13,-417.61 202.06,-414.14"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M672.6,-85.49C653.68,-87.37 633.02,-93.15 620,-107.85 562.3,-173.01 637.75,-429.4 584,-497.85 577.79,-505.76 568.43,-510.71 558.89,-513.79"/>
<polygon fill="#004eff" stroke="#004eff" points="557.8,-510.46 549.02,-516.38 559.58,-517.23 557.8,-510.46"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M864.17,-484.71C835.58,-475.28 795.78,-462.16 765.09,-452.04"/>
<polygon fill="#2700ff" stroke="#2700ff" points="766.06,-448.68 755.46,-448.87 763.87,-455.33 766.06,-448.68"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~pes_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M717,-596.85C673.5,-605.81 663.11,-610.16 620,-620.85 572.6,-632.6 235.44,-751.87 193.5,-726.85"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge47" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M870.05,-484.82C863.43,-481.12 856.95,-476.5 852,-470.85 821.71,-436.25 846.29,-408.45 816,-373.85 778.09,-330.54 412.45,-110.79 358.5,-130.85"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge48" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M717,-596.85C624,-615.27 374.06,-619.56 291,-573.85 244.61,-548.32 215.01,-490.2 201.7,-458.48"/>
<polygon fill="#2700ff" stroke="#2700ff" points="204.94,-457.15 197.95,-449.19 198.45,-459.77 204.94,-457.15"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge49" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M717,-596.85C652,-609.73 581.07,-564.59 545.7,-537.62"/>
<polygon fill="#2700ff" stroke="#2700ff" points="547.54,-534.61 537.5,-531.2 543.22,-540.12 547.54,-534.61"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge51" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M897.92,-509C889.86,-538.13 865.29,-612.27 816,-648.85 744.38,-702 699.15,-650.75 620,-691.85 600.74,-701.85 602.41,-713.35 584,-724.85 559.29,-740.29 551.15,-741.36 523,-748.85"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge50" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M886.67,-508.85C857.46,-532.32 787.96,-583.19 719,-596.85"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M717,-596.85C644.71,-611.17 649.17,-532.25 584,-497.85 580.53,-496.02 576.87,-494.3 573.14,-492.69"/>
<polygon fill="#2700ff" stroke="#2700ff" points="574.36,-489.41 563.77,-488.92 571.74,-495.9 574.36,-489.41"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge52" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M494.93,-527.97C483.79,-532.36 470.87,-538.14 460,-544.85 434.84,-560.38 383.49,-615.05 358.5,-630.85"/>
</g>
<!-- module~io_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge53" class="edge">
<title>module~io_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M494.87,-512.77C483.59,-509.43 470.59,-504.57 460,-497.85 440.63,-485.56 441.94,-475.15 424,-460.85 369.88,-417.71 350.03,-415.99 291,-379.85 267.73,-365.61 241.39,-349.39 221.95,-337.41"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="223.63,-334.33 213.28,-332.06 219.95,-340.29 223.63,-334.33"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge54" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M494.87,-514.54C451.92,-507.2 363.91,-491.08 291,-470.85 272.23,-465.64 251.82,-458.73 234.56,-452.5"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="235.38,-449.07 224.79,-448.92 232.98,-455.65 235.38,-449.07"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge56" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M512.26,-531.11C485.75,-568.31 406.01,-680.19 373.03,-726.47"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="370.04,-724.63 367.08,-734.81 375.74,-728.7 370.04,-724.63"/>
</g>
<!-- module~input_validation -->
<g id="program~~scattering~~UsesGraph_node18" class="node">
<title>module~input_validation</title>
<g id="a_program~~scattering~~UsesGraph_node18"><a xlink:href=".././module/input_validation.html" xlink:title="input_validation">
<polygon fill="#337ab7" stroke="#337ab7" points="406,-564.85 309,-564.85 309,-540.85 406,-540.85 406,-564.85"/>
<text text-anchor="middle" x="357.5" y="-550.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_validation</text>
</a>
</g>
</g>
<!-- module~io_mod&#45;&gt;module~input_validation -->
<g id="program~~scattering~~UsesGraph_edge55" class="edge">
<title>module~io_mod&#45;&gt;module~input_validation</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M494.89,-524.31C473.73,-528.74 443.12,-535.15 416.26,-540.77"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="415.25,-537.4 406.17,-542.88 416.68,-544.25 415.25,-537.4"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge57" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M642.59,-116.77C634.77,-114.33 627.09,-111.38 620,-107.85 601.1,-98.44 602.08,-87.76 584,-76.85 559.05,-61.8 551.1,-60.55 523,-52.85"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge59" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M619.73,-126.59C588.79,-126.48 554.44,-126.98 523,-128.85"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge60" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M699.75,-141C649.74,-175.54 499.29,-274.63 358.5,-318.85"/>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M356.5,-318.85C327.04,-326 317.03,-322.33 291,-337.85 256.61,-358.36 225.83,-393.88 208.44,-416.34"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="205.48,-414.44 202.24,-424.52 211.07,-418.66 205.48,-414.44"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge58" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M711.74,-140.94C696.45,-176.32 651.11,-282.96 620,-373.85 601.42,-428.15 623.57,-456.29 584,-497.85 577.31,-504.88 568.16,-509.56 558.98,-512.67"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="557.79,-509.37 549.12,-515.47 559.7,-516.1 557.79,-509.37"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge61" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M290.63,-750.76C259.24,-749.75 222.36,-744.14 193.5,-726.85"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge62" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473.26,-488.97C468.46,-491.41 463.92,-494.34 460,-497.85 432.15,-522.78 446.58,-544.06 424,-573.85 400.69,-604.61 391.12,-610.23 358.5,-630.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-630.85C320.97,-653.31 229.56,-748.46 193.5,-726.85"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge64" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.78,-469.37C404.68,-462.64 323.66,-452.75 265.47,-445.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="265.6,-442.13 255.25,-444.39 264.75,-449.08 265.6,-442.13"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node19" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node19"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-370.85 291,-370.85 291,-346.85 424,-346.85 424,-370.85"/>
<text text-anchor="middle" x="357.5" y="-356.45" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge63" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M481.91,-464.8C474.06,-461.17 466.31,-456.58 460,-450.85 435.26,-428.39 449.02,-407 424,-384.85 419.94,-381.25 415.31,-378.12 410.44,-375.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="412,-372.27 401.49,-370.94 408.88,-378.53 412,-372.27"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge65" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M692.23,-724.99C666.05,-737.13 623.2,-755.09 584,-762.85 413.03,-796.69 343,-816.45 193.5,-726.85"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge68" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M696.91,-700.81C622.53,-656.07 363.35,-498.68 291,-434.85 257.61,-405.39 225.54,-364.31 207.79,-340.05"/>
<polygon fill="#00ffff" stroke="#00ffff" points="210.61,-337.98 201.91,-331.93 204.94,-342.09 210.61,-337.98"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge66" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M694.24,-700.85C673.5,-689.25 642.74,-670.32 620,-648.85 584.28,-615.14 552.2,-567.01 535.39,-539.77"/>
<polygon fill="#00ffff" stroke="#00ffff" points="538.28,-537.79 530.1,-531.06 532.3,-541.42 538.28,-537.79"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge67" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M648.19,-722.98C610.85,-729.14 564.05,-737.92 523,-748.85"/>
</g>
<!-- module~input_validation&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge69" class="edge">
<title>module~input_validation&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M343.68,-564.86C330.28,-577.53 308.76,-598.2 291,-616.85 245.94,-664.15 249.54,-760.43 193.5,-726.85"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M191.5,-726.85C79.79,-659.9 54.84,-483 49.44,-420.28"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="52.9,-419.66 48.64,-409.96 45.92,-420.2 52.9,-419.66"/>
</g>
<!-- module~input_validation&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge70" class="edge">
<title>module~input_validation&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M341.54,-540.83C327.24,-528.8 305.75,-509.18 291,-488.85 269.76,-459.57 272.78,-447.35 255,-415.85 239.95,-389.19 220.63,-359.7 207.7,-340.53"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="210.43,-338.31 201.91,-332.01 204.63,-342.25 210.43,-338.31"/>
</g>
<!-- module~input_validation&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge71" class="edge">
<title>module~input_validation&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M319.31,-540.82C309.74,-537.01 299.7,-532.32 291,-526.85 259.64,-507.12 229.2,-476.65 210.9,-456.73"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="213.36,-454.23 204.06,-449.16 208.16,-458.92 213.36,-454.23"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="986pt"
 viewBox="0.00 0.00 641.00 985.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(1.93 1.93) rotate(0) translate(4 1898)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1898 1233,-1898 1233,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-856 0,-856 0,-832 79,-832 79,-856"/>
<text text-anchor="middle" x="39.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="800.5,-740 718.5,-740 718.5,-716 800.5,-716 800.5,-740"/>
<text text-anchor="middle" x="759.5" y="-725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M42.81,-831.68C48.91,-802.88 68.29,-731.03 115,-697 160.32,-663.99 568.1,-631.44 618,-657 642.37,-669.48 630.98,-692.16 654,-707 670.08,-717.36 690.21,-722.78 708.5,-725.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="708.06,-729.03 718.43,-726.84 708.96,-722.09 708.06,-729.03"/>
</g>
<!-- proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~save_s_matrix_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/save_s_matrix_file_header.html" xlink:title="save_s_matrix_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="299.5,-1142 146.5,-1142 146.5,-1118 299.5,-1118 299.5,-1142"/>
<text text-anchor="middle" x="223" y="-1127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_file_header</title>
<path fill="none" stroke="#ff0000" d="M42.21,-856.13C49.11,-903.26 76.37,-1073.35 115,-1109 121.35,-1114.86 128.84,-1119.3 136.85,-1122.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.88,-1126 146.47,-1126.06 138.23,-1119.41 135.88,-1126"/>
</g>
<!-- proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~interpolate_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/interpolate_radial_coupling_terms.html" xlink:title="interpolate_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="589.5,-1018 395.5,-1018 395.5,-994 589.5,-994 589.5,-1018"/>
<text text-anchor="middle" x="492.5" y="-1003.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M42.96,-856.28C49.27,-884.24 68.92,-952.48 115,-982 158.24,-1009.7 289.74,-1012.47 385.17,-1010.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="385.53,-1013.95 395.45,-1010.22 385.37,-1006.95 385.53,-1013.95"/>
</g>
<!-- proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~save_partial_xs_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/save_partial_xs_file_header.html" xlink:title="save_partial_xs_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-1058 143.5,-1058 143.5,-1034 302.5,-1034 302.5,-1058"/>
<text text-anchor="middle" x="223" y="-1043.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_file_header</title>
<path fill="none" stroke="#ff0000" d="M41.96,-856.45C46.41,-888.75 62.91,-975.74 115,-1020 120.66,-1024.81 127.06,-1028.76 133.86,-1031.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.76,-1035.33 143.33,-1035.98 135.47,-1028.88 132.76,-1035.33"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="274,-570 172,-570 172,-546 274,-546 274,-570"/>
<text text-anchor="middle" x="223" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M42.21,-831.87C49.11,-784.74 76.37,-614.65 115,-579 127.73,-567.25 145.04,-561.22 162.02,-558.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.52,-561.78 171.95,-556.95 161.57,-554.85 162.52,-561.78"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1063,-1287 939,-1287 939,-1263 1063,-1263 1063,-1287"/>
<text text-anchor="middle" x="1001" y="-1272.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.28,-856.26C45.26,-915.53 65.18,-1171.88 115,-1231 223.68,-1359.96 701.39,-1387.9 865,-1347 906.49,-1336.63 949.2,-1310.82 975.17,-1293.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="977.43,-1295.79 983.63,-1287.2 973.43,-1290.05 977.43,-1295.79"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-730 167,-730 167,-706 279,-706 279,-730"/>
<text text-anchor="middle" x="223" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M45.38,-831.96C55.07,-809.71 78.96,-762.29 115,-739 127.4,-730.99 142.18,-725.9 156.73,-722.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.58,-726.12 166.74,-720.8 156.26,-719.24 157.58,-726.12"/>
</g>
<!-- proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~calculate_state_to_state_cross_section</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/calculate_state_to_state_cross_section.html" xlink:title="calculate_state_to_state_cross_section">
<polygon fill="#d9534f" stroke="#d9534f" points="331,-1894 115,-1894 115,-1870 331,-1870 331,-1894"/>
<text text-anchor="middle" x="223" y="-1879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_state_to_state_cross_section</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section</title>
<path fill="none" stroke="#ff0000" d="M40.51,-856.15C40.76,-965.78 44.92,-1781.91 115,-1861 115.75,-1861.85 116.53,-1862.67 117.33,-1863.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="115.14,-1866.2 125.07,-1869.9 119.61,-1860.81 115.14,-1866.2"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="250,-528 196,-528 196,-504 250,-504 250,-528"/>
<text text-anchor="middle" x="223" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M41.73,-831.77C47.18,-779.95 70.91,-579.18 115,-537 133.51,-519.3 162.33,-514.44 185.4,-513.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.55,-517.29 195.54,-513.76 185.53,-510.29 185.55,-517.29"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="834,-698 685,-698 685,-674 834,-674 834,-698"/>
<text text-anchor="middle" x="759.5" y="-683.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M41.26,-831.81C44.11,-797.62 57.16,-700.24 115,-654 190.86,-593.36 246.64,-669.11 331,-621 352.95,-608.48 344.17,-587.82 367,-577 417.4,-553.11 571.69,-545.91 618,-577 653.08,-600.55 621.42,-638.09 654,-665 660.34,-670.24 667.63,-674.29 675.34,-677.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="674.33,-680.76 684.93,-680.77 676.65,-674.16 674.33,-680.76"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-772 177.5,-772 177.5,-748 268.5,-748 268.5,-772"/>
<text text-anchor="middle" x="223" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M51.05,-831.92C64.42,-817.44 88.89,-793.54 115,-781 131.19,-773.22 150.08,-768.32 167.44,-765.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.14,-768.67 177.45,-763.63 167.02,-761.76 168.14,-768.67"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="270,-486 176,-486 176,-462 270,-462 270,-486"/>
<text text-anchor="middle" x="223" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M41.35,-831.66C45.5,-775.4 65.42,-543.77 115,-495 128.38,-481.84 147.44,-475.72 165.78,-473.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.28,-476.63 175.86,-472.09 165.54,-469.67 166.28,-476.63"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="312,-814 134,-814 134,-790 312,-790 312,-814"/>
<text text-anchor="middle" x="223" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M79.01,-832.5C90.54,-829.24 103.24,-825.81 115,-823 125.05,-820.6 135.67,-818.27 146.17,-816.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="147.08,-819.48 156.18,-814.05 145.68,-812.62 147.08,-819.48"/>
</g>
<!-- proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~prepare_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/prepare_pes_matrix_elements.html" xlink:title="prepare_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="309,-444 137,-444 137,-420 309,-420 309,-444"/>
<text text-anchor="middle" x="223" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.04,-831.83C43.96,-771.87 59.82,-508.49 115,-453 118.78,-449.2 123.04,-445.98 127.62,-443.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="129.43,-446.27 136.78,-438.63 126.28,-440.02 129.43,-446.27"/>
</g>
<!-- proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~print_pes_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/print_pes_matrix_elements_summary.html" xlink:title="print_pes_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="865,-1456 654,-1456 654,-1432 865,-1432 865,-1456"/>
<text text-anchor="middle" x="759.5" y="-1441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_pes_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M41.19,-856.2C45.75,-935.15 72.8,-1371.55 115,-1411 188.89,-1480.08 479.49,-1468.03 643.77,-1455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="644.23,-1458.47 653.92,-1454.18 643.67,-1451.5 644.23,-1458.47"/>
</g>
<!-- proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~check_cross_section_thresholds</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/check_cross_section_thresholds.html" xlink:title="check_cross_section_thresholds">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-402 133,-402 133,-378 313,-378 313,-402"/>
<text text-anchor="middle" x="223" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cross_section_thresholds</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~check_cross_section_thresholds</title>
<path fill="none" stroke="#ff0000" d="M40.8,-831.83C42.61,-768.07 54.24,-473.2 115,-411 117.74,-408.19 120.74,-405.71 123.93,-403.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="125.95,-406.37 132.81,-398.3 122.42,-400.33 125.95,-406.37"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-360 122.5,-360 122.5,-336 323.5,-336 323.5,-360"/>
<text text-anchor="middle" x="223" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.6,-831.56C41.41,-763.61 48.72,-437.86 115,-369 115.92,-368.04 116.88,-367.12 117.86,-366.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="120.05,-368.96 125.88,-360.11 115.81,-363.39 120.05,-368.96"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1229,-1435 1137,-1435 1137,-1411 1229,-1411 1229,-1435"/>
<text text-anchor="middle" x="1183" y="-1420.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M41.1,-856.22C45.21,-938.28 70.55,-1406.96 115,-1450 235.7,-1566.87 323.49,-1484 491.5,-1484 491.5,-1484 491.5,-1484 760.5,-1484 912.77,-1484 951.58,-1475.34 1101,-1446 1111.98,-1443.84 1123.64,-1440.92 1134.59,-1437.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1135.75,-1441.19 1144.4,-1435.08 1133.83,-1434.46 1135.75,-1441.19"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-1574 176,-1574 176,-1550 270,-1550 270,-1574"/>
<text text-anchor="middle" x="223" y="-1559.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.45,-856.18C40.32,-936.13 42.87,-1386.1 115,-1498 129.26,-1520.13 154.13,-1535.68 176.3,-1545.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.03,-1549.17 185.59,-1549.96 177.83,-1542.75 175.03,-1549.17"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="267.5,-318 178.5,-318 178.5,-294 267.5,-294 267.5,-318"/>
<text text-anchor="middle" x="223" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.43,-831.89C40.26,-761.22 42.99,-402.75 115,-327 128.66,-312.63 149.06,-306.5 168.39,-304.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.68,-307.77 178.36,-303.45 168.1,-300.79 168.68,-307.77"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="311.5,-940 134.5,-940 134.5,-916 311.5,-916 311.5,-940"/>
<text text-anchor="middle" x="223" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M51.05,-856.08C64.42,-870.56 88.89,-894.46 115,-907 119.41,-909.12 124.01,-911.02 128.74,-912.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.97,-916.17 138.56,-915.98 130.17,-909.52 127.97,-916.17"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1055.5,-1652 946.5,-1652 946.5,-1628 1055.5,-1628 1055.5,-1652"/>
<text text-anchor="middle" x="1001" y="-1637.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.58,-856.18C41.4,-957.94 49.42,-1664.27 115,-1728 174.77,-1786.09 795.21,-1788.58 865,-1743 898.32,-1721.24 870.13,-1686.12 901,-1661 911.15,-1652.74 923.78,-1647.51 936.59,-1644.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="937.35,-1647.66 946.37,-1642.11 935.86,-1640.82 937.35,-1647.66"/>
</g>
<!-- proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~save_partial_xs_single_block</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/save_partial_xs_single_block.html" xlink:title="save_partial_xs_single_block">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-1418 410.5,-1418 410.5,-1394 574.5,-1394 574.5,-1418"/>
<text text-anchor="middle" x="492.5" y="-1403.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_single_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_single_block</title>
<path fill="none" stroke="#ff0000" d="M40.22,-856.22C38.84,-929.12 35.66,-1305.97 115,-1380 154.85,-1417.18 301.9,-1417.02 400,-1412.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="400.41,-1415.83 410.23,-1411.83 400.06,-1408.84 400.41,-1415.83"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-1222 177.5,-1222 177.5,-1198 268.5,-1198 268.5,-1222"/>
<text text-anchor="middle" x="223" y="-1207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M41.48,-856.34C46.13,-911.59 67.69,-1135.6 115,-1184 128.65,-1197.96 148.44,-1204.92 167.3,-1208.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.94,-1211.73 177.34,-1209.7 167.94,-1204.8 166.94,-1211.73"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-1833 429,-1833 429,-1809 556,-1809 556,-1833"/>
<text text-anchor="middle" x="492.5" y="-1818.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.56,-856.14C41.19,-960.66 48.06,-1706.38 115,-1776 135.64,-1797.47 315.26,-1811.07 418.76,-1817.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="418.65,-1820.7 428.84,-1817.79 419.06,-1813.71 418.65,-1820.7"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295.5,-276 150.5,-276 150.5,-252 295.5,-252 295.5,-276"/>
<text text-anchor="middle" x="223" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.28,-831.89C39.22,-757.92 37.36,-367.55 115,-285 122.05,-277.5 130.94,-272.24 140.55,-268.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.9,-271.85 150.38,-265.49 139.79,-265.18 141.9,-271.85"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-234 151,-234 151,-210 295,-210 295,-234"/>
<text text-anchor="middle" x="223" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M41.16,-831.93C45.67,-750.89 73.16,-287.9 115,-243 122.19,-235.29 131.31,-229.93 141.19,-226.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.35,-229.59 150.86,-223.28 140.27,-222.91 142.35,-229.59"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-612 167,-612 167,-588 279,-588 279,-612"/>
<text text-anchor="middle" x="223" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.8,-831.96C42.38,-795.15 52.38,-683.17 115,-626 126.58,-615.43 141.73,-608.96 156.96,-605.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.95,-608.42 166.95,-602.84 156.43,-601.59 157.95,-608.42"/>
</g>
<!-- proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~print_largest_partial_cross_sections</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/print_largest_partial_cross_sections.html" xlink:title="print_largest_partial_cross_sections">
<polygon fill="#d9534f" stroke="#d9534f" points="1101,-1694 901,-1694 901,-1670 1101,-1670 1101,-1694"/>
<text text-anchor="middle" x="1001" y="-1679.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_cross_sections</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_cross_sections</title>
<path fill="none" stroke="#ff0000" d="M40.93,-856.03C44.31,-946.9 67.52,-1523.66 115,-1583 209.36,-1700.95 675.27,-1696.52 890.56,-1687.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="890.78,-1691.31 900.62,-1687.39 890.48,-1684.31 890.78,-1691.31"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="294.5,-856 151.5,-856 151.5,-832 294.5,-832 294.5,-856"/>
<text text-anchor="middle" x="223" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M79.44,-844C97.51,-844 119.71,-844 141.16,-844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.27,-847.5 151.27,-844 141.27,-840.5 141.27,-847.5"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-1140 455.5,-1140 455.5,-1116 529.5,-1116 529.5,-1140"/>
<text text-anchor="middle" x="492.5" y="-1125.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M41.5,-856.1C46.08,-908.3 66.93,-1113.2 115,-1151 203.07,-1220.25 256.23,-1161.79 367,-1145 392.83,-1141.08 421.75,-1137.11 445.2,-1133.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.78,-1137.45 455.23,-1132.67 444.86,-1130.51 445.78,-1137.45"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="269.5,-192 176.5,-192 176.5,-168 269.5,-168 269.5,-192"/>
<text text-anchor="middle" x="223" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M41.05,-831.91C45.03,-747.59 70.32,-249.33 115,-201 128.02,-186.92 147.49,-180.69 166.26,-178.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.65,-181.79 176.28,-177.38 165.99,-174.82 166.65,-181.79"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="267,-150 179,-150 179,-126 267,-126 267,-150"/>
<text text-anchor="middle" x="223" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.96,-831.97C44.42,-744.72 67.47,-210.77 115,-159 128.57,-144.21 149.26,-138.07 168.83,-135.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="169.22,-139.43 178.92,-135.19 168.69,-132.45 169.22,-139.43"/>
</g>
<!-- proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~read_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/read_radial_coupling_terms.html" xlink:title="read_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-1100 143,-1100 143,-1076 303,-1076 303,-1100"/>
<text text-anchor="middle" x="223" y="-1085.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~read_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.58,-856.17C41.53,-893.89 49.85,-1009.73 115,-1067 120.52,-1071.85 126.83,-1075.72 133.57,-1078.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.38,-1082.08 142.97,-1082.48 134.95,-1075.57 132.38,-1082.08"/>
</g>
<!-- proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~reduce_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/reduce_radial_coupling_terms.html" xlink:title="reduce_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="845.5,-1734 673.5,-1734 673.5,-1710 845.5,-1710 845.5,-1734"/>
<text text-anchor="middle" x="759.5" y="-1719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduce_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~reduce_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.61,-856.12C41.61,-955.88 50.81,-1639.1 115,-1700 153.77,-1736.78 493.65,-1730.89 663.18,-1725.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="663.47,-1729.04 673.35,-1725.23 663.25,-1722.05 663.47,-1729.04"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="292,-898 154,-898 154,-874 292,-874 292,-898"/>
<text text-anchor="middle" x="223" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M79.01,-855.5C90.54,-858.76 103.24,-862.19 115,-865 125.05,-867.4 135.67,-869.73 146.17,-871.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="145.68,-875.38 156.18,-873.95 147.08,-868.52 145.68,-875.38"/>
</g>
<!-- proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~check_nonzero_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/check_nonzero_pes_matrix_elements.html" xlink:title="check_nonzero_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-108 117.5,-108 117.5,-84 328.5,-84 328.5,-108"/>
<text text-anchor="middle" x="223" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.89,-831.82C43.89,-741.07 64.66,-172.18 115,-117 115.77,-116.16 116.55,-115.35 117.36,-114.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="119.63,-117.23 125.19,-108.21 115.22,-111.8 119.63,-117.23"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="260,-66 186,-66 186,-42 260,-42 260,-66"/>
<text text-anchor="middle" x="223" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M40.82,-831.73C43.38,-737.7 61.83,-133.61 115,-75 130.15,-58.3 154.38,-52.59 175.94,-51.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.06,-54.76 185.95,-50.94 175.84,-47.77 176.06,-54.76"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="253,-1852 193,-1852 193,-1828 253,-1828 253,-1852"/>
<text text-anchor="middle" x="223" y="-1837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M40.59,-856.24C41.44,-963.22 49.84,-1737.35 115,-1814 131.32,-1833.2 159.2,-1839.52 182.41,-1841.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.55,-1844.64 192.69,-1841.57 182.85,-1837.65 182.55,-1844.64"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="786.5,-980 732.5,-980 732.5,-956 786.5,-956 786.5,-980"/>
<text text-anchor="middle" x="759.5" y="-965.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M44.91,-856.25C53.94,-879.3 76.97,-928.64 115,-949 168.49,-977.64 594.23,-971.36 722.23,-968.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="722.37,-972.3 732.3,-968.59 722.23,-965.3 722.37,-972.3"/>
</g>
<!-- proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~save_s_matrix_block_info</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/save_s_matrix_block_info.html" xlink:title="save_s_matrix_block_info">
<polygon fill="#d9534f" stroke="#d9534f" points="296.5,-24 149.5,-24 149.5,0 296.5,0 296.5,-24"/>
<text text-anchor="middle" x="223" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_block_info</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_block_info</title>
<path fill="none" stroke="#ff0000" d="M40.75,-831.99C42.85,-735.96 58.92,-95.12 115,-33 121.75,-25.52 130.33,-20.24 139.67,-16.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="140.83,-19.87 149.24,-13.42 138.64,-13.23 140.83,-19.87"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M800.51,-730.06C873.22,-736.15 1026.38,-760.17 1101,-855 1169.51,-942.07 1180.12,-1306.72 1181.72,-1400.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1178.22,-1400.93 1181.88,-1410.88 1185.22,-1400.83 1178.22,-1400.93"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1036,-991 966,-991 966,-967 1036,-967 1036,-991"/>
<text text-anchor="middle" x="1001" y="-976.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M800.59,-730.65C821.47,-733.73 846.44,-740.26 865,-754 866.19,-754.88 954.54,-902.82 987.65,-958.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="984.69,-960.16 992.82,-966.96 990.7,-956.58 984.69,-960.16"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1048,-1228 954,-1228 954,-1204 1048,-1204 1048,-1228"/>
<text text-anchor="middle" x="1001" y="-1213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff0000" d="M800.7,-727.7C822.81,-729.77 848.93,-736.27 865,-754 939.19,-835.89 869.66,-894.04 901,-1000 923.12,-1074.8 966.58,-1156.96 987.78,-1194.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="984.93,-1196.85 992.9,-1203.83 991.02,-1193.4 984.93,-1196.85"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="533,-1098 452,-1098 452,-1074 533,-1074 533,-1098"/>
<text text-anchor="middle" x="492.5" y="-1083.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff2500" d="M297.1,-1117.98C343.01,-1110.42 401.03,-1100.88 441.69,-1094.19"/>
<polygon fill="#ff2500" stroke="#ff2500" points="442.33,-1097.63 451.63,-1092.56 441.2,-1090.73 442.33,-1097.63"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-1060 732.5,-1060 732.5,-1036 786.5,-1036 786.5,-1060"/>
<text text-anchor="middle" x="759.5" y="-1045.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline</title>
<path fill="none" stroke="#ff4a00" d="M569.44,-1018.04C619.59,-1025.98 683.06,-1036.04 722.21,-1042.25"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="721.91,-1045.74 732.34,-1043.85 723.01,-1038.83 721.91,-1045.74"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff6f00" d="M302.58,-1048.34C382.17,-1051.06 508.77,-1056.31 618,-1065 634.05,-1066.28 637.97,-1067.52 654,-1069 703.59,-1073.58 1062.87,-1069.97 1101,-1102 1147.49,-1141.05 1172.41,-1334.29 1179.7,-1400.61"/>
<polygon fill="#ff6f00" stroke="#ff6f00" points="1176.25,-1401.22 1180.79,-1410.79 1183.21,-1400.47 1176.25,-1401.22"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff6f00" d="M302.81,-1057.78C347.8,-1064.51 402.82,-1072.74 441.82,-1078.57"/>
<polygon fill="#ff6f00" stroke="#ff6f00" points="441.46,-1082.06 451.87,-1080.07 442.5,-1075.13 441.46,-1082.06"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-732 465.5,-732 465.5,-708 519.5,-708 519.5,-732"/>
<text text-anchor="middle" x="492.5" y="-717.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#ffdf00" d="M279.1,-718.41C331.77,-718.81 409.69,-719.39 455.05,-719.73"/>
<polygon fill="#ffdf00" stroke="#ffdf00" points="455.28,-723.23 465.3,-719.8 455.33,-716.23 455.28,-723.23"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="540.5,-854 444.5,-854 444.5,-830 540.5,-830 540.5,-854"/>
<text text-anchor="middle" x="492.5" y="-839.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#ffdf00" d="M279.14,-718.83C297.25,-721.55 316.45,-727.34 331,-739 362.06,-763.89 335.61,-796.53 367,-821 385.9,-835.73 411.36,-841.71 434.33,-843.73"/>
<polygon fill="#ffdf00" stroke="#ffdf00" points="434.14,-847.22 444.34,-844.38 434.59,-840.24 434.14,-847.22"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-690 422.5,-690 422.5,-666 562.5,-666 562.5,-690"/>
<text text-anchor="middle" x="492.5" y="-675.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#ffdf00" d="M279.1,-709.76C317.47,-704.02 369.24,-696.28 412.06,-689.88"/>
<polygon fill="#ffdf00" stroke="#ffdf00" points="412.8,-693.31 422.17,-688.37 411.77,-686.38 412.8,-693.31"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="519.5,-938 465.5,-938 465.5,-914 519.5,-914 519.5,-938"/>
<text text-anchor="middle" x="492.5" y="-923.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ffdf00" d="M279.16,-717.05C297.81,-719.52 317.35,-725.61 331,-739 384.91,-791.85 312.39,-852.87 367,-905 390.2,-927.14 427.55,-930.84 455.29,-929.93"/>
<polygon fill="#ffdf00" stroke="#ffdf00" points="455.61,-933.42 465.41,-929.39 455.23,-926.43 455.61,-933.42"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="539,-812 446,-812 446,-788 539,-788 539,-812"/>
<text text-anchor="middle" x="492.5" y="-797.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#ffdf00" d="M279.13,-726.97C295.93,-730.2 314.35,-734.24 331,-739 374.38,-751.4 422.56,-770.46 454.71,-783.97"/>
<polygon fill="#ffdf00" stroke="#ffdf00" points="453.57,-787.29 464.15,-787.97 456.31,-780.85 453.57,-787.29"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-610 465.5,-610 465.5,-586 519.5,-586 519.5,-610"/>
<text text-anchor="middle" x="492.5" y="-595.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ffdf00" d="M251.12,-705.83C299.86,-683.97 402.22,-638.05 456.3,-613.79"/>
<polygon fill="#ffdf00" stroke="#ffdf00" points="457.8,-616.95 465.49,-609.67 454.94,-610.57 457.8,-616.95"/>
</g>
<!-- proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~wavenumber_squared_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/wavenumber_squared_from_energy.html" xlink:title="wavenumber_squared_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="594,-896 391,-896 391,-872 594,-872 594,-896"/>
<text text-anchor="middle" x="492.5" y="-881.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_squared_from_energy</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ffdf00" d="M279.22,-717.65C297.65,-720.22 317.03,-726.22 331,-739 373.34,-777.74 324.15,-824.83 367,-863 371.51,-867.02 376.49,-870.41 381.79,-873.27"/>
<polygon fill="#ffdf00" stroke="#ffdf00" points="380.44,-876.51 390.98,-877.6 383.42,-870.17 380.44,-876.51"/>
</g>
<!-- proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#f8ff00" d="M288.05,-1869.98C302.22,-1867.16 317.14,-1864.08 331,-1861 366.03,-1853.2 405.11,-1843.49 435.94,-1835.58"/>
<polygon fill="#f8ff00" stroke="#f8ff00" points="436.83,-1838.97 445.64,-1833.08 435.08,-1832.19 436.83,-1838.97"/>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#aeff00" d="M834.17,-691.95C845.25,-695.26 855.97,-700.07 865,-707 949.75,-771.99 984.91,-904.46 995.89,-956.91"/>
<polygon fill="#aeff00" stroke="#aeff00" points="992.48,-957.71 997.88,-966.83 999.35,-956.34 992.48,-957.71"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#88ff00" d="M268.56,-764.32C360.36,-772.22 566.29,-784.45 618,-741 673.8,-694.11 597.08,-626.53 654,-581 809.13,-456.89 953.95,-447.42 1101,-581 1163.52,-637.79 1179.09,-1272.5 1181.6,-1400.56"/>
<polygon fill="#88ff00" stroke="#88ff00" points="1178.1,-1400.81 1181.79,-1410.74 1185.1,-1400.68 1178.1,-1400.81"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#88ff00" d="M268.59,-758.52C289.89,-760.14 314.31,-765.73 331,-781 373.34,-819.74 324.15,-866.83 367,-905 390.88,-926.27 427.96,-930.12 455.45,-929.49"/>
<polygon fill="#88ff00" stroke="#88ff00" points="455.63,-932.99 465.47,-929.06 455.33,-925.99 455.63,-932.99"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#88ff00" d="M268.56,-759.55C289.47,-761.48 313.57,-767.03 331,-781 362.06,-805.89 335.61,-838.53 367,-863 371.48,-866.5 376.34,-869.5 381.44,-872.07"/>
<polygon fill="#88ff00" stroke="#88ff00" points="380.31,-875.4 390.87,-876.26 383.15,-869 380.31,-875.4"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#3eff00" d="M312.15,-811.85C318.91,-814.78 325.31,-818.44 331,-823 362.06,-847.89 335.61,-880.53 367,-905 391.88,-924.39 428.12,-928.62 455.1,-928.6"/>
<polygon fill="#3eff00" stroke="#3eff00" points="455.38,-932.1 465.3,-928.4 455.23,-925.1 455.38,-932.1"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#3eff00" d="M311.01,-814.03C317.99,-816.49 324.74,-819.45 331,-823 351.8,-834.8 346.04,-851.48 367,-863 371.57,-865.51 376.36,-867.73 381.29,-869.7"/>
<polygon fill="#3eff00" stroke="#3eff00" points="380.34,-873.08 390.94,-873.19 382.72,-866.5 380.34,-873.08"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff0c" d="M781.76,-1431.92C803.19,-1419.53 837.01,-1399.37 865,-1380 905.98,-1351.64 951.25,-1315.34 977.58,-1293.69"/>
<polygon fill="#00ff0c" stroke="#00ff0c" points="979.94,-1296.28 985.43,-1287.21 975.49,-1290.88 979.94,-1296.28"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff0c" d="M865.23,-1438.78C948.09,-1434.65 1060.5,-1429.05 1126.73,-1425.75"/>
<polygon fill="#00ff0c" stroke="#00ff0c" points="1127.14,-1429.24 1136.96,-1425.24 1126.79,-1422.25 1127.14,-1429.24"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffa1" d="M270.24,-1554.16C298.18,-1549.69 334.55,-1544.33 367,-1541 529.54,-1524.34 950.68,-1562.04 1101,-1498 1128.43,-1486.32 1152.43,-1461.14 1167.04,-1443.18"/>
<polygon fill="#00ffa1" stroke="#00ffa1" points="1170.01,-1445.07 1173.43,-1435.04 1164.51,-1440.74 1170.01,-1445.07"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="618,-1658 367,-1658 367,-1634 618,-1634 618,-1658"/>
<text text-anchor="middle" x="492.5" y="-1643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#00ffa1" d="M246.61,-1574.07C274.26,-1588.33 322.82,-1611.77 367,-1625 375.56,-1627.56 384.55,-1629.84 393.61,-1631.86"/>
<polygon fill="#00ffa1" stroke="#00ffa1" points="392.95,-1635.3 403.46,-1633.96 394.41,-1628.46 392.95,-1635.3"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="588.5,-1574 396.5,-1574 396.5,-1550 588.5,-1550 588.5,-1574"/>
<text text-anchor="middle" x="492.5" y="-1559.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#00ffa1" d="M270.29,-1562C302.2,-1562 345.94,-1562 386.11,-1562"/>
<polygon fill="#00ffa1" stroke="#00ffa1" points="386.24,-1565.5 396.24,-1562 386.24,-1558.5 386.24,-1565.5"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="589,-1616 396,-1616 396,-1592 589,-1592 589,-1616"/>
<text text-anchor="middle" x="492.5" y="-1601.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#00ffa1" d="M270.29,-1569.27C307.27,-1575.07 360.13,-1583.37 404.91,-1590.4"/>
<polygon fill="#00ffa1" stroke="#00ffa1" points="404.5,-1593.88 414.92,-1591.98 405.58,-1586.97 404.5,-1593.88"/>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ffec" d="M311.59,-927.35C360.41,-926.98 418.57,-926.55 455.27,-926.27"/>
<polygon fill="#00ffec" stroke="#00ffec" points="455.51,-929.77 465.49,-926.19 455.46,-922.77 455.51,-929.77"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00c7ff" d="M574.5,-1408C716.12,-1411.5 1005.16,-1418.63 1126.46,-1421.63"/>
<polygon fill="#00c7ff" stroke="#00c7ff" points="1126.54,-1425.13 1136.63,-1421.88 1126.72,-1418.13 1126.54,-1425.13"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00c7ff" d="M509.72,-1393.93C537.13,-1372.54 592.16,-1325.08 618,-1271 665.26,-1172.09 591.96,-1117.37 654,-1027 670.3,-1003.25 699.47,-987.95 722.86,-978.89"/>
<polygon fill="#00c7ff" stroke="#00c7ff" points="724.28,-982.1 732.47,-975.39 721.88,-975.52 724.28,-982.1"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#00a1ff" d="M268.54,-1203.87C288.39,-1199.98 311.62,-1193.76 331,-1184 349.6,-1174.63 348.25,-1163.06 367,-1154 391.44,-1142.19 421.12,-1135.72 445.37,-1132.19"/>
<polygon fill="#00a1ff" stroke="#00a1ff" points="445.95,-1135.65 455.4,-1130.86 445.02,-1128.71 445.95,-1135.65"/>
</g>
<!-- proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~check_namelist_input</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/check_namelist_input.html" xlink:title="check_namelist_input">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1140 696,-1140 696,-1116 823,-1116 823,-1140"/>
<text text-anchor="middle" x="759.5" y="-1125.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_input</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_input</title>
<path fill="none" stroke="#00a1ff" d="M268.75,-1202.69C296.93,-1198.11 334.08,-1192.13 367,-1187 426.94,-1177.66 590.33,-1153.15 686.03,-1138.83"/>
<polygon fill="#00a1ff" stroke="#00a1ff" points="686.55,-1142.29 695.93,-1137.35 685.52,-1135.37 686.55,-1142.29"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00a1ff" d="M252.64,-1197.87C275.32,-1187.45 307.04,-1170.96 331,-1151 350.41,-1134.83 345.15,-1119.69 367,-1107 389.47,-1093.95 417.84,-1088.48 441.81,-1086.37"/>
<polygon fill="#00a1ff" stroke="#00a1ff" points="442.06,-1089.87 451.79,-1085.66 441.56,-1082.88 442.06,-1089.87"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-1262 455.5,-1262 455.5,-1238 529.5,-1238 529.5,-1262"/>
<text text-anchor="middle" x="492.5" y="-1247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#00a1ff" d="M268.77,-1216.7C317.65,-1224 395.54,-1235.65 445.06,-1243.06"/>
<polygon fill="#00a1ff" stroke="#00a1ff" points="444.77,-1246.55 455.18,-1244.57 445.81,-1239.63 444.77,-1246.55"/>
</g>
<!-- proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>proc~check_namelist_potential</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././proc/check_namelist_potential.html" xlink:title="check_namelist_potential">
<polygon fill="#d9534f" stroke="#d9534f" points="833.5,-1296 685.5,-1296 685.5,-1272 833.5,-1272 833.5,-1296"/>
<text text-anchor="middle" x="759.5" y="-1281.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_potential</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_potential</title>
<path fill="none" stroke="#00a1ff" d="M245.45,-1222.15C272.7,-1236.87 321.68,-1260.95 367,-1271 471.42,-1294.15 595.3,-1293.76 675.32,-1290.02"/>
<polygon fill="#00a1ff" stroke="#00a1ff" points="675.53,-1293.52 685.34,-1289.52 675.18,-1286.52 675.53,-1293.52"/>
</g>
<!-- proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~check_namelist_basis</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/check_namelist_basis.html" xlink:title="check_namelist_basis">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1338 696,-1338 696,-1314 823,-1314 823,-1338"/>
<text text-anchor="middle" x="759.5" y="-1323.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_basis</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_basis</title>
<path fill="none" stroke="#00a1ff" d="M239.15,-1222.25C264.08,-1241.64 316.08,-1278.82 367,-1295 473.96,-1328.99 605.24,-1332.08 685.34,-1329.96"/>
<polygon fill="#00a1ff" stroke="#00a1ff" points="685.92,-1333.45 695.81,-1329.65 685.71,-1326.45 685.92,-1333.45"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1220 445,-1220 445,-1196 540,-1196 540,-1220"/>
<text text-anchor="middle" x="492.5" y="-1205.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#00a1ff" d="M268.77,-1209.67C314.32,-1209.32 385.05,-1208.8 434.56,-1208.43"/>
<polygon fill="#00a1ff" stroke="#00a1ff" points="434.81,-1211.92 444.78,-1208.35 434.75,-1204.92 434.81,-1211.92"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#007cff" d="M553.88,-1833.04C674.54,-1853.31 947.02,-1879.47 1101,-1740 1145.37,-1699.81 1171.59,-1510.86 1179.47,-1445.39"/>
<polygon fill="#007cff" stroke="#007cff" points="1182.96,-1445.66 1180.65,-1435.32 1176.01,-1444.85 1182.96,-1445.66"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="565,-530 420,-530 420,-506 565,-506 565,-530"/>
<text text-anchor="middle" x="492.5" y="-515.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#000cff" d="M279.1,-595.38C296.43,-592.34 315.15,-587.3 331,-579 350.77,-568.64 347.3,-554.47 367,-544 380.27,-536.94 395.3,-531.8 410.19,-528.05"/>
<polygon fill="#000cff" stroke="#000cff" points="411,-531.46 419.95,-525.79 409.41,-524.64 411,-531.46"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#000cff" d="M279.1,-599.59C331.77,-599.19 409.69,-598.61 455.05,-598.27"/>
<polygon fill="#000cff" stroke="#000cff" points="455.33,-601.77 465.3,-598.2 455.28,-594.77 455.33,-601.77"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="556,-488 429,-488 429,-464 556,-464 556,-488"/>
<text text-anchor="middle" x="492.5" y="-473.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#000cff" d="M279.14,-599.17C297.25,-596.45 316.45,-590.66 331,-579 362.06,-554.11 335.61,-521.47 367,-497 381.66,-485.57 400.27,-479.41 418.6,-476.28"/>
<polygon fill="#000cff" stroke="#000cff" points="419.32,-479.71 428.73,-474.84 418.34,-472.78 419.32,-479.71"/>
</g>
<!-- proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#1800ff" d="M1088.02,-1669.98C1092.68,-1667.47 1097.06,-1664.5 1101,-1661 1165.67,-1603.6 1178.76,-1492.5 1181.37,-1445.2"/>
<polygon fill="#1800ff" stroke="#1800ff" points="1184.87,-1445.25 1181.82,-1435.11 1177.88,-1444.94 1184.87,-1445.25"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#3e00ff" d="M294.53,-851.14C307.19,-854.26 319.88,-858.7 331,-865 351.8,-876.8 346.04,-893.48 367,-905 394.01,-919.85 428.92,-924.72 454.89,-926.1"/>
<polygon fill="#3e00ff" stroke="#3e00ff" points="454.95,-929.6 465.07,-926.48 455.21,-922.61 454.95,-929.6"/>
</g>
<!-- proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#d300ff" d="M303.17,-1087.41C348.15,-1087.07 403.05,-1086.66 441.95,-1086.37"/>
<polygon fill="#d300ff" stroke="#d300ff" points="442,-1089.87 451.98,-1086.3 441.95,-1082.87 442,-1089.87"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#f800ff" d="M776.76,-1710C799.32,-1692.61 840.12,-1658.39 865,-1621 938.5,-1510.56 981.06,-1354.16 994.93,-1297"/>
<polygon fill="#f800ff" stroke="#f800ff" points="998.35,-1297.77 997.26,-1287.23 991.54,-1296.14 998.35,-1297.77"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#f800ff" d="M804.2,-1734.04C874.9,-1750.66 1015.08,-1771.41 1101,-1703 1142.18,-1670.21 1169.93,-1505.78 1178.87,-1445.34"/>
<polygon fill="#f800ff" stroke="#f800ff" points="1182.36,-1445.72 1180.32,-1435.32 1175.43,-1444.71 1182.36,-1445.72"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff00df" d="M292.23,-887.08C306.66,-890.42 320.64,-896.48 331,-907 394.36,-971.36 302.79,-1043.49 367,-1107 387.22,-1127 418.94,-1132.12 445.29,-1132.31"/>
<polygon fill="#ff00df" stroke="#ff00df" points="445.53,-1135.8 455.47,-1132.14 445.41,-1128.81 445.53,-1135.8"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff00df" d="M292.19,-896.2C344.14,-903.96 413.6,-914.35 455.31,-920.59"/>
<polygon fill="#ff00df" stroke="#ff00df" points="454.88,-924.06 465.29,-922.08 455.92,-917.14 454.88,-924.06"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ff00df" d="M292.19,-885.49C319.1,-885.29 350.72,-885.05 380.74,-884.83"/>
<polygon fill="#ff00df" stroke="#ff00df" points="380.88,-888.33 390.85,-884.75 380.82,-881.33 380.88,-888.33"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="577,-108 408,-108 408,-84 577,-84 577,-108"/>
<text text-anchor="middle" x="492.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#ff00ba" d="M328.57,-96C351.32,-96 375.25,-96 397.55,-96"/>
<polygon fill="#ff00ba" stroke="#ff00ba" points="397.68,-99.5 407.68,-96 397.68,-92.5 397.68,-99.5"/>
</g>
<!-- proc~numerov&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~numerov&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff006f" d="M253.14,-1837.93C292.51,-1835.13 364.03,-1830.05 418.5,-1826.19"/>
<polygon fill="#ff006f" stroke="#ff006f" points="419.08,-1829.65 428.8,-1825.45 418.58,-1822.67 419.08,-1829.65"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="832,-129 687,-129 687,-105 832,-105 832,-129"/>
<text text-anchor="middle" x="759.5" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ff4500" d="M577.35,-102.64C609.09,-105.16 645.16,-108.02 676.71,-110.52"/>
<polygon fill="#ff4500" stroke="#ff4500" points="676.54,-114.02 686.79,-111.32 677.09,-107.04 676.54,-114.02"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="799.5,-87 719.5,-87 719.5,-63 799.5,-63 799.5,-87"/>
<text text-anchor="middle" x="759.5" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ff4500" d="M577.35,-89.36C620.73,-85.92 672.19,-81.84 709.16,-78.91"/>
<polygon fill="#ff4500" stroke="#ff4500" points="709.49,-82.39 719.18,-78.12 708.94,-75.42 709.49,-82.39"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffd000" d="M588.55,-1567.86C736.86,-1575.37 1015.23,-1582.39 1101,-1536 1137.9,-1516.04 1162.03,-1471.1 1173.72,-1444.3"/>
<polygon fill="#ffd000" stroke="#ffd000" points="1176.98,-1445.58 1177.59,-1435 1170.52,-1442.89 1176.98,-1445.58"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="803,-862 716,-862 716,-838 803,-838 803,-862"/>
<text text-anchor="middle" x="759.5" y="-847.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ffd000" d="M510.58,-1549.78C538.76,-1528.51 594.24,-1481.68 618,-1427 703.26,-1230.79 561.19,-1139.75 654,-947 670.52,-912.68 704.93,-884.58 729.76,-867.61"/>
<polygon fill="#ffd000" stroke="#ffd000" points="731.7,-870.53 738.1,-862.09 727.83,-864.7 731.7,-870.53"/>
</g>
<!-- proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~print_sum_of_squares</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/print_sum_of_squares.html" xlink:title="print_sum_of_squares">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1612 696,-1612 696,-1588 823,-1588 823,-1612"/>
<text text-anchor="middle" x="759.5" y="-1597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_sum_of_squares</text>
</a>
</g>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares</title>
<path fill="none" stroke="#ffd000" d="M577.35,-1574.02C612.11,-1579.01 652.07,-1584.74 685.6,-1589.55"/>
<polygon fill="#ffd000" stroke="#ffd000" points="685.39,-1593.05 695.78,-1591.01 686.38,-1586.12 685.39,-1593.05"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#5cff00" d="M785.35,-1140.06C807.6,-1151.57 840.43,-1170.33 865,-1192 884.21,-1208.94 880.32,-1221.88 901,-1237 913.86,-1246.4 929.34,-1253.79 944.2,-1259.45"/>
<polygon fill="#5cff00" stroke="#5cff00" points="943.25,-1262.83 953.84,-1262.93 945.62,-1256.24 943.25,-1262.83"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#5cff00" d="M810.12,-1115.95C882.54,-1101.52 1017.61,-1086.94 1101,-1154 1140.37,-1185.66 1169.06,-1342.21 1178.58,-1400.81"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1175.15,-1401.53 1180.18,-1410.86 1182.06,-1400.43 1175.15,-1401.53"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#5cff00" d="M783.2,-1115.81C804.56,-1104.2 837.31,-1086.02 865,-1069 903.81,-1045.15 947.46,-1015.52 974.35,-996.93"/>
<polygon fill="#5cff00" stroke="#5cff00" points="976.57,-999.64 982.79,-991.07 972.58,-993.89 976.57,-999.64"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~check_namelist_input&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#5cff00" d="M793.3,-1140.05C836,-1155.74 910.7,-1183.19 957.64,-1200.44"/>
<polygon fill="#5cff00" stroke="#5cff00" points="956.62,-1203.79 967.21,-1203.95 959.03,-1197.22 956.62,-1203.79"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#17ff00" d="M533.1,-1085.86C558.78,-1087.35 592.15,-1092.38 618,-1107 639.4,-1119.1 633.76,-1135.04 654,-1149 736.04,-1205.61 771.37,-1190.8 865,-1225 896.36,-1236.46 931.76,-1249.57 958.43,-1259.5"/>
<polygon fill="#17ff00" stroke="#17ff00" points="957.25,-1262.79 967.84,-1263 959.69,-1256.23 957.25,-1262.79"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#17ff00" d="M520.77,-1073.93C552.26,-1060.47 605.9,-1039.03 654,-1027 760.39,-1000.39 889.11,-987.43 955.54,-982.1"/>
<polygon fill="#17ff00" stroke="#17ff00" points="955.95,-985.58 965.65,-981.31 955.41,-978.6 955.95,-985.58"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff2e" d="M540.58,-848.12C564.03,-851.62 592.71,-856.61 618,-863 674.21,-877.2 828.4,-902.04 865,-947 946.99,-1047.72 820.97,-1134.71 901,-1237 908.44,-1246.52 918.58,-1253.65 929.53,-1259"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="928.32,-1262.29 938.89,-1263.08 931.12,-1255.87 928.32,-1262.29"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-820 732.5,-820 732.5,-796 786.5,-796 786.5,-820"/>
<text text-anchor="middle" x="759.5" y="-805.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#00ff2e" d="M540.57,-835.96C592.56,-829.29 675.14,-818.69 722.31,-812.64"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="722.9,-816.1 732.38,-811.35 722.01,-809.15 722.9,-816.1"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ff2e" d="M540.57,-843.42C586.85,-844.82 657.37,-846.95 705.58,-848.4"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="705.71,-851.91 715.81,-848.71 705.92,-844.91 705.71,-851.91"/>
</g>
<!-- proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~modified_bessel_temme_algorithm</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/modified_bessel_temme_algorithm.html" xlink:title="modified_bessel_temme_algorithm">
<polygon fill="#d9534f" stroke="#d9534f" points="859,-614 660,-614 660,-590 859,-590 859,-614"/>
<text text-anchor="middle" x="759.5" y="-599.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_temme_algorithm</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm</title>
<path fill="none" stroke="#00ff73" d="M524.79,-665.9C556.86,-653.83 608.37,-635.35 654,-623 663.02,-620.56 672.54,-618.27 682.02,-616.16"/>
<polygon fill="#00ff73" stroke="#00ff73" points="682.82,-619.56 691.85,-614.03 681.34,-612.72 682.82,-619.56"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ffb9" d="M519.88,-930.18C567.5,-937.73 667.9,-953.64 722.04,-962.22"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="721.8,-965.73 732.23,-963.84 722.9,-958.81 721.8,-965.73"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffff" d="M539.19,-790.8C627.91,-774.13 818.83,-744.37 865,-787 938.71,-855.05 840.92,-1156.66 901,-1237 908.28,-1246.73 918.39,-1253.97 929.38,-1259.36"/>
<polygon fill="#00ffff" stroke="#00ffff" points="928.22,-1262.67 938.78,-1263.46 931.02,-1256.25 928.22,-1262.67"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ffff" d="M539.13,-807.12C562.73,-810.95 591.97,-815.92 618,-821 634.09,-824.14 637.96,-825.61 654,-829 670.79,-832.55 689.13,-836.29 705.7,-839.61"/>
<polygon fill="#00ffff" stroke="#00ffff" points="705.26,-843.09 715.75,-841.61 706.63,-836.22 705.26,-843.09"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-656 732.5,-656 732.5,-632 786.5,-632 786.5,-656"/>
<text text-anchor="middle" x="759.5" y="-641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#00ffff" d="M539.03,-801.18C565.06,-799.47 596.67,-793.04 618,-774 656.06,-740.02 615.81,-698.83 654,-665 672.41,-648.68 699.88,-643.65 722.04,-642.58"/>
<polygon fill="#00ffff" stroke="#00ffff" points="722.2,-646.08 732.11,-642.34 722.03,-639.08 722.2,-646.08"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#002eff" d="M786.72,-1056.25C810.56,-1065.09 844.98,-1081.39 865,-1107 901.92,-1154.23 860.7,-1192.62 901,-1237 909.64,-1246.52 920.94,-1253.67 932.79,-1259.04"/>
<polygon fill="#002eff" stroke="#002eff" points="931.8,-1262.42 942.38,-1262.98 934.46,-1255.94 931.8,-1262.42"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#002eff" d="M786.82,-1041.95C808.03,-1036.95 838.56,-1029.49 865,-1022 895.64,-1013.32 929.81,-1002.42 956.11,-993.77"/>
<polygon fill="#002eff" stroke="#002eff" points="957.39,-997.03 965.78,-990.57 955.19,-990.39 957.39,-997.03"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~check_namelist_potential&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#1700ff" d="M833.66,-1281.25C863.81,-1280.12 898.62,-1278.81 928.59,-1277.68"/>
<polygon fill="#1700ff" stroke="#1700ff" points="929.11,-1281.17 938.97,-1277.29 928.84,-1274.17 929.11,-1281.17"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~check_namelist_potential&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#1700ff" d="M802.77,-1272C843.13,-1260.54 904.08,-1243.23 947.53,-1230.9"/>
<polygon fill="#1700ff" stroke="#1700ff" points="948.69,-1234.21 957.35,-1228.11 946.77,-1227.47 948.69,-1234.21"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#5c00ff" d="M1020.05,-991.19C1042.58,-1007.39 1080.63,-1038.18 1101,-1074 1164.27,-1185.27 1178.16,-1343.16 1181.18,-1400.82"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1177.69,-1401.15 1181.65,-1410.98 1184.68,-1400.83 1177.69,-1401.15"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~check_namelist_basis&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#a200ff" d="M821.33,-1313.99C835.66,-1311.1 850.88,-1307.99 865,-1305 888.63,-1300 914.54,-1294.3 937.29,-1289.21"/>
<polygon fill="#a200ff" stroke="#a200ff" points="938.17,-1292.6 947.16,-1287 936.64,-1285.77 938.17,-1292.6"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~check_namelist_basis&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#a200ff" d="M823.17,-1321.33C837.74,-1318.16 852.59,-1313.08 865,-1305 888.25,-1289.86 879.1,-1271.04 901,-1254 913.69,-1244.12 929.25,-1236.56 944.24,-1230.88"/>
<polygon fill="#a200ff" stroke="#a200ff" points="945.73,-1234.07 953.98,-1227.42 943.38,-1227.48 945.73,-1234.07"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#e700ff" d="M540.24,-1214.18C629.24,-1225.96 823.51,-1251.65 928.79,-1265.58"/>
<polygon fill="#e700ff" stroke="#e700ff" points="928.63,-1269.09 939,-1266.93 929.54,-1262.15 928.63,-1269.09"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#e700ff" d="M540.11,-1200.13C666.34,-1179.85 1011.37,-1131.73 1101,-1195 1168.99,-1243 1180.26,-1353.26 1181.88,-1400.66"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1178.38,-1400.87 1182.1,-1410.79 1185.38,-1400.71 1178.38,-1400.87"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#e700ff" d="M540.21,-1203.07C566.82,-1203.02 598.63,-1208.1 618,-1229 677.48,-1293.15 591.02,-1560.29 654,-1621 692.85,-1658.45 847.16,-1652.74 936.04,-1645.97"/>
<polygon fill="#e700ff" stroke="#e700ff" points="936.58,-1649.44 946.27,-1645.17 936.03,-1642.46 936.58,-1649.44"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#e700ff" d="M540.21,-1196.16C566.49,-1187.25 597.94,-1172.45 618,-1149 654.75,-1106.04 618.81,-1071.25 654,-1027 671.7,-1004.74 700.24,-989.45 723.02,-980.02"/>
<polygon fill="#e700ff" stroke="#e700ff" points="724.36,-983.25 732.38,-976.33 721.79,-976.74 724.36,-983.25"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff008b" d="M594.22,-895.23C602.49,-897.86 610.53,-901.08 618,-905 638.32,-915.66 634.11,-930.57 654,-942 674.8,-953.95 701.01,-960.45 721.97,-963.97"/>
<polygon fill="#ff008b" stroke="#ff008b" points="721.68,-967.46 732.09,-965.5 722.73,-960.54 721.68,-967.46"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff008b" d="M564.94,-896.03C582.3,-898.96 600.82,-902.09 618,-905 727.79,-923.59 755.88,-924.81 865,-947 895.42,-953.19 929.43,-961.25 955.71,-967.74"/>
<polygon fill="#ff008b" stroke="#ff008b" points="955.18,-971.22 965.73,-970.23 956.87,-964.43 955.18,-971.22"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff91" d="M803.27,-849.72C876.86,-851.76 1026.7,-867.54 1101,-958 1157.93,-1027.32 1176.73,-1318.17 1180.98,-1400.94"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1177.49,-1401.18 1181.47,-1410.99 1184.48,-1400.83 1177.49,-1401.18"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0091ff" d="M770.18,-1587.84C788.83,-1564.34 830.92,-1510.94 865,-1465 910.15,-1404.14 961.48,-1330.65 985.79,-1295.57"/>
<polygon fill="#0091ff" stroke="#0091ff" points="988.83,-1297.34 991.64,-1287.13 983.07,-1293.36 988.83,-1297.34"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0091ff" d="M823.03,-1602.23C908.61,-1604.13 1056.66,-1602.88 1101,-1574 1146.89,-1544.11 1168.66,-1479.13 1177.28,-1444.98"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1180.73,-1445.6 1179.63,-1435.06 1173.92,-1443.98 1180.73,-1445.6"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#0091ff" d="M823.11,-1610.46C857.93,-1616.27 901.16,-1623.49 936.17,-1629.34"/>
<polygon fill="#0091ff" stroke="#0091ff" points="935.84,-1632.83 946.28,-1631.03 937,-1625.93 935.84,-1632.83"/>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#4800ff" d="M851.63,-614.07C856.4,-616.58 860.91,-619.53 865,-623 871.85,-628.81 964.32,-881.21 992.14,-957.43"/>
<polygon fill="#4800ff" stroke="#4800ff" points="988.9,-958.78 995.62,-966.97 995.48,-956.38 988.9,-958.78"/>
</g>
<!-- proc~rgamma -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~rgamma</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/rgamma.html" xlink:title="rgamma">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1030,-614 972,-614 972,-590 1030,-590 1030,-614"/>
<text text-anchor="middle" x="1001" y="-599.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rgamma</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma</title>
<path fill="none" stroke="#4800ff" d="M859.3,-602C895.4,-602 934.13,-602 961.8,-602"/>
<polygon fill="#4800ff" stroke="#4800ff" points="961.83,-605.5 971.83,-602 961.83,-598.5 961.83,-605.5"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node73"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-698 974,-698 974,-674 1028,-674 1028,-698"/>
<text text-anchor="middle" x="1001" y="-683.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ff00da" d="M786.59,-648.57C829.51,-656.1 915.11,-671.11 963.84,-679.66"/>
<polygon fill="#ff00da" stroke="#ff00da" points="963.49,-683.15 973.95,-681.43 964.7,-676.26 963.49,-683.15"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-656 974,-656 974,-632 1028,-632 1028,-656"/>
<text text-anchor="middle" x="1001" y="-641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ff00da" d="M786.59,-644C829.51,-644 915.11,-644 963.84,-644"/>
<polygon fill="#ff00da" stroke="#ff00da" points="963.95,-647.5 973.95,-644 963.95,-640.5 963.95,-647.5"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node75" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node75"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1210,-677 1156,-677 1156,-653 1210,-653 1210,-677"/>
<text text-anchor="middle" x="1183" y="-662.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ff00" d="M1028.17,-682.95C1059.1,-679.34 1110.75,-673.31 1145.57,-669.25"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1146.27,-672.69 1155.79,-668.06 1145.46,-665.74 1146.27,-672.69"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#0000ff" d="M1028.17,-647.05C1059.1,-650.66 1110.75,-656.69 1145.57,-660.75"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1145.46,-664.26 1155.79,-661.94 1146.27,-657.31 1145.46,-664.26"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~2">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_indices~12"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~8"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholdoff"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholdoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~2"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_algebraic_coefficients~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_algebraic_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~2"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_algebraic_coefficients~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_algebraic_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_pes_matrix_elements~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_pes_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">data_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">pes_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">prepare_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="n">print_pes_matrix_elements_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">propagator_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">numerov</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">save_s_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">save_s_matrix_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_s_matrix_block_info</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">check_cross_section_thresholds</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">save_partial_xs_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_partial_xs_single_block</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">save_s_matrix_file_header</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">save_partial_xs_file_header</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by consecutive_blocks_thresholddiag and consecutive_blocks_thresholdoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">consecutive_blocks_thresholddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">consecutive_blocks_thresholdoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the PES matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_pes_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">save_s_matrix_block_info</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w"> </span><span class="n">wv</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">s_matrix_real</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">save_partial_xs_single_block</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if elastic_xs_threshold/inelastic_xs_threshold condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-09 12:01            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>