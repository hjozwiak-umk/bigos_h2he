<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">214 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~5">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/potential.html'>POTENTIAL</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/statetostatexs.html'>statetostateXS</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/pes_coupling_matrix.html'>PES_COUPLING_MATRIX</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="366pt"
 viewBox="0.00 0.00 641.00 365.56" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.34 1.34) rotate(0) translate(4 487.6)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-487.6 858,-487.6 858,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="854,-197.64 775,-197.64 775,-173.64 854,-173.64 854,-197.64"/>
<text text-anchor="middle" x="814.5" y="-183.24" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-300.64 334,-300.64 334,-276.64 388,-276.64 388,-300.64"/>
<text text-anchor="middle" x="361" y="-286.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C657.46,-292.45 647.82,-268.82 612,-259.64 578.48,-251.06 570.48,-234.13 536.5,-240.64"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-261.64 134,-261.64 134,-237.64 259,-237.64 259,-261.64"/>
<text text-anchor="middle" x="196.5" y="-247.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C649.42,-295.06 654.95,-328.84 612,-343.64 506.77,-379.93 470.99,-351.28 362,-328.64"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-142.64 130,-142.64 130,-118.64 263,-118.64 263,-142.64"/>
<text text-anchor="middle" x="196.5" y="-128.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C638.1,-298.98 661.97,-207.9 612,-179.64 506.13,-119.77 360.89,-117.35 273.43,-122.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.06,-119.29 263.32,-123.46 273.53,-126.28 273.06,-119.29"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-182.64 0,-182.64 0,-158.64 94,-158.64 94,-182.64"/>
<text text-anchor="middle" x="47" y="-168.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C623.25,-303.52 674.96,-386.83 612,-423.64 452.8,-516.72 359.24,-493.24 197.5,-404.64"/>
</g>
<!-- module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~statetostatexs</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/statetostatexs.html" xlink:title="statetostateXS">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-414.64 490.5,-414.64 490.5,-390.64 580.5,-390.64 580.5,-414.64"/>
<text text-anchor="middle" x="535.5" y="-400.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">statetostateXS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~statetostatexs</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C639.73,-298.43 657.88,-345.1 612,-376.64 605.34,-381.22 597.8,-385.07 590.12,-388.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="588.83,-385.02 580.74,-391.86 591.33,-391.55 588.83,-385.02"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="612,-212.64 459,-212.64 459,-188.64 612,-188.64 612,-212.64"/>
<text text-anchor="middle" x="535.5" y="-198.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C651.67,-294.4 650.58,-245.82 612,-226.64 604.15,-222.74 595.58,-219.19 587.11,-216.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="588.24,-212.72 577.65,-212.66 585.89,-219.32 588.24,-212.72"/>
</g>
<!-- module~potential -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~potential</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/potential.html" xlink:title="POTENTIAL">
<polygon fill="#337ab7" stroke="#337ab7" points="571,-102.64 500,-102.64 500,-78.64 571,-78.64 571,-102.64"/>
<text text-anchor="middle" x="535.5" y="-88.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POTENTIAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~potential</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M803.63,-197.79C785.04,-219.57 742.35,-264.52 694.5,-280.64"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C626.66,-302.83 658.68,-198.1 612,-146.64 598.53,-131.79 580.59,-118.3 565.58,-108.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="567.43,-105.3 557.14,-102.79 563.62,-111.17 567.43,-105.3"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-334.64 490.5,-334.64 490.5,-310.64 580.5,-310.64 580.5,-334.64"/>
<text text-anchor="middle" x="535.5" y="-320.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C659.07,-291.91 620.83,-302.25 590.58,-309.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="589.5,-306.5 580.64,-312.31 591.19,-313.3 589.5,-306.5"/>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="739,-177.64 648,-177.64 648,-153.64 739,-153.64 739,-177.64"/>
<text text-anchor="middle" x="693.5" y="-163.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.86,-179.15C766.67,-177.77 757.87,-176.3 749.21,-174.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="749.59,-171.35 739.14,-173.15 748.43,-178.26 749.59,-171.35"/>
</g>
<!-- module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~pes_coupling_matrix</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/pes_coupling_matrix.html" xlink:title="PES_COUPLING_MATRIX">
<polygon fill="#337ab7" stroke="#337ab7" points="603.5,-292.64 467.5,-292.64 467.5,-268.64 603.5,-268.64 603.5,-292.64"/>
<text text-anchor="middle" x="535.5" y="-278.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PES_COUPLING_MATRIX</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~pes_coupling_matrix</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-280.64C667.69,-289.01 639.37,-291.05 613.74,-290.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="613.82,-286.86 603.68,-289.95 613.53,-293.86 613.82,-286.86"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M333.89,-282.38C313.37,-277.45 283.95,-270.39 257.69,-264.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="258.35,-260.65 247.81,-261.72 256.71,-267.46 258.35,-260.65"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M333.7,-285.06C321.71,-282.18 308.18,-276.99 299,-267.64 262.66,-230.64 298.48,-194.48 263,-156.64 259.86,-153.29 256.22,-150.36 252.31,-147.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="253.82,-144.64 243.39,-142.78 250.39,-150.74 253.82,-144.64"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M333.78,-282.7C322.49,-279.38 309.5,-274.5 299,-267.64 279.25,-254.75 279.85,-245.15 263,-228.64 235.22,-201.44 235.83,-177.2 197.5,-170.64"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M172.78,-237.47C147.8,-224.1 107.51,-202.52 79.5,-187.51"/>
<polygon fill="#ff9900" stroke="#ff9900" points="80.98,-184.34 70.51,-182.7 77.67,-190.51 80.98,-184.34"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M151.25,-142.65C135.86,-146.82 118.41,-151.55 102.31,-155.92"/>
<polygon fill="#cbff00" stroke="#cbff00" points="101.21,-152.59 92.48,-158.58 103.05,-159.34 101.21,-152.59"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~statetostatexs&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M518.83,-390.51C503.52,-378.63 479.59,-359.98 459,-343.64 442.91,-330.87 440.62,-325.22 423,-314.64 415.11,-309.91 406.2,-305.6 397.68,-301.91"/>
<polygon fill="#00ff66" stroke="#00ff66" points="398.87,-298.61 388.3,-298.01 396.19,-305.08 398.87,-298.61"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~statetostatexs&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M490.35,-408.55C455.17,-411.98 404.87,-413.98 362,-404.64"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M360,-404.64C286.6,-388.66 231.64,-308.94 208.94,-270.47"/>
<polygon fill="#00ff66" stroke="#00ff66" points="211.88,-268.58 203.87,-261.65 205.81,-272.06 211.88,-268.58"/>
</g>
<!-- module~statetostatexs&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~statetostatexs&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M360,-404.64C289.43,-389.28 260.84,-439.34 197.5,-404.64"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M487.2,-212.72C477.42,-216.35 467.52,-220.93 459,-226.64 438.86,-240.16 443.14,-254.14 423,-267.64 415.43,-272.72 406.51,-276.69 397.86,-279.75"/>
<polygon fill="#00ffff" stroke="#00ffff" points="396.75,-276.43 388.3,-282.82 398.89,-283.09 396.75,-276.43"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M458.81,-194.87C428.17,-194.69 392.81,-197.25 362,-206.64"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M476,-188.64C442.69,-182.1 400.13,-174.22 362,-168.64"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M360,-168.64C322.88,-163.22 281.74,-153.56 250.14,-145.34"/>
<polygon fill="#00ffff" stroke="#00ffff" points="250.79,-141.89 240.23,-142.73 249.01,-148.66 250.79,-141.89"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M360,-168.64C288.53,-158.2 268.69,-182.83 197.5,-170.64"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M195.5,-170.64C165.73,-165.55 132.09,-165.15 104.46,-166.2"/>
<polygon fill="#00ffff" stroke="#00ffff" points="104.01,-162.72 94.18,-166.67 104.33,-169.71 104.01,-162.72"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-102.64 299,-102.64 299,-78.64 423,-78.64 423,-102.64"/>
<text text-anchor="middle" x="361" y="-88.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M515.38,-188.45C484.86,-168.99 425,-130.82 389.76,-108.35"/>
<polygon fill="#00ffff" stroke="#00ffff" points="391.26,-105.15 380.94,-102.72 387.49,-111.05 391.26,-105.15"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-258.64 334,-258.64 334,-234.64 388,-234.64 388,-258.64"/>
<text text-anchor="middle" x="361" y="-244.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M489.18,-212.73C460.8,-220.3 424.73,-229.92 398.26,-236.98"/>
<polygon fill="#00ffff" stroke="#00ffff" points="397.02,-233.68 388.26,-239.64 398.83,-240.45 397.02,-233.68"/>
</g>
<!-- module~potential&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~potential&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M521.86,-102.91C505.61,-119.23 477.31,-149.51 459,-179.64 437.06,-215.76 453.72,-238.62 423,-267.64 416.06,-274.2 406.99,-278.71 397.97,-281.82"/>
<polygon fill="#0066ff" stroke="#0066ff" points="396.9,-278.49 388.3,-284.68 398.89,-285.2 396.9,-278.49"/>
</g>
<!-- module~potential&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~potential&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M522.44,-102.82C502.98,-121.93 462.79,-159.21 423,-182.64 397.9,-197.43 389.87,-198.15 362,-206.64"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M360,-206.64C326,-217.01 287.56,-227.25 256.61,-235.13"/>
<polygon fill="#0066ff" stroke="#0066ff" points="255.67,-231.76 246.84,-237.61 257.39,-238.55 255.67,-231.76"/>
</g>
<!-- module~potential&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~potential&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M499.85,-80.01C486.86,-75.69 472.08,-70.36 459,-64.64 414.18,-45.06 410.29,-20.46 362,-12.64"/>
</g>
<!-- module~potential&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~potential&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M499.59,-90.64C480.47,-90.64 456.05,-90.64 433.11,-90.64"/>
<polygon fill="#0066ff" stroke="#0066ff" points="433.04,-87.14 423.04,-90.64 433.04,-94.14 433.04,-87.14"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M490.08,-313.89C461.52,-308.26 424.9,-301.04 398.14,-295.77"/>
<polygon fill="#3200ff" stroke="#3200ff" points="398.53,-292.28 388.04,-293.78 397.18,-299.15 398.53,-292.28"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M490.41,-329.9C455.26,-334.32 404.98,-337.57 362,-328.64"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M490.26,-332.84C455.25,-341.18 405.22,-353.66 362,-366.64"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M678.63,-177.66C663.3,-190.35 637.41,-210.08 612,-221.64 580.51,-235.98 570.48,-234.13 536.5,-240.64"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M534.5,-240.64C486.57,-249.83 432.55,-265.8 397.93,-276.78"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="396.73,-273.49 388.28,-279.88 398.87,-280.16 396.73,-273.49"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M534.5,-50.64C434.58,-18.34 393.13,-23.1 299,-69.64 277.56,-80.25 283.08,-96.66 263,-109.64 260.38,-111.34 257.61,-112.91 254.75,-114.36"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="253.04,-111.29 245.37,-118.6 255.93,-117.67 253.04,-111.29"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M685.81,-153.52C673.82,-132.95 646.65,-91.36 612,-69.64 582.68,-51.27 569.41,-61.32 536.5,-50.64"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M534.5,-50.64C459.82,-26.42 439.5,-25.19 362,-12.64"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M360,-12.64C288.71,-1.11 266.7,8.02 197.5,-12.64"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M195.5,-12.64C126.84,-33.14 78.55,-110.96 58.44,-149.19"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="55.15,-147.92 53.72,-158.42 61.39,-151.1 55.15,-147.92"/>
</g>
<!-- module~propagators&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~propagators&#45;&gt;module~potential</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M667.44,-153.59C641.17,-140.97 599.73,-121.05 570.52,-107"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="572.03,-103.84 561.5,-102.66 569,-110.15 572.03,-103.84"/>
</g>
<!-- module~propagators&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~propagators&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M534.5,-50.64C510.82,-42.99 448.11,-61.01 405.2,-75.3"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="403.91,-72.04 395.56,-78.55 406.15,-78.67 403.91,-72.04"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M467.31,-283.76C443.9,-284.85 418.51,-286.02 398.53,-286.95"/>
<polygon fill="#ff0098" stroke="#ff0098" points="398.15,-283.46 388.32,-287.42 398.47,-290.46 398.15,-283.46"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M490.97,-292.76C439.87,-306.98 362,-328.64 362,-328.64"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M360,-328.64C332.2,-322.87 324.95,-321.17 299,-309.64 272.23,-297.76 243.68,-280.41 223.7,-267.43"/>
<polygon fill="#ff0098" stroke="#ff0098" points="225.43,-264.38 215.16,-261.8 221.58,-270.23 225.43,-264.38"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M477.31,-292.68C470.9,-295.14 464.65,-298.1 459,-301.64 438.46,-314.54 442.84,-328.7 423,-342.64 399.16,-359.4 389.9,-358.26 362,-366.64"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M360,-366.64C324.48,-377.31 230.03,-422.46 197.5,-404.64"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M195.5,-404.64C111.31,-358.53 68.67,-241.77 54.02,-192.8"/>
<polygon fill="#ff0098" stroke="#ff0098" points="57.3,-191.55 51.17,-182.91 50.58,-193.49 57.3,-191.55"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M514.66,-268.49C498.24,-257.7 475.08,-240.73 459,-221.64 437.22,-195.8 442.84,-182.01 423,-154.64 411.14,-138.28 395.34,-121.82 382.79,-109.69"/>
<polygon fill="#ff0098" stroke="#ff0098" points="385.13,-107.08 375.47,-102.74 380.31,-112.16 385.13,-107.08"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M473.2,-268.56C448.06,-263.61 419.84,-258.05 398.12,-253.76"/>
<polygon fill="#ff0098" stroke="#ff0098" points="398.5,-250.27 388.01,-251.77 397.15,-257.14 398.5,-250.27"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M347.52,-102.86C319.45,-130.32 251.15,-197.15 217.25,-230.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="214.5,-228.11 209.8,-237.61 219.4,-233.12 214.5,-228.11"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M348.68,-78.51C322.92,-52.42 257.47,5.26 197.5,-12.64"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-100.64 130,-100.64 130,-76.64 263,-76.64 263,-100.64"/>
<text text-anchor="middle" x="196.5" y="-86.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.57,-89.89C290.32,-89.79 281.79,-89.68 273.34,-89.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.13,-86.08 263.09,-89.45 273.04,-93.07 273.13,-86.08"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="917pt"
 viewBox="0.00 0.00 641.00 916.81" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.06 2.06) rotate(0) translate(4 1888.27)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1888.27 1319,-1888.27 1319,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-910 0,-910 0,-886 79,-886 79,-910"/>
<text text-anchor="middle" x="39.5" y="-895.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="594,-1666 456,-1666 456,-1642 594,-1642 594,-1666"/>
<text text-anchor="middle" x="525" y="-1651.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.93,-910.17C44.19,-998.44 66.02,-1538.61 115,-1590 159.19,-1636.37 340.14,-1649.19 445.97,-1652.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.86,-1656.2 455.97,-1653.02 446.08,-1649.21 445.86,-1656.2"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-360 161,-360 161,-336 360,-336 360,-360"/>
<text text-anchor="middle" x="260.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.33,-885.55C39.58,-812.95 39.58,-444.75 115,-369 125,-358.95 137.53,-352.29 151,-348.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.23,-351.32 160.96,-345.32 150.39,-344.56 152.23,-351.32"/>
</g>
<!-- proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~print_bf_channels</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/print_bf_channels.html" xlink:title="print_bf_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="816,-1826 710,-1826 710,-1802 816,-1802 816,-1826"/>
<text text-anchor="middle" x="763" y="-1811.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_bf_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~print_bf_channels</title>
<path fill="none" stroke="#ff0000" d="M40.57,-910.27C41.27,-1012.78 48.51,-1724.33 115,-1788 283.05,-1948.92 602.27,-1866.64 718.38,-1829.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="719.59,-1832.5 728.01,-1826.06 717.42,-1825.85 719.59,-1832.5"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-276 209.5,-276 209.5,-252 311.5,-252 311.5,-276"/>
<text text-anchor="middle" x="260.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M41.1,-885.93C45.28,-803.86 71.22,-329.81 115,-285 136.39,-263.1 169.76,-257.19 199.04,-257.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.14,-260.56 209.2,-257.23 199.26,-253.56 199.14,-260.56"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="882,-870 644,-870 644,-846 882,-846 882,-870"/>
<text text-anchor="middle" x="763" y="-855.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M79.04,-895.86C181.84,-890.16 466.18,-874.4 633.79,-865.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="634.13,-868.59 643.92,-864.55 633.74,-861.61 634.13,-868.59"/>
</g>
<!-- proc~crosssection -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~crosssection</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/crosssection.html" xlink:title="CROSSSECTION">
<polygon fill="#d9534f" stroke="#d9534f" points="573,-1510 477,-1510 477,-1486 573,-1486 573,-1510"/>
<text text-anchor="middle" x="525" y="-1495.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CROSSSECTION</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~crosssection -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~crosssection</title>
<path fill="none" stroke="#ff0000" d="M41.16,-910.1C45.61,-989.32 72.27,-1431.99 115,-1472 164.41,-1518.27 366.3,-1510.12 466.72,-1502.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="467.28,-1506.36 476.99,-1502.13 466.76,-1499.38 467.28,-1506.36"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="305,-234 216,-234 216,-210 305,-210 305,-234"/>
<text text-anchor="middle" x="260.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M41,-885.94C44.64,-800.69 68.3,-291.17 115,-243 137.99,-219.29 175,-214.27 205.81,-215.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.84,-218.57 215.99,-215.53 206.16,-211.58 205.84,-218.57"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1315,-1230 1223,-1230 1223,-1206 1315,-1206 1315,-1230"/>
<text text-anchor="middle" x="1269" y="-1215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.97,-910.26C44.4,-995.73 66.59,-1500.67 115,-1546 168.1,-1595.73 369.28,-1559.68 442,-1562 775.91,-1572.65 951.38,-1698.84 1187,-1462 1249.37,-1399.31 1263.71,-1287.52 1267.01,-1240.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1270.51,-1240.27 1267.61,-1230.08 1263.53,-1239.85 1270.51,-1240.27"/>
</g>
<!-- proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~potential_interpolation</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/potential_interpolation.html" xlink:title="potential_interpolation">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-990 194,-990 194,-966 327,-966 327,-990"/>
<text text-anchor="middle" x="260.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_interpolation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~potential_interpolation</title>
<path fill="none" stroke="#ff0000" d="M53.37,-910.16C67.39,-922.7 91.04,-941.8 115,-952 136.45,-961.13 161.02,-967.06 183.74,-970.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.26,-974.37 193.69,-972.48 184.36,-967.46 183.26,-974.37"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1042,-870 918,-870 918,-846 1042,-846 1042,-870"/>
<text text-anchor="middle" x="980" y="-855.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M44.22,-885.87C52.44,-861.4 74.7,-806.45 115,-783 318.54,-664.56 408.6,-759.4 644,-753 749.74,-750.12 786.41,-707.7 882,-753 904.83,-763.82 901.05,-778.27 918,-797 931.03,-811.39 946.5,-826.85 958.6,-838.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="956.38,-841.32 966.01,-845.74 961.24,-836.28 956.38,-841.32"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1187,-605 1078,-605 1078,-581 1187,-581 1187,-605"/>
<text text-anchor="middle" x="1132.5" y="-590.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M42.14,-885.97C48.84,-838.43 75.73,-664.5 115,-628 278.63,-475.9 399.09,-609.15 608,-530 625.32,-523.44 626.12,-513.83 644,-509 746.11,-481.39 777.17,-494.85 882,-509 955.09,-518.87 972.58,-528.1 1042,-553 1060.88,-559.77 1081.35,-568.79 1097.94,-576.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1096.68,-579.82 1107.22,-580.94 1099.68,-573.5 1096.68,-579.82"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-520 230.5,-520 230.5,-496 290.5,-496 290.5,-520"/>
<text text-anchor="middle" x="260.5" y="-505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M41.5,-885.92C46.28,-830.81 68.58,-603.76 115,-553 141.8,-523.69 187.32,-513.31 220.12,-509.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="220.65,-513.18 230.28,-508.77 220,-506.21 220.65,-513.18"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1007,-1674 953,-1674 953,-1650 1007,-1650 1007,-1674"/>
<text text-anchor="middle" x="980" y="-1659.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M40.6,-910.07C41.51,-1009.39 50.14,-1689.57 115,-1749 177.91,-1806.64 800,-1735.57 882,-1712 907.19,-1704.76 933.49,-1690.74 952.34,-1679.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="954.28,-1682.3 960.95,-1674.07 950.6,-1676.34 954.28,-1682.3"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="287.5,-192 233.5,-192 233.5,-168 287.5,-168 287.5,-192"/>
<text text-anchor="middle" x="260.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.92,-885.74C44.09,-796.79 65.41,-252.5 115,-201 142.45,-172.49 190.15,-170.94 223.2,-174.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="223.04,-177.58 233.37,-175.23 223.83,-170.62 223.04,-177.58"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="570.5,-1116 479.5,-1116 479.5,-1092 570.5,-1092 570.5,-1116"/>
<text text-anchor="middle" x="525" y="-1101.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M43.52,-910.4C50.77,-937.35 71.85,-1001.27 115,-1032 171.15,-1071.99 371.64,-1092.41 469.49,-1100.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="469.24,-1103.68 479.48,-1100.96 469.79,-1096.7 469.24,-1103.68"/>
</g>
<!-- proc~potential_read -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~potential_read</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/potential_read.html" xlink:title="potential_read">
<polygon fill="#d9534f" stroke="#d9534f" points="569.5,-910 480.5,-910 480.5,-886 569.5,-886 569.5,-910"/>
<text text-anchor="middle" x="525" y="-895.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_read</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_read -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~potential_read</title>
<path fill="none" stroke="#ff0000" d="M79.25,-898C165.17,-898 371.83,-898 470.2,-898"/>
<polygon fill="#ff0000" stroke="#ff0000" points="470.23,-901.5 480.23,-898 470.23,-894.5 470.23,-901.5"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="562,-219 488,-219 488,-195 562,-195 562,-219"/>
<text text-anchor="middle" x="525" y="-204.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M40.61,-885.59C41.44,-819.21 48.89,-506.9 115,-444 209.3,-354.28 310.06,-498.97 406,-411 465.49,-356.45 388.08,-293.06 442,-233 451.22,-222.73 464.48,-216.48 477.65,-212.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="478.75,-216.03 487.64,-210.26 477.09,-209.23 478.75,-216.03"/>
</g>
<!-- proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~print_largest_partial_xs</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/print_largest_partial_xs.html" xlink:title="print_largest_partial_xs">
<polygon fill="#d9534f" stroke="#d9534f" points="831,-542 695,-542 695,-518 831,-518 831,-542"/>
<text text-anchor="middle" x="763" y="-527.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_xs</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_xs</title>
<path fill="none" stroke="#ff0000" d="M41.94,-885.98C46.41,-853.98 63.08,-765.97 115,-720 285.46,-569.1 406.58,-687.09 608,-581 626.43,-571.29 625.12,-559.78 644,-551 656.68,-545.1 670.83,-540.85 684.81,-537.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="685.81,-541.16 694.93,-535.77 684.44,-534.3 685.81,-541.16"/>
</g>
<!-- proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~potential_reduction</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/potential_reduction.html" xlink:title="potential_reduction">
<polygon fill="#d9534f" stroke="#d9534f" points="820.5,-950 705.5,-950 705.5,-926 820.5,-926 820.5,-950"/>
<text text-anchor="middle" x="763" y="-935.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_reduction</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~potential_reduction</title>
<path fill="none" stroke="#ff0000" d="M79.01,-906.34C90.53,-908.54 103.23,-910.66 115,-912 325.62,-935.89 576.98,-938.69 694.8,-938.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="695.11,-942.01 705.1,-938.49 695.09,-935.01 695.11,-942.01"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="304.5,-150 216.5,-150 216.5,-126 304.5,-126 304.5,-150"/>
<text text-anchor="middle" x="260.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.84,-885.89C43.51,-794.4 62.45,-213.9 115,-159 137.91,-135.06 175.1,-130.09 206.02,-130.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="206.07,-134.47 216.23,-131.47 206.41,-127.48 206.07,-134.47"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~set_number_of_open_channels_wavmax</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/set_number_of_open_channels_wavmax.html" xlink:title="set_number_of_open_channels_wavmax">
<polygon fill="#d9534f" stroke="#d9534f" points="373.5,-1740 147.5,-1740 147.5,-1716 373.5,-1716 373.5,-1740"/>
<text text-anchor="middle" x="260.5" y="-1725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_open_channels_wavmax</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax</title>
<path fill="none" stroke="#ff0000" d="M40.86,-910.14C43.77,-1004.44 64.56,-1618.07 115,-1681 126.48,-1695.33 142.41,-1705.34 159.5,-1712.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.51,-1715.69 169.1,-1715.9 160.95,-1709.13 158.51,-1715.69"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="572,-1430 478,-1430 478,-1406 572,-1406 572,-1430"/>
<text text-anchor="middle" x="525" y="-1415.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.37,-910.17C39.93,-979.55 41.5,-1324.57 115,-1392 165.01,-1437.87 367.57,-1429.82 467.58,-1422.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.08,-1426.21 477.8,-1421.99 467.57,-1419.23 468.08,-1426.21"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="803.5,-1034 722.5,-1034 722.5,-1010 803.5,-1010 803.5,-1034"/>
<text text-anchor="middle" x="763" y="-1019.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M45.2,-910.12C54.59,-932.43 78,-979.48 115,-999 167.19,-1026.53 569.11,-1024.37 711.88,-1022.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="712.15,-1026.2 722.1,-1022.58 712.06,-1019.2 712.15,-1026.2"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="804,-1392 722,-1392 722,-1368 804,-1368 804,-1392"/>
<text text-anchor="middle" x="763" y="-1377.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M40.55,-910.41C41.1,-976.74 47.28,-1288.71 115,-1349 159.14,-1388.31 567.15,-1383.96 711.6,-1381.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="712.01,-1384.64 721.94,-1380.94 711.87,-1377.64 712.01,-1384.64"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="596.5,-1708 453.5,-1708 453.5,-1684 596.5,-1684 596.5,-1708"/>
<text text-anchor="middle" x="525" y="-1693.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.85,-910.06C43.56,-1001.16 62.82,-1579.17 115,-1634 158.77,-1679.99 337.15,-1692.03 443.34,-1695.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="443.3,-1698.57 453.39,-1695.34 443.48,-1691.58 443.3,-1698.57"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="800,-1556 726,-1556 726,-1532 800,-1532 800,-1556"/>
<text text-anchor="middle" x="763" y="-1541.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M41.08,-910.24C45.1,-992.39 69.94,-1461.59 115,-1504 201.07,-1585.01 581.52,-1560.01 715.29,-1548.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="715.95,-1551.88 725.6,-1547.52 715.33,-1544.91 715.95,-1551.88"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="333,-1340 188,-1340 188,-1316 333,-1316 333,-1340"/>
<text text-anchor="middle" x="260.5" y="-1325.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.21,-910.01C39.68,-955.68 43.04,-1121.39 115,-1228 141.18,-1266.78 187.85,-1294.98 221.07,-1311.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="219.94,-1314.71 230.48,-1315.87 222.97,-1308.4 219.94,-1314.71"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~set_channels_level_indices_channels_omega_values</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/set_channels_level_indices_channels_omega_values.html" xlink:title="set_channels_level_indices_channels_omega_values">
<polygon fill="#d9534f" stroke="#d9534f" points="406,-1219 115,-1219 115,-1195 406,-1195 406,-1219"/>
<text text-anchor="middle" x="260.5" y="-1204.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_level_indices_channels_omega_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values</title>
<path fill="none" stroke="#ff0000" d="M40.63,-910.12C41.72,-949.47 50.32,-1075.3 115,-1147 134.61,-1168.74 163.31,-1182.8 189.98,-1191.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="189.11,-1195.2 199.7,-1194.9 191.23,-1188.53 189.11,-1195.2"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="361,-402 160,-402 160,-378 361,-378 361,-402"/>
<text text-anchor="middle" x="260.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.55,-885.81C41.08,-817.77 47.15,-485.55 115,-416 124.74,-406.02 136.92,-399.11 150.05,-394.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="151.25,-397.72 159.75,-391.4 149.16,-391.04 151.25,-397.72"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="581,-797 469,-797 469,-773 581,-773 581,-797"/>
<text text-anchor="middle" x="525" y="-782.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M53.04,-885.9C66.98,-873.24 90.72,-853.84 115,-844 229.88,-797.42 376.01,-786.84 458.87,-784.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="458.98,-788.38 468.9,-784.68 458.83,-781.38 458.98,-788.38"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="307,-108 214,-108 214,-84 307,-84 307,-108"/>
<text text-anchor="middle" x="260.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.77,-885.81C42.99,-791.13 59.53,-175.27 115,-117 137.3,-93.58 173.26,-88.28 203.73,-88.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.69,-92.37 213.82,-89.27 203.97,-85.37 203.69,-92.37"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="826.5,-1472 699.5,-1472 699.5,-1448 826.5,-1448 826.5,-1472"/>
<text text-anchor="middle" x="763" y="-1457.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.25,-910.01C39.02,-981.65 36.54,-1351.95 115,-1424 156.48,-1462.09 528.87,-1462.62 689.16,-1461.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="689.45,-1464.54 699.41,-1460.94 689.37,-1457.54 689.45,-1464.54"/>
</g>
<!-- proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~set_channels_l_values</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/set_channels_l_values.html" xlink:title="set_channels_l_values">
<polygon fill="#d9534f" stroke="#d9534f" points="325.5,-1138 195.5,-1138 195.5,-1114 325.5,-1114 325.5,-1138"/>
<text text-anchor="middle" x="260.5" y="-1123.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_l_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_l_values</title>
<path fill="none" stroke="#ff0000" d="M41.93,-910.18C46.41,-942.66 63.06,-1032.07 115,-1080 134.39,-1097.89 160.74,-1108.82 185.62,-1115.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="184.89,-1118.93 195.44,-1117.94 186.58,-1112.13 184.89,-1118.93"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="379.5,-318 141.5,-318 141.5,-294 379.5,-294 379.5,-318"/>
<text text-anchor="middle" x="260.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.18,-885.58C38.53,-809.71 33.77,-409.42 115,-327 120.08,-321.84 125.83,-317.58 132.02,-314.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="133.98,-317 141.41,-309.44 130.89,-310.72 133.98,-317"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="581,-337 469,-337 469,-313 581,-313 581,-337"/>
<text text-anchor="middle" x="525" y="-322.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.86,-885.99C42.97,-824.36 55.73,-544.37 115,-487 208.94,-396.07 304.57,-526.48 406,-444 442,-414.72 407.57,-377.11 442,-346 447.06,-341.43 452.97,-337.83 459.26,-334.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="460.63,-338.22 468.7,-331.36 458.11,-331.69 460.63,-338.22"/>
</g>
<!-- proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~check_dtol_otol</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/check_dtol_otol.html" xlink:title="check_dtol_otol">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-66 213,-66 213,-42 308,-42 308,-66"/>
<text text-anchor="middle" x="260.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_dtol_otol</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~check_dtol_otol</title>
<path fill="none" stroke="#ff0000" d="M40.71,-885.78C42.5,-788.15 56.6,-136.64 115,-75 137.01,-51.77 172.45,-46.34 202.72,-46.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.64,-50.31 212.76,-47.18 202.89,-43.31 202.64,-50.31"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="307.5,-24 213.5,-24 213.5,0 307.5,0 307.5,-24"/>
<text text-anchor="middle" x="260.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.65,-885.81C42.03,-785.46 53.66,-98.04 115,-33 137.11,-9.56 172.9,-4.22 203.32,-4.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.28,-8.28 213.41,-5.18 203.56,-1.29 203.28,-8.28"/>
</g>
<!-- proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~wavenumber_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/wavenumber_from_energy.html" xlink:title="wavenumber_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="840.5,-1514 685.5,-1514 685.5,-1490 840.5,-1490 840.5,-1514"/>
<text text-anchor="middle" x="763" y="-1499.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_from_energy</text>
</a>
</g>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#ff0000" d="M533.02,-1641.81C548.98,-1615.33 590.75,-1552.57 644,-1523 653.78,-1517.57 664.65,-1513.5 675.73,-1510.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="676.64,-1513.83 685.5,-1508.02 674.95,-1507.03 676.64,-1513.83"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="790,-1674 736,-1674 736,-1650 790,-1650 790,-1674"/>
<text text-anchor="middle" x="763" y="-1659.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff0000" d="M594.26,-1656.31C637.19,-1657.77 690.88,-1659.59 725.78,-1660.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="725.86,-1664.28 735.98,-1661.12 726.1,-1657.28 725.86,-1664.28"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="1007,-137 953,-137 953,-113 1007,-113 1007,-137"/>
<text text-anchor="middle" x="980" y="-122.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#ff2900" d="M360.25,-349.97C377.22,-346.04 393.42,-338.97 406,-327 466.06,-269.87 378.92,-197.78 442,-144 479.91,-111.68 828.35,-120.07 942.78,-123.73"/>
<polygon fill="#ff2900" stroke="#ff2900" points="942.69,-127.23 952.79,-124.06 942.91,-120.23 942.69,-127.23"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="565,-55 485,-55 485,-31 565,-31 565,-55"/>
<text text-anchor="middle" x="525" y="-40.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ff2900" d="M360.08,-350.72C377.27,-346.77 393.59,-339.51 406,-327 489.08,-243.23 363.49,-152.07 442,-64 450.49,-54.48 462.65,-49 475.01,-45.92"/>
<polygon fill="#ff2900" stroke="#ff2900" points="475.79,-49.33 484.9,-43.93 474.41,-42.47 475.79,-49.33"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="597.5,-97 452.5,-97 452.5,-73 597.5,-73 597.5,-97"/>
<text text-anchor="middle" x="525" y="-82.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ff2900" d="M360.16,-350.35C377.25,-346.41 393.5,-339.24 406,-327 475.53,-258.9 378.23,-184.52 442,-111 444.86,-107.7 448.14,-104.81 451.7,-102.29"/>
<polygon fill="#ff2900" stroke="#ff2900" points="453.69,-105.18 460.47,-97.04 450.09,-99.18 453.69,-105.18"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff5200" d="M816.26,-1806.44C837.19,-1802.4 861.21,-1796.47 882,-1788 1029.9,-1727.72 1095.27,-1728.73 1187,-1598 1228.47,-1538.9 1257.22,-1312.97 1265.53,-1240.51"/>
<polygon fill="#ff5200" stroke="#ff5200" points="1269.04,-1240.57 1266.68,-1230.25 1262.09,-1239.79 1269.04,-1240.57"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff5200" d="M816.06,-1810.39C837.77,-1806.97 862.43,-1800.43 882,-1788 887.53,-1784.49 938.24,-1716.85 964.05,-1682.16"/>
<polygon fill="#ff5200" stroke="#ff5200" points="966.88,-1684.22 970.03,-1674.11 961.26,-1680.04 966.88,-1684.22"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffa500" d="M815.59,-870.04C903.43,-893.06 1082.63,-951.35 1187,-1064 1224.08,-1104.02 1249.15,-1164.21 1260.71,-1196.2"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1257.49,-1197.62 1264.1,-1205.9 1264.1,-1195.3 1257.49,-1197.62"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ffa500" d="M882.19,-858C890.84,-858 899.39,-858 907.62,-858"/>
<polygon fill="#ffa500" stroke="#ffa500" points="907.86,-861.5 917.86,-858 907.86,-854.5 907.86,-861.5"/>
</g>
<!-- proc~crosssection&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~crosssection&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ffce00" d="M573.01,-1508.33C594.61,-1512.98 620.57,-1518.43 644,-1523 667.63,-1527.6 693.99,-1532.33 715.8,-1536.14"/>
<polygon fill="#ffce00" stroke="#ffce00" points="715.34,-1539.61 725.79,-1537.87 716.54,-1532.71 715.34,-1539.61"/>
</g>
<!-- proc~crosssection&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~crosssection&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ffce00" d="M573.19,-1490.4C606.41,-1485.05 651.5,-1477.79 689.29,-1471.71"/>
<polygon fill="#ffce00" stroke="#ffce00" points="689.92,-1475.15 699.23,-1470.11 688.8,-1468.24 689.92,-1475.15"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="790,-992 736,-992 736,-968 790,-968 790,-992"/>
<text text-anchor="middle" x="763" y="-977.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~potential_interpolation&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~potential_interpolation&#45;&gt;proc~spline</title>
<path fill="none" stroke="#b3ff00" d="M327.19,-978.26C434.14,-978.69 642.34,-979.52 725.96,-979.86"/>
<polygon fill="#b3ff00" stroke="#b3ff00" points="725.97,-983.36 735.99,-979.9 726,-976.36 725.97,-983.36"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#37ff00" d="M290.71,-502.56C323.84,-494.81 377.01,-477.3 406,-441 453.65,-381.33 383.58,-322.17 442,-273 463.04,-255.3 872.43,-261.64 882,-265 1045.81,-322.46 1103.03,-357.07 1187,-509 1254.58,-631.27 1265.95,-1088.38 1267.7,-1195.46"/>
<polygon fill="#37ff00" stroke="#37ff00" points="1264.21,-1195.79 1267.86,-1205.74 1271.21,-1195.68 1264.21,-1195.79"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#37ff00" d="M290.57,-508.42C326.24,-508.92 388.57,-509.7 442,-510 515.78,-510.41 539.44,-537.26 608,-510 628.45,-501.87 623.55,-484.13 644,-476 726.19,-443.32 962.71,-436.82 1042,-476 1082.23,-495.88 1109.35,-543.46 1122.44,-571.44"/>
<polygon fill="#37ff00" stroke="#37ff00" points="1119.34,-573.08 1126.63,-580.78 1125.73,-570.22 1119.34,-573.08"/>
</g>
<!-- proc~numerov&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~numerov&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#37ff00" d="M266.67,-520.21C288.32,-571.9 372.08,-778.4 406,-957 417.67,-1018.47 402.3,-1470.63 442,-1519 458.43,-1539.02 825.24,-1626.09 942.98,-1653.62"/>
<polygon fill="#37ff00" stroke="#37ff00" points="942.4,-1657.09 952.94,-1655.95 944,-1650.27 942.4,-1657.09"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#37ff00" d="M290.65,-503.47C323.99,-496.67 377.6,-480.48 406,-444 464.43,-368.93 379.53,-304.75 442,-233 451.14,-222.5 464.5,-216.2 477.8,-212.43"/>
<polygon fill="#37ff00" stroke="#37ff00" points="478.97,-215.75 487.88,-210.02 477.34,-208.94 478.97,-215.75"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="835.5,-298 690.5,-298 690.5,-274 835.5,-274 835.5,-298"/>
<text text-anchor="middle" x="763" y="-283.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#37ff00" d="M290.72,-502.92C323.6,-495.64 376.3,-479.07 406,-444 447.52,-394.98 392.35,-344.78 442,-304 477.08,-275.18 597.48,-275.79 680.16,-280.02"/>
<polygon fill="#37ff00" stroke="#37ff00" points="680.12,-283.52 690.3,-280.57 680.5,-276.53 680.12,-283.52"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="826.5,-382 699.5,-382 699.5,-358 826.5,-358 826.5,-382"/>
<text text-anchor="middle" x="763" y="-367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#37ff00" d="M290.6,-509.33C321.71,-509.36 371.23,-505.21 406,-482 430.61,-465.57 417.35,-442.37 442,-426 462.33,-412.5 601.44,-391.65 689.43,-379.57"/>
<polygon fill="#37ff00" stroke="#37ff00" points="689.93,-383.03 699.36,-378.21 688.98,-376.1 689.93,-383.03"/>
</g>
<!-- proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~cenitrfugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/cenitrfugal_matrix.html" xlink:title="cenitrfugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="580,-459 470,-459 470,-435 580,-435 580,-459"/>
<text text-anchor="middle" x="525" y="-444.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cenitrfugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~numerov&#45;&gt;proc~cenitrfugal_matrix</title>
<path fill="none" stroke="#37ff00" d="M290.66,-504.44C320.11,-500.45 366.74,-493.05 406,-482 422.52,-477.35 425.66,-473.25 442,-468 448.83,-465.81 456.04,-463.69 463.23,-461.69"/>
<polygon fill="#37ff00" stroke="#37ff00" points="464.25,-465.04 472.99,-459.05 462.42,-458.28 464.25,-465.04"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="575.5,-501 474.5,-501 474.5,-477 575.5,-477 575.5,-501"/>
<text text-anchor="middle" x="525" y="-486.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#37ff00" d="M290.6,-505.89C332.23,-502.88 409.75,-497.27 463.99,-493.34"/>
<polygon fill="#37ff00" stroke="#37ff00" points="464.45,-496.82 474.17,-492.61 463.95,-489.84 464.45,-496.82"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-379 452,-379 452,-355 598,-355 598,-379"/>
<text text-anchor="middle" x="525" y="-364.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#37ff00" d="M290.63,-510.52C322.46,-511.67 373.26,-508.6 406,-482 439.12,-455.1 410.68,-421.98 442,-393 445.87,-389.41 450.24,-386.32 454.89,-383.66"/>
<polygon fill="#37ff00" stroke="#37ff00" points="456.75,-386.64 464.13,-379.04 453.62,-380.38 456.75,-386.64"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00ff44" d="M544.83,-1091.99C567.49,-1078.08 607.09,-1055.5 644,-1043 665.85,-1035.6 690.9,-1030.67 712.29,-1027.46"/>
<polygon fill="#00ff44" stroke="#00ff44" points="713.05,-1030.89 722.46,-1026.02 712.07,-1023.96 713.05,-1030.89"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#00ff44" d="M529.37,-1116.06C548.55,-1184.6 642.99,-1522.09 644,-1523 663.23,-1540.42 691.72,-1545.85 715.89,-1546.84"/>
<polygon fill="#00ff44" stroke="#00ff44" points="715.88,-1550.34 725.94,-1547.02 716,-1543.35 715.88,-1550.34"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="801,-1156 725,-1156 725,-1132 801,-1132 801,-1156"/>
<text text-anchor="middle" x="763" y="-1141.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#00ff44" d="M570.67,-1111.57C611.9,-1118.56 672.93,-1128.9 714.91,-1136.02"/>
<polygon fill="#00ff44" stroke="#00ff44" points="714.44,-1139.49 724.89,-1137.71 715.61,-1132.59 714.44,-1139.49"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="800,-1236 726,-1236 726,-1212 800,-1212 800,-1236"/>
<text text-anchor="middle" x="763" y="-1221.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#00ff44" d="M537.46,-1116.21C557.2,-1136.48 599.79,-1176.93 644,-1198 666.42,-1208.68 693.33,-1215.05 715.79,-1218.8"/>
<polygon fill="#00ff44" stroke="#00ff44" points="715.35,-1222.27 725.77,-1220.35 716.42,-1215.36 715.35,-1222.27"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="810.5,-1076 715.5,-1076 715.5,-1052 810.5,-1052 810.5,-1076"/>
<text text-anchor="middle" x="763" y="-1061.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#00ff44" d="M570.67,-1096.43C608.94,-1089.94 664.26,-1080.57 705.58,-1073.56"/>
<polygon fill="#00ff44" stroke="#00ff44" points="706.22,-1077 715.5,-1071.88 705.05,-1070.1 706.22,-1077"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~potential_read&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff6e" d="M569.5,-897.91C636.79,-897.27 770.05,-894.01 882,-879 894.53,-877.32 907.85,-874.88 920.47,-872.25"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="921.38,-875.63 930.42,-870.11 919.91,-868.79 921.38,-875.63"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~potential_read&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#00ff6e" d="M540.71,-885.97C559.41,-869.81 591.29,-839.27 608,-806 643.64,-735.04 584.45,-683.53 644,-631 675.08,-603.59 942.36,-595.88 1067.44,-593.77"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="1067.7,-597.27 1077.64,-593.61 1067.59,-590.27 1067.7,-597.27"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~potential_read&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00ff6e" d="M535.9,-910.21C554.53,-932.27 597.16,-978.55 644,-1001 665.14,-1011.13 690.53,-1016.41 712.33,-1019.15"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="712.06,-1022.64 722.38,-1020.27 712.83,-1015.68 712.06,-1022.64"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1015,-1270 945,-1270 945,-1246 1015,-1246 1015,-1270"/>
<text text-anchor="middle" x="980" y="-1255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~potential_read&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~potential_read&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff6e" d="M531.39,-910.11C544.52,-939.65 579.22,-1017.75 608,-1083 624.06,-1119.42 612.5,-1140.67 644,-1165 728.77,-1230.48 784.11,-1159.5 882,-1203 900.77,-1211.34 900.38,-1221.43 918,-1232 923.9,-1235.54 930.38,-1238.85 936.83,-1241.84"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="935.65,-1245.14 946.21,-1245.97 938.47,-1238.73 935.65,-1245.14"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffc0" d="M810.34,-517.95C897.64,-498.35 1086.7,-471.14 1187,-572 1232.08,-617.33 1260.74,-1087.09 1266.8,-1195.68"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="1263.31,-1196.03 1267.36,-1205.82 1270.3,-1195.64 1263.31,-1196.03"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffc0" d="M831.13,-527.94C849.89,-530.75 868.75,-537.33 882,-551 958.92,-630.33 868.42,-698.25 918,-797 926.32,-813.58 940.87,-828.4 953.68,-839.27"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="951.78,-842.25 961.75,-845.83 956.2,-836.81 951.78,-842.25"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#00ffc0" d="M831.41,-541.56C898.91,-553.13 1002.01,-570.8 1068.07,-582.13"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="1067.49,-585.58 1077.94,-583.82 1068.68,-578.68 1067.49,-585.58"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffea" d="M820.55,-943.22C840.48,-946.31 862.7,-951.21 882,-959 1035.76,-1021.05 1191.34,-1150.32 1246.78,-1198.95"/>
<polygon fill="#00ffea" stroke="#00ffea" points="1244.7,-1201.79 1254.51,-1205.78 1249.34,-1196.54 1244.7,-1201.79"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffea" d="M820.8,-928.97C840.53,-924.92 862.58,-919.36 882,-912 907.09,-902.49 933.58,-887.35 952.52,-875.52"/>
<polygon fill="#00ffea" stroke="#00ffea" points="954.62,-878.34 961.18,-870.02 950.86,-872.43 954.62,-878.34"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00c0ff" d="M373.61,-1727.04C441.52,-1725.82 529.84,-1723.08 608,-1717 730.34,-1707.49 761.02,-1703.56 882,-1683 902.26,-1679.56 924.69,-1674.76 942.88,-1670.63"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="943.82,-1674 952.78,-1668.35 942.24,-1667.18 943.82,-1674"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0097ff" d="M572.11,-1418.86C640.27,-1419.44 771.76,-1417.91 882,-1401 954.67,-1389.85 971.84,-1380.98 1042,-1359 1107.48,-1338.49 1129.93,-1344.1 1187,-1306 1214.41,-1287.7 1238.96,-1258.28 1253.67,-1238.55"/>
<polygon fill="#0097ff" stroke="#0097ff" points="1256.66,-1240.39 1259.71,-1230.24 1251,-1236.27 1256.66,-1240.39"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#0097ff" d="M572.06,-1410.58C612.25,-1404.11 670.45,-1394.74 711.81,-1388.08"/>
<polygon fill="#0097ff" stroke="#0097ff" points="712.63,-1391.49 721.94,-1386.45 711.51,-1384.58 712.63,-1391.49"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1176,-788 1089,-788 1089,-764 1176,-764 1176,-788"/>
<text text-anchor="middle" x="1132.5" y="-773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0097ff" d="M526.79,-1405.71C530.46,-1359.95 549.85,-1198.25 644,-1123 727.67,-1056.12 783.46,-1127 882,-1085 964.02,-1050.04 985.68,-1033.11 1042,-964 1084.82,-911.46 1112.92,-835.04 1124.9,-797.9"/>
<polygon fill="#0097ff" stroke="#0097ff" points="1128.32,-798.7 1127.97,-788.11 1121.64,-796.6 1128.32,-798.7"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#006eff" d="M803.74,-1022.53C828.07,-1021.1 858.87,-1016 882,-1001 927.87,-971.24 957.6,-911.37 970.91,-879.35"/>
<polygon fill="#006eff" stroke="#006eff" points="974.19,-880.59 974.66,-870 967.69,-877.98 974.19,-880.59"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#006eff" d="M803.72,-1019.23C828.97,-1019.63 860.79,-1024.42 882,-1043 921.65,-1077.73 896.33,-1107.95 918,-1156 931.39,-1185.69 951.45,-1217.54 964.88,-1237.6"/>
<polygon fill="#006eff" stroke="#006eff" points="962.02,-1239.62 970.53,-1245.94 967.81,-1235.7 962.02,-1239.62"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0044ff" d="M804.02,-1376.61C858.84,-1371.14 959.87,-1358.13 1042,-1331 1116.93,-1306.25 1198.15,-1260.48 1239.82,-1235.46"/>
<polygon fill="#0044ff" stroke="#0044ff" points="1241.84,-1238.33 1248.58,-1230.16 1238.21,-1232.34 1241.84,-1238.33"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1027,-1322 933,-1322 933,-1298 1027,-1298 1027,-1322"/>
<text text-anchor="middle" x="980" y="-1307.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#0044ff" d="M804.16,-1373.31C827.25,-1368.93 856.62,-1362.45 882,-1354 904.26,-1346.59 928.28,-1335.72 946.85,-1326.63"/>
<polygon fill="#0044ff" stroke="#0044ff" points="948.63,-1329.66 956.03,-1322.07 945.52,-1323.39 948.63,-1329.66"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0044ff" d="M804.06,-1379.32C828.66,-1377.05 859.64,-1370.68 882,-1354 908.47,-1334.25 894.24,-1311.93 918,-1289 923.71,-1283.49 930.59,-1278.74 937.65,-1274.74"/>
<polygon fill="#0044ff" stroke="#0044ff" points="939.36,-1277.8 946.6,-1270.06 936.12,-1271.59 939.36,-1277.8"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#001bff" d="M596.81,-1685.8C639.38,-1679.67 691.77,-1672.12 725.98,-1667.19"/>
<polygon fill="#001bff" stroke="#001bff" points="726.58,-1670.64 735.98,-1665.75 725.58,-1663.71 726.58,-1670.64"/>
</g>
<!-- proc~set_number_of_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~set_number_of_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#3700ff" d="M333.44,-1333.78C450.32,-1341.22 687.96,-1348.22 882,-1302 894.81,-1298.95 923.37,-1285.68 946.21,-1274.5"/>
<polygon fill="#3700ff" stroke="#3700ff" points="947.84,-1277.6 955.26,-1270.04 944.75,-1271.32 947.84,-1277.6"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#6000ff" d="M284.03,-1219.07C317.4,-1236.19 382.45,-1266.71 442,-1278 634.13,-1314.43 687.45,-1297.85 882,-1278 899.42,-1276.22 918.34,-1272.69 934.8,-1269.09"/>
<polygon fill="#6000ff" stroke="#6000ff" points="935.72,-1272.47 944.7,-1266.85 934.17,-1265.64 935.72,-1272.47"/>
</g>
<!-- proc~calculate_single_sf_element -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~calculate_single_sf_element</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/calculate_single_sf_element.html" xlink:title="calculate_single_SF_element">
<polygon fill="#d9534f" stroke="#d9534f" points="608,-177 442,-177 442,-153 608,-153 608,-177"/>
<text text-anchor="middle" x="525" y="-162.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_single_SF_element</text>
</a>
</g>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix&#45;&gt;proc~calculate_single_sf_element -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~calculate_sf_matrix_from_bf_matrix&#45;&gt;proc~calculate_single_sf_element</title>
<path fill="none" stroke="#8900ff" d="M361.36,-391.7C377.93,-387.72 393.69,-380.71 406,-369 466.06,-311.87 385.06,-246.24 442,-186 442.94,-185.01 443.91,-184.06 444.93,-183.16"/>
<polygon fill="#8900ff" stroke="#8900ff" points="447.31,-185.75 453.32,-177.02 443.18,-180.1 447.31,-185.75"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#b300ff" d="M542.13,-797.24C561.72,-813.17 593.88,-843.02 608,-877 633.79,-939.09 599.31,-1430.77 644,-1481 652.4,-1490.45 663.46,-1496.59 675.45,-1500.47"/>
<polygon fill="#b300ff" stroke="#b300ff" points="674.66,-1503.88 685.22,-1503.11 676.49,-1497.12 674.66,-1503.88"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="790,-340 736,-340 736,-316 790,-316 790,-340"/>
<text text-anchor="middle" x="763" y="-325.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#b300ff" d="M529.99,-772.75C542.43,-734.3 581.31,-612.45 608,-510 626.49,-439.05 591.03,-399.7 644,-349 665.4,-328.51 699.5,-324.32 725.55,-324.63"/>
<polygon fill="#b300ff" stroke="#b300ff" points="725.69,-328.14 735.81,-324.99 725.93,-321.14 725.69,-328.14"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="809.5,-584 716.5,-584 716.5,-560 809.5,-560 809.5,-584"/>
<text text-anchor="middle" x="763" y="-569.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#b300ff" d="M535.07,-772.68C550.69,-751.25 583.36,-705.53 608,-665 625.56,-636.12 617.03,-618.39 644,-598 661.84,-584.51 685.29,-577.75 706.58,-574.45"/>
<polygon fill="#b300ff" stroke="#b300ff" points="707.05,-577.92 716.5,-573.13 706.12,-570.98 707.05,-577.92"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#b300ff" d="M542.17,-797.22C561.8,-813.13 594,-842.96 608,-877 666.23,-1018.59 575,-1428.33 644,-1565 662.15,-1600.94 700.28,-1628.37 728.3,-1644.74"/>
<polygon fill="#b300ff" stroke="#b300ff" points="726.95,-1648 737.38,-1649.87 730.39,-1641.9 726.95,-1648"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="833,-664 693,-664 693,-640 833,-640 833,-664"/>
<text text-anchor="middle" x="763" y="-649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#b300ff" d="M534.8,-772.82C552.54,-749.29 595.09,-697.7 644,-673 655.91,-666.98 669.27,-662.66 682.59,-659.57"/>
<polygon fill="#b300ff" stroke="#b300ff" points="683.68,-662.91 692.75,-657.43 682.24,-656.06 683.68,-662.91"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="790,-786 736,-786 736,-762 790,-762 790,-786"/>
<text text-anchor="middle" x="763" y="-771.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#b300ff" d="M581.03,-782.43C625.6,-780.36 687.12,-777.49 725.72,-775.69"/>
<polygon fill="#b300ff" stroke="#b300ff" points="726.14,-779.18 735.97,-775.21 725.81,-772.18 726.14,-779.18"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="811,-828 715,-828 715,-804 811,-804 811,-828"/>
<text text-anchor="middle" x="763" y="-813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#b300ff" d="M581.03,-792.23C618.13,-797.1 666.98,-803.52 704.57,-808.46"/>
<polygon fill="#b300ff" stroke="#b300ff" points="704.49,-811.98 714.86,-809.81 705.4,-805.03 704.49,-811.98"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00f8" d="M826.74,-1464.22C930.4,-1469.89 1131.54,-1475.01 1187,-1434 1250.08,-1387.35 1264.05,-1285.61 1267.13,-1240.41"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="1270.64,-1240.39 1267.71,-1230.21 1263.65,-1240 1270.64,-1240.39"/>
</g>
<!-- proc~set_channels_l_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~set_channels_l_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff00ce" d="M291.09,-1138.16C354.47,-1163.54 508.63,-1221.73 644,-1245 746.97,-1262.7 870.25,-1261.97 934.73,-1259.95"/>
<polygon fill="#ff00ce" stroke="#ff00ce" points="935.06,-1263.44 944.93,-1259.61 934.82,-1256.45 935.06,-1263.44"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ff00a5" d="M379.69,-302.16C389.42,-298.04 398.41,-292.46 406,-285 476.97,-215.24 374.84,-137.44 442,-64 450.53,-54.67 462.58,-49.24 474.83,-46.14"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="475.54,-49.57 484.63,-44.13 474.13,-42.71 475.54,-49.57"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ff00a5" d="M379.71,-301.67C389.37,-297.64 398.34,-292.21 406,-285 463.48,-230.85 389.11,-169.64 442,-111 445.06,-107.6 448.57,-104.64 452.37,-102.07"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="454.18,-105.07 461.09,-97.03 450.68,-99 454.18,-105.07"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff007c" d="M581.03,-325.7C625.6,-326.27 687.12,-327.05 725.72,-327.54"/>
<polygon fill="#ff007c" stroke="#ff007c" points="725.92,-331.04 735.97,-327.67 726.01,-324.04 725.92,-331.04"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ff007c" d="M581.03,-315.91C610.53,-311.03 647.46,-304.93 680.25,-299.51"/>
<polygon fill="#ff007c" stroke="#ff007c" points="680.99,-302.94 690.28,-297.85 679.84,-296.03 680.99,-302.94"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff007c" d="M581.17,-336.51C600.97,-340.57 623.46,-345.08 644,-349 658.61,-351.79 674.27,-354.65 689.25,-357.34"/>
<polygon fill="#ff007c" stroke="#ff007c" points="689.02,-360.86 699.48,-359.17 690.25,-353.97 689.02,-360.86"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M840.61,-1506.65C855.14,-1509.96 869.64,-1515.1 882,-1523 926.77,-1551.62 956.65,-1609.03 970.36,-1640.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="967.28,-1642.07 974.39,-1649.92 973.73,-1639.35 967.28,-1642.07"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M840.62,-1501.89C856,-1498.42 870.84,-1492.06 882,-1481 943.67,-1419.89 865.94,-1358.48 918,-1289 922.76,-1282.65 929.19,-1277.5 936.09,-1273.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="937.8,-1276.42 945,-1268.64 934.52,-1270.23 937.8,-1276.42"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff4200" d="M790.37,-979.92C815.33,-978.81 853.19,-974.4 882,-959 918.12,-939.69 948.71,-902.05 965.41,-878.57"/>
<polygon fill="#ff4200" stroke="#ff4200" points="968.29,-880.55 971.11,-870.34 962.54,-876.57 968.29,-880.55"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff4200" d="M790.16,-977.03C816.79,-975.55 857.55,-977.79 882,-1001 933.29,-1049.69 891.53,-1090.42 918,-1156 930.12,-1186.03 950.31,-1217.58 964.12,-1237.5"/>
<polygon fill="#ff4200" stroke="#ff4200" points="961.34,-1239.63 969.96,-1245.78 967.06,-1235.59 961.34,-1239.63"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff8500" d="M801.24,-1143.78C825.32,-1144.96 856.75,-1149.03 882,-1161 901.61,-1170.29 898.05,-1185.44 918,-1194 1015.23,-1235.71 1141.66,-1231.86 1212.89,-1225.08"/>
<polygon fill="#ff8500" stroke="#ff8500" points="1213.39,-1228.55 1222.99,-1224.07 1212.69,-1221.59 1213.39,-1228.55"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff8500" d="M801.18,-1133.01C826.78,-1123.8 860.01,-1108.34 882,-1085 939.29,-1024.17 965.58,-924.32 974.86,-880.18"/>
<polygon fill="#ff8500" stroke="#ff8500" points="978.32,-880.7 976.86,-870.21 971.46,-879.33 978.32,-880.7"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff8500" d="M801.18,-1155.35C826.62,-1164.7 859.65,-1180.17 882,-1203 908.15,-1229.71 891.94,-1252.21 918,-1279 923.3,-1284.44 929.75,-1289.1 936.46,-1293.03"/>
<polygon fill="#ff8500" stroke="#ff8500" points="935.2,-1296.32 945.67,-1297.93 938.49,-1290.15 935.2,-1296.32"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff8500" d="M801.2,-1144.6C826.16,-1146.7 858.62,-1152.93 882,-1170 907.73,-1188.79 894.12,-1210.9 918,-1232 923.16,-1236.56 929.23,-1240.41 935.52,-1243.63"/>
<polygon fill="#ff8500" stroke="#ff8500" points="934.25,-1246.89 944.79,-1247.9 937.18,-1240.54 934.25,-1246.89"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#f3ff00" d="M809.22,-584.03C834.29,-592.98 863.95,-607.76 882,-631 928.31,-690.62 881.84,-730.73 918,-797 926.94,-813.39 941.65,-828.29 954.38,-839.26"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="952.44,-842.2 962.38,-845.87 956.9,-836.8 952.44,-842.2"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#f3ff00" d="M809.63,-581.1C867.56,-594.26 968.78,-622.7 1042,-673 1074.58,-695.38 1102.71,-732.34 1118.35,-755.37"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1115.46,-757.34 1123.9,-763.74 1121.29,-753.47 1115.46,-757.34"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="1007,-179 953,-179 953,-155 1007,-155 1007,-179"/>
<text text-anchor="middle" x="980" y="-164.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#f3ff00" d="M809.72,-576.16C834.64,-575.76 863.98,-570.47 882,-551 937.06,-491.51 867.72,-251.59 918,-188 924.19,-180.18 933.45,-175.25 942.9,-172.16"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="943.94,-175.51 952.7,-169.56 942.14,-168.74 943.94,-175.51"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#b1ff00" d="M790.36,-1662C828.59,-1662 899.53,-1662 942.68,-1662"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="942.76,-1665.5 952.76,-1662 942.76,-1658.5 942.76,-1665.5"/>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ff9b" d="M574.98,-434.88C586.18,-431.19 597.78,-426.59 608,-421 626.27,-411 625.12,-399.78 644,-391 658.01,-384.48 673.81,-379.98 689.2,-376.87"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="690.02,-380.28 699.22,-375.02 688.75,-373.4 690.02,-380.28"/>
</g>
<!-- dfloat -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>dfloat</title>
<polygon fill="#777777" stroke="#777777" points="790,-424 736,-424 736,-400 790,-400 790,-424"/>
<text text-anchor="middle" x="763" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfloat</text>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;dfloat -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;dfloat</title>
<path fill="none" stroke="#00ff9b" d="M580.14,-438.97C624.67,-432.37 686.57,-423.19 725.44,-417.42"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="726.38,-420.82 735.76,-415.89 725.36,-413.9 726.38,-420.82"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ffdd" d="M575.72,-483.63C587.26,-480.49 598.84,-475.6 608,-468 637.09,-443.89 614.04,-414.01 644,-391 656.98,-381.03 673.13,-375.21 689.27,-371.92"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="690.04,-375.34 699.29,-370.19 688.84,-368.44 690.04,-375.34"/>
</g>
<!-- proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~radtermvalue</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/radtermvalue.html" xlink:title="RADTERMVALUE">
<polygon fill="#d9534f" stroke="#d9534f" points="811.5,-706 714.5,-706 714.5,-682 811.5,-682 811.5,-706"/>
<text text-anchor="middle" x="763" y="-691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RADTERMVALUE</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~radtermvalue</title>
<path fill="none" stroke="#00ffdd" d="M529.96,-501.36C541.48,-535.1 578.34,-629.19 644,-673 661.62,-684.76 683.89,-690.48 704.32,-693.12"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="704.17,-696.62 714.49,-694.2 704.91,-689.66 704.17,-696.62"/>
</g>
<!-- proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~p_coeff</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/p_coeff.html" xlink:title="p_coeff">
<polygon fill="#d94e8f" stroke="#d94e8f" points="790,-177 736,-177 736,-153 790,-153 790,-177"/>
<text text-anchor="middle" x="763" y="-162.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_coeff</text>
</a>
</g>
</g>
<!-- proc~calculate_single_sf_element&#45;&gt;proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~calculate_single_sf_element&#45;&gt;proc~p_coeff</title>
<path fill="none" stroke="#00ddff" d="M608.21,-165C648.19,-165 694.23,-165 725.44,-165"/>
<polygon fill="#00ddff" stroke="#00ddff" points="725.82,-168.5 735.82,-165 725.82,-161.5 725.82,-168.5"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#0016ff" d="M598.09,-355.09C640.47,-348.08 692.21,-339.53 726.08,-333.94"/>
<polygon fill="#0016ff" stroke="#0016ff" points="726.69,-337.38 735.99,-332.3 725.55,-330.48 726.69,-337.38"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#0016ff" d="M588.86,-354.94C595.55,-352.49 602.07,-349.54 608,-346 628.26,-333.91 623.31,-318.32 644,-307 655.09,-300.93 667.56,-296.56 680.14,-293.42"/>
<polygon fill="#0016ff" stroke="#0016ff" points="681.23,-296.76 690.22,-291.16 679.7,-289.93 681.23,-296.76"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0016ff" d="M598.09,-367.92C626.95,-368.28 660.15,-368.71 689.09,-369.07"/>
<polygon fill="#0016ff" stroke="#0016ff" points="689.09,-372.57 699.13,-369.2 689.18,-365.57 689.09,-372.57"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#2c00ff" d="M833.08,-651.6C850.8,-654.67 868.61,-660.97 882,-673 924.68,-711.36 888.79,-747.6 918,-797 927.57,-813.18 942.42,-828.16 955.07,-839.22"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="953.09,-842.13 962.99,-845.9 957.6,-836.78 953.09,-842.13"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#2c00ff" d="M833.21,-656.24C849.97,-659.4 867.28,-664.59 882,-673 903.35,-685.2 897.3,-701.73 918,-715 931.69,-723.78 1020.09,-747.49 1078.76,-762.63"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1078.07,-766.06 1088.63,-765.17 1079.82,-759.29 1078.07,-766.06"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="1007,-221 953,-221 953,-197 1007,-197 1007,-221"/>
<text text-anchor="middle" x="980" y="-206.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#2c00ff" d="M808.35,-639.95C833.43,-630.94 863.41,-616.11 882,-593 972.24,-480.78 979.75,-295.18 979.5,-231.36"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="983,-231.19 979.38,-221.23 976,-231.26 983,-231.19"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#6e00ff" d="M793.88,-1076.17C818.53,-1086.84 853.89,-1103.65 882,-1123 899.88,-1135.31 898.54,-1146.39 918,-1156 968.98,-1181.17 1127.89,-1202.23 1212.96,-1212.05"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1212.62,-1215.54 1222.95,-1213.19 1213.41,-1208.58 1212.62,-1215.54"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#6e00ff" d="M810.6,-1065.07C833.99,-1063.42 861.6,-1057.94 882,-1043 937.63,-1002.27 964.13,-920 974.09,-880.35"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="977.55,-880.91 976.47,-870.37 970.74,-879.29 977.55,-880.91"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#6e00ff" d="M810.7,-1062.32C833.31,-1059.89 860.21,-1054.54 882,-1043 972,-995.35 990.71,-966.97 1042,-879 1070.9,-829.42 1061,-809.81 1078,-755 1093.62,-704.64 1113.39,-645.99 1123.98,-614.92"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1127.4,-615.74 1127.32,-605.14 1120.77,-613.47 1127.4,-615.74"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#6e00ff" d="M810.47,-1076.06C835.47,-1084.95 864.65,-1099.66 882,-1123 937.97,-1198.29 901.5,-1238.64 918,-1331 938.82,-1447.53 964.89,-1586.92 974.86,-1640.01"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="971.45,-1640.8 976.74,-1649.99 978.33,-1639.51 971.45,-1640.8"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#b100ff" d="M1015.33,-1254.15C1056.27,-1249.45 1126.75,-1241 1187,-1232 1195.32,-1230.76 1204.1,-1229.34 1212.69,-1227.91"/>
<polygon fill="#b100ff" stroke="#b100ff" points="1213.38,-1231.34 1222.65,-1226.21 1212.2,-1224.44 1213.38,-1231.34"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0085" d="M1138.65,-788.21C1148.74,-812.34 1171.43,-867.98 1187,-916 1220.53,-1019.43 1251.18,-1145.89 1262.93,-1196.02"/>
<polygon fill="#ff0085" stroke="#ff0085" points="1259.52,-1196.84 1265.2,-1205.79 1266.34,-1195.25 1259.52,-1196.84"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0042" d="M811.16,-823.98C832.78,-827.75 858.73,-832.41 882,-837 892.74,-839.12 904.13,-841.48 915.18,-843.83"/>
<polygon fill="#ff0042" stroke="#ff0042" points="914.69,-847.31 925.2,-845.98 916.16,-840.46 914.69,-847.31"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0042" d="M811.47,-815.1C867.02,-813.5 961.63,-809.09 1042,-797 1054.08,-795.18 1066.94,-792.57 1079.04,-789.81"/>
<polygon fill="#ff0042" stroke="#ff0042" points="1080.05,-793.17 1088.98,-787.46 1078.44,-786.35 1080.05,-793.17"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="1007,-788 953,-788 953,-764 1007,-764 1007,-788"/>
<text text-anchor="middle" x="980" y="-773.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#ff0042" d="M811.12,-807.81C832.73,-804 858.68,-799.36 882,-795 902.12,-791.24 924.54,-786.86 942.76,-783.25"/>
<polygon fill="#ff0042" stroke="#ff0042" points="943.55,-786.66 952.68,-781.28 942.18,-779.8 943.55,-786.66"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1159.5,-221 1105.5,-221 1105.5,-197 1159.5,-197 1159.5,-221"/>
<text text-anchor="middle" x="1132.5" y="-206.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ff0000" d="M1007.22,-174.32C1031.63,-181.13 1068.26,-191.35 1095.43,-198.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1094.76,-202.38 1105.33,-201.7 1096.64,-195.64 1094.76,-202.38"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1159.5,-179 1105.5,-179 1105.5,-155 1159.5,-155 1159.5,-179"/>
<text text-anchor="middle" x="1132.5" y="-164.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ff0000" d="M1007.22,-167C1031.53,-167 1067.93,-167 1095.07,-167"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1095.33,-170.5 1105.33,-167 1095.33,-163.5 1095.33,-170.5"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ffff00" d="M811.6,-694.86C834.97,-697.51 862.27,-704.2 882,-720 911.49,-743.61 896.32,-766.07 918,-797 928.93,-812.59 944.05,-827.75 956.5,-839.05"/>
<polygon fill="#ffff00" stroke="#ffff00" points="954.42,-841.88 964.23,-845.88 959.06,-836.64 954.42,-841.88"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ffff00" d="M810.01,-706.08C835.02,-715 864.36,-729.72 882,-753 911.92,-792.49 962.88,-1143.18 975.9,-1235.7"/>
<polygon fill="#ffff00" stroke="#ffff00" points="972.44,-1236.25 977.3,-1245.67 979.38,-1235.28 972.44,-1236.25"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1007,-706 953,-706 953,-682 1007,-682 1007,-706"/>
<text text-anchor="middle" x="980" y="-691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#ffff00" d="M811.72,-694C851.35,-694 906.88,-694 942.9,-694"/>
<polygon fill="#ffff00" stroke="#ffff00" points="942.96,-697.5 952.96,-694 942.96,-690.5 942.96,-697.5"/>
</g>
<!-- proc~p_coeff&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~p_coeff&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#00ff00" d="M790.36,-160.1C828.59,-152.98 899.53,-139.78 942.68,-131.76"/>
<polygon fill="#00ff00" stroke="#00ff00" points="943.57,-135.15 952.76,-129.88 942.29,-128.27 943.57,-135.15"/>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#00ffff" d="M1007.22,-209C1031.53,-209 1067.93,-209 1095.07,-209"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1095.33,-212.5 1105.33,-209 1095.33,-205.5 1095.33,-212.5"/>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#00ffff" d="M1007.22,-201.68C1031.63,-194.87 1068.26,-184.65 1095.43,-177.07"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1096.64,-180.36 1105.33,-174.3 1094.76,-173.62 1096.64,-180.36"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1296,-200 1242,-200 1242,-176 1296,-176 1296,-200"/>
<text text-anchor="middle" x="1269" y="-185.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge140" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1159.75,-204.9C1180.3,-201.69 1209.12,-197.19 1231.85,-193.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1232.47,-197.09 1241.81,-192.09 1231.39,-190.17 1232.47,-197.09"/>
</g>
<!-- proc~ispline&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge141" class="edge">
<title>proc~ispline&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#00ff00" d="M999.15,-681.82C1025.48,-664.15 1074.43,-631.3 1104.85,-610.88"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1106.93,-613.7 1113.28,-605.23 1103.03,-607.89 1106.93,-613.7"/>
</g>
<!-- proc~ispline&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge142" class="edge">
<title>proc~ispline&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ff00" d="M1007.19,-704.67C1018.11,-709.36 1030.83,-715.13 1042,-721 1063.72,-732.42 1087.33,-747.02 1104.85,-758.32"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1103.12,-761.37 1113.41,-763.88 1106.93,-755.5 1103.12,-761.37"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge143" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#0000ff" d="M1159.75,-171.1C1180.3,-174.31 1209.12,-178.81 1231.85,-182.36"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1231.39,-185.83 1241.81,-183.91 1232.47,-178.91 1231.39,-185.83"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~5">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_level_indices~13"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_level_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~3"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij~10"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~15"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_index"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_index</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_indextmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_indextmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate~2"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavmax~2"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">POTENTIAL</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PES_COUPLING_MATRIX</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">statetostateXS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w"> </span><span class="n">write_message</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_indextmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wavmax</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channels_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_read</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_reduction</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_interpolation</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_index</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_index</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channels_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channels_level_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channels_level_indices and channels_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_level_indices_channels_omega_values</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_l_values</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_bf_channels</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">! and the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_number_of_open_channels_wavmax</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">wavmax</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">wavmax</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">CROSSSECTION</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_xs</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_dtol_otol</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-02 15:00            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>