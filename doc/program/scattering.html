<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">214 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen~4">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2~4">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~8">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/potential.html'>POTENTIAL</a></li>
                <li><a href='../module/pes_coupling_matrix.html'>PES_COUPLING_MATRIX</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/statetostatexs.html'>statetostateXS</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="335pt"
 viewBox="0.00 0.00 641.00 334.78" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.34 1.34) rotate(0) translate(4 446.2)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-446.2 858,-446.2 858,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="854,-122.65 775,-122.65 775,-98.65 854,-98.65 854,-122.65"/>
<text text-anchor="middle" x="814.5" y="-108.25" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~potential -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~potential</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/potential.html" xlink:title="POTENTIAL">
<polygon fill="#337ab7" stroke="#337ab7" points="571,-141.65 500,-141.65 500,-117.65 571,-117.65 571,-141.65"/>
<text text-anchor="middle" x="535.5" y="-127.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POTENTIAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~potential</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M811.53,-122.78C804.43,-161.85 776.09,-284.15 694.5,-323.65"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C629.28,-354.26 658.58,-240.22 612,-187.65 598.25,-172.14 579.86,-157.91 564.67,-147.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="566.41,-144.38 556.16,-141.7 562.5,-150.19 566.41,-144.38"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-181.65 0,-181.65 0,-157.65 94,-157.65 94,-181.65"/>
<text text-anchor="middle" x="47" y="-167.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C640.25,-349.05 664.22,-401.19 612,-426.65 550.88,-456.46 526.61,-433.89 459,-426.65 415.14,-421.96 405.94,-401.78 362,-405.65"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="612,-295.65 459,-295.65 459,-271.65 612,-271.65 612,-295.65"/>
<text text-anchor="middle" x="535.5" y="-281.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C682.52,-328.48 625,-311.97 582.7,-298.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="583.71,-295.35 573.12,-295.68 581.6,-302.03 583.71,-295.35"/>
</g>
<!-- module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~pes_coupling_matrix</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/pes_coupling_matrix.html" xlink:title="PES_COUPLING_MATRIX">
<polygon fill="#337ab7" stroke="#337ab7" points="603.5,-253.65 467.5,-253.65 467.5,-229.65 603.5,-229.65 603.5,-253.65"/>
<text text-anchor="middle" x="535.5" y="-239.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PES_COUPLING_MATRIX</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~pes_coupling_matrix</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C652.1,-343.21 652.23,-282.57 612,-262.65 607.98,-260.66 603.75,-258.84 599.42,-257.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="600.43,-253.81 589.84,-253.75 598.09,-260.41 600.43,-253.81"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-339.65 334,-339.65 334,-315.65 388,-315.65 388,-339.65"/>
<text text-anchor="middle" x="361" y="-325.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C630.1,-353.87 602.57,-302.63 536.5,-323.65"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-375.65 490.5,-375.65 490.5,-351.65 580.5,-351.65 580.5,-375.65"/>
<text text-anchor="middle" x="535.5" y="-361.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C660.51,-339.14 621.82,-349.11 590.97,-355.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="590.01,-351.85 580.84,-357.15 591.31,-358.72 590.01,-351.85"/>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="739,-122.65 648,-122.65 648,-98.65 739,-98.65 739,-122.65"/>
<text text-anchor="middle" x="693.5" y="-108.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.86,-110.65C766.67,-110.65 757.87,-110.65 749.21,-110.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="749.14,-107.15 739.14,-110.65 749.14,-114.15 749.14,-107.15"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-260.65 134,-260.65 134,-236.65 259,-236.65 259,-260.65"/>
<text text-anchor="middle" x="196.5" y="-246.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C640.21,-348.97 663.54,-247.46 612,-220.65 513.3,-169.3 472.89,-198.53 362,-207.65"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M360,-207.65C318.72,-210.81 273.13,-223.12 240.77,-233.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="239.6,-230.14 231.18,-236.56 241.77,-236.8 239.6,-230.14"/>
</g>
<!-- module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~statetostatexs</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/statetostatexs.html" xlink:title="statetostateXS">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-417.65 490.5,-417.65 490.5,-393.65 580.5,-393.65 580.5,-417.65"/>
<text text-anchor="middle" x="535.5" y="-403.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">statetostateXS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~statetostatexs</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-323.65C652.1,-343.21 652.23,-364.73 612,-384.65 605.22,-388.01 597.82,-390.9 590.39,-393.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="589.18,-390.08 580.66,-396.37 591.25,-396.77 589.18,-390.08"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-99.65 130,-99.65 130,-75.65 263,-75.65 263,-99.65"/>
<text text-anchor="middle" x="196.5" y="-85.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M775.51,-98.64C763.89,-95.32 751,-91.99 739,-89.65 673.55,-76.91 394.44,-49.91 362,-51.65"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M360,-51.65C319.96,-53.06 275.62,-63.5 243.39,-72.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="242.39,-69.43 233.79,-75.61 244.37,-76.14 242.39,-69.43"/>
</g>
<!-- module~potential&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~potential&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.82,-123.43C485.94,-119.57 470.54,-113.4 459,-103.65 433.48,-82.09 448.05,-59.76 423,-37.65 401.16,-18.37 390.76,-18.31 362,-13.65"/>
</g>
<!-- module~potential&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~potential&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M522.57,-141.76C506.59,-158.45 478.05,-189.95 459,-220.65 438.23,-254.13 451.07,-274.01 423,-301.65 415.94,-308.61 406.73,-313.82 397.61,-317.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="396.35,-314.42 388.24,-321.24 398.83,-320.97 396.35,-314.42"/>
</g>
<!-- module~potential&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>module~potential&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.76,-136.46C453.09,-146.19 368.03,-166 299,-193.65 273.02,-204.06 245.19,-219.47 225.25,-231.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="223.44,-228.34 216.68,-236.51 227.05,-234.34 223.44,-228.34"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-103.65 299,-103.65 299,-79.65 423,-79.65 423,-103.65"/>
<text text-anchor="middle" x="361" y="-89.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~potential&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~potential&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.59,-121.96C478.65,-117.35 451.37,-111.34 426.62,-105.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="427.08,-102.4 416.56,-103.67 425.57,-109.24 427.08,-102.4"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M517.37,-295.8C501.64,-307.24 477.97,-325.18 459,-342.65 441.65,-358.63 442.47,-368.33 423,-381.65 398.96,-398.1 391.02,-403.09 362,-405.65"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M360,-405.65C288.06,-411.99 264.39,-432.89 197.5,-405.65"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M487.36,-295.67C459.18,-302.86 423.93,-311.85 398,-318.47"/>
<polygon fill="#cbff00" stroke="#cbff00" points="397.02,-315.11 388.2,-320.97 398.75,-321.89 397.02,-315.11"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M360,-287.65C329.53,-278.14 295.23,-269.6 266.03,-262.95"/>
<polygon fill="#cbff00" stroke="#cbff00" points="266.45,-259.46 255.93,-260.68 264.91,-266.29 266.45,-259.46"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M460.87,-295.65C429.73,-298.12 393.45,-297.47 362,-287.65"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M360,-287.65C332.89,-279.19 318.25,-289.52 299,-268.65 249.58,-215.08 312.2,-162.43 263,-108.65 262.09,-107.66 261.14,-106.72 260.15,-105.82"/>
<polygon fill="#cbff00" stroke="#cbff00" points="261.96,-102.81 251.82,-99.75 257.84,-108.46 261.96,-102.81"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M473.36,-271.52C468.22,-269.09 463.34,-266.16 459,-262.65 432.12,-240.89 439.88,-223.84 423,-193.65 407.02,-165.07 387.41,-132.73 374.81,-112.27"/>
<polygon fill="#cbff00" stroke="#cbff00" points="377.79,-110.43 369.56,-103.76 371.83,-114.11 377.79,-110.43"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-259.65 334,-259.65 334,-235.65 388,-235.65 388,-259.65"/>
<text text-anchor="middle" x="361" y="-245.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M476.58,-271.56C450.61,-266.14 420.78,-259.92 398.07,-255.18"/>
<polygon fill="#cbff00" stroke="#cbff00" points="398.68,-251.73 388.17,-253.11 397.25,-258.58 398.68,-251.73"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M512.64,-229.56C490.71,-218.09 455.59,-201.46 423,-193.65 312.27,-167.11 178.21,-165.61 104.11,-167.33"/>
<polygon fill="#33ff00" stroke="#33ff00" points="103.96,-163.84 94.06,-167.6 104.15,-170.83 103.96,-163.84"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M477.79,-253.67C471.22,-256.14 464.81,-259.11 459,-262.65 438.87,-274.95 442.28,-288.06 423,-301.65 415.26,-307.11 406.2,-311.74 397.46,-315.52"/>
<polygon fill="#33ff00" stroke="#33ff00" points="396.14,-312.28 388.19,-319.28 398.77,-318.77 396.14,-312.28"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M501.74,-229.63C467.27,-218.29 411.28,-203.6 362,-207.65"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M520.68,-229.63C490.77,-203.63 419.88,-141.99 383.85,-110.65"/>
<polygon fill="#33ff00" stroke="#33ff00" points="385.73,-107.65 375.89,-103.73 381.14,-112.93 385.73,-107.65"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M467.31,-243.99C443.9,-244.8 418.51,-245.69 398.53,-246.38"/>
<polygon fill="#33ff00" stroke="#33ff00" points="398.19,-242.89 388.32,-246.74 398.44,-249.89 398.19,-242.89"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M349.17,-339.78C323.37,-367.14 256.05,-429.49 197.5,-405.65"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M195.5,-405.65C105.03,-368.82 65.46,-242.98 52.82,-191.68"/>
<polygon fill="#00ff66" stroke="#00ff66" points="56.16,-190.59 50.47,-181.66 49.35,-192.2 56.16,-190.59"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M333.98,-317.09C323.08,-312.53 310.34,-307.02 299,-301.65 274.96,-290.27 248.32,-276.31 228.37,-265.57"/>
<polygon fill="#00ff66" stroke="#00ff66" points="229.89,-262.41 219.43,-260.74 226.56,-268.57 229.89,-262.41"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M333.96,-322.56C321.59,-318.81 307.65,-312.43 299,-301.65 244.4,-233.59 320.7,-174.11 263,-108.65 262.13,-107.67 261.22,-106.73 260.27,-105.84"/>
<polygon fill="#00ff66" stroke="#00ff66" points="262.36,-103.03 252.26,-99.81 258.14,-108.62 262.36,-103.03"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M491.47,-375.7C448.96,-387.32 386.79,-403.47 362,-405.65"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M490.08,-354.38C461.52,-348.42 424.9,-340.78 398.14,-335.19"/>
<polygon fill="#00ffff" stroke="#00ffff" points="398.55,-331.7 388.04,-333.09 397.12,-338.56 398.55,-331.7"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M490.44,-373.56C454.64,-379.55 403.47,-383.34 362,-367.65"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M360,-367.65C333.44,-357.6 323.36,-363.25 299,-348.65 263.44,-327.34 230.94,-291.07 212.73,-268.57"/>
<polygon fill="#00ffff" stroke="#00ffff" points="215.43,-266.34 206.48,-260.68 209.95,-270.69 215.43,-266.34"/>
</g>
<!-- module~propagators&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~propagators&#45;&gt;module~potential</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M647.8,-116.1C626.92,-118.64 602.13,-121.66 581.26,-124.2"/>
<polygon fill="#0066ff" stroke="#0066ff" points="580.55,-120.76 571.05,-125.44 581.39,-127.71 580.55,-120.76"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M667.55,-98.51C651.86,-91.21 631.05,-82.11 612,-75.65 503.57,-38.92 475.01,-31.94 362,-13.65"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M360,-13.65C289.37,1.42 266.77,6.79 197.5,-13.65"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M195.5,-13.65C127.24,-33.79 78.75,-110.67 58.51,-148.45"/>
<polygon fill="#0066ff" stroke="#0066ff" points="55.28,-147.08 53.77,-157.57 61.49,-150.31 55.28,-147.08"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M691.19,-122.83C686.84,-157.06 669.7,-254.86 612,-304.65 585.8,-327.26 569.47,-313.16 536.5,-323.65"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M534.5,-323.65C489.36,-338.01 434.16,-336.16 398.56,-332.64"/>
<polygon fill="#0066ff" stroke="#0066ff" points="398.49,-329.11 388.17,-331.51 397.74,-336.07 398.49,-329.11"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M647.83,-104.24C616.67,-99.87 574.09,-94.09 536.5,-89.65"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M534.5,-89.65C456.54,-80.45 440.39,-47.45 362,-51.65"/>
</g>
<!-- module~propagators&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~propagators&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M534.5,-89.65C501.5,-85.76 464.7,-85.61 433.59,-86.7"/>
<polygon fill="#0066ff" stroke="#0066ff" points="433.13,-83.22 423.28,-87.12 433.41,-90.21 433.13,-83.22"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M172.78,-236.48C147.8,-223.1 107.51,-201.53 79.5,-186.52"/>
<polygon fill="#3200ff" stroke="#3200ff" points="80.98,-183.34 70.51,-181.71 77.67,-189.51 80.98,-183.34"/>
</g>
<!-- module~statetostatexs&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~statetostatexs&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M490.45,-403.53C455.54,-402.35 405.56,-401.81 362,-405.65"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~statetostatexs&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M490.12,-396.8C479.57,-393.76 468.6,-389.78 459,-384.65 440.38,-374.69 440.92,-364.81 423,-353.65 415.12,-348.74 406.15,-344.35 397.56,-340.63"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="398.68,-337.3 388.1,-336.73 396.01,-343.78 398.68,-337.3"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~statetostatexs&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M490.24,-399.53C454.78,-393.76 404.16,-383.6 362,-367.65"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M151.01,-99.72C143.82,-102.29 136.58,-105.27 130,-108.65 107.56,-120.19 84.75,-137.73 68.9,-151.05"/>
<polygon fill="#ff0098" stroke="#ff0098" points="66.6,-148.41 61.29,-157.57 71.16,-153.72 66.6,-148.41"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M348.69,-79.54C322.94,-53.51 257.53,4.06 197.5,-13.65"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M323.17,-103.78C314.77,-107.49 306.2,-112.1 299,-117.65 258.69,-148.76 225.6,-199.47 209.02,-227.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.97,-226.08 204.04,-236.5 212.05,-229.56 205.97,-226.08"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-141.65 130,-141.65 130,-117.65 263,-117.65 263,-141.65"/>
<text text-anchor="middle" x="196.5" y="-127.25" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M308.58,-103.67C292.8,-107.37 275.27,-111.47 258.89,-115.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="257.8,-111.96 248.86,-117.64 259.39,-118.77 257.8,-111.96"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="1001pt"
 viewBox="0.00 0.00 641.00 1000.61" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.03 2.03) rotate(0) translate(4 2030)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2030 1299,-2030 1299,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-904 0,-904 0,-880 79,-880 79,-904"/>
<text text-anchor="middle" x="39.5" y="-889.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="304.5,-2026 216.5,-2026 216.5,-2002 304.5,-2002 304.5,-2026"/>
<text text-anchor="middle" x="260.5" y="-2011.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.44,-904.01C39.97,-1017.76 38.82,-1902.93 115,-1988 137.38,-2012.99 174.95,-2019.16 206.16,-2019.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="206.54,-2022.74 216.48,-2019.07 206.42,-2015.75 206.54,-2022.74"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-1590 459,-1590 459,-1566 571,-1566 571,-1590"/>
<text text-anchor="middle" x="515" y="-1575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.29,-904.02C39.22,-979.21 37.17,-1384.35 115,-1473 199.07,-1568.76 358.97,-1582.13 448.72,-1581.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.82,-1584.88 458.77,-1581.24 448.72,-1577.88 448.82,-1584.88"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="586.5,-1908 443.5,-1908 443.5,-1884 586.5,-1884 586.5,-1908"/>
<text text-anchor="middle" x="515" y="-1893.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.54,-904.09C41,-1009.78 46.69,-1774.42 115,-1846 201.09,-1936.21 361.28,-1924.88 450.27,-1909.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="450.99,-1913.21 460.23,-1908.03 449.77,-1906.32 450.99,-1913.21"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~set_channels_level_indices_channels_omega_values</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/set_channels_level_indices_channels_omega_values.html" xlink:title="set_channels_level_indices_channels_omega_values">
<polygon fill="#d9534f" stroke="#d9534f" points="406,-646 115,-646 115,-622 406,-622 406,-646"/>
<text text-anchor="middle" x="260.5" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_level_indices_channels_omega_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values</title>
<path fill="none" stroke="#ff0000" d="M40.62,-879.81C41.68,-842.02 50.3,-725.82 115,-667 122.65,-660.05 131.45,-654.47 140.86,-649.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.25,-653.21 150.05,-646.04 139.48,-646.78 142.25,-653.21"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-826 478,-826 478,-802 552,-802 552,-826"/>
<text text-anchor="middle" x="515" y="-811.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M52.39,-879.98C66.12,-866.99 90.03,-846.93 115,-838 236.38,-794.57 391.69,-801.53 467.79,-808.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="467.69,-812.13 477.98,-809.62 468.37,-805.16 467.69,-812.13"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="584,-1866 446,-1866 446,-1842 584,-1842 584,-1866"/>
<text text-anchor="middle" x="515" y="-1851.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.58,-904.26C41.34,-1008.23 49.08,-1739.82 115,-1808 157.92,-1852.39 332.42,-1857.38 435.9,-1856.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="436.04,-1859.73 445.99,-1856.1 435.94,-1852.73 436.04,-1859.73"/>
</g>
<!-- proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~potential_reduction</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/potential_reduction.html" xlink:title="potential_reduction">
<polygon fill="#d9534f" stroke="#d9534f" points="800.5,-1144 685.5,-1144 685.5,-1120 800.5,-1120 800.5,-1144"/>
<text text-anchor="middle" x="743" y="-1129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_reduction</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~potential_reduction</title>
<path fill="none" stroke="#ff0000" d="M41.67,-904.11C45.49,-936.3 60.67,-1024.17 115,-1064 200.22,-1126.48 483,-1101.09 588,-1113 616.6,-1116.25 648.15,-1120.09 675.21,-1123.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="674.99,-1126.97 685.35,-1124.74 675.86,-1120.03 674.99,-1126.97"/>
</g>
<!-- proc~bf_to_sf_transformation -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~bf_to_sf_transformation</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/bf_to_sf_transformation.html" xlink:title="bf_to_sf_transformation">
<polygon fill="#d9534f" stroke="#d9534f" points="329.5,-360 191.5,-360 191.5,-336 329.5,-336 329.5,-360"/>
<text text-anchor="middle" x="260.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bf_to_sf_transformation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~bf_to_sf_transformation -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~bf_to_sf_transformation</title>
<path fill="none" stroke="#ff0000" d="M40.41,-879.85C40.11,-808.95 42.27,-449.33 115,-374 132.19,-356.19 157.14,-348.15 181.48,-345.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="181.89,-348.51 191.48,-344.01 181.18,-341.55 181.89,-348.51"/>
</g>
<!-- proc~crosssection -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~crosssection</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/crosssection.html" xlink:title="CROSSSECTION">
<polygon fill="#d9534f" stroke="#d9534f" points="308.5,-984 212.5,-984 212.5,-960 308.5,-960 308.5,-984"/>
<text text-anchor="middle" x="260.5" y="-969.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CROSSSECTION</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~crosssection -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~crosssection</title>
<path fill="none" stroke="#ff0000" d="M53.37,-904.16C67.39,-916.7 91.04,-935.8 115,-946 142.45,-957.69 175.01,-964.13 202.26,-967.67"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.08,-971.17 212.42,-968.89 202.91,-964.22 202.08,-971.17"/>
</g>
<!-- proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~print_largest_partial_xs</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/print_largest_partial_xs.html" xlink:title="print_largest_partial_xs">
<polygon fill="#d9534f" stroke="#d9534f" points="811,-984 675,-984 675,-960 811,-960 811,-984"/>
<text text-anchor="middle" x="743" y="-969.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_xs</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_xs</title>
<path fill="none" stroke="#ff0000" d="M45.14,-904.25C54.42,-926.76 77.66,-974.14 115,-993 208.99,-1040.47 518.7,-1004.25 664.63,-983.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="665.44,-987.1 674.85,-982.23 664.46,-980.17 665.44,-987.1"/>
</g>
<!-- proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~check_dtol_otol</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/check_dtol_otol.html" xlink:title="check_dtol_otol">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-234 213,-234 213,-210 308,-210 308,-234"/>
<text text-anchor="middle" x="260.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_dtol_otol</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~check_dtol_otol</title>
<path fill="none" stroke="#ff0000" d="M41.02,-879.77C44.76,-794.5 68.75,-290.66 115,-243 137.29,-220.04 172.73,-214.61 202.93,-215.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.83,-218.51 212.95,-215.36 203.07,-211.52 202.83,-218.51"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="307,-192 214,-192 214,-168 307,-168 307,-192"/>
<text text-anchor="middle" x="260.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.93,-879.84C44.15,-791.66 65.81,-252.04 115,-201 137.44,-177.71 173.4,-172.42 203.84,-172.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.79,-176.47 213.92,-173.36 204.06,-169.48 203.79,-176.47"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-764 215,-764 215,-740 306,-740 306,-764"/>
<text text-anchor="middle" x="260.5" y="-749.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M47.3,-879.69C58.75,-860.05 83.74,-821.64 115,-800 141.83,-781.43 176.39,-769.61 204.98,-762.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.92,-765.72 214.82,-759.96 204.28,-758.91 205.92,-765.72"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="578.5,-1502 451.5,-1502 451.5,-1478 578.5,-1478 578.5,-1502"/>
<text text-anchor="middle" x="515" y="-1487.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.93,-904.2C43.43,-968.08 57.96,-1263.82 115,-1331 203.51,-1435.25 281.08,-1375.35 406,-1431 422.72,-1438.45 425.95,-1442.2 442,-1451 455.34,-1458.32 470.11,-1466.33 482.78,-1473.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="481.13,-1476.27 491.59,-1477.94 484.45,-1470.11 481.13,-1476.27"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="333,-590 188,-590 188,-566 333,-566 333,-590"/>
<text text-anchor="middle" x="260.5" y="-575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M42.07,-879.95C48.64,-831.51 75.37,-651.71 115,-613 131.81,-596.58 154.93,-587.41 177.76,-582.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.7,-585.8 187.85,-580.46 177.37,-578.93 178.7,-585.8"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-1181 478,-1181 478,-1157 552,-1157 552,-1181"/>
<text text-anchor="middle" x="515" y="-1166.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M42.3,-904.17C49.33,-949.85 76.43,-1110.12 115,-1141 217.67,-1223.19 386.82,-1199.09 467.88,-1180.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.83,-1184.36 477.79,-1178.71 467.26,-1177.54 468.83,-1184.36"/>
</g>
<!-- proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~print_bf_channels</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/print_bf_channels.html" xlink:title="print_bf_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="796,-1987 690,-1987 690,-1963 796,-1963 796,-1987"/>
<text text-anchor="middle" x="743" y="-1972.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_bf_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~print_bf_channels</title>
<path fill="none" stroke="#ff0000" d="M40.4,-904.01C39.59,-1015.89 35.95,-1873.32 115,-1950 154.89,-1988.7 529.58,-1981.59 679.97,-1977.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="680.09,-1980.61 689.98,-1976.8 679.88,-1973.61 680.09,-1980.61"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="305,-150 216,-150 216,-126 305,-126 305,-150"/>
<text text-anchor="middle" x="260.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.85,-879.99C43.57,-789.24 62.85,-213.44 115,-159 137.84,-135.15 174.86,-130.14 205.7,-130.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.74,-134.47 215.9,-131.45 206.08,-127.48 205.74,-134.47"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~set_number_of_open_channels_wavmax</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/set_number_of_open_channels_wavmax.html" xlink:title="set_number_of_open_channels_wavmax">
<polygon fill="#d9534f" stroke="#d9534f" points="373.5,-1799 147.5,-1799 147.5,-1775 373.5,-1775 373.5,-1799"/>
<text text-anchor="middle" x="260.5" y="-1784.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_open_channels_wavmax</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax</title>
<path fill="none" stroke="#ff0000" d="M40.71,-904.08C42.53,-1003.49 57.07,-1684.58 115,-1752 121.62,-1759.71 129.63,-1765.87 138.43,-1770.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="136.97,-1773.97 147.48,-1775.3 140.09,-1767.71 136.97,-1773.97"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="379.5,-276 141.5,-276 141.5,-252 379.5,-252 379.5,-276"/>
<text text-anchor="middle" x="260.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.12,-879.78C45.4,-797.78 71.66,-329.31 115,-285 120.06,-279.82 125.79,-275.54 131.98,-272.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="133.93,-274.96 141.34,-267.38 130.83,-268.68 133.93,-274.96"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="862,-1186 624,-1186 624,-1162 862,-1162 862,-1186"/>
<text text-anchor="middle" x="743" y="-1171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.68,-904.14C41.94,-940.65 51.11,-1050 115,-1100 156.6,-1132.55 535.65,-1140.93 588,-1148 613.62,-1151.46 641.53,-1155.95 666.46,-1160.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="666.13,-1163.72 676.58,-1161.97 667.32,-1156.82 666.13,-1163.72"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-1322 230.5,-1322 230.5,-1298 290.5,-1298 290.5,-1322"/>
<text text-anchor="middle" x="260.5" y="-1307.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M41.14,-904.25C43.83,-946.04 56.91,-1085.64 115,-1181 144.59,-1229.57 198.14,-1270.26 231.08,-1292.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.51,-1295.44 239.79,-1298 233.35,-1289.59 229.51,-1295.44"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="287.5,-108 233.5,-108 233.5,-84 287.5,-84 287.5,-108"/>
<text text-anchor="middle" x="260.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.78,-879.91C43.06,-785.95 59.93,-174.8 115,-117 142.3,-88.35 190.03,-86.83 223.13,-90.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="222.99,-93.51 233.32,-91.18 223.78,-86.56 222.99,-93.51"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="307.5,-66 213.5,-66 213.5,-42 307.5,-42 307.5,-66"/>
<text text-anchor="middle" x="260.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.72,-879.87C42.56,-782.95 57,-136.18 115,-75 137.17,-51.61 172.96,-46.27 203.37,-46.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.32,-50.33 213.45,-47.22 203.59,-43.33 203.32,-50.33"/>
</g>
<!-- proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~set_channels_l_values</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/set_channels_l_values.html" xlink:title="set_channels_l_values">
<polygon fill="#d9534f" stroke="#d9534f" points="325.5,-541 195.5,-541 195.5,-517 325.5,-517 325.5,-541"/>
<text text-anchor="middle" x="260.5" y="-526.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_l_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_l_values</title>
<path fill="none" stroke="#ff0000" d="M41.46,-879.79C46,-825.12 67.17,-603.53 115,-557 133.59,-538.91 160.17,-530.76 185.46,-527.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.87,-531 195.45,-526.48 185.14,-524.03 185.87,-531"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="784,-432 702,-432 702,-408 784,-408 784,-432"/>
<text text-anchor="middle" x="743" y="-417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M41.02,-879.99C43.82,-820.8 59.22,-560.94 115,-508 197.57,-429.63 557.02,-420.47 691.22,-419.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="691.63,-423.33 701.62,-419.79 691.61,-416.33 691.63,-423.33"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="783.5,-744 702.5,-744 702.5,-720 783.5,-720 783.5,-744"/>
<text text-anchor="middle" x="743" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M77.68,-879.95C89.5,-876.55 102.69,-873.18 115,-871 322.6,-834.22 388.73,-903.86 588,-835 641.13,-816.64 693.48,-775.35 721.36,-750.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="723.73,-753.57 728.88,-744.31 719.08,-748.34 723.73,-753.57"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-24 209.5,-24 209.5,0 311.5,0 311.5,-24"/>
<text text-anchor="middle" x="260.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.66,-879.89C42.09,-780.24 54.06,-97.57 115,-33 136.09,-10.65 169.6,-4.76 199.05,-4.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.19,-8.25 209.26,-4.97 199.34,-1.26 199.19,-8.25"/>
</g>
<!-- proc~potential_read -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~potential_read</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/potential_read.html" xlink:title="potential_read">
<polygon fill="#d9534f" stroke="#d9534f" points="559.5,-662 470.5,-662 470.5,-638 559.5,-638 559.5,-662"/>
<text text-anchor="middle" x="515" y="-647.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_read</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_read -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~potential_read</title>
<path fill="none" stroke="#ff0000" d="M42.37,-879.59C47.67,-849.06 65.71,-769.96 115,-731 167.97,-689.13 364.08,-664.65 460.2,-654.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="460.69,-658.38 470.29,-653.91 459.99,-651.42 460.69,-658.38"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1295,-1144 1203,-1144 1203,-1120 1295,-1120 1295,-1144"/>
<text text-anchor="middle" x="1249" y="-1129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M41.09,-904.14C45.31,-988.85 71.99,-1489.52 115,-1540 267.4,-1718.86 393.48,-1637.45 624,-1683 742.58,-1706.43 1075.84,-1794.37 1167,-1715 1210.32,-1677.29 1240.02,-1256.17 1246.62,-1154.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1250.12,-1154.27 1247.26,-1144.07 1243.13,-1153.82 1250.12,-1154.27"/>
</g>
<!-- proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~potential_interpolation</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/potential_interpolation.html" xlink:title="potential_interpolation">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-904 194,-904 194,-880 327,-880 327,-904"/>
<text text-anchor="middle" x="260.5" y="-889.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_interpolation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~potential_interpolation</title>
<path fill="none" stroke="#ff0000" d="M79.15,-892C107.98,-892 148.3,-892 183.51,-892"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.77,-895.5 193.77,-892 183.77,-888.5 183.77,-895.5"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-318 161,-318 161,-294 360,-294 360,-318"/>
<text text-anchor="middle" x="260.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.21,-879.71C38.68,-804.63 34.56,-408.51 115,-327 124.96,-316.91 137.46,-310.22 150.92,-305.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.14,-309.24 160.87,-303.23 150.3,-302.48 152.14,-309.24"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-1544 459,-1544 459,-1520 571,-1520 571,-1544"/>
<text text-anchor="middle" x="515" y="-1529.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.65,-904.09C41.76,-973.06 50.5,-1316.6 115,-1395 197.89,-1495.75 358.62,-1522.62 448.72,-1529.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.59,-1533.15 458.82,-1530.38 449.09,-1526.17 448.59,-1533.15"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="987,-1828 933,-1828 933,-1804 987,-1804 987,-1828"/>
<text text-anchor="middle" x="960" y="-1813.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M40.46,-904.08C40.19,-1012.99 40.68,-1823.64 115,-1897 174.08,-1955.32 784.53,-1914.81 862,-1885 891.57,-1873.62 920.51,-1851.13 938.97,-1834.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="941.36,-1837.47 946.45,-1828.18 936.67,-1832.27 941.36,-1837.47"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1022,-1062 898,-1062 898,-1038 1022,-1038 1022,-1062"/>
<text text-anchor="middle" x="960" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M43.47,-904.11C50.64,-930.34 71.56,-992.11 115,-1018 180.44,-1056.99 695.75,-1053.77 887.47,-1051.17"/>
<polygon fill="#ff0000" stroke="#ff0000" points="887.77,-1054.67 897.72,-1051.03 887.67,-1047.67 887.77,-1054.67"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1167,-963 1058,-963 1058,-939 1167,-939 1167,-963"/>
<text text-anchor="middle" x="1112.5" y="-948.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M76.88,-904.04C88.89,-907.53 102.4,-910.95 115,-913 290.23,-941.49 336.47,-932 514,-932 514,-932 514,-932 744,-932 850.78,-932 974.78,-940.1 1048,-945.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1047.75,-949.21 1057.99,-946.5 1048.29,-942.23 1047.75,-949.21"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="1007,-472 913,-472 913,-448 1007,-448 1007,-472"/>
<text text-anchor="middle" x="960" y="-457.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.5,-879.69C40.76,-812.49 45.65,-490.59 115,-428 176.66,-372.35 782.19,-375.99 862,-399 890.68,-407.27 919.06,-426.79 937.64,-441.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="935.49,-444.31 945.45,-447.93 939.92,-438.89 935.49,-444.31"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff2900" d="M525.39,-1590.16C542.66,-1611.78 581.63,-1657.04 624,-1683 719.28,-1741.37 759.53,-1719.45 862,-1764 885.49,-1774.21 910.98,-1787.99 929.93,-1798.8"/>
<polygon fill="#ff2900" stroke="#ff2900" points="928.26,-1801.87 938.67,-1803.83 931.76,-1795.81 928.26,-1801.87"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="791,-1548 695,-1548 695,-1524 791,-1524 791,-1548"/>
<text text-anchor="middle" x="743" y="-1533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#ff2900" d="M571.19,-1567.09C588.12,-1563.79 606.82,-1560.2 624,-1557 643.86,-1553.3 665.62,-1549.39 685,-1545.96"/>
<polygon fill="#ff2900" stroke="#ff2900" points="685.65,-1549.4 694.88,-1544.21 684.43,-1542.5 685.65,-1549.4"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="789.5,-1632 696.5,-1632 696.5,-1608 789.5,-1608 789.5,-1632"/>
<text text-anchor="middle" x="743" y="-1617.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#ff2900" d="M571.19,-1588.91C588.12,-1592.21 606.82,-1595.8 624,-1599 644.29,-1602.78 666.58,-1606.78 686.27,-1610.27"/>
<polygon fill="#ff2900" stroke="#ff2900" points="685.84,-1613.75 696.3,-1612.04 687.06,-1606.86 685.84,-1613.75"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="770,-1674 716,-1674 716,-1650 770,-1650 770,-1674"/>
<text text-anchor="middle" x="743" y="-1659.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#ff2900" d="M532.65,-1590.24C553.1,-1604.67 589.36,-1628.27 624,-1641 650.54,-1650.75 682.15,-1656.07 705.98,-1658.91"/>
<polygon fill="#ff2900" stroke="#ff2900" points="705.67,-1662.4 716,-1660.01 706.44,-1655.44 705.67,-1662.4"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="770,-1506 716,-1506 716,-1482 770,-1482 770,-1506"/>
<text text-anchor="middle" x="743" y="-1491.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff2900" d="M561.33,-1565.97C570.54,-1562.52 579.89,-1558.24 588,-1553 607.54,-1540.38 603.52,-1526.04 624,-1515 649.05,-1501.5 681.01,-1496.43 705.35,-1494.64"/>
<polygon fill="#ff2900" stroke="#ff2900" points="705.83,-1498.12 715.61,-1494.04 705.42,-1491.13 705.83,-1498.12"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="813,-1590 673,-1590 673,-1566 813,-1566 813,-1590"/>
<text text-anchor="middle" x="743" y="-1575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#ff2900" d="M571.29,-1578C598.76,-1578 632.45,-1578 662.63,-1578"/>
<polygon fill="#ff2900" stroke="#ff2900" points="662.71,-1581.5 672.71,-1578 662.71,-1574.5 662.71,-1581.5"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff5200" d="M586.82,-1892.2C657.4,-1887.24 768.46,-1876.29 862,-1853 882.81,-1847.82 905.22,-1839.46 923.26,-1832"/>
<polygon fill="#ff5200" stroke="#ff5200" points="924.94,-1835.09 932.79,-1827.97 922.22,-1828.64 924.94,-1835.09"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="995,-628 925,-628 925,-604 995,-604 995,-628"/>
<text text-anchor="middle" x="960" y="-613.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff7c00" d="M406.1,-626.35C472.47,-623.17 552.21,-619.8 624,-618 728.09,-615.39 850.44,-615.45 914.59,-615.73"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="914.74,-619.23 924.75,-615.77 914.77,-612.23 914.74,-619.23"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ffce00" d="M584.08,-1850.77C653.95,-1847.11 765.75,-1840.27 862,-1830 882.18,-1827.85 904.61,-1824.66 922.81,-1821.87"/>
<polygon fill="#ffce00" stroke="#ffce00" points="923.38,-1825.33 932.72,-1820.33 922.3,-1818.41 923.38,-1825.33"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#fff800" d="M800.84,-1132C898.33,-1132 1096.24,-1132 1192.68,-1132"/>
<polygon fill="#fff800" stroke="#fff800" points="1192.81,-1135.5 1202.81,-1132 1192.81,-1128.5 1192.81,-1135.5"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#fff800" d="M800.59,-1129.53C820.94,-1126.73 843.45,-1121.31 862,-1111 882.91,-1099.39 878.06,-1084.2 898,-1071 900.53,-1069.32 903.21,-1067.77 905.98,-1066.32"/>
<polygon fill="#fff800" stroke="#fff800" points="907.48,-1069.49 915.06,-1062.09 904.51,-1063.14 907.48,-1069.49"/>
</g>
<!-- proc~transform_summation -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~transform_summation</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/transform_summation.html" xlink:title="transform_summation">
<polygon fill="#d9534f" stroke="#d9534f" points="580,-357 450,-357 450,-333 580,-333 580,-357"/>
<text text-anchor="middle" x="515" y="-342.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transform_summation</text>
</a>
</g>
</g>
<!-- proc~bf_to_sf_transformation&#45;&gt;proc~transform_summation -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~bf_to_sf_transformation&#45;&gt;proc~transform_summation</title>
<path fill="none" stroke="#dcff00" d="M329.83,-347.19C363.86,-346.78 405.06,-346.29 439.85,-345.88"/>
<polygon fill="#dcff00" stroke="#dcff00" points="440,-349.38 449.96,-345.76 439.92,-342.38 440,-349.38"/>
</g>
<!-- proc~crosssection&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~crosssection&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#b3ff00" d="M301.35,-960C331.44,-949.94 373.04,-933.89 406,-913 441.63,-890.43 476.41,-855.56 496.5,-833.8"/>
<polygon fill="#b3ff00" stroke="#b3ff00" points="499.31,-835.9 503.45,-826.15 494.13,-831.2 499.31,-835.9"/>
</g>
<!-- proc~crosssection&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~crosssection&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#b3ff00" d="M267.96,-984.06C289.93,-1025.46 362.78,-1166.03 406,-1289 427.59,-1350.42 407.07,-1376.06 442,-1431 452.65,-1447.76 469.67,-1462.02 484.48,-1472.33"/>
<polygon fill="#b3ff00" stroke="#b3ff00" points="482.63,-1475.29 492.89,-1477.92 486.51,-1469.47 482.63,-1475.29"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#89ff00" d="M811.28,-980.48C827.92,-982.91 845.65,-985.79 862,-989 933.92,-1003.13 952.81,-1004.81 1022,-1029 1093.33,-1053.94 1172.91,-1093 1216.02,-1115.16"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1214.66,-1118.4 1225.15,-1119.89 1217.88,-1112.18 1214.66,-1118.4"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#89ff00" d="M811.28,-982.09C828.25,-985.91 846.14,-991.07 862,-998 879.85,-1005.8 881.02,-1013.46 898,-1023 904.66,-1026.74 911.95,-1030.35 919.09,-1033.65"/>
<polygon fill="#89ff00" stroke="#89ff00" points="918.1,-1037.04 928.66,-1037.92 920.96,-1030.65 918.1,-1037.04"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#89ff00" d="M811.41,-968.15C878.77,-964.3 981.58,-958.42 1047.66,-954.65"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1048.16,-958.13 1057.94,-954.06 1047.76,-951.14 1048.16,-958.13"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#0dff00" d="M306.06,-762.94C351.57,-774.12 421.88,-791.38 467.93,-802.69"/>
<polygon fill="#0dff00" stroke="#0dff00" points="467.11,-806.09 477.65,-805.08 468.78,-799.29 467.11,-806.09"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#0dff00" d="M306.27,-750.14C396.21,-746.39 598.22,-737.98 692.18,-734.07"/>
<polygon fill="#0dff00" stroke="#0dff00" points="692.44,-737.57 702.28,-733.65 692.15,-730.57 692.44,-737.57"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="781,-474 705,-474 705,-450 781,-450 781,-474"/>
<text text-anchor="middle" x="743" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#0dff00" d="M279.88,-739.95C307.47,-721.8 361.12,-686.26 406,-655 422.2,-643.72 425.35,-639.6 442,-629 536.13,-569.1 652.99,-507.52 709.02,-478.73"/>
<polygon fill="#0dff00" stroke="#0dff00" points="710.81,-481.75 718.11,-474.07 707.62,-475.52 710.81,-481.75"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-704 478,-704 478,-680 552,-680 552,-704"/>
<text text-anchor="middle" x="515" y="-689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#0dff00" d="M306.06,-741.41C351.47,-730.62 421.59,-713.96 467.64,-703.02"/>
<polygon fill="#0dff00" stroke="#0dff00" points="468.73,-706.35 477.65,-700.64 467.12,-699.54 468.73,-706.35"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-784 467.5,-784 467.5,-760 562.5,-760 562.5,-784"/>
<text text-anchor="middle" x="515" y="-769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#0dff00" d="M306.06,-755.53C348.18,-758.87 411.56,-763.89 457.27,-767.51"/>
<polygon fill="#0dff00" stroke="#0dff00" points="457.07,-771 467.32,-768.3 457.63,-764.02 457.07,-771"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff1b" d="M578.7,-1480.13C677.49,-1464.57 858.6,-1435.98 862,-1435 1003.72,-1393.99 1060.9,-1406.51 1167,-1304 1211.1,-1261.39 1233.85,-1190.04 1243.01,-1154.11"/>
<polygon fill="#00ff1b" stroke="#00ff1b" points="1246.47,-1154.71 1245.43,-1144.16 1239.67,-1153.05 1246.47,-1154.71"/>
</g>
<!-- proc~set_number_of_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~set_number_of_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff44" d="M333.19,-581.91C477.12,-589.75 797.46,-607.2 914.82,-613.59"/>
<polygon fill="#00ff44" stroke="#00ff44" points="914.7,-617.09 924.88,-614.14 915.08,-610.1 914.7,-617.09"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff97" d="M796.02,-1967.62C817.02,-1963.6 841.17,-1957.63 862,-1949 1010.64,-1887.41 1080.76,-1889.83 1167,-1754 1232.34,-1651.1 1245.34,-1252.5 1247.58,-1154.07"/>
<polygon fill="#00ff97" stroke="#00ff97" points="1251.08,-1154.13 1247.79,-1144.06 1244.08,-1153.98 1251.08,-1154.13"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff97" d="M796.22,-1971.64C817.96,-1968.26 842.6,-1961.68 862,-1949 864.87,-1947.13 917.86,-1873.44 944.28,-1836.57"/>
<polygon fill="#00ff97" stroke="#00ff97" points="947.4,-1838.23 950.38,-1828.06 941.71,-1834.15 947.4,-1838.23"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ffea" d="M373.57,-1791.66C534.24,-1798.34 821.82,-1810.3 922.77,-1814.49"/>
<polygon fill="#00ffea" stroke="#00ffea" points="922.64,-1817.99 932.77,-1814.91 922.93,-1811 922.64,-1817.99"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="555,-234 475,-234 475,-210 555,-210 555,-234"/>
<text text-anchor="middle" x="515" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#00eaff" d="M349.1,-251.95C367.9,-249.18 387.63,-246.12 406,-243 425.31,-239.72 446.47,-235.7 464.9,-232.06"/>
<polygon fill="#00eaff" stroke="#00eaff" points="465.71,-235.47 474.84,-230.08 464.35,-228.6 465.71,-235.47"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="587.5,-276 442.5,-276 442.5,-252 587.5,-252 587.5,-276"/>
<text text-anchor="middle" x="515" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#00eaff" d="M379.62,-264C397.37,-264 415.33,-264 432.1,-264"/>
<polygon fill="#00eaff" stroke="#00eaff" points="432.38,-267.5 442.38,-264 432.38,-260.5 432.38,-267.5"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00c0ff" d="M862.37,-1169.5C947.35,-1165.45 1064.5,-1158.22 1167,-1146 1175.35,-1145 1184.15,-1143.73 1192.75,-1142.35"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="1193.42,-1145.78 1202.71,-1140.69 1192.27,-1138.88 1193.42,-1145.78"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00c0ff" d="M847.74,-1161.99C852.79,-1159.45 857.58,-1156.47 862,-1153 893.28,-1128.39 868.72,-1097.97 898,-1071 899.45,-1069.66 900.99,-1068.41 902.6,-1067.24"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="904.45,-1070.21 911.16,-1062.01 900.8,-1064.24 904.45,-1070.21"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#0097ff" d="M278.24,-1297.78C309.33,-1275.45 378.6,-1227.49 442,-1196 450.34,-1191.86 459.48,-1187.97 468.37,-1184.5"/>
<polygon fill="#0097ff" stroke="#0097ff" points="469.75,-1187.72 477.86,-1180.91 467.27,-1181.17 469.75,-1187.72"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0097ff" d="M290.73,-1307.93C365.68,-1302.83 570.84,-1290 742,-1290 742,-1290 742,-1290 961,-1290 1074.78,-1290 1185.99,-1193.52 1229.17,-1151.34"/>
<polygon fill="#0097ff" stroke="#0097ff" points="1231.8,-1153.67 1236.43,-1144.14 1226.86,-1148.7 1231.8,-1153.67"/>
</g>
<!-- proc~numerov&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~numerov&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#0097ff" d="M267.03,-1322.05C286.57,-1363.77 355.83,-1504.66 442,-1599 510.46,-1673.95 532.16,-1693.75 624,-1737 677.31,-1762.11 847.31,-1795.42 922.56,-1809.39"/>
<polygon fill="#0097ff" stroke="#0097ff" points="922.06,-1812.86 932.53,-1811.23 923.33,-1805.97 922.06,-1812.86"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#0097ff" d="M282.04,-1297.96C314.68,-1279.49 380.95,-1244.67 442,-1229 623.4,-1182.43 681.87,-1246.25 862,-1195 938.86,-1173.13 964.63,-1168.62 1022,-1113 1064.26,-1072.03 1091.87,-1006.75 1104.15,-972.92"/>
<polygon fill="#0097ff" stroke="#0097ff" points="1107.59,-973.71 1107.6,-963.12 1100.98,-971.39 1107.59,-973.71"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="565.5,-1262 464.5,-1262 464.5,-1238 565.5,-1238 565.5,-1262"/>
<text text-anchor="middle" x="515" y="-1247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#0097ff" d="M290.96,-1303C330.84,-1293.52 402.93,-1276.39 454.35,-1264.17"/>
<polygon fill="#0097ff" stroke="#0097ff" points="455.43,-1267.52 464.35,-1261.8 453.81,-1260.71 455.43,-1267.52"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="815.5,-1426 670.5,-1426 670.5,-1402 815.5,-1402 815.5,-1426"/>
<text text-anchor="middle" x="743" y="-1411.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#0097ff" d="M290.6,-1312.2C322.39,-1316.03 373.17,-1326.48 406,-1355 434.22,-1379.51 410.42,-1411.01 442,-1431 478.28,-1453.96 591.94,-1440.36 668.47,-1427.73"/>
<polygon fill="#0097ff" stroke="#0097ff" points="669.26,-1431.15 678.54,-1426.04 668.1,-1424.24 669.26,-1431.15"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="588,-1422 442,-1422 442,-1398 588,-1398 588,-1422"/>
<text text-anchor="middle" x="515" y="-1407.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#0097ff" d="M290.73,-1315.7C320.85,-1322.35 368.56,-1335.03 406,-1355 424.13,-1364.67 424.09,-1373.93 442,-1384 448.84,-1387.85 456.36,-1391.3 463.88,-1394.34"/>
<polygon fill="#0097ff" stroke="#0097ff" points="462.76,-1397.66 473.35,-1397.97 465.26,-1391.13 462.76,-1397.66"/>
</g>
<!-- proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~cenitrfugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/cenitrfugal_matrix.html" xlink:title="cenitrfugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="570,-1342 460,-1342 460,-1318 570,-1318 570,-1342"/>
<text text-anchor="middle" x="515" y="-1327.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cenitrfugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~numerov&#45;&gt;proc~cenitrfugal_matrix</title>
<path fill="none" stroke="#0097ff" d="M290.96,-1312.33C329.54,-1315.39 398.26,-1320.83 449.26,-1324.87"/>
<polygon fill="#0097ff" stroke="#0097ff" points="449.29,-1328.38 459.53,-1325.69 449.84,-1321.41 449.29,-1328.38"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="806.5,-1384 679.5,-1384 679.5,-1360 806.5,-1360 806.5,-1384"/>
<text text-anchor="middle" x="743" y="-1369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0097ff" d="M290.63,-1318.07C326.09,-1327.56 387.96,-1343.02 442,-1351 519.02,-1362.37 608.11,-1367.62 669.07,-1370.02"/>
<polygon fill="#0097ff" stroke="#0097ff" points="669.23,-1373.53 679.36,-1370.41 669.5,-1366.54 669.23,-1373.53"/>
</g>
<!-- proc~set_channels_l_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~set_channels_l_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#001bff" d="M325.86,-533.17C436.17,-540.92 668.23,-559.84 862,-593 879.38,-595.97 898.28,-600.22 914.75,-604.26"/>
<polygon fill="#001bff" stroke="#001bff" points="914.1,-607.71 924.65,-606.73 915.8,-600.91 914.1,-607.71"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0d00ff" d="M784,-410.36C869.39,-392.44 1069.64,-365.11 1167,-475 1210.15,-523.7 1240.35,-1000.47 1246.74,-1109.76"/>
<polygon fill="#0d00ff" stroke="#0d00ff" points="1243.26,-1110.16 1247.33,-1119.94 1250.24,-1109.76 1243.26,-1110.16"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1007,-514 913,-514 913,-490 1007,-490 1007,-514"/>
<text text-anchor="middle" x="960" y="-499.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#0d00ff" d="M784.16,-420.69C808.06,-422.61 838.26,-427.81 862,-441 882.91,-452.61 878.06,-467.8 898,-481 900.53,-482.68 903.21,-484.23 905.98,-485.68"/>
<polygon fill="#0d00ff" stroke="#0d00ff" points="904.51,-488.86 915.06,-489.91 907.48,-482.51 904.51,-488.86"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0d00ff" d="M784.2,-418.02C809.02,-418.85 840.17,-423.82 862,-441 893.28,-465.61 879.02,-488.02 898,-523 912.09,-548.96 931.12,-577.1 944.16,-595.55"/>
<polygon fill="#0d00ff" stroke="#0d00ff" points="941.37,-597.67 950.03,-603.77 947.07,-593.6 941.37,-597.67"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#3700ff" d="M763.99,-744.16C789.64,-760.62 834.14,-792.22 862,-829 910.87,-893.53 941.22,-986.52 953.17,-1028.27"/>
<polygon fill="#3700ff" stroke="#3700ff" points="949.82,-1029.26 955.88,-1037.95 956.56,-1027.38 949.82,-1029.26"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#3700ff" d="M766.6,-719.81C805.17,-699 883.78,-656.59 927.64,-632.92"/>
<polygon fill="#3700ff" stroke="#3700ff" points="929.56,-635.86 936.7,-628.03 926.24,-629.7 929.56,-635.86"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~potential_read&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#8900ff" d="M559.67,-659.04C569.37,-662.04 579.34,-665.95 588,-671 607.28,-682.23 604.35,-695.42 624,-706 644.89,-717.25 670.35,-723.63 692.26,-727.26"/>
<polygon fill="#8900ff" stroke="#8900ff" points="691.97,-730.75 702.38,-728.78 693.01,-723.83 691.97,-730.75"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~potential_read&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#8900ff" d="M559.75,-657.41C652.19,-673.1 859.19,-708.46 862,-711 886.39,-732.97 938,-956.1 954.1,-1027.88"/>
<polygon fill="#8900ff" stroke="#8900ff" points="950.69,-1028.7 956.29,-1037.69 957.53,-1027.17 950.69,-1028.7"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~potential_read&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#8900ff" d="M559.61,-648.27C640.32,-645.71 809.5,-643.59 862,-668 984.7,-725.06 1071.85,-874.33 1100.92,-929.82"/>
<polygon fill="#8900ff" stroke="#8900ff" points="1097.83,-931.48 1105.52,-938.76 1104.06,-928.27 1097.83,-931.48"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~potential_read&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#8900ff" d="M559.6,-645.76C579.27,-643.89 602.79,-641.74 624,-640 728.04,-631.46 850.41,-623.13 914.58,-618.89"/>
<polygon fill="#8900ff" stroke="#8900ff" points="914.99,-622.37 924.74,-618.22 914.53,-615.38 914.99,-622.37"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="770,-862 716,-862 716,-838 770,-838 770,-862"/>
<text text-anchor="middle" x="743" y="-847.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~potential_interpolation&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~potential_interpolation&#45;&gt;proc~spline</title>
<path fill="none" stroke="#dc00ff" d="M327.23,-888C393.22,-883.79 497.75,-876.59 588,-868 628.45,-864.15 674.73,-858.58 705.91,-854.66"/>
<polygon fill="#dc00ff" stroke="#dc00ff" points="706.4,-858.13 715.88,-853.4 705.52,-851.18 706.4,-858.13"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="987,-332 933,-332 933,-308 987,-308 987,-332"/>
<text text-anchor="middle" x="960" y="-317.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#ff00f8" d="M360.32,-307.98C517.85,-311.15 818.71,-317.18 922.63,-319.27"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="922.84,-322.77 932.91,-319.48 922.98,-315.78 922.84,-322.77"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ff00f8" d="M360.2,-301.32C376.15,-297.89 392.01,-292.7 406,-285 427.54,-273.14 421.34,-256.33 442,-243 449,-238.48 457,-234.91 465.06,-232.1"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="466.37,-235.36 474.86,-229.02 464.27,-228.68 466.37,-235.36"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ff00f8" d="M349.1,-293.95C367.9,-291.18 387.63,-288.12 406,-285 418.56,-282.87 431.9,-280.42 444.76,-277.97"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="445.8,-281.34 454.96,-276.01 444.48,-274.46 445.8,-281.34"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ff00ce" d="M569.29,-1519.97C575.82,-1517.49 582.22,-1514.53 588,-1511 607.86,-1498.88 605.31,-1486.86 624,-1473 647.77,-1455.37 677.6,-1440.51 701.32,-1430.11"/>
<polygon fill="#ff00ce" stroke="#ff00ce" points="702.94,-1433.23 710.75,-1426.07 700.18,-1426.8 702.94,-1433.23"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff00ce" d="M571.29,-1522.7C613.15,-1515.66 669.47,-1506.2 705.75,-1500.09"/>
<polygon fill="#ff00ce" stroke="#ff00ce" points="706.6,-1503.5 715.88,-1498.39 705.44,-1496.6 706.6,-1503.5"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff00ce" d="M571.12,-1522.31C577.35,-1519.45 583.18,-1515.76 588,-1511 627.01,-1472.47 582.97,-1429.38 624,-1393 636.51,-1381.91 652.78,-1375.71 669.23,-1372.43"/>
<polygon fill="#ff00ce" stroke="#ff00ce" points="670.16,-1375.82 679.46,-1370.74 669.03,-1368.92 670.16,-1375.82"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0029" d="M1007.33,-465.49C1055.45,-473.83 1128.91,-494.49 1167,-545 1235.97,-636.45 1246.24,-1012.96 1247.75,-1109.41"/>
<polygon fill="#ff0029" stroke="#ff0029" points="1244.25,-1109.56 1247.89,-1119.51 1251.25,-1109.46 1244.25,-1109.56"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1156,-1506 1069,-1506 1069,-1482 1156,-1482 1156,-1506"/>
<text text-anchor="middle" x="1112.5" y="-1491.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0029" d="M1007.21,-469.17C1012.92,-472.09 1018.1,-475.94 1022,-481 1055.37,-524.34 1053.21,-917.51 1058,-972 1075.03,-1165.82 1100.88,-1399.56 1108.98,-1471.71"/>
<polygon fill="#ff0029" stroke="#ff0029" points="1105.53,-1472.33 1110.13,-1481.87 1112.49,-1471.54 1105.53,-1472.33"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M791.03,-1540.26C815.73,-1539.75 844.43,-1534.32 862,-1515 928.59,-1441.75 837.3,-1149.2 898,-1071 898.69,-1070.12 899.41,-1069.27 900.17,-1068.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="902.41,-1071.15 907.87,-1062.06 897.94,-1065.76 902.41,-1071.15"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0000" d="M791.08,-1528.23C821.52,-1523.38 862.03,-1517.28 898,-1513 952.73,-1506.48 1015.61,-1501.15 1058.88,-1497.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1059.18,-1501.29 1068.89,-1497.04 1058.65,-1494.31 1059.18,-1501.29"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-1546 933,-1546 933,-1522 987,-1522 987,-1546"/>
<text text-anchor="middle" x="960" y="-1531.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#ff0000" d="M791.18,-1535.56C830.78,-1535.19 886.53,-1534.67 922.72,-1534.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="922.86,-1537.84 932.82,-1534.24 922.79,-1530.84 922.86,-1537.84"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff4800" d="M770.43,-848.42C796.15,-848.23 835.17,-851.64 862,-871 916.23,-910.14 943.29,-989.21 953.71,-1027.8"/>
<polygon fill="#ff4800" stroke="#ff4800" points="950.34,-1028.73 956.22,-1037.54 957.12,-1026.99 950.34,-1028.73"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff4800" d="M761.64,-837.81C785.86,-820.58 830.02,-787.36 862,-753 896.96,-715.43 929.72,-664.72 946.77,-636.73"/>
<polygon fill="#ff4800" stroke="#ff4800" points="949.77,-638.53 951.92,-628.16 943.77,-634.92 949.77,-638.53"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff9100" d="M532.42,-1262.13C547.48,-1273.55 570.09,-1291.48 588,-1309 605.58,-1326.19 602.65,-1338.8 624,-1351 637.63,-1358.79 653.49,-1363.81 669.06,-1367.02"/>
<polygon fill="#ff9100" stroke="#ff9100" points="668.76,-1370.53 679.23,-1368.88 670.02,-1363.64 668.76,-1370.53"/>
</g>
<!-- proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~radtermvalue</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/radtermvalue.html" xlink:title="RADTERMVALUE">
<polygon fill="#d9534f" stroke="#d9534f" points="791.5,-1102 694.5,-1102 694.5,-1078 791.5,-1078 791.5,-1102"/>
<text text-anchor="middle" x="743" y="-1087.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RADTERMVALUE</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~radtermvalue</title>
<path fill="none" stroke="#ff9100" d="M534.88,-1237.86C550.72,-1226.9 573.1,-1209.53 588,-1190 611.41,-1159.33 593.51,-1134.65 624,-1111 641.03,-1097.79 663.59,-1091.84 684.42,-1089.42"/>
<polygon fill="#ff9100" stroke="#ff9100" points="684.83,-1092.9 694.47,-1088.51 684.2,-1085.93 684.83,-1092.9"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#daff00" d="M1149.46,-1481.99C1156.07,-1478.38 1162.34,-1473.79 1167,-1468 1244.4,-1371.79 1249.7,-1213.15 1248.81,-1154.61"/>
<polygon fill="#daff00" stroke="#daff00" points="1252.3,-1154.2 1248.56,-1144.29 1245.3,-1154.36 1252.3,-1154.2"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#91ff00" d="M789.66,-1624.37C814.71,-1624.07 844.21,-1618.82 862,-1599 940.55,-1511.47 826.48,-1164.36 898,-1071 898.6,-1070.22 899.22,-1069.47 899.88,-1068.75"/>
<polygon fill="#91ff00" stroke="#91ff00" points="902.45,-1071.16 907.82,-1062.03 897.93,-1065.82 902.45,-1071.16"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#91ff00" d="M789.81,-1621.79C847.05,-1622.2 946.63,-1616.8 1022,-1580 1053.35,-1564.7 1080.84,-1534.36 1096.81,-1514.12"/>
<polygon fill="#91ff00" stroke="#91ff00" points="1099.63,-1516.21 1102.93,-1506.14 1094.07,-1511.95 1099.63,-1516.21"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-1706 933,-1706 933,-1682 987,-1682 987,-1706"/>
<text text-anchor="middle" x="960" y="-1691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#91ff00" d="M789.5,-1622.26C812.2,-1624.81 839.53,-1630.11 862,-1641 881.26,-1650.34 879.52,-1662.19 898,-1673 905.71,-1677.51 914.54,-1681.25 923.05,-1684.26"/>
<polygon fill="#91ff00" stroke="#91ff00" points="922.2,-1687.66 932.79,-1687.46 924.38,-1681.01 922.2,-1687.66"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff91" d="M774.68,-474.04C869.75,-511.48 1153.87,-624.32 1167,-641 1225.69,-715.55 1243.3,-1023.6 1247.11,-1109.61"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1243.63,-1109.97 1247.55,-1119.81 1250.62,-1109.67 1243.63,-1109.97"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff91" d="M752.03,-474.14C772.92,-506.17 829.55,-596.17 862,-678 912.73,-805.94 944.67,-969.14 955.18,-1027.78"/>
<polygon fill="#00ff91" stroke="#00ff91" points="951.76,-1028.53 956.94,-1037.78 958.65,-1027.32 951.76,-1028.53"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ff91" d="M781.45,-468.97C814.91,-475.19 864.42,-484.4 902.66,-491.52"/>
<polygon fill="#00ff91" stroke="#00ff91" points="902.15,-494.98 912.62,-493.37 903.43,-488.1 902.15,-494.98"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff91" d="M781.09,-461.63C806.48,-463.25 839.5,-469.29 862,-488 893.55,-514.23 872.24,-541.07 898,-573 906.01,-582.93 916.88,-591.58 927.22,-598.47"/>
<polygon fill="#00ff91" stroke="#00ff91" points="925.39,-601.45 935.71,-603.83 929.13,-595.53 925.39,-601.45"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00ffda" d="M588.13,-1411.28C610.97,-1411.68 636.39,-1412.13 659.88,-1412.55"/>
<polygon fill="#00ffda" stroke="#00ffda" points="660.11,-1416.05 670.17,-1412.73 660.23,-1409.05 660.11,-1416.05"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ffda" d="M548.38,-1422.04C590.16,-1437.57 662.63,-1464.5 706.07,-1480.65"/>
<polygon fill="#00ffda" stroke="#00ffda" points="705.07,-1484.01 715.67,-1484.21 707.51,-1477.45 705.07,-1484.01"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ffda" d="M587.51,-1397.98C613.65,-1393.58 643.24,-1388.61 669.47,-1384.2"/>
<polygon fill="#00ffda" stroke="#00ffda" points="670.07,-1387.64 679.35,-1382.53 668.9,-1380.74 670.07,-1387.64"/>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0091ff" d="M570.08,-1340.69C587.3,-1344.05 606.44,-1347.73 624,-1351 638.54,-1353.71 654.11,-1356.53 669.01,-1359.2"/>
<polygon fill="#0091ff" stroke="#0091ff" points="668.74,-1362.7 679.2,-1361.01 669.97,-1355.81 668.74,-1362.7"/>
</g>
<!-- dfloat -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>dfloat</title>
<polygon fill="#777777" stroke="#777777" points="770,-1342 716,-1342 716,-1318 770,-1318 770,-1342"/>
<text text-anchor="middle" x="743" y="-1327.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfloat</text>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;dfloat -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;dfloat</title>
<path fill="none" stroke="#0091ff" d="M570.13,-1330C612.09,-1330 669.06,-1330 705.69,-1330"/>
<polygon fill="#0091ff" stroke="#0091ff" points="705.91,-1333.5 715.91,-1330 705.91,-1326.5 705.91,-1333.5"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0000ff" d="M813.29,-1580.4C831.55,-1577.47 849.59,-1570.75 862,-1557 934.57,-1476.61 831.89,-1156.78 898,-1071 898.6,-1070.22 899.23,-1069.48 899.88,-1068.76"/>
<polygon fill="#0000ff" stroke="#0000ff" points="902.45,-1071.17 907.84,-1062.04 897.94,-1065.81 902.45,-1071.17"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0000ff" d="M813.16,-1581.93C870.69,-1582.94 953.87,-1579.13 1022,-1555 1048.05,-1545.77 1073.68,-1527.04 1090.8,-1512.75"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1093.17,-1515.33 1098.48,-1506.16 1088.61,-1510.02 1093.17,-1515.33"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-1664 933,-1664 933,-1640 987,-1640 987,-1664"/>
<text text-anchor="middle" x="960" y="-1649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#0000ff" d="M813.29,-1586.47C829.54,-1589.51 846.59,-1593.58 862,-1599 887.2,-1607.86 913.68,-1622.76 932.59,-1634.51"/>
<polygon fill="#0000ff" stroke="#0000ff" points="930.91,-1637.58 941.23,-1639.98 934.66,-1631.67 930.91,-1637.58"/>
</g>
<!-- proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~p_coeff</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/p_coeff.html" xlink:title="p_coeff">
<polygon fill="#d94e8f" stroke="#d94e8f" points="770,-352 716,-352 716,-328 770,-328 770,-352"/>
<text text-anchor="middle" x="743" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_coeff</text>
</a>
</g>
</g>
<!-- proc~transform_summation&#45;&gt;proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~transform_summation&#45;&gt;proc~p_coeff</title>
<path fill="none" stroke="#4800ff" d="M580.16,-343.58C620.78,-342.68 671.84,-341.55 705.62,-340.8"/>
<polygon fill="#4800ff" stroke="#4800ff" points="706.03,-344.3 715.95,-340.58 705.87,-337.3 706.03,-344.3"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00da" d="M995.11,-623.35C1041.62,-635.25 1124.04,-663.33 1167,-720 1214.55,-782.71 1239.51,-1032.72 1246.16,-1109.47"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1242.71,-1110.21 1247.04,-1119.87 1249.69,-1109.62 1242.71,-1110.21"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0091" d="M562.62,-769.79C629.51,-767.55 756.28,-766.74 862,-786 935.7,-799.42 954.23,-807.08 1022,-839 1090.83,-871.42 1118.23,-871.6 1167,-930 1213.05,-985.14 1235.38,-1069.79 1243.82,-1109.71"/>
<polygon fill="#ff0091" stroke="#ff0091" points="1240.43,-1110.61 1245.84,-1119.72 1247.29,-1109.23 1240.43,-1110.61"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0091" d="M562.67,-776.96C572.35,-780.14 581.55,-785.16 588,-793 644.96,-862.28 572.86,-1121.32 624,-1195 690.87,-1291.35 795.17,-1212.62 862,-1309 913.61,-1383.43 869.86,-1628.91 898,-1715 907.93,-1745.39 928.43,-1776.27 942.92,-1795.75"/>
<polygon fill="#ff0091" stroke="#ff0091" points="940.25,-1798.01 949.09,-1803.85 945.82,-1793.77 940.25,-1798.01"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0091" d="M562.54,-777.51C572.11,-780.68 581.29,-785.55 588,-793 648.4,-860.15 559.83,-929.44 624,-993 628.69,-997.65 790.89,-1023.71 887.84,-1038.93"/>
<polygon fill="#ff0091" stroke="#ff0091" points="887.46,-1042.42 897.88,-1040.51 888.54,-1035.5 887.46,-1042.42"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0091" d="M562.79,-777.99C643.86,-788.65 807.05,-811.46 862,-829 946.44,-855.96 1038.27,-907.11 1083.33,-933.81"/>
<polygon fill="#ff0091" stroke="#ff0091" points="1081.58,-936.84 1091.96,-938.96 1085.17,-930.83 1081.58,-936.84"/>
</g>
<!-- proc~wavenumberekin -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~wavenumberekin</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/wavenumberekin.html" xlink:title="WAVENUMBEREKIN">
<polygon fill="#d94e8f" stroke="#d94e8f" points="799,-904 687,-904 687,-880 799,-880 799,-904"/>
<text text-anchor="middle" x="743" y="-889.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">WAVENUMBEREKIN</text>
</a>
</g>
</g>
<!-- proc~input_summary&#45;&gt;proc~wavenumberekin -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~input_summary&#45;&gt;proc~wavenumberekin</title>
<path fill="none" stroke="#ff0091" d="M562.73,-779.34C571.85,-782.42 580.8,-786.8 588,-793 616.93,-817.92 593.77,-847.67 624,-871 639.01,-882.58 658.29,-888.58 676.89,-891.5"/>
<polygon fill="#ff0091" stroke="#ff0091" points="676.46,-894.98 686.82,-892.79 677.36,-888.03 676.46,-894.98"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1139.5,-1664 1085.5,-1664 1085.5,-1640 1139.5,-1640 1139.5,-1664"/>
<text text-anchor="middle" x="1112.5" y="-1649.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ff0000" d="M987.22,-1686.68C1011.63,-1679.87 1048.26,-1669.65 1075.43,-1662.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1076.64,-1665.36 1085.33,-1659.3 1074.76,-1658.62 1076.64,-1665.36"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1139.5,-1706 1085.5,-1706 1085.5,-1682 1139.5,-1682 1139.5,-1706"/>
<text text-anchor="middle" x="1112.5" y="-1691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ff0000" d="M987.22,-1694C1011.53,-1694 1047.93,-1694 1075.07,-1694"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1075.33,-1697.5 1085.33,-1694 1075.33,-1690.5 1075.33,-1697.5"/>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ffda00" d="M987.22,-1652C1011.53,-1652 1047.93,-1652 1075.07,-1652"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1075.33,-1655.5 1085.33,-1652 1075.33,-1648.5 1075.33,-1655.5"/>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ffda00" d="M987.22,-1659.32C1011.63,-1666.13 1048.26,-1676.35 1075.43,-1683.93"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1074.76,-1687.38 1085.33,-1686.7 1076.64,-1680.64 1074.76,-1687.38"/>
</g>
<!-- proc~p_coeff&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~p_coeff&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#48ff00" d="M770.36,-337.55C808.59,-333.99 879.53,-327.39 922.68,-323.38"/>
<polygon fill="#48ff00" stroke="#48ff00" points="923.12,-326.85 932.76,-322.44 922.48,-319.88 923.12,-326.85"/>
</g>
<!-- proc~wavenumberekin&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~wavenumberekin&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff91" d="M793.71,-904C818.56,-912.73 846.57,-927.29 862,-951 908.37,-1022.22 873.28,-1633.69 898,-1715 907.3,-1745.59 927.94,-1776.43 942.63,-1795.84"/>
<polygon fill="#00ff91" stroke="#00ff91" points="940,-1798.16 948.9,-1803.91 945.53,-1793.86 940,-1798.16"/>
</g>
<!-- proc~wavenumberekin&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~wavenumberekin&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff91" d="M799.06,-893.46C820.77,-891.37 844.61,-885.4 862,-871 935.08,-810.47 953.19,-688.5 957.6,-638.33"/>
<polygon fill="#00ff91" stroke="#00ff91" points="961.1,-638.48 958.39,-628.24 954.12,-637.94 961.1,-638.48"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#4800ff" d="M791.72,-1081.12C819.96,-1075.87 856.27,-1069.11 887.85,-1063.24"/>
<polygon fill="#4800ff" stroke="#4800ff" points="888.72,-1066.63 897.92,-1061.36 887.44,-1059.75 888.72,-1066.63"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#4800ff" d="M765.86,-1077.95C792.65,-1062.03 837.49,-1031.47 862,-993 937.56,-874.42 954.37,-699.58 958.02,-638.24"/>
<polygon fill="#4800ff" stroke="#4800ff" points="961.52,-638.32 958.56,-628.15 954.53,-637.95 961.52,-638.32"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="987,-1104 933,-1104 933,-1080 987,-1080 987,-1104"/>
<text text-anchor="middle" x="960" y="-1089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#4800ff" d="M791.72,-1090.44C831.35,-1090.81 886.88,-1091.33 922.9,-1091.66"/>
<polygon fill="#4800ff" stroke="#4800ff" points="922.93,-1095.16 932.96,-1091.76 922.99,-1088.16 922.93,-1095.16"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1276,-1685 1222,-1685 1222,-1661 1276,-1661 1276,-1685"/>
<text text-anchor="middle" x="1249" y="-1670.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1139.75,-1656.1C1160.3,-1659.31 1189.12,-1663.81 1211.85,-1667.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1211.39,-1670.83 1221.81,-1668.91 1212.47,-1663.91 1211.39,-1670.83"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ff00" d="M1139.75,-1689.9C1160.3,-1686.69 1189.12,-1682.19 1211.85,-1678.64"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1212.47,-1682.09 1221.81,-1677.09 1211.39,-1675.17 1212.47,-1682.09"/>
</g>
<!-- proc~ispline&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~ispline&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#0000ff" d="M987.27,-1086.65C998.7,-1083.43 1011.78,-1078.46 1022,-1071 1058.45,-1044.38 1086.64,-998.65 1100.99,-971.99"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1104.11,-973.58 1105.65,-963.1 1097.91,-970.34 1104.11,-973.58"/>
</g>
<!-- proc~ispline&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge140" class="edge">
<title>proc~ispline&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0000ff" d="M965.5,-1104.03C986.57,-1160.31 1075.55,-1397.98 1103.24,-1471.94"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1100.08,-1473.48 1106.87,-1481.62 1106.64,-1471.03 1100.08,-1473.48"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen~4">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2~4">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~8">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_level_indices~13"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_level_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~3"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij~10"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~8"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~15"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_index"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_index</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_indextmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_indextmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate~2"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavmax~2"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">POTENTIAL</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PES_COUPLING_MATRIX</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">statetostateXS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w"> </span><span class="n">write_message</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_indextmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wavmax</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channels_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_read</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_reduction</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_interpolation</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_index</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_index</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channels_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channels_level_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channels_level_indices and channels_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_level_indices_channels_omega_values</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_l_values</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_bf_channels</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">! and the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_number_of_open_channels_wavmax</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">wavmax</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">wavmax</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">bf_to_sf_transformation</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">CROSSSECTION</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_xs</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_dtol_otol</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2023 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-12-29 16:14            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>