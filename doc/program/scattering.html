<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">205 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~2">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/radial_coupling_terms_mod.html'>radial_coupling_terms_mod</a></li>
                <li><a href='../module/state_to_state_cross_sections_mod.html'>state_to_state_cross_sections_mod</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/pes_matrix_mod.html'>pes_matrix_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/data_mod.html'>data_mod</a></li>
                <li><a href='../module/save_s_matrix_mod.html'>save_s_matrix_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/propagator_mod.html'>propagator_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="465pt"
 viewBox="0.00 0.00 641.00 465.42" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.89 1.89) rotate(0) translate(4 876.01)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-876.01 1208,-876.01 1208,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="1204,-52.37 1125,-52.37 1125,-28.37 1204,-28.37 1204,-52.37"/>
<text text-anchor="middle" x="1164.5" y="-37.97" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~radial_coupling_terms_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/radial_coupling_terms_mod.html" xlink:title="radial_coupling_terms_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="798,-497.37 638,-497.37 638,-473.37 798,-473.37 798,-497.37"/>
<text text-anchor="middle" x="718" y="-482.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-563.37C940.06,-622.57 800.13,-541.4 743.84,-503.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="745.77,-500.33 735.55,-497.53 741.79,-506.09 745.77,-500.33"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="763,-712.37 673,-712.37 673,-688.37 763,-688.37 763,-712.37"/>
<text text-anchor="middle" x="718" y="-697.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-721.37C878.7,-730.88 818.4,-721.62 773.28,-712.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="773.83,-709.1 763.33,-710.52 772.42,-715.96 773.83,-709.1"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="255,-633.37 130,-633.37 130,-609.37 255,-609.37 255,-633.37"/>
<text text-anchor="middle" x="192.5" y="-618.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-721.37C862.35,-738.14 856.1,-750.42 816,-763.37 690.36,-803.94 653.71,-831.01 523,-812.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-812.37C489,-807.15 484.69,-793.38 460,-772.37 409.1,-729.03 425.32,-663.16 358.5,-661.37"/>
</g>
<!-- module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~pes_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/pes_matrix_mod.html" xlink:title="pes_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="952,-497.37 852,-497.37 852,-473.37 952,-473.37 952,-497.37"/>
<text text-anchor="middle" x="902" y="-482.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-563.37C994.7,-589.38 943.28,-536.7 918.22,-505.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="920.81,-503.38 911.89,-497.67 915.31,-507.7 920.81,-503.38"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="419,-822.37 296,-822.37 296,-798.37 419,-798.37 419,-822.37"/>
<text text-anchor="middle" x="357.5" y="-807.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-812.37C491.27,-808.13 458.18,-807.07 429.65,-807.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="429.32,-803.78 419.36,-807.41 429.41,-810.78 429.32,-803.78"/>
</g>
<!-- module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~state_to_state_cross_sections_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/state_to_state_cross_sections_mod.html" xlink:title="state_to_state_cross_sections_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="816,-754.37 620,-754.37 620,-730.37 816,-730.37 816,-754.37"/>
<text text-anchor="middle" x="718" y="-739.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~state_to_state_cross_sections_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-721.37C877.76,-731.29 851.41,-737.07 826.12,-740.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="825.65,-736.86 816.12,-741.5 826.46,-743.82 825.65,-736.86"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="549,-556.37 495,-556.37 495,-532.37 549,-532.37 549,-556.37"/>
<text text-anchor="middle" x="522" y="-541.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-563.37C959.11,-611.94 987.82,-685.17 903,-721.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-721.37C862.24,-737.91 853.85,-697.89 816,-679.37 729.05,-636.81 704.49,-631.62 620,-584.37 603.43,-575.1 601.34,-569.11 584,-561.37 576.15,-557.86 567.4,-554.91 559.04,-552.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="559.68,-549.05 549.12,-549.84 557.87,-555.81 559.68,-549.05"/>
</g>
<!-- module~data_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~data_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/data_mod.html" xlink:title="data_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="225.5,-318.37 159.5,-318.37 159.5,-294.37 225.5,-294.37 225.5,-318.37"/>
<text text-anchor="middle" x="192.5" y="-303.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">data_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.8,-52.73C1158.36,-126.44 1131.12,-506.6 1039.5,-563.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-563.37C941.69,-622.73 992.6,-416.75 903,-348.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-348.37C761.1,-241.59 696.36,-200.05 523,-230.37"/>
</g>
<!-- module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~save_s_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/save_s_matrix_mod.html" xlink:title="save_s_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="416,-358.37 299,-358.37 299,-334.37 416,-334.37 416,-358.37"/>
<text text-anchor="middle" x="357.5" y="-343.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~save_s_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-348.37C863.83,-320.77 563.71,-334.39 426.51,-342.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="425.91,-338.72 416.12,-342.78 426.31,-345.7 425.91,-338.72"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-164.37 291,-164.37 291,-140.37 424,-140.37 424,-164.37"/>
<text text-anchor="middle" x="357.5" y="-149.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-0.37C1013.96,-1.55 1007.85,-6.67 988,-19.37 969.2,-31.39 972.09,-44.66 952,-54.37 818.03,-119.09 766.86,-73.5 620,-97.37 576.64,-104.41 566.7,-111.87 523,-116.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-116.37C482.95,-119.76 440.87,-129.25 409.06,-137.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="407.86,-134.33 399.11,-140.31 409.68,-141.09 407.86,-134.33"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="794.5,-320.37 641.5,-320.37 641.5,-296.37 794.5,-296.37 794.5,-320.37"/>
<text text-anchor="middle" x="718" y="-305.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-348.37C873.46,-327.92 837.51,-317.55 804.84,-312.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="805.22,-308.93 794.82,-310.98 804.23,-315.86 805.22,-308.93"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node13"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-555.37 0,-555.37 0,-531.37 94,-531.37 94,-555.37"/>
<text text-anchor="middle" x="47" y="-540.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1141.77,-28.24C1117.53,-15.94 1076.79,1.1 1039.5,-0.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-0.37C975.18,-2.82 965.2,-35.83 903,-40.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-40.37C629.39,-60.16 537.45,17.52 291,-98.37 236.53,-123.98 243.2,-158.4 193.5,-192.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M191.5,-192.37C76.75,-269.35 53.7,-456.06 49.12,-520.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="45.61,-520.9 48.48,-531.1 52.59,-521.34 45.61,-520.9"/>
</g>
<!-- module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~propagator_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/propagator_mod.html" xlink:title="propagator_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="1089,-52.37 988,-52.37 988,-28.37 1089,-28.37 1089,-52.37"/>
<text text-anchor="middle" x="1038.5" y="-37.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">propagator_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;module~propagator_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1124.95,-40.37C1116.87,-40.37 1108.18,-40.37 1099.53,-40.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1099.45,-36.87 1089.45,-40.37 1099.45,-43.87 1099.45,-36.87"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M699.08,-497.47C664.54,-520.92 586.55,-574.47 523,-622.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-622.37C506.17,-633.54 377.06,-661.74 358.5,-661.37"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M669.46,-497.44C653.66,-501.63 636.01,-506.5 620,-511.37 599.61,-517.56 577.06,-525.19 558.83,-531.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="557.47,-528.31 549.2,-534.93 559.79,-534.92 557.47,-528.31"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M653.95,-497.37C564.48,-512.99 406.23,-535 358.5,-505.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-505.37C283.14,-458.94 227.19,-368.26 204.52,-327.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.57,-325.59 199.72,-318.48 201.42,-328.93 207.57,-325.59"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-622.37C479.43,-653.7 481.86,-675.12 460,-722.37 438.58,-768.67 460.73,-795.96 424,-831.37 402.18,-852.4 387.43,-841.32 358.5,-850.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-850.37C287.36,-871.98 256.94,-885.34 193.5,-850.37"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="584,-438.37 460,-438.37 460,-414.37 584,-414.37 584,-438.37"/>
<text text-anchor="middle" x="522" y="-423.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M677.27,-473.29C646.93,-464.06 604.95,-451.29 572.44,-441.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="573.26,-437.99 562.67,-438.43 571.22,-444.69 573.26,-437.99"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M672.84,-709.44C633.61,-717.29 574.65,-728.57 523,-736.37"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M521,-736.37C442.35,-748.24 438.02,-663.42 358.5,-661.37"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M691.84,-688.22C670.66,-677.03 640.62,-658.79 620,-636.37 597.38,-611.77 608.74,-592.83 584,-570.37 576.8,-563.83 567.71,-558.78 558.77,-554.94"/>
<polygon fill="#ff7500" stroke="#ff7500" points="559.8,-551.59 549.21,-551.24 557.27,-558.12 559.8,-551.59"/>
</g>
<!-- module~channels_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~channels_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M697.75,-688.29C677.96,-675.73 646.4,-655.3 620,-636.37 603.53,-624.55 601.81,-618.04 584,-608.37 532.74,-580.53 512.93,-589.89 460,-565.37 412.45,-543.34 402.78,-533.39 358.5,-505.37"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M521,-736.37C461.33,-745.37 476.11,-800.93 424,-831.37 397.83,-846.66 387.43,-841.32 358.5,-850.37"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M169.39,-609.35C145.34,-596.28 106.69,-575.27 79.48,-560.48"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="80.83,-557.23 70.37,-555.53 77.48,-563.38 80.83,-557.23"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M851.75,-485.37C838.32,-485.37 823.34,-485.37 808.42,-485.37"/>
<polygon fill="#9cff00" stroke="#9cff00" points="808.12,-481.87 798.12,-485.37 808.12,-488.87 808.12,-481.87"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M885.21,-497.5C835.42,-534.64 675.92,-645.21 523,-660.37"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M521,-660.37C449.06,-666.78 430.7,-663.31 358.5,-661.37"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M717,-426.37C641.75,-419.64 570.45,-489.11 539.35,-524.46"/>
<polygon fill="#9cff00" stroke="#9cff00" points="536.53,-522.39 532.67,-532.25 541.84,-526.95 536.53,-522.39"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M876.14,-473.34C841.78,-457.66 777.39,-431.59 719,-426.37"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M717,-426.37C657.39,-421.04 643.23,-413.88 584,-405.37 454.02,-386.68 414.62,-411.66 291,-367.37 263.29,-357.44 235.16,-338.72 216.28,-324.62"/>
<polygon fill="#9cff00" stroke="#9cff00" points="218.37,-321.81 208.3,-318.52 214.12,-327.37 218.37,-321.81"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M896.06,-473.2C878.96,-431.23 823.04,-294.65 816,-287.37 766.3,-235.96 594.41,-158.02 523,-154.37"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M521,-154.37C492.87,-150.49 461.74,-149.35 434.32,-149.4"/>
<polygon fill="#9cff00" stroke="#9cff00" points="433.98,-145.9 424.01,-149.47 434.03,-152.9 433.98,-145.9"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~pes_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M521,-154.37C447.53,-144.23 432.55,-188.11 358.5,-192.37"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M356.5,-192.37C284.18,-196.53 253.31,-151.49 193.5,-192.37"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M717,-426.37C676.52,-422.75 631.11,-422.54 594.4,-423.33"/>
<polygon fill="#9cff00" stroke="#9cff00" points="594.2,-419.84 584.29,-423.58 594.37,-426.83 594.2,-419.84"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M346.06,-798.26C318.64,-766.46 244.39,-680.37 210.63,-641.23"/>
<polygon fill="#27ff00" stroke="#27ff00" points="213.25,-638.91 204.07,-633.62 207.95,-643.48 213.25,-638.91"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M351.36,-798.28C339.78,-770.85 311.12,-701.66 291,-642.37 251.29,-525.33 213.11,-382.07 199.11,-328.21"/>
<polygon fill="#27ff00" stroke="#27ff00" points="202.47,-327.2 196.57,-318.39 195.69,-328.95 202.47,-327.2"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M327.33,-822.46C286.93,-838.38 216.34,-862.96 193.5,-850.37"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M191.5,-850.37C84.53,-791.4 56.68,-626.15 49.98,-565.8"/>
<polygon fill="#27ff00" stroke="#27ff00" points="53.42,-565.09 48.93,-555.49 46.46,-565.8 53.42,-565.09"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M669.28,-754.42C616.3,-765.42 529.14,-776.39 460,-750.37 403.85,-729.24 418.48,-662.91 358.5,-661.37"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M632.63,-730.29C628.09,-727.79 623.82,-724.84 620,-721.37 581,-685.91 610.87,-653.71 584,-608.37 573.83,-591.2 558.25,-574.96 545.39,-563.14"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="547.6,-560.42 537.8,-556.38 542.94,-565.64 547.6,-560.42"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M649.78,-730.34C639.67,-727.81 629.47,-724.83 620,-721.37 544.38,-693.7 524.74,-684.25 460,-636.37 441.81,-622.91 441.79,-614.35 424,-600.37 369.59,-557.59 336.97,-571.1 291,-519.37 239.05,-460.9 210.13,-370.07 198.95,-328.5"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="202.28,-327.39 196.38,-318.59 195.51,-329.15 202.28,-327.39"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M702.62,-754.65C679.41,-773.69 631.46,-809.86 584,-826.37 488.8,-859.47 454.7,-820.29 358.5,-850.37"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M509.1,-556.71C484.33,-582.37 429.09,-639.34 424,-642.37 397.95,-657.86 388.8,-662.15 358.5,-661.37"/>
</g>
<!-- module~io_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~io_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M494.72,-540.13C454.8,-533.36 381.11,-519.41 358.5,-505.37"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M510.82,-532.11C496.83,-514.55 472.05,-480.66 460,-447.37 418.96,-333.94 498.24,-273.44 424,-178.37 421.49,-175.15 418.52,-172.33 415.25,-169.86"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="416.94,-166.79 406.62,-164.4 413.2,-172.7 416.94,-166.79"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M494.98,-546.27C439.4,-549.91 305.04,-556.37 193.5,-543.37"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M191.5,-543.37C162.92,-539.75 130.87,-539.4 104.33,-540.1"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="103.95,-536.61 94.07,-540.43 104.18,-543.61 103.95,-536.61"/>
</g>
<!-- module~input_validation -->
<g id="program~~scattering~~UsesGraph_node18" class="node">
<title>module~input_validation</title>
<g id="a_program~~scattering~~UsesGraph_node18"><a xlink:href=".././module/input_validation.html" xlink:title="input_validation">
<polygon fill="#337ab7" stroke="#337ab7" points="406,-633.37 309,-633.37 309,-609.37 406,-609.37 406,-633.37"/>
<text text-anchor="middle" x="357.5" y="-618.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_validation</text>
</a>
</g>
</g>
<!-- module~io_mod&#45;&gt;module~input_validation -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~io_mod&#45;&gt;module~input_validation</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M495.61,-556.4C468.02,-569.47 423.79,-590.43 393.05,-605"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="391.52,-601.85 383.98,-609.29 394.52,-608.17 391.52,-601.85"/>
</g>
<!-- module~data_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~data_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M184.19,-318.45C161.11,-356.56 89.64,-474.6 60.53,-522.68"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="57.48,-520.95 55.3,-531.31 63.47,-524.57 57.48,-520.95"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M337.83,-358.39C322.91,-368.98 302.63,-385.75 291,-405.37 255.6,-465.09 288.22,-496.41 255,-557.37 245.47,-574.85 229.9,-590.98 216.81,-602.68"/>
<polygon fill="#004eff" stroke="#004eff" points="214.35,-600.18 209.05,-609.36 218.92,-605.49 214.35,-600.18"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M307.59,-334.37C284.66,-328.74 257.61,-322.1 235.6,-316.7"/>
<polygon fill="#004eff" stroke="#004eff" points="236.42,-313.3 225.88,-314.31 234.75,-320.1 236.42,-313.3"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M343.9,-334.15C306.01,-297.48 195.63,-190.91 193.5,-192.37"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge47" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M290.98,-157.61C259.32,-162.72 222.09,-172.74 193.5,-192.37"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge48" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M705.73,-320.5C676.11,-352.33 597.45,-436.52 584,-447.37 533.68,-487.94 499.5,-472.2 460,-523.37 426.24,-567.11 463.29,-603.52 424,-642.37 402.44,-663.68 388.81,-661.97 358.5,-661.37"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge50" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M703.58,-320.54C683.68,-339.05 645.92,-375.96 620,-412.37 600.17,-440.22 603.98,-452.62 584,-480.37 572.19,-496.77 556.39,-513.23 543.83,-525.35"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="541.35,-522.88 536.49,-532.3 546.16,-527.96 541.35,-522.88"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge52" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M653.98,-296.35C631.94,-292.69 606.96,-289.17 584,-287.37 457.43,-277.44 307.34,-292.16 235.68,-300.81"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="235.18,-297.35 225.69,-302.04 236.04,-304.3 235.18,-297.35"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge51" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M701.78,-296.09C677.82,-277.17 629.33,-240.55 584,-216.37 558.29,-202.66 550.58,-201.74 523,-192.37"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M521,-192.37C490.98,-182.16 457.02,-173.39 427.94,-166.68"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="428.4,-163.2 417.87,-164.4 426.85,-170.02 428.4,-163.2"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge54" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M521,-192.37C452.62,-169.12 430.6,-188.22 358.5,-192.37"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge49" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M696.97,-320.55C662.39,-341.58 591.39,-384.77 551.62,-408.96"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="549.65,-406.06 542.92,-414.25 553.28,-412.04 549.65,-406.06"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node17" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="549,-320.37 495,-320.37 495,-296.37 549,-296.37 549,-320.37"/>
<text text-anchor="middle" x="522" y="-305.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge53" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M641.44,-308.37C613.21,-308.37 582.43,-308.37 559.32,-308.37"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="559.28,-304.87 549.28,-308.37 559.28,-311.87 559.28,-304.87"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge56" class="edge">
<title>module~propagator_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M1036.98,-52.46C1033.8,-121.51 1014.93,-465.51 952,-546.37 881.04,-637.54 531.4,-659.62 523,-660.37"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge55" class="edge">
<title>module~propagator_mod&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M1034.83,-52.51C1025.28,-95.38 991.31,-243.47 952,-362.37 940,-398.65 922.92,-439.68 912.42,-463.99"/>
<polygon fill="#ff0075" stroke="#ff0075" points="909.14,-462.76 908.36,-473.32 915.56,-465.55 909.14,-462.76"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge60" class="edge">
<title>module~propagator_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M1037.17,-52.71C1035.1,-120.1 1021.62,-442.94 952,-506.37 841.08,-607.41 640.46,-573.39 558.92,-553.97"/>
<polygon fill="#ff0075" stroke="#ff0075" points="559.67,-550.55 549.12,-551.57 558,-557.35 559.67,-550.55"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge58" class="edge">
<title>module~propagator_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M717,-158.37C625.1,-161.88 614.63,-222.48 523,-230.37"/>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M521,-230.37C416.34,-239.38 296.96,-273.28 235.3,-292.63"/>
<polygon fill="#ff0075" stroke="#ff0075" points="234.02,-289.36 225.55,-295.71 236.14,-296.03 234.02,-289.36"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge57" class="edge">
<title>module~propagator_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M901,-158.37C823.78,-182.45 799.83,-155.28 719,-158.37"/>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M717,-158.37C673.1,-160.04 662.94,-148.66 620,-139.37 576.7,-130 567.07,-111.83 523,-116.37"/>
</g>
<!-- module~propagator_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge61" class="edge">
<title>module~propagator_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M987.93,-38.65C962.51,-38.2 931.06,-38.32 903,-40.37"/>
</g>
<!-- module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node16" class="node">
<title>module~centrifugal_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node16"><a xlink:href=".././module/centrifugal_matrix_mod.html" xlink:title="centrifugal_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="787.5,-130.37 648.5,-130.37 648.5,-106.37 787.5,-106.37 787.5,-130.37"/>
<text text-anchor="middle" x="718" y="-115.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">centrifugal_matrix_mod</text>
</a>
</g>
</g>
<!-- module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge59" class="edge">
<title>module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M1029.24,-52.58C1010.55,-78.87 962.01,-139.96 903,-158.37"/>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M901,-158.37C888.76,-162.19 821.85,-145.93 772.69,-133"/>
<polygon fill="#ff0075" stroke="#ff0075" points="773.38,-129.56 762.81,-130.38 771.58,-136.32 773.38,-129.56"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge62" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M477.63,-438.45C470.93,-441.99 464.69,-446.54 460,-452.37 406.12,-519.33 481.82,-578.77 424,-642.37 403.61,-664.79 388.8,-662.15 358.5,-661.37"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-661.37C314.13,-660.27 267.29,-647.51 234.73,-636.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="235.7,-633.32 225.11,-633.41 233.44,-639.95 235.7,-633.32"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge63" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M511.19,-414.1C494.67,-393.93 459.6,-353.25 424,-325.37 377.44,-288.9 242.26,-158.9 193.5,-192.37"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node19" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node19"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-438.37 291,-438.37 291,-414.37 424,-414.37 424,-438.37"/>
<text text-anchor="middle" x="357.5" y="-423.97" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge64" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.57,-426.37C451.32,-426.37 442.79,-426.37 434.34,-426.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="434.09,-422.87 424.09,-426.37 434.09,-429.87 434.09,-422.87"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge68" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M648.46,-125.7C637.63,-129.73 627.53,-135.67 620,-144.37 575.62,-195.63 606.6,-383.44 584,-447.37 573.81,-476.19 553.88,-505.36 539.57,-524.08"/>
<polygon fill="#7fff00" stroke="#7fff00" points="536.66,-522.11 533.25,-532.14 542.17,-526.42 536.66,-522.11"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge65" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M356.5,-112.37C329.19,-125.51 314.13,-111.78 291,-131.37 262.79,-155.27 272.71,-173.91 255,-206.37 239.66,-234.48 219.99,-265.75 207.07,-285.72"/>
<polygon fill="#7fff00" stroke="#7fff00" points="204.01,-284 201.49,-294.29 209.88,-287.82 204.01,-284"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge66" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M648.14,-113.89C610.98,-112.42 564.38,-112.11 523,-116.37"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge67" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M675.77,-106.3C606.34,-88.37 463.4,-61.91 358.5,-112.37"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M356.5,-112.37C328.88,-124.86 318.67,-118.99 291,-131.37 244.34,-152.24 235.7,-163.53 193.5,-192.37"/>
</g>
<!-- module~input_validation&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge71" class="edge">
<title>module~input_validation&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M308.92,-621.37C295.25,-621.37 280.03,-621.37 265.25,-621.37"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="265.11,-617.87 255.11,-621.37 265.11,-624.87 265.11,-617.87"/>
</g>
<!-- module~input_validation&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge69" class="edge">
<title>module~input_validation&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M311,-609.34C303.6,-605.79 296.56,-601.23 291,-595.37 253,-555.32 212.22,-388.77 198.4,-328.37"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="201.76,-327.36 196.14,-318.38 194.93,-328.91 201.76,-327.36"/>
</g>
<!-- module~input_validation&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge70" class="edge">
<title>module~input_validation&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M323.88,-609.25C313.28,-605.09 301.55,-600.25 291,-595.37 246.44,-574.72 242.28,-549.05 193.5,-543.37"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="944pt"
 viewBox="0.00 0.00 641.00 944.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(1.91 1.91) rotate(0) translate(4 1800.47)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1800.47 1221,-1800.47 1221,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-852 0,-852 0,-828 79,-828 79,-852"/>
<text text-anchor="middle" x="39.5" y="-837.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="267,-1748 179,-1748 179,-1724 267,-1724 267,-1748"/>
<text text-anchor="middle" x="223" y="-1733.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.67,-852.31C42.17,-953.62 54.63,-1647.67 115,-1715 128.4,-1729.94 149.05,-1736.11 168.65,-1738.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.53,-1741.71 178.76,-1738.96 169.05,-1734.73 168.53,-1741.71"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="267.5,-1706 178.5,-1706 178.5,-1682 267.5,-1682 267.5,-1706"/>
<text text-anchor="middle" x="223" y="-1691.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.75,-852.24C42.9,-950.11 59.25,-1603.28 115,-1668 128.17,-1683.29 148.69,-1690.4 168.24,-1693.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.98,-1696.95 178.33,-1694.72 168.84,-1690.01 167.98,-1696.95"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-894 167,-894 167,-870 279,-870 279,-894"/>
<text text-anchor="middle" x="223" y="-879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M79.01,-851.5C90.54,-854.76 103.24,-858.19 115,-861 128.48,-864.22 143.01,-867.31 156.88,-870.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.34,-873.56 166.83,-872.06 157.7,-866.69 156.34,-873.56"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="808,-1131 699,-1131 699,-1107 808,-1107 808,-1131"/>
<text text-anchor="middle" x="753.5" y="-1116.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M42.01,-852.25C48.23,-900.62 73.55,-1077.42 115,-1112 200.44,-1183.28 544.87,-1146.92 688.8,-1128.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="689.36,-1131.48 698.81,-1126.69 688.44,-1124.54 689.36,-1131.48"/>
</g>
<!-- proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~print_largest_partial_cross_sections</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/print_largest_partial_cross_sections.html" xlink:title="print_largest_partial_cross_sections">
<polygon fill="#d9534f" stroke="#d9534f" points="1089,-1325 889,-1325 889,-1301 1089,-1301 1089,-1325"/>
<text text-anchor="middle" x="989" y="-1310.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_cross_sections</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_cross_sections</title>
<path fill="none" stroke="#ff0000" d="M41.12,-852.24C44.38,-911.38 61.43,-1166.87 115,-1221 135.11,-1241.32 338.67,-1269.18 367,-1273 545.21,-1297.01 754.2,-1306.71 878.61,-1310.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="878.8,-1314.06 888.9,-1310.86 879.01,-1307.06 878.8,-1314.06"/>
</g>
<!-- proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~save_s_matrix_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/save_s_matrix_file_header.html" xlink:title="save_s_matrix_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="299.5,-1302 146.5,-1302 146.5,-1278 299.5,-1278 299.5,-1302"/>
<text text-anchor="middle" x="223" y="-1287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_file_header</title>
<path fill="none" stroke="#ff0000" d="M40.9,-852.29C43.22,-915.34 56.85,-1201.98 115,-1264 121.17,-1270.59 128.71,-1275.63 136.9,-1279.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.8,-1282.8 146.38,-1283.32 138.43,-1276.31 135.8,-1282.8"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="815.5,-1439 691.5,-1439 691.5,-1415 815.5,-1415 815.5,-1439"/>
<text text-anchor="middle" x="753.5" y="-1424.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.22,-852.03C38.62,-930.95 33.4,-1374.69 115,-1475 189.5,-1566.58 250.47,-1540.09 367,-1559 477.12,-1576.87 514.74,-1601.21 618,-1559 618.92,-1558.62 695.83,-1482.87 732.92,-1446.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="735.53,-1448.65 740.19,-1439.14 730.61,-1443.67 735.53,-1448.65"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="311.5,-646 134.5,-646 134.5,-622 311.5,-622 311.5,-646"/>
<text text-anchor="middle" x="223" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M41.52,-827.77C45,-794.34 59.5,-700.89 115,-655 118.28,-652.29 121.81,-649.89 125.53,-647.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.09,-650.9 134.48,-643.32 123.97,-644.63 127.09,-650.9"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-1466 177.5,-1466 177.5,-1442 268.5,-1442 268.5,-1466"/>
<text text-anchor="middle" x="223" y="-1451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M40.24,-852.19C38.9,-928.39 35.47,-1338.99 115,-1428 128.12,-1442.68 148,-1449.76 167.08,-1452.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.86,-1456.48 177.24,-1454.35 167.81,-1449.54 166.86,-1456.48"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="292,-730 154,-730 154,-706 292,-706 292,-730"/>
<text text-anchor="middle" x="223" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M45.83,-827.74C55.93,-806.06 80.02,-761.15 115,-739 123.79,-733.44 133.73,-729.29 143.93,-726.22"/>
<polygon fill="#ff0000" stroke="#ff0000" points="145,-729.55 153.76,-723.58 143.19,-722.79 145,-729.55"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-852 177.5,-852 177.5,-828 268.5,-828 268.5,-852"/>
<text text-anchor="middle" x="223" y="-837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M79.44,-840C105.04,-840 138.92,-840 167.23,-840"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.38,-843.5 177.38,-840 167.38,-836.5 167.38,-843.5"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="312,-772 134,-772 134,-748 312,-748 312,-772"/>
<text text-anchor="middle" x="223" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M53.76,-827.89C67.91,-815.59 91.51,-796.85 115,-786 124.47,-781.63 134.76,-777.93 145.1,-774.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="146.32,-778.13 155,-772.04 144.42,-771.39 146.32,-778.13"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="260,-486 186,-486 186,-462 260,-462 260,-486"/>
<text text-anchor="middle" x="223" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M41.38,-827.8C45.62,-772.18 65.91,-543.18 115,-495 130.85,-479.45 154.64,-473.74 175.77,-472.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.06,-475.61 185.88,-471.62 175.72,-468.62 176.06,-475.61"/>
</g>
<!-- proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~save_partial_xs_single_block</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/save_partial_xs_single_block.html" xlink:title="save_partial_xs_single_block">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-688 410.5,-688 410.5,-664 574.5,-664 574.5,-688"/>
<text text-anchor="middle" x="492.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_single_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_single_block</title>
<path fill="none" stroke="#ff0000" d="M79.36,-828.25C90.78,-825.01 103.34,-821.66 115,-819 210.03,-797.31 254.6,-841.53 331,-781 362.84,-755.78 335.08,-722.11 367,-697 376.79,-689.3 388.36,-683.98 400.45,-680.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="401.43,-683.73 410.23,-677.83 399.67,-676.96 401.43,-683.73"/>
</g>
<!-- proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~save_s_matrix_block_info</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/save_s_matrix_block_info.html" xlink:title="save_s_matrix_block_info">
<polygon fill="#d9534f" stroke="#d9534f" points="296.5,-444 149.5,-444 149.5,-420 296.5,-420 296.5,-444"/>
<text text-anchor="middle" x="223" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_block_info</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_block_info</title>
<path fill="none" stroke="#ff0000" d="M41.06,-827.95C44.08,-768.6 60.31,-507.89 115,-453 121.94,-446.03 130.47,-441.03 139.66,-437.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.02,-440.72 149.44,-434.28 138.85,-434.06 141.02,-440.72"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="250,-402 196,-402 196,-378 250,-378 250,-402"/>
<text text-anchor="middle" x="223" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.82,-827.94C42.72,-764.76 54.73,-472.6 115,-411 133.02,-392.58 162.14,-387.81 185.45,-387.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.67,-390.89 195.7,-387.46 185.72,-383.89 185.67,-390.89"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="294.5,-688 151.5,-688 151.5,-664 294.5,-664 294.5,-688"/>
<text text-anchor="middle" x="223" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M43.1,-827.7C49.71,-799.64 69.94,-730.7 115,-697 122.96,-691.05 132.15,-686.65 141.74,-683.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.83,-686.76 151.43,-680.58 140.85,-680.04 142.83,-686.76"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-360 151,-360 151,-336 295,-336 295,-360"/>
<text text-anchor="middle" x="223" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M40.62,-827.67C41.51,-760.28 49.22,-437.25 115,-369 122.27,-361.46 131.39,-356.2 141.23,-352.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.33,-355.9 150.84,-349.6 140.25,-349.22 142.33,-355.9"/>
</g>
<!-- proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~print_pes_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/print_pes_matrix_elements_summary.html" xlink:title="print_pes_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-1752 387,-1752 387,-1728 598,-1728 598,-1752"/>
<text text-anchor="middle" x="492.5" y="-1737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_pes_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.77,-852.03C43.04,-946.86 60.03,-1571.62 115,-1632 180.78,-1704.26 247.55,-1622.16 331,-1673 353.17,-1686.51 344.69,-1705.72 367,-1719 370.4,-1721.02 373.94,-1722.87 377.58,-1724.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="376.24,-1727.78 386.82,-1728.38 378.93,-1721.31 376.24,-1727.78"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="270,-318 176,-318 176,-294 270,-294 270,-318"/>
<text text-anchor="middle" x="223" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.44,-827.98C40.36,-757.86 43.5,-402.14 115,-327 128.05,-313.29 147.23,-307.08 165.75,-304.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.33,-308.07 175.94,-303.6 165.64,-301.11 166.33,-308.07"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295.5,-276 150.5,-276 150.5,-252 295.5,-252 295.5,-276"/>
<text text-anchor="middle" x="223" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M40.3,-827.97C39.31,-754.54 37.87,-366.94 115,-285 122.06,-277.5 130.94,-272.25 140.56,-268.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.91,-271.86 150.39,-265.5 139.8,-265.18 141.91,-271.86"/>
</g>
<!-- proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>proc~check_nonzero_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././proc/check_nonzero_pes_matrix_elements.html" xlink:title="check_nonzero_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-234 117.5,-234 117.5,-210 328.5,-210 328.5,-234"/>
<text text-anchor="middle" x="223" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.18,-827.75C45.77,-746.52 73.46,-287.54 115,-243 115.77,-242.17 116.57,-241.37 117.39,-240.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="119.65,-243.27 125.28,-234.29 115.28,-237.8 119.65,-243.27"/>
</g>
<!-- proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~save_partial_xs_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/save_partial_xs_file_header.html" xlink:title="save_partial_xs_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-1588 143.5,-1588 143.5,-1564 302.5,-1564 302.5,-1588"/>
<text text-anchor="middle" x="223" y="-1573.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_file_header</title>
<path fill="none" stroke="#ff0000" d="M40.94,-852.16C44.31,-941.54 67.02,-1495.13 115,-1550 120.35,-1556.12 126.88,-1560.93 134.05,-1564.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.87,-1567.99 143.42,-1568.9 135.74,-1561.61 132.87,-1567.99"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="274,-192 172,-192 172,-168 274,-168 274,-192"/>
<text text-anchor="middle" x="223" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M41.06,-827.99C45.07,-744.19 70.58,-249.01 115,-201 126.98,-188.05 144.42,-181.74 161.76,-178.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.42,-182.41 171.91,-177.71 161.56,-175.46 162.42,-182.41"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-604 455.5,-604 455.5,-580 529.5,-580 529.5,-604"/>
<text text-anchor="middle" x="492.5" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M40.17,-827.77C39.86,-788.79 44.76,-666.92 115,-613 165.45,-574.27 356.22,-582.24 445.23,-588.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.09,-591.82 455.31,-589.03 445.58,-584.84 445.09,-591.82"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="828,-1089 679,-1089 679,-1065 828,-1065 828,-1089"/>
<text text-anchor="middle" x="753.5" y="-1074.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M40.35,-852.13C40.57,-890.82 46.89,-1012.22 115,-1071 199.92,-1144.28 508.01,-1135 618,-1113 635,-1109.6 637.45,-1103.16 654,-1098 661.65,-1095.61 669.73,-1093.41 677.82,-1091.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="678.77,-1094.76 687.68,-1089.03 677.14,-1087.96 678.77,-1094.76"/>
</g>
<!-- proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~prepare_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/prepare_pes_matrix_elements.html" xlink:title="prepare_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="309,-150 137,-150 137,-126 309,-126 309,-150"/>
<text text-anchor="middle" x="223" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.98,-827.76C44.52,-740.17 67.78,-210.4 115,-159 118.8,-154.86 123.16,-151.4 127.9,-148.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="129.51,-151.62 136.79,-143.92 126.3,-145.4 129.51,-151.62"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-528 167,-528 167,-504 279,-504 279,-528"/>
<text text-anchor="middle" x="223" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.87,-827.83C47.82,-777.18 73.01,-583.72 115,-542 126.24,-530.84 141.41,-524.18 156.79,-520.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.86,-523.62 166.89,-518.09 156.37,-516.78 157.86,-523.62"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="780.5,-646 726.5,-646 726.5,-622 780.5,-622 780.5,-646"/>
<text text-anchor="middle" x="753.5" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M39.9,-827.91C38.53,-786.31 40,-647.81 115,-579 187.06,-512.88 235.26,-556.94 331,-537 347.05,-533.66 350.71,-530.79 367,-529 477.89,-516.83 512.52,-492.7 618,-529 667.04,-545.87 711.9,-588.77 735.37,-614.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="732.92,-616.72 742.22,-621.8 738.12,-612.03 732.92,-616.72"/>
</g>
<!-- proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~calculate_state_to_state_cross_section</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/calculate_state_to_state_cross_section.html" xlink:title="calculate_state_to_state_cross_section">
<polygon fill="#d9534f" stroke="#d9534f" points="331,-938 115,-938 115,-914 331,-914 331,-938"/>
<text text-anchor="middle" x="223" y="-923.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_state_to_state_cross_section</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section</title>
<path fill="none" stroke="#ff0000" d="M51.32,-852.25C64.78,-866.68 89.16,-890.3 115,-903 121.07,-905.98 127.53,-908.58 134.14,-910.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="133.32,-914.26 143.91,-913.93 135.42,-907.58 133.32,-914.26"/>
</g>
<!-- proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~read_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/read_radial_coupling_terms.html" xlink:title="read_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-1344 143,-1344 143,-1320 303,-1320 303,-1344"/>
<text text-anchor="middle" x="223" y="-1329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~read_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.62,-852.33C41.51,-919.72 49.22,-1242.75 115,-1311 120.28,-1316.48 126.55,-1320.76 133.35,-1324.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.35,-1327.45 142.93,-1328.03 135.02,-1320.98 132.35,-1327.45"/>
</g>
<!-- proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~reduce_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/reduce_radial_coupling_terms.html" xlink:title="reduce_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="578.5,-1710 406.5,-1710 406.5,-1686 578.5,-1686 578.5,-1710"/>
<text text-anchor="middle" x="492.5" y="-1695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduce_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~reduce_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.84,-852.08C43.51,-944.64 62.68,-1539.26 115,-1597 180.73,-1669.53 243.36,-1596.41 331,-1640 350.17,-1649.53 347.88,-1662.38 367,-1672 376.27,-1676.66 386.33,-1680.49 396.57,-1683.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="395.86,-1687.07 406.44,-1686.44 397.78,-1680.34 395.86,-1687.07"/>
</g>
<!-- proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~interpolate_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/interpolate_radial_coupling_terms.html" xlink:title="interpolate_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="320,-1386 126,-1386 126,-1362 320,-1362 320,-1386"/>
<text text-anchor="middle" x="223" y="-1371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M40.44,-852.02C40.36,-922.14 43.5,-1277.86 115,-1353 115.92,-1353.96 116.87,-1354.89 117.84,-1355.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="115.77,-1358.61 125.83,-1361.94 120.04,-1353.06 115.77,-1358.61"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1217,-1247 1125,-1247 1125,-1223 1217,-1223 1217,-1247"/>
<text text-anchor="middle" x="1171" y="-1232.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M41.19,-852.23C45.74,-930.39 72.47,-1357.8 115,-1395 199.13,-1468.59 506.45,-1402.19 618,-1395 828.64,-1381.42 904.46,-1436.48 1089,-1334 1121.42,-1316 1146.01,-1279.35 1159.19,-1256.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1162.27,-1257.72 1163.98,-1247.26 1156.12,-1254.37 1162.27,-1257.72"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-108 122.5,-108 122.5,-84 323.5,-84 323.5,-108"/>
<text text-anchor="middle" x="223" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.89,-827.89C43.93,-737.63 64.91,-171.87 115,-117 115.77,-116.16 116.55,-115.35 117.36,-114.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="119.63,-117.23 125.19,-108.21 115.22,-111.8 119.63,-117.23"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-1062 176,-1062 176,-1038 270,-1038 270,-1062"/>
<text text-anchor="middle" x="223" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M41.38,-852C44.55,-885.7 58.36,-981.82 115,-1029 129.04,-1040.7 147.71,-1046.56 165.52,-1049.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="165.51,-1052.85 175.87,-1050.61 166.38,-1045.9 165.51,-1052.85"/>
</g>
<!-- proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~check_cross_section_thresholds</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/check_cross_section_thresholds.html" xlink:title="check_cross_section_thresholds">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-66 133,-66 133,-42 313,-42 313,-66"/>
<text text-anchor="middle" x="223" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cross_section_thresholds</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~check_cross_section_thresholds</title>
<path fill="none" stroke="#ff0000" d="M40.82,-827.79C43.42,-734.25 62.09,-133.3 115,-75 117.78,-71.93 120.87,-69.24 124.19,-66.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.12,-69.8 132.89,-61.65 122.52,-63.8 126.12,-69.8"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="533.5,-1264 451.5,-1264 451.5,-1240 533.5,-1240 533.5,-1264"/>
<text text-anchor="middle" x="492.5" y="-1249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M41.37,-852.17C45.6,-907.69 65.8,-1136.2 115,-1184 138.18,-1206.52 343.79,-1234.11 441,-1246.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="440.83,-1249.54 451.18,-1247.28 441.68,-1242.59 440.83,-1249.54"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-1020 429,-1020 429,-996 556,-996 556,-1020"/>
<text text-anchor="middle" x="492.5" y="-1005.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M45.1,-852.02C54.46,-874.73 78.02,-923.73 115,-947 127.76,-955.03 312.92,-982.51 418.72,-997.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="418.31,-1001.17 428.71,-999.13 419.3,-994.25 418.31,-1001.17"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="253,-1020 193,-1020 193,-996 253,-996 253,-1020"/>
<text text-anchor="middle" x="223" y="-1005.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M43.38,-852.38C50.48,-879.97 71.46,-946.79 115,-981 134.25,-996.12 160.94,-1002.88 182.84,-1005.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.51,-1009.33 192.84,-1006.99 183.3,-1002.38 182.51,-1009.33"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="269.5,-24 176.5,-24 176.5,0 269.5,0 269.5,-24"/>
<text text-anchor="middle" x="223" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.76,-827.74C42.92,-731.15 59.24,-94.74 115,-33 127.91,-18.71 147.45,-12.46 166.32,-10.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.74,-13.59 176.38,-9.21 166.11,-6.62 166.74,-13.59"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="539,-810 446,-810 446,-786 539,-786 539,-810"/>
<text text-anchor="middle" x="492.5" y="-795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#ff4a00" d="M279.02,-878.33C296.53,-875.34 315.38,-870.11 331,-861 352.24,-848.61 345.6,-831.1 367,-819 387.68,-807.3 413.17,-801.75 435.69,-799.23"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="436.17,-802.7 445.8,-798.27 435.51,-795.73 436.17,-802.7"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-978 422.5,-978 422.5,-954 562.5,-954 562.5,-978"/>
<text text-anchor="middle" x="492.5" y="-963.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#ff4a00" d="M279.2,-887.12C296.62,-890.46 315.38,-895.96 331,-905 351.7,-916.98 346.04,-933.48 367,-945 380.71,-952.53 396.45,-957.5 412.03,-960.74"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="411.74,-964.25 422.21,-962.64 413.02,-957.37 411.74,-964.25"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="540.5,-936 444.5,-936 444.5,-912 540.5,-912 540.5,-936"/>
<text text-anchor="middle" x="492.5" y="-921.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#ff4a00" d="M279.1,-890.65C324.32,-897.75 388.13,-907.77 433.99,-914.97"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="433.65,-918.46 444.07,-916.55 434.74,-911.54 433.65,-918.46"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="519.5,-646 465.5,-646 465.5,-622 519.5,-622 519.5,-646"/>
<text text-anchor="middle" x="492.5" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff4a00" d="M279.19,-883.29C297.95,-880.87 317.56,-874.73 331,-861 396.03,-794.6 301.09,-720.53 367,-655 389.81,-632.32 427.38,-628.74 455.3,-629.82"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="455.28,-633.32 465.47,-630.43 455.7,-626.34 455.28,-633.32"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-562 465.5,-562 465.5,-538 519.5,-538 519.5,-562"/>
<text text-anchor="middle" x="492.5" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff4a00" d="M279.01,-883.71C297.98,-881.39 317.77,-875.19 331,-861 419.55,-765.99 277.19,-664.82 367,-571 389.31,-547.69 427.13,-544.25 455.24,-545.53"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="455.27,-549.04 465.49,-546.22 455.74,-542.05 455.27,-549.04"/>
</g>
<!-- proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~wavenumber_squared_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/wavenumber_squared_from_energy.html" xlink:title="wavenumber_squared_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="594,-730 391,-730 391,-706 594,-706 594,-730"/>
<text text-anchor="middle" x="492.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_squared_from_energy</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ff4a00" d="M279.2,-881.25C297.32,-878.53 316.5,-872.72 331,-861 362.59,-835.46 338.82,-806.26 367,-777 386.41,-756.85 414.07,-742.79 438.4,-733.47"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="439.69,-736.73 447.88,-730.01 437.29,-730.15 439.69,-736.73"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-852 465.5,-852 465.5,-828 519.5,-828 519.5,-852"/>
<text text-anchor="middle" x="492.5" y="-837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#ff4a00" d="M279.1,-873.35C331.89,-865.06 410.01,-852.79 455.34,-845.68"/>
<polygon fill="#ff4a00" stroke="#ff4a00" points="455.97,-849.12 465.3,-844.11 454.88,-842.21 455.97,-849.12"/>
</g>
<!-- proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff9500" d="M1048.1,-1300.99C1061.8,-1297.28 1076.15,-1292.64 1089,-1287 1109.34,-1278.07 1130.39,-1264.4 1145.94,-1253.31"/>
<polygon fill="#ff9500" stroke="#ff9500" points="1148.38,-1255.86 1154.4,-1247.14 1144.26,-1250.2 1148.38,-1255.86"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="533,-1344 452,-1344 452,-1320 533,-1320 533,-1344"/>
<text text-anchor="middle" x="492.5" y="-1329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ffba00" d="M299.58,-1301.87C345.06,-1309.01 401.69,-1317.9 441.61,-1324.17"/>
<polygon fill="#ffba00" stroke="#ffba00" points="441.21,-1327.65 451.63,-1325.74 442.3,-1320.73 441.21,-1327.65"/>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#f8ff00" d="M311.59,-634C360.41,-634 418.57,-634 455.27,-634"/>
<polygon fill="#f8ff00" stroke="#f8ff00" points="455.49,-637.5 465.49,-634 455.49,-630.5 455.49,-637.5"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#d3ff00" d="M266.47,-1441.9C289.7,-1432.92 316.6,-1418.15 331,-1395 376.94,-1321.14 309.33,-678.11 367,-613 386.14,-591.39 418.53,-586.46 445.47,-586.76"/>
<polygon fill="#d3ff00" stroke="#d3ff00" points="445.38,-590.26 455.49,-587.11 445.62,-583.26 445.38,-590.26"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1222 445,-1222 445,-1198 540,-1198 540,-1222"/>
<text text-anchor="middle" x="492.5" y="-1207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#d3ff00" d="M262.41,-1441.99C285.68,-1432.76 314.05,-1417.69 331,-1395 375.65,-1335.21 312.96,-1282.46 367,-1231 384.85,-1214 411.04,-1207.89 434.79,-1206.37"/>
<polygon fill="#d3ff00" stroke="#d3ff00" points="434.94,-1209.87 444.79,-1205.98 434.67,-1202.87 434.94,-1209.87"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#d3ff00" d="M252.06,-1441.94C274.69,-1431.44 306.65,-1414.82 331,-1395 350.07,-1379.48 345.6,-1365.1 367,-1353 389.52,-1340.26 417.74,-1334.81 441.62,-1332.63"/>
<polygon fill="#d3ff00" stroke="#d3ff00" points="442.19,-1336.09 451.9,-1331.86 441.67,-1329.11 442.19,-1336.09"/>
</g>
<!-- proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~check_namelist_basis</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/check_namelist_basis.html" xlink:title="check_namelist_basis">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-1550 429,-1550 429,-1526 556,-1526 556,-1550"/>
<text text-anchor="middle" x="492.5" y="-1535.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_basis</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_basis</title>
<path fill="none" stroke="#d3ff00" d="M246.61,-1466.07C274.26,-1480.33 322.82,-1503.77 367,-1517 383.5,-1521.94 401.6,-1525.83 418.76,-1528.84"/>
<polygon fill="#d3ff00" stroke="#d3ff00" points="418.3,-1532.31 428.74,-1530.52 419.46,-1525.41 418.3,-1532.31"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-1508 455.5,-1508 455.5,-1484 529.5,-1484 529.5,-1508"/>
<text text-anchor="middle" x="492.5" y="-1493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#d3ff00" d="M268.77,-1461.03C317.65,-1468.7 395.54,-1480.93 445.06,-1488.71"/>
<polygon fill="#d3ff00" stroke="#d3ff00" points="444.76,-1492.2 455.18,-1490.3 445.84,-1485.29 444.76,-1492.2"/>
</g>
<!-- proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~check_namelist_potential</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/check_namelist_potential.html" xlink:title="check_namelist_potential">
<polygon fill="#d9534f" stroke="#d9534f" points="566.5,-1630 418.5,-1630 418.5,-1606 566.5,-1606 566.5,-1630"/>
<text text-anchor="middle" x="492.5" y="-1615.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_potential</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_potential</title>
<path fill="none" stroke="#d3ff00" d="M238.38,-1466.01C263.46,-1486.61 317.27,-1529.33 367,-1559 394.68,-1575.52 427.73,-1591 452.81,-1601.95"/>
<polygon fill="#d3ff00" stroke="#d3ff00" points="451.44,-1605.17 462.01,-1605.92 454.22,-1598.75 451.44,-1605.17"/>
</g>
<!-- proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~check_namelist_input</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/check_namelist_input.html" xlink:title="check_namelist_input">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-1466 429,-1466 429,-1442 556,-1442 556,-1466"/>
<text text-anchor="middle" x="492.5" y="-1451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_input</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_input</title>
<path fill="none" stroke="#d3ff00" d="M268.77,-1454C309.67,-1454 370.87,-1454 418.77,-1454"/>
<polygon fill="#d3ff00" stroke="#d3ff00" points="418.78,-1457.5 428.78,-1454 418.78,-1450.5 418.78,-1457.5"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#aeff00" d="M292.27,-714.74C306.2,-711.42 319.96,-705.93 331,-697 362.59,-671.46 335.08,-638.11 367,-613 388.88,-595.79 419.69,-590.49 445.19,-589.51"/>
<polygon fill="#aeff00" stroke="#aeff00" points="445.45,-593.01 455.39,-589.34 445.33,-586.01 445.45,-593.01"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#aeff00" d="M292.12,-711.69C305.61,-708.53 319.23,-703.87 331,-697 352.24,-684.61 345.6,-667.1 367,-655 394,-639.73 429.19,-634.93 455.27,-633.68"/>
<polygon fill="#aeff00" stroke="#aeff00" points="455.6,-637.17 465.48,-633.35 455.37,-630.18 455.6,-637.17"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#aeff00" d="M292.19,-718C319.1,-718 350.72,-718 380.74,-718"/>
<polygon fill="#aeff00" stroke="#aeff00" points="380.85,-721.5 390.85,-718 380.85,-714.5 380.85,-721.5"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#88ff00" d="M268.51,-834.9C288.58,-831.2 311.99,-824.85 331,-814 350.93,-802.62 345.86,-785.93 367,-777 517.15,-713.6 1076.19,-833.93 1089,-846 1143.09,-896.95 1163.51,-1137.65 1168.62,-1212.64"/>
<polygon fill="#88ff00" stroke="#88ff00" points="1165.14,-1213.08 1169.29,-1222.83 1172.12,-1212.62 1165.14,-1213.08"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#88ff00" d="M261.16,-827.93C284.38,-818.58 313.16,-803.4 331,-781 367.28,-735.44 323.59,-693.83 367,-655 390.83,-633.68 427.92,-629.84 455.43,-630.48"/>
<polygon fill="#88ff00" stroke="#88ff00" points="455.31,-633.98 465.45,-630.92 455.62,-626.98 455.31,-633.98"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#88ff00" d="M268.57,-837.61C289.36,-834.51 313.35,-827.9 331,-814 358.48,-792.36 339.17,-765.2 367,-744 371.84,-740.31 377.08,-737.12 382.58,-734.36"/>
<polygon fill="#88ff00" stroke="#88ff00" points="384.36,-737.39 392.05,-730.1 381.49,-731.01 384.36,-737.39"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#63ff00" d="M312.19,-750.2C318.95,-747.26 325.33,-743.58 331,-739 362.59,-713.46 335.08,-680.11 367,-655 391.79,-635.5 428.05,-631.29 455.05,-631.34"/>
<polygon fill="#63ff00" stroke="#63ff00" points="455.19,-634.84 465.26,-631.56 455.34,-627.84 455.19,-634.84"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#63ff00" d="M300.65,-747.96C333.11,-742.87 371.1,-736.9 404.59,-731.65"/>
<polygon fill="#63ff00" stroke="#63ff00" points="405.5,-735.05 414.83,-730.04 404.41,-728.13 405.5,-735.05"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#18ff00" d="M567.72,-663.96C616.36,-656.08 677.81,-646.11 716.14,-639.9"/>
<polygon fill="#18ff00" stroke="#18ff00" points="717,-643.3 726.31,-638.25 715.88,-636.39 717,-643.3"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#18ff00" d="M574.51,-687.37C733.12,-709.97 1070.83,-759.92 1089,-778 1151.53,-840.21 1166.35,-1130.26 1169.33,-1212.95"/>
<polygon fill="#18ff00" stroke="#18ff00" points="1165.83,-1213.12 1169.67,-1222.99 1172.83,-1212.88 1165.83,-1213.12"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ff57" d="M294.63,-664.91C346.32,-656.79 414.33,-646.12 455.38,-639.67"/>
<polygon fill="#00ff57" stroke="#00ff57" points="456.13,-643.1 465.46,-638.09 455.04,-636.18 456.13,-643.1"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffa1" d="M598.26,-1732.68C605.51,-1729.17 612.22,-1724.69 618,-1719 680.8,-1657.17 612.69,-1601.85 654,-1524 671.36,-1491.29 703.57,-1462.77 726.43,-1445.28"/>
<polygon fill="#00ffa1" stroke="#00ffa1" points="728.75,-1447.91 734.68,-1439.13 724.57,-1442.3 728.75,-1447.91"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffa1" d="M530.82,-1752.01C634.42,-1782.79 928.48,-1852.33 1089,-1708 1157.04,-1646.83 1167.95,-1342.45 1169.68,-1257.21"/>
<polygon fill="#00ffa1" stroke="#00ffa1" points="1173.18,-1257.16 1169.86,-1247.1 1166.18,-1257.04 1173.18,-1257.16"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="577,-234 408,-234 408,-210 577,-210 577,-234"/>
<text text-anchor="middle" x="492.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#00ecff" d="M328.57,-222C351.32,-222 375.25,-222 397.55,-222"/>
<polygon fill="#00ecff" stroke="#00ecff" points="397.68,-225.5 407.68,-222 397.68,-218.5 397.68,-225.5"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00c7ff" d="M302.66,-1581.5C312.61,-1584.18 322.33,-1587.89 331,-1593 353.37,-1606.17 343.66,-1627.63 367,-1639 467.29,-1687.86 507.71,-1655.74 618,-1639 726.13,-1622.59 750.78,-1604.88 853,-1566 960.64,-1525.06 1010.83,-1543.57 1089,-1459 1143.61,-1399.91 1162,-1301.25 1167.68,-1257.3"/>
<polygon fill="#00c7ff" stroke="#00c7ff" points="1171.18,-1257.47 1168.89,-1247.13 1164.23,-1256.65 1171.18,-1257.47"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00c7ff" d="M241.93,-1563.8C265.72,-1546.69 307.48,-1513.32 331,-1475 360.58,-1426.82 324.7,-1390.51 367,-1353 387.11,-1335.17 416.51,-1329.6 441.7,-1328.64"/>
<polygon fill="#00c7ff" stroke="#00c7ff" points="441.89,-1332.14 451.83,-1328.48 441.78,-1325.14 441.89,-1332.14"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1024,-1169 954,-1169 954,-1145 1024,-1145 1024,-1169"/>
<text text-anchor="middle" x="989" y="-1154.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0057ff" d="M819.89,-1089C831.04,-1091.6 842.43,-1094.6 853,-1098 888.78,-1109.5 927.97,-1127.24 954.86,-1140.27"/>
<polygon fill="#0057ff" stroke="#0057ff" points="953.66,-1143.58 964.18,-1144.83 956.74,-1137.29 953.66,-1143.58"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="565,-482 420,-482 420,-458 565,-458 565,-482"/>
<text text-anchor="middle" x="492.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#000cff" d="M279.1,-506.52C317.33,-499.95 368.86,-491.09 411.58,-483.74"/>
<polygon fill="#000cff" stroke="#000cff" points="412.42,-487.15 421.68,-482.01 411.23,-480.25 412.42,-487.15"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#000cff" d="M279.1,-523C331.89,-529.71 410.01,-539.64 455.34,-545.4"/>
<polygon fill="#000cff" stroke="#000cff" points="454.94,-548.88 465.3,-546.67 455.83,-541.94 454.94,-548.88"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="556,-440 429,-440 429,-416 556,-416 556,-440"/>
<text text-anchor="middle" x="492.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#000cff" d="M279.27,-512.73C296.79,-509.78 315.59,-504.45 331,-495 353.13,-481.42 344.69,-462.28 367,-449 382.43,-439.81 400.73,-434.36 418.49,-431.18"/>
<polygon fill="#000cff" stroke="#000cff" points="419.52,-434.57 428.86,-429.57 418.44,-427.65 419.52,-434.57"/>
</g>
<!-- proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#3e00ff" d="M293.6,-938.07C306.49,-941.82 319.5,-946.69 331,-953 350.29,-963.59 347.3,-977.19 367,-987 382.83,-994.88 401.04,-999.88 418.57,-1003.03"/>
<polygon fill="#3e00ff" stroke="#3e00ff" points="418.36,-1006.54 428.79,-1004.68 419.47,-999.63 418.36,-1006.54"/>
</g>
<!-- proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#6300ff" d="M303.17,-1332C348.15,-1332 403.05,-1332 441.95,-1332"/>
<polygon fill="#6300ff" stroke="#6300ff" points="441.98,-1335.5 451.98,-1332 441.98,-1328.5 441.98,-1335.5"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#8800ff" d="M540.38,-1685.93C566.54,-1676.97 597.83,-1662.19 618,-1639 653.15,-1598.59 626.09,-1569.71 654,-1524 673.41,-1492.21 705.48,-1463.32 727.73,-1445.5"/>
<polygon fill="#8800ff" stroke="#8800ff" points="730.02,-1448.15 735.73,-1439.22 725.7,-1442.64 730.02,-1448.15"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#8800ff" d="M578.77,-1706.72C725.02,-1719.71 1015.1,-1736.24 1089,-1672 1152.54,-1616.76 1166.61,-1338.12 1169.38,-1257.12"/>
<polygon fill="#8800ff" stroke="#8800ff" points="1172.88,-1257.15 1169.7,-1247.04 1165.88,-1256.93 1172.88,-1257.15"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="519.5,-1386 465.5,-1386 465.5,-1362 519.5,-1362 519.5,-1386"/>
<text text-anchor="middle" x="492.5" y="-1371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline</title>
<path fill="none" stroke="#ae00ff" d="M320.2,-1374C367.16,-1374 420.85,-1374 455.41,-1374"/>
<polygon fill="#ae00ff" stroke="#ae00ff" points="455.5,-1377.5 465.5,-1374 455.5,-1370.5 455.5,-1377.5"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff00df" d="M232.8,-1062.14C261.02,-1100.94 348.56,-1220.08 367,-1231 389.18,-1244.13 417.25,-1249.63 441.13,-1251.74"/>
<polygon fill="#ff00df" stroke="#ff00df" points="441.2,-1255.25 451.42,-1252.47 441.69,-1248.27 441.2,-1255.25"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="588.5,-894 396.5,-894 396.5,-870 588.5,-870 588.5,-894"/>
<text text-anchor="middle" x="492.5" y="-879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#ff00df" d="M270.22,-1051.38C291.14,-1049.61 314.76,-1043.92 331,-1029 373.89,-989.59 323.59,-941.83 367,-903 372.92,-897.71 379.65,-893.49 386.85,-890.16"/>
<polygon fill="#ff00df" stroke="#ff00df" points="388.23,-893.37 396.2,-886.38 385.61,-886.88 388.23,-893.37"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="618,-1104 367,-1104 367,-1080 618,-1080 618,-1104"/>
<text text-anchor="middle" x="492.5" y="-1089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#ff00df" d="M270.29,-1057.27C307.27,-1063.07 360.13,-1071.37 404.91,-1078.4"/>
<polygon fill="#ff00df" stroke="#ff00df" points="404.5,-1081.88 414.92,-1079.98 405.58,-1074.97 404.5,-1081.88"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="589,-1062 396,-1062 396,-1038 589,-1038 589,-1062"/>
<text text-anchor="middle" x="492.5" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#ff00df" d="M270.29,-1050C302.13,-1050 345.76,-1050 385.85,-1050"/>
<polygon fill="#ff00df" stroke="#ff00df" points="385.96,-1053.5 395.96,-1050 385.96,-1046.5 385.96,-1053.5"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0095" d="M533.79,-1250.99C649.28,-1248.09 981.67,-1239.73 1114.34,-1236.4"/>
<polygon fill="#ff0095" stroke="#ff0095" points="1114.76,-1239.89 1124.67,-1236.14 1114.58,-1232.89 1114.76,-1239.89"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0095" d="M533.51,-1246.33C558.03,-1242.59 589.97,-1237.24 618,-1231 634.21,-1227.39 637.83,-1224.79 654,-1221 756.92,-1196.89 879.24,-1175.2 943.49,-1164.34"/>
<polygon fill="#ff0095" stroke="#ff0095" points="944.39,-1167.74 953.67,-1162.63 943.22,-1160.83 944.39,-1167.74"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="800.5,-1557 706.5,-1557 706.5,-1533 800.5,-1533 800.5,-1557"/>
<text text-anchor="middle" x="753.5" y="-1542.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff0095" d="M533.56,-1261.4C561.14,-1269.89 596.54,-1285.14 618,-1311 658.2,-1359.45 622.44,-1393.52 654,-1448 672.67,-1480.23 704.9,-1509.03 727.39,-1526.71"/>
<polygon fill="#ff0095" stroke="#ff0095" points="725.42,-1529.61 735.48,-1532.93 729.68,-1524.06 725.42,-1529.61"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff006f" d="M556.19,-1012.66C628.46,-1018.88 750.46,-1032.01 853,-1056 960.84,-1081.23 997.97,-1072.92 1089,-1136 1119.03,-1156.81 1143.91,-1191.75 1157.86,-1214.07"/>
<polygon fill="#ff006f" stroke="#ff006f" points="1154.97,-1216.06 1163.15,-1222.79 1160.96,-1212.42 1154.97,-1216.06"/>
</g>
<!-- proc~numerov&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~numerov&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff004a" d="M253.14,-1008C292.51,-1008 364.03,-1008 418.5,-1008"/>
<polygon fill="#ff004a" stroke="#ff004a" points="418.8,-1011.5 428.8,-1008 418.8,-1004.5 418.8,-1011.5"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M539.14,-793.21C565.88,-793.09 598.19,-798.06 618,-819 667.33,-871.14 638.26,-1069.97 654,-1140 676.94,-1242.02 723.52,-1358.37 743.29,-1405.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="740.18,-1407.12 747.3,-1414.97 746.63,-1404.4 740.18,-1407.12"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="780.5,-688 726.5,-688 726.5,-664 780.5,-664 780.5,-688"/>
<text text-anchor="middle" x="753.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#ff0000" d="M519.28,-785.86C566.02,-763.84 664.77,-717.33 717.53,-692.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="719.27,-695.52 726.82,-688.09 716.29,-689.19 719.27,-695.52"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="797,-887 710,-887 710,-863 797,-863 797,-887"/>
<text text-anchor="middle" x="753.5" y="-872.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0000" d="M539,-803.15C562.83,-806.47 592.31,-811.59 618,-819 653.5,-829.24 692.27,-846.02 719.03,-858.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="717.78,-861.83 728.32,-862.96 720.78,-855.51 717.78,-861.83"/>
</g>
<!-- proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~modified_bessel_temme_algorithm</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/modified_bessel_temme_algorithm.html" xlink:title="modified_bessel_temme_algorithm">
<polygon fill="#d9534f" stroke="#d9534f" points="853,-1009 654,-1009 654,-985 853,-985 853,-1009"/>
<text text-anchor="middle" x="753.5" y="-994.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_temme_algorithm</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm</title>
<path fill="none" stroke="#ff4500" d="M562.57,-974.27C587.52,-977.25 616.34,-980.7 643.87,-984"/>
<polygon fill="#ff4500" stroke="#ff4500" points="643.6,-987.49 653.94,-985.2 644.43,-980.54 643.6,-987.49"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff8b00" d="M540.26,-1207.08C564.71,-1203.92 594.37,-1197.39 618,-1184 638.52,-1172.37 633.79,-1157.16 654,-1145 664.7,-1138.56 677,-1133.69 689.19,-1130.02"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="690.21,-1133.37 698.91,-1127.33 688.34,-1126.63 690.21,-1133.37"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff8b00" d="M540.1,-1209.31C564.92,-1210.95 595,-1216.31 618,-1231 685.34,-1274 727.75,-1364.05 744.42,-1405.4"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="741.2,-1406.77 748.11,-1414.81 747.72,-1404.22 741.2,-1406.77"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff8b00" d="M519.52,-1198C549.11,-1182.82 596.12,-1153.66 618,-1113 666.38,-1023.1 586.71,-731.78 654,-655 669.15,-637.71 694.72,-632.64 716.01,-631.8"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="716.1,-635.3 726.06,-631.69 716.02,-628.3 716.1,-635.3"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff8b00" d="M540.27,-1211.73C661.26,-1216.2 984.19,-1228.13 1114.42,-1232.95"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1114.44,-1236.45 1124.56,-1233.32 1114.7,-1229.45 1114.44,-1236.45"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffd000" d="M1024.34,-1163.24C1043.81,-1167.46 1068.34,-1173.93 1089,-1183 1109.34,-1191.93 1130.39,-1205.6 1145.94,-1216.69"/>
<polygon fill="#ffd000" stroke="#ffd000" points="1144.26,-1219.8 1154.4,-1222.86 1148.38,-1214.14 1144.26,-1219.8"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#e7ff00" d="M540.76,-919.74C566.88,-920.06 598.01,-925.31 618,-945 680.8,-1006.83 631.63,-1054.75 654,-1140 680.54,-1241.14 725.14,-1357.98 743.84,-1405.37"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="740.68,-1406.89 747.62,-1414.89 747.18,-1404.31 740.68,-1406.89"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#e7ff00" d="M540.58,-916.49C563.9,-912.66 592.47,-907.81 618,-903 645.09,-897.9 675.13,-891.7 699.94,-886.43"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="700.83,-889.82 709.88,-884.31 699.37,-882.97 700.83,-889.82"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="780.5,-967 726.5,-967 726.5,-943 780.5,-943 780.5,-967"/>
<text text-anchor="middle" x="753.5" y="-952.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#e7ff00" d="M540.7,-929.65C591.19,-935.69 670.18,-945.15 716.08,-950.64"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="715.83,-954.14 726.18,-951.85 716.67,-947.19 715.83,-954.14"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#a2ff00" d="M533.04,-1335.25C557.94,-1338.12 590.47,-1343.41 618,-1353 658.08,-1366.95 700.33,-1392.18 726.55,-1409.25"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="724.86,-1412.33 735.13,-1414.92 728.72,-1406.49 724.86,-1412.33"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#a2ff00" d="M533.23,-1320.13C599.91,-1299.96 738.27,-1256.97 853,-1214 886.95,-1201.29 924.93,-1185.06 951.94,-1173.18"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="953.64,-1176.26 961.37,-1169.01 950.81,-1169.86 953.64,-1176.26"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#5cff00" d="M519.76,-634C566.2,-634 662.91,-634 715.88,-634"/>
<polygon fill="#5cff00" stroke="#5cff00" points="716.17,-637.5 726.17,-634 716.17,-630.5 716.17,-637.5"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="826,-255 681,-255 681,-231 826,-231 826,-255"/>
<text text-anchor="middle" x="753.5" y="-240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#17ff00" d="M577.23,-228.79C607.11,-231.21 640.72,-233.94 670.46,-236.35"/>
<polygon fill="#17ff00" stroke="#17ff00" points="670.55,-239.87 680.8,-237.19 671.11,-232.89 670.55,-239.87"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="793.5,-213 713.5,-213 713.5,-189 793.5,-189 793.5,-213"/>
<text text-anchor="middle" x="753.5" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#17ff00" d="M577.23,-215.21C618.8,-211.84 667.58,-207.89 703.11,-205"/>
<polygon fill="#17ff00" stroke="#17ff00" points="703.54,-208.48 713.23,-204.18 702.98,-201.5 703.54,-208.48"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff73" d="M588.78,-891.43C747.42,-907.94 1052.03,-943.45 1089,-976 1160.01,-1038.52 1169.46,-1162.32 1170.23,-1212.8"/>
<polygon fill="#00ff73" stroke="#00ff73" points="1166.73,-1212.95 1170.28,-1222.93 1173.73,-1212.91 1166.73,-1212.95"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ff73" d="M588.84,-879.42C626.16,-878.41 667.56,-877.3 699.38,-876.44"/>
<polygon fill="#00ff73" stroke="#00ff73" points="699.88,-879.92 709.79,-876.15 699.69,-872.93 699.88,-879.92"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~check_namelist_basis&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffff" d="M556.01,-1532.71C576.28,-1529.62 598.55,-1524.73 618,-1517 661.63,-1499.65 705.61,-1466.6 730.89,-1445.74"/>
<polygon fill="#00ffff" stroke="#00ffff" points="733.31,-1448.28 738.72,-1439.18 728.81,-1442.92 733.31,-1448.28"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~check_namelist_basis&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ffff" d="M556.2,-1539.69C598.84,-1540.85 654.8,-1542.36 696.06,-1543.47"/>
<polygon fill="#00ffff" stroke="#00ffff" points="696.12,-1546.98 706.21,-1543.75 696.31,-1539.98 696.12,-1546.98"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00b9ff" d="M519.76,-1379.37C557.9,-1387.18 629.93,-1401.92 683.8,-1412.94"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="683.14,-1416.38 693.64,-1414.96 684.54,-1409.52 683.14,-1416.38"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00b9ff" d="M519.59,-1371.19C545.02,-1368.08 584.62,-1362.24 618,-1353 726.1,-1323.07 755.37,-1316.22 853,-1261 896.69,-1236.29 941.75,-1198.66 967.19,-1176.08"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="969.63,-1178.6 974.73,-1169.32 964.95,-1173.39 969.63,-1178.6"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#0073ff" d="M594.17,-707.38C602.49,-704.62 610.56,-701.21 618,-697 639.4,-684.9 632.86,-667.56 654,-655 672.73,-643.87 696.56,-638.6 716.09,-636.12"/>
<polygon fill="#0073ff" stroke="#0073ff" points="716.59,-639.59 726.15,-635.04 715.84,-632.63 716.59,-639.59"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0073ff" d="M594.11,-729.76C675.75,-744.7 787.67,-778.39 853,-854 901.79,-910.47 858.74,-949.79 889,-1018 909.7,-1064.68 947.4,-1111.51 969.83,-1137.13"/>
<polygon fill="#0073ff" stroke="#0073ff" points="967.27,-1139.52 976.53,-1144.67 972.51,-1134.87 967.27,-1139.52"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~check_namelist_potential&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff008b" d="M566.51,-1613.66C584.68,-1609.78 603.18,-1603.15 618,-1592 645.33,-1571.44 633.58,-1551.43 654,-1524 676.5,-1493.79 708.43,-1464.16 729.78,-1445.76"/>
<polygon fill="#ff008b" stroke="#ff008b" points="732.05,-1448.42 737.4,-1439.28 727.51,-1443.09 732.05,-1448.42"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~check_namelist_potential&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff008b" d="M559.15,-1605.96C578.25,-1602.01 599.07,-1597.26 618,-1592 650.02,-1583.1 685.47,-1570.6 711.93,-1560.73"/>
<polygon fill="#ff008b" stroke="#ff008b" points="713.48,-1563.88 721.61,-1557.09 711.02,-1557.33 713.48,-1563.88"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0045" d="M556.2,-1447.46C593.85,-1443.54 641.89,-1438.53 681.01,-1434.45"/>
<polygon fill="#ff0045" stroke="#ff0045" points="681.69,-1437.9 691.27,-1433.38 680.97,-1430.94 681.69,-1437.9"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0045" d="M556.22,-1463.64C585.8,-1467.72 621.63,-1471.99 654,-1474 849.66,-1486.14 940.13,-1528.55 1089,-1401 1134.24,-1362.24 1156.48,-1292.31 1165.27,-1256.87"/>
<polygon fill="#ff0045" stroke="#ff0045" points="1168.7,-1257.58 1167.58,-1247.05 1161.88,-1255.98 1168.7,-1257.58"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0045" d="M556.3,-1461.87C647.11,-1471.79 809.03,-1483.59 853,-1448 908.31,-1403.24 859.35,-1356.68 889,-1292 909.67,-1246.9 946.79,-1201.92 969.24,-1176.95"/>
<polygon fill="#ff0045" stroke="#ff0045" points="972.08,-1179.03 976.24,-1169.28 966.91,-1174.31 972.08,-1179.03"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~check_namelist_input&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff0045" d="M556.01,-1455.8C576.82,-1458.61 599.42,-1464.21 618,-1475 639.85,-1487.69 632.75,-1505.33 654,-1519 666.69,-1527.16 681.86,-1532.77 696.45,-1536.62"/>
<polygon fill="#ff0045" stroke="#ff0045" points="695.88,-1540.09 706.42,-1539.02 697.52,-1533.28 695.88,-1540.09"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1016,-646 962,-646 962,-622 1016,-622 1016,-646"/>
<text text-anchor="middle" x="989" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ff0000" d="M780.83,-671.26C822.63,-663.74 904.29,-649.06 951.64,-640.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="952.54,-643.93 961.76,-638.72 951.3,-637.04 952.54,-643.93"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node73"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1016,-688 962,-688 962,-664 1016,-664 1016,-688"/>
<text text-anchor="middle" x="989" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ff0000" d="M780.83,-676C822.63,-676 904.29,-676 951.64,-676"/>
<polygon fill="#ff0000" stroke="#ff0000" points="951.76,-679.5 961.76,-676 951.76,-672.5 951.76,-679.5"/>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ffff00" d="M776.03,-1009.04C796.25,-1020.55 827.18,-1038.67 853,-1056 893.58,-1083.23 938.64,-1117.89 965.08,-1138.72"/>
<polygon fill="#ffff00" stroke="#ffff00" points="962.97,-1141.51 972.98,-1144.97 967.31,-1136.02 962.97,-1141.51"/>
</g>
<!-- proc~rgamma -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~rgamma</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/rgamma.html" xlink:title="rgamma">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1018,-1009 960,-1009 960,-985 1018,-985 1018,-1009"/>
<text text-anchor="middle" x="989" y="-994.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rgamma</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma</title>
<path fill="none" stroke="#ffff00" d="M853.19,-997C887.21,-997 923.33,-997 949.61,-997"/>
<polygon fill="#ffff00" stroke="#ffff00" points="949.88,-1000.5 959.88,-997 949.88,-993.5 949.88,-1000.5"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffff" d="M797.07,-864.08C866.93,-848.92 1006.39,-830.68 1089,-901 1137.2,-942.03 1161.15,-1144.5 1167.93,-1212.61"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1164.46,-1213.06 1168.9,-1222.68 1171.43,-1212.39 1164.46,-1213.06"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1198,-667 1144,-667 1144,-643 1198,-643 1198,-667"/>
<text text-anchor="middle" x="1171" y="-652.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1016.17,-637.05C1047.1,-640.66 1098.75,-646.69 1133.57,-650.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1133.46,-654.26 1143.79,-651.94 1134.27,-647.31 1133.46,-654.26"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#0000ff" d="M1016.17,-672.95C1047.1,-669.34 1098.75,-663.31 1133.57,-659.25"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1134.27,-662.69 1143.79,-658.06 1133.46,-655.74 1134.27,-662.69"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~2">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_indices~12"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~8"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholdoff"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholdoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~2"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_algebraic_coefficients~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_algebraic_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~2"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_algebraic_coefficients~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_algebraic_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_pes_matrix_elements~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_pes_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">data_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">pes_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">prepare_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="n">print_pes_matrix_elements_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">propagator_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">numerov</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">save_s_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">save_s_matrix_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_s_matrix_block_info</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">check_cross_section_thresholds</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">save_partial_xs_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_partial_xs_single_block</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">save_s_matrix_file_header</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">save_partial_xs_file_header</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by consecutive_blocks_thresholddiag and consecutive_blocks_thresholdoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">consecutive_blocks_thresholddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">consecutive_blocks_thresholdoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the PES matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_pes_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">save_s_matrix_block_info</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w"> </span><span class="n">wv</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">s_matrix_real</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">save_partial_xs_single_block</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if elastic_xs_threshold/inelastic_xs_threshold condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-08 14:29            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>