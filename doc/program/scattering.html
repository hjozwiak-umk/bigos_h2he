<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">202 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-count_blocks">count_blocks</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~3">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/propagator_mod.html'>propagator_mod</a></li>
                <li><a href='../module/pes_matrix_mod.html'>pes_matrix_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/save_s_matrix_mod.html'>save_s_matrix_mod</a></li>
                <li><a href='../module/radial_coupling_terms_mod.html'>radial_coupling_terms_mod</a></li>
                <li><a href='../module/state_to_state_cross_sections_mod.html'>state_to_state_cross_sections_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/data_mod.html'>data_mod</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="466pt"
 viewBox="0.00 0.00 641.00 465.77" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.89 1.89) rotate(0) translate(4 876.67)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-876.67 1208,-876.67 1208,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="1204,-514.23 1125,-514.23 1125,-490.23 1204,-490.23 1204,-514.23"/>
<text text-anchor="middle" x="1164.5" y="-499.83" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="794.5,-634.23 641.5,-634.23 641.5,-610.23 794.5,-610.23 794.5,-634.23"/>
<text text-anchor="middle" x="718" y="-619.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-700.23C856.99,-705.15 856.7,-665.69 816,-648.23 806.06,-643.96 795.25,-640.24 784.57,-637.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="785.4,-633.64 774.82,-634.25 783.47,-640.37 785.4,-633.64"/>
</g>
<!-- module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~save_s_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/save_s_matrix_mod.html" xlink:title="save_s_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="416,-749.23 299,-749.23 299,-725.23 416,-725.23 416,-749.23"/>
<text text-anchor="middle" x="357.5" y="-734.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~save_s_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~save_s_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-700.23C726.23,-719.76 695.05,-780.81 523,-817.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-817.23C471.91,-822.25 468.58,-784.37 424,-763.23 416.53,-759.68 408.45,-756.2 400.59,-752.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="401.76,-749.69 391.17,-749.23 399.16,-756.19 401.76,-749.69"/>
</g>
<!-- module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~radial_coupling_terms_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/radial_coupling_terms_mod.html" xlink:title="radial_coupling_terms_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="798,-554.23 638,-554.23 638,-530.23 798,-530.23 798,-554.23"/>
<text text-anchor="middle" x="718" y="-539.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-700.23C843.37,-706.67 860.21,-638.76 816,-601.23 796.54,-584.71 771.95,-569.8 752.4,-559.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="753.99,-555.99 743.53,-554.35 750.69,-562.16 753.99,-555.99"/>
</g>
<!-- module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~state_to_state_cross_sections_mod</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/state_to_state_cross_sections_mod.html" xlink:title="state_to_state_cross_sections_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="816,-405.23 620,-405.23 620,-381.23 816,-381.23 816,-405.23"/>
<text text-anchor="middle" x="718" y="-390.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~state_to_state_cross_sections_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-542.23C967.02,-547.02 1004.68,-629.16 952,-676.23 933.92,-692.38 927.1,-697.53 903,-700.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-700.23C813.48,-710.01 861.73,-596.49 816,-521.23 791.4,-480.72 756.71,-437.58 736.17,-413.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="738.67,-410.7 729.53,-405.33 733.33,-415.22 738.67,-410.7"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-629.23 0,-629.23 0,-605.23 94,-605.23 94,-629.23"/>
<text text-anchor="middle" x="47" y="-614.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-817.23C447,-824.68 431.47,-842.84 358.5,-857.23"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="255,-689.23 130,-689.23 130,-665.23 255,-665.23 255,-689.23"/>
<text text-anchor="middle" x="192.5" y="-674.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-817.23C507.88,-818.57 302.75,-764.23 291,-758.23 259.96,-742.37 230.01,-715.13 211.68,-696.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="214.05,-694.08 204.57,-689.34 209.03,-698.96 214.05,-694.08"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="549,-325.23 495,-325.23 495,-301.23 549,-301.23 549,-325.23"/>
<text text-anchor="middle" x="522" y="-310.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-313.23C662.12,-310.43 598.39,-311.2 559.38,-312.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="558.97,-308.63 549.07,-312.39 559.15,-315.63 558.97,-308.63"/>
</g>
<!-- module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~propagator_mod</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/propagator_mod.html" xlink:title="propagator_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="1089,-514.23 988,-514.23 988,-490.23 1089,-490.23 1089,-514.23"/>
<text text-anchor="middle" x="1038.5" y="-499.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">propagator_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagator_mod -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~propagator_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1124.95,-502.23C1116.87,-502.23 1108.18,-502.23 1099.53,-502.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1099.45,-498.73 1089.45,-502.23 1099.45,-505.73 1099.45,-498.73"/>
</g>
<!-- module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~pes_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/pes_matrix_mod.html" xlink:title="pes_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="952,-554.23 852,-554.23 852,-530.23 952,-530.23 952,-554.23"/>
<text text-anchor="middle" x="902" y="-539.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-542.23C1012.94,-543.89 985.81,-544.19 962.38,-543.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="962.29,-540.46 952.24,-543.82 962.2,-547.46 962.29,-540.46"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-131.23 291,-131.23 291,-107.23 424,-107.23 424,-131.23"/>
<text text-anchor="middle" x="357.5" y="-116.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.57,-490C1156.31,-417.33 1113.96,-45.23 903,-45.23 903,-45.23 903,-45.23 717,-45.23 601.85,-45.23 470.1,-82.3 402.94,-103.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="401.54,-100.74 393.12,-107.17 403.71,-107.39 401.54,-100.74"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="763,-285.23 673,-285.23 673,-261.23 763,-261.23 763,-285.23"/>
<text text-anchor="middle" x="718" y="-270.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1138.57,-514.26C1114.03,-525.13 1075.16,-539.8 1039.5,-542.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1037.5,-542.23C919.74,-550.23 1002.32,-377 903,-313.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-313.23C862.8,-288.7 811.81,-279.04 773.51,-275.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="773.33,-271.8 763.07,-274.42 772.73,-278.77 773.33,-271.8"/>
</g>
<!-- module~data_mod -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>module~data_mod</title>
<g id="a_program~~scattering~~UsesGraph_node13"><a xlink:href=".././module/data_mod.html" xlink:title="data_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="225.5,-383.23 159.5,-383.23 159.5,-359.23 225.5,-359.23 225.5,-383.23"/>
<text text-anchor="middle" x="192.5" y="-368.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">data_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901,-313.23C832.93,-269.52 799.78,-317.34 719,-313.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M717,-313.23C673.13,-310.99 663.03,-303.1 620,-294.23 576.8,-285.32 567.01,-270.33 523,-273.23"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="419,-829.23 296,-829.23 296,-805.23 419,-805.23 419,-829.23"/>
<text text-anchor="middle" x="357.5" y="-814.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521,-817.23C491.13,-820.28 458.01,-820.8 429.5,-820.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="429.29,-816.85 419.23,-820.15 429.16,-823.85 429.29,-816.85"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M696.1,-634.32C675.86,-646.42 644.7,-666.07 620,-686.23 602.47,-700.53 601.57,-707.96 584,-722.23 532.9,-763.72 511.39,-762.09 460,-803.23 442.58,-817.17 443.29,-827.01 424,-838.23 397.8,-853.47 388.07,-850.57 358.5,-857.23"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.5,-857.23C285.42,-871.24 261.39,-882.51 193.5,-857.23"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M641.5,-633.75C605.23,-640.21 561.41,-649.37 523,-661.23"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M682.9,-610.15C661.4,-600.73 634.96,-585.47 620,-563.23 563.75,-479.54 646.11,-418.66 584,-339.23 577.62,-331.06 568.18,-325.43 558.63,-321.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="559.75,-318.23 549.15,-318.23 557.43,-324.84 559.75,-318.23"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M690.71,-610.03C669.97,-599.56 641.13,-583.05 620,-563.23 480.71,-432.5 391.85,-210.93 366.2,-141.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="369.44,-139.71 362.75,-131.5 362.86,-142.09 369.44,-139.71"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M691.75,-610.12C606.07,-569.04 326.27,-434.88 228,-387.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.33,-384.52 218.8,-383.36 226.31,-390.84 229.33,-384.52"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="549,-713.23 495,-713.23 495,-689.23 549,-689.23 549,-713.23"/>
<text text-anchor="middle" x="522" y="-698.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M657.73,-634.26C644.95,-637.91 631.76,-642.51 620,-648.23 602.01,-656.97 601.32,-665.23 584,-675.23 576.03,-679.82 567.09,-684.08 558.57,-687.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="557.07,-684.6 549.19,-691.68 559.76,-691.06 557.07,-684.6"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node17" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node17"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="584,-633.23 460,-633.23 460,-609.23 584,-609.23 584,-633.23"/>
<text text-anchor="middle" x="522" y="-618.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M641.44,-621.84C626.05,-621.76 609.91,-621.67 594.66,-621.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="594.29,-618.09 584.27,-621.54 594.25,-625.09 594.29,-618.09"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M342.74,-749.43C306.6,-781.2 210.54,-863.57 193.5,-857.23"/>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M191.5,-857.23C99.12,-822.82 63.01,-692 52.02,-639.36"/>
<polygon fill="#ff7500" stroke="#ff7500" points="55.42,-638.51 50.05,-629.38 48.55,-639.87 55.42,-638.51"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M323.51,-725.08C298.24,-715.78 263.19,-702.88 235.85,-692.81"/>
<polygon fill="#ff7500" stroke="#ff7500" points="236.75,-689.42 226.16,-689.25 234.33,-695.99 236.75,-689.42"/>
</g>
<!-- module~save_s_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~save_s_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M338.51,-725.18C323.79,-714.46 303.44,-697.52 291,-678.23 259.28,-629.01 214.21,-454.86 198.86,-393.12"/>
<polygon fill="#ff7500" stroke="#ff7500" points="202.22,-392.14 196.42,-383.27 195.42,-393.82 202.22,-392.14"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M663.69,-530.17C591.6,-516.48 460.34,-500.88 358.5,-541.23"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M692.53,-554.42C672.06,-565.23 642.64,-582.22 620,-601.23 601.43,-616.82 604.34,-629.02 584,-642.23 560.19,-657.69 550.13,-652.85 523,-661.23"/>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M521,-661.23C485.66,-672.13 395.47,-698.33 358.5,-697.23"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M706.49,-530.11C687.66,-508.05 647.6,-459.44 620,-414.23 600.74,-382.67 610.72,-364.78 584,-339.23 576.84,-332.38 567.59,-327.19 558.48,-323.33"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="559.71,-320.05 549.12,-319.77 557.22,-326.6 559.71,-320.05"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M707.73,-529.97C677.72,-490.31 585.07,-367.92 584,-367.23 560.63,-352.14 550.74,-355.23 523,-353.23"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M662.89,-554.29C648.71,-558.11 633.6,-562.78 620,-568.23 595.66,-577.98 569.67,-592.42 550.72,-603.76"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="548.75,-600.86 542.03,-609.05 552.39,-606.85 548.75,-600.86"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M643.93,-405.26C590.95,-415.82 518.62,-434.14 460,-463.23 409.04,-488.51 410.61,-518.39 358.5,-541.23"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M356.5,-541.23C329.05,-552.75 318.55,-543.95 291,-555.23 243.47,-574.68 244.47,-610.99 193.5,-617.23"/>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M191.5,-617.23C162.9,-620.73 130.86,-621.06 104.32,-620.38"/>
<polygon fill="#9cff00" stroke="#9cff00" points="104.16,-616.88 94.06,-620.06 103.94,-623.87 104.16,-616.88"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M695.39,-405.35C646.96,-432.49 525.99,-500.05 424,-555.23 353.55,-593.34 270.39,-637.04 225.73,-660.4"/>
<polygon fill="#9cff00" stroke="#9cff00" points="224.04,-657.34 216.8,-665.07 227.29,-663.54 224.04,-657.34"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M657.15,-381.2C644.53,-377.57 631.55,-372.97 620,-367.23 601.85,-358.2 601.47,-349.51 584,-339.23 576.07,-334.56 567.15,-330.27 558.62,-326.58"/>
<polygon fill="#9cff00" stroke="#9cff00" points="559.82,-323.29 549.24,-322.68 557.13,-329.75 559.82,-323.29"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M674.68,-381.15C635.68,-370.83 575.99,-357.06 523,-353.23"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M162.46,-665.08C140.58,-655.93 110.36,-643.3 86.47,-633.31"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="87.57,-629.98 77,-629.35 84.87,-636.44 87.57,-629.98"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M494.82,-313.19C462.7,-313.09 406.58,-312.68 358.5,-311.23"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M356.5,-311.23C276.6,-308.8 255.57,-184.87 193.5,-235.23"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M501.9,-325.23C470.66,-345.21 407.23,-387.28 358.5,-429.23"/>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M356.5,-429.23C318.43,-462 287.25,-592.71 255,-631.23 245.95,-642.03 233.88,-651.76 222.84,-659.46"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="220.65,-656.71 214.27,-665.17 224.53,-662.53 220.65,-656.71"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M510.83,-301.09C483.59,-268.56 408.73,-179.19 375.16,-139.12"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="377.77,-136.78 368.66,-131.36 372.4,-141.27 377.77,-136.78"/>
</g>
<!-- module~io_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~io_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M356.5,-311.23C306.3,-309.7 252.42,-335.56 220.9,-353.81"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="219.05,-350.84 212.25,-358.96 222.63,-356.86 219.05,-350.84"/>
</g>
<!-- module~input_validation -->
<g id="program~~scattering~~UsesGraph_node18" class="node">
<title>module~input_validation</title>
<g id="a_program~~scattering~~UsesGraph_node18"><a xlink:href=".././module/input_validation.html" xlink:title="input_validation">
<polygon fill="#337ab7" stroke="#337ab7" points="406,-363.23 309,-363.23 309,-339.23 406,-339.23 406,-363.23"/>
<text text-anchor="middle" x="357.5" y="-348.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_validation</text>
</a>
</g>
</g>
<!-- module~io_mod&#45;&gt;module~input_validation -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~io_mod&#45;&gt;module~input_validation</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M494.89,-319.33C473.73,-324.28 443.12,-331.44 416.26,-337.72"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="415.11,-334.39 406.17,-340.08 416.71,-341.21 415.11,-334.39"/>
</g>
<!-- module~propagator_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~propagator_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1037.8,-489.93C1038.41,-434.64 1032.74,-207.7 903,-115.23"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M901,-115.23C704.23,25.03 570.96,35.88 358.5,-79.23"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M356.5,-79.23C329.64,-93.28 315.72,-80.68 291,-98.23 230.06,-141.48 251.56,-188.17 193.5,-235.23"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M191.5,-235.23C75.22,-329.47 53.13,-528.34 48.96,-594.95"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="45.46,-594.96 48.4,-605.14 52.45,-595.35 45.46,-594.96"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~propagator_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M1011.23,-514.24C1003.47,-518.25 995.15,-523.04 988,-528.23 969.94,-541.33 969.74,-549.69 952,-563.23 896.24,-605.75 881.57,-618.35 816,-643.23 774.93,-658.81 760.73,-648.5 719,-662.23"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~propagator_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M717,-195.23C676.76,-214.02 655,-191.88 620,-219.23 593.05,-240.28 609.17,-264.08 584,-287.23 576.84,-293.81 567.77,-298.87 558.82,-302.71"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="557.33,-299.54 549.26,-306.41 559.85,-306.07 557.33,-299.54"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~pes_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~propagator_mod&#45;&gt;module~pes_matrix_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M997.15,-514.23C983.44,-518.3 967.95,-522.91 953.55,-527.19"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="952.38,-523.89 943.79,-530.09 954.37,-530.6 952.38,-523.89"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~propagator_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M901,-115.23C763.06,-19.29 689.75,-141.83 523,-121.23"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M521,-121.23C492.9,-118.15 461.9,-117.17 434.58,-117.12"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="434.29,-113.62 424.3,-117.15 434.31,-120.62 434.29,-113.62"/>
</g>
<!-- module~propagator_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~propagator_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M901,-115.23C863.14,-88.24 858.68,-157.78 816,-176.23 775.67,-193.65 758.8,-176.64 719,-195.23"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M717,-195.23C676.76,-214.02 661.32,-202.95 620,-219.23 574.09,-237.31 572.32,-271.63 523,-273.23"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M521,-273.23C418.28,-276.54 386.57,-259.43 291,-297.23 260.33,-309.36 231,-333.98 212.67,-351.49"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="209.74,-349.46 205.06,-358.97 214.64,-354.46 209.74,-349.46"/>
</g>
<!-- module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node16" class="node">
<title>module~centrifugal_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node16"><a xlink:href=".././module/centrifugal_matrix_mod.html" xlink:title="centrifugal_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="787.5,-167.23 648.5,-167.23 648.5,-143.23 787.5,-143.23 787.5,-167.23"/>
<text text-anchor="middle" x="718" y="-152.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">centrifugal_matrix_mod</text>
</a>
</g>
</g>
<!-- module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~propagator_mod&#45;&gt;module~centrifugal_matrix_mod</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M901,-115.23C895.73,-111.56 826.99,-127.83 775.54,-140.71"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="774.67,-137.32 765.83,-143.15 776.38,-144.11 774.67,-137.32"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M851.75,-542.23C838.32,-542.23 823.34,-542.23 808.42,-542.23"/>
<polygon fill="#004eff" stroke="#004eff" points="808.12,-538.73 798.12,-542.23 808.12,-545.73 808.12,-538.73"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge47" class="edge">
<title>module~pes_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M717,-233.23C671.44,-195.05 643.16,-224.93 584,-219.23 411.1,-202.56 327.2,-124.34 193.5,-235.23"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge49" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M894.45,-554.5C882.17,-576.2 853.52,-621.13 816,-643.23 778.15,-665.52 758.99,-644.04 719,-662.23"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M717,-662.23C676.57,-680.61 658.67,-664.39 620,-686.23 600.3,-697.35 604.91,-713.57 584,-722.23 533.08,-743.32 514.71,-728.86 460,-722.23 413.88,-716.63 404.94,-698.62 358.5,-697.23"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge50" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M898.73,-530.01C892.17,-498.38 870.1,-413.38 816,-372.23 781.04,-345.63 758.55,-372.34 719,-353.23"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M717,-353.23C689.6,-339.98 607.34,-325.93 559.18,-318.52"/>
<polygon fill="#004eff" stroke="#004eff" points="559.58,-315.04 549.17,-317 558.53,-321.96 559.58,-315.04"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge51" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M898.2,-529.99C886.07,-477.36 837.61,-271.94 816,-252.23 783.55,-222.62 752.67,-261.44 719,-233.23"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M717,-233.23C682.96,-204.7 659.19,-230.11 620,-209.23 568.63,-181.85 580.77,-128.36 523,-121.23"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge52" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M717,-353.23C639.37,-315.7 609,-359.44 523,-353.23"/>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M521,-353.23C477.18,-350.06 467.73,-367.98 424,-372.23 365.17,-377.93 350.11,-372.53 291,-372.23 272.92,-372.13 252.95,-371.94 235.81,-371.75"/>
<polygon fill="#004eff" stroke="#004eff" points="235.6,-368.25 225.56,-371.64 235.52,-375.25 235.6,-368.25"/>
</g>
<!-- module~pes_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge48" class="edge">
<title>module~pes_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M853.89,-554.32C841.59,-557.35 828.32,-560.51 816,-563.23 729.35,-582.32 707.01,-583.82 620,-601.23 610.45,-603.14 600.38,-605.18 590.49,-607.2"/>
<polygon fill="#004eff" stroke="#004eff" points="589.77,-603.78 580.68,-609.22 591.18,-610.63 589.77,-603.78"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge53" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M319.31,-131.25C309.74,-135.07 299.7,-139.75 291,-145.23 241.09,-176.63 239.3,-198.07 193.5,-235.23"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge54" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M672.82,-262.58C560.24,-236.59 266.3,-176.16 193.5,-235.23"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge56" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M672.97,-277.29C655.02,-280.79 635,-287.27 620,-299.23 593.26,-320.54 610.67,-345.83 584,-367.23 543.46,-399.75 397.89,-395.32 358.5,-429.23"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge55" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M672.98,-282.3C638.58,-289.39 591.36,-299.13 559.15,-305.77"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="558.34,-302.36 549.26,-307.81 559.76,-309.22 558.34,-302.36"/>
</g>
<!-- module~channels_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge57" class="edge">
<title>module~channels_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M672.68,-272.41C633.35,-271.89 574.34,-271.57 523,-273.23"/>
</g>
<!-- module~data_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge58" class="edge">
<title>module~data_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M184.38,-383.42C161.48,-422.69 89.47,-546.13 60.38,-596"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="57.17,-594.55 55.16,-604.95 63.22,-598.08 57.17,-594.55"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge59" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M325.39,-829.25C285.17,-844.04 217.46,-866.15 193.5,-857.23"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge60" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M317.14,-805.19C308.11,-801.47 298.86,-796.85 291,-791.23 254.58,-765.19 223.11,-722.72 206.36,-697.63"/>
<polygon fill="#ff0075" stroke="#ff0075" points="209.28,-695.69 200.88,-689.23 203.42,-699.52 209.28,-695.69"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge61" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M337.81,-805.21C322.87,-794.63 302.58,-777.87 291,-758.23 255.07,-697.31 272.06,-671.86 255,-603.23 235.71,-525.64 210.79,-434.04 199.52,-393.01"/>
<polygon fill="#ff0075" stroke="#ff0075" points="202.86,-391.98 196.83,-383.27 196.11,-393.84 202.86,-391.98"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge63" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M698.31,-143.01C643.1,-108.6 477.25,-17.31 358.5,-79.23"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge64" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M648.4,-164.47C637.96,-168.33 628.02,-173.72 620,-181.23 583.69,-215.24 617.83,-250.74 584,-287.23 577.15,-294.62 567.84,-300 558.57,-303.87"/>
<polygon fill="#7fff00" stroke="#7fff00" points="557.19,-300.65 549.02,-307.39 559.61,-307.22 557.19,-300.65"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge62" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M657.37,-143.17C619.12,-135.83 568.3,-126.82 523,-121.23"/>
</g>
<!-- module~centrifugal_matrix_mod&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge65" class="edge">
<title>module~centrifugal_matrix_mod&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M648.32,-159.23C559.83,-167.11 403.98,-190.43 291,-259.23 253.15,-282.27 222.17,-324.86 205.9,-350.36"/>
<polygon fill="#7fff00" stroke="#7fff00" points="202.89,-348.58 200.59,-358.92 208.84,-352.27 202.89,-348.58"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge66" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M459.81,-615.92C393.84,-611.27 285.87,-606.73 193.5,-617.23"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge68" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M487.46,-633.34C478.27,-637.23 468.5,-641.93 460,-647.23 442.08,-658.39 442.56,-668.17 424,-678.23 397.35,-692.67 388.8,-698.13 358.5,-697.23"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M356.5,-697.23C326.55,-696.33 293.72,-692.8 265.42,-688.95"/>
<polygon fill="#00ffff" stroke="#00ffff" points="265.6,-685.44 255.22,-687.52 264.63,-692.37 265.6,-685.44"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node19" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node19"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="424,-669.23 291,-669.23 291,-645.23 424,-645.23 424,-669.23"/>
<text text-anchor="middle" x="357.5" y="-654.83" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge67" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M466.44,-633.31C452.43,-636.42 437.23,-639.78 422.78,-642.99"/>
<polygon fill="#00ffff" stroke="#00ffff" points="421.92,-639.59 412.92,-645.17 423.44,-646.42 421.92,-639.59"/>
</g>
<!-- module~input_validation&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge69" class="edge">
<title>module~input_validation&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M319.31,-339.2C309.74,-335.38 299.7,-330.7 291,-325.23 241.09,-293.82 239.3,-198.07 193.5,-235.23"/>
</g>
<!-- module~input_validation&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge70" class="edge">
<title>module~input_validation&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M338.99,-363.27C323.73,-374.77 302.33,-393.52 291,-415.23 245.97,-501.5 305.61,-548.1 255,-631.23 248,-642.73 236.95,-652.31 226.13,-659.71"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="224.14,-656.83 217.59,-665.16 227.91,-662.73 224.14,-656.83"/>
</g>
<!-- module~input_validation&#45;&gt;module~data_mod -->
<g id="program~~scattering~~UsesGraph_edge71" class="edge">
<title>module~input_validation&#45;&gt;module~data_mod</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M308.92,-357.06C285.8,-359.9 258.24,-363.28 235.86,-366.03"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="235.15,-362.59 225.65,-367.28 236,-369.54 235.15,-362.59"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="912pt"
 viewBox="0.00 0.00 641.00 912.01" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(1.93 1.93) rotate(0) translate(4 1756)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1756 1233,-1756 1233,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-923 0,-923 0,-899 79,-899 79,-923"/>
<text text-anchor="middle" x="39.5" y="-908.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="267,-1752 179,-1752 179,-1728 267,-1728 267,-1752"/>
<text text-anchor="middle" x="223" y="-1737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.76,-923.27C42.91,-1019.99 59.18,-1657.18 115,-1719 128.45,-1733.9 149.11,-1740.06 168.71,-1742.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.58,-1745.66 178.81,-1742.92 169.1,-1738.68 168.58,-1745.66"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-986 455.5,-986 455.5,-962 529.5,-962 529.5,-986"/>
<text text-anchor="middle" x="492.5" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M44.18,-923.11C52.32,-947.53 74.45,-1002.16 115,-1024 199.52,-1069.52 239.12,-1051.82 331,-1024 349.4,-1018.43 349.27,-1007.43 367,-1000 391.86,-989.58 421.31,-983.19 445.33,-979.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.9,-982.8 455.27,-977.85 444.86,-975.88 445.9,-982.8"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="267.5,-1668 178.5,-1668 178.5,-1644 267.5,-1644 267.5,-1668"/>
<text text-anchor="middle" x="223" y="-1653.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.89,-923.13C43.92,-1013.51 64.85,-1580.05 115,-1635 128.42,-1649.71 148.87,-1655.87 168.31,-1658.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.1,-1661.53 178.35,-1658.82 168.65,-1654.55 168.1,-1661.53"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="260,-1626 186,-1626 186,-1602 260,-1602 260,-1626"/>
<text text-anchor="middle" x="223" y="-1611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M40.98,-923.25C44.51,-1010.98 67.72,-1541.52 115,-1593 130.13,-1609.48 154.09,-1615.22 175.51,-1616.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.64,-1620.13 185.76,-1616.99 175.9,-1613.13 175.64,-1620.13"/>
</g>
<!-- proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~check_cross_section_thresholds</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/check_cross_section_thresholds.html" xlink:title="check_cross_section_thresholds">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-1584 133,-1584 133,-1560 313,-1560 313,-1584"/>
<text text-anchor="middle" x="223" y="-1569.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cross_section_thresholds</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~check_cross_section_thresholds</title>
<path fill="none" stroke="#ff0000" d="M41.1,-923.19C45.36,-1007.09 71.96,-1497.38 115,-1546 117.77,-1549.13 120.85,-1551.92 124.17,-1554.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="122.53,-1557.5 132.85,-1559.93 126.3,-1551.6 122.53,-1557.5"/>
</g>
<!-- proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~reduce_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/reduce_radial_coupling_terms.html" xlink:title="reduce_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="845.5,-946 673.5,-946 673.5,-922 845.5,-922 845.5,-946"/>
<text text-anchor="middle" x="759.5" y="-931.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduce_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~reduce_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M49.19,-923.05C61.64,-939.17 86.25,-966.97 115,-978 204.63,-1012.38 239.39,-1006.69 331,-978 349.59,-972.18 348.56,-959.27 367,-953 463.85,-920.07 581.94,-919.26 662.95,-924.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="662.92,-927.71 673.13,-924.87 663.38,-920.73 662.92,-927.71"/>
</g>
<!-- proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~interpolate_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/interpolate_radial_coupling_terms.html" xlink:title="interpolate_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="589.5,-1306 395.5,-1306 395.5,-1282 589.5,-1282 589.5,-1306"/>
<text text-anchor="middle" x="492.5" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M41.09,-923.18C44.14,-980.86 60.22,-1225.75 115,-1273 154.14,-1306.76 288.25,-1306.86 385.27,-1301.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="385.63,-1305.47 395.43,-1301.45 385.26,-1298.48 385.63,-1305.47"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295,-1466 151,-1466 151,-1442 295,-1442 295,-1466"/>
<text text-anchor="middle" x="223" y="-1451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M40.48,-923.07C40.6,-993.46 44.7,-1350.66 115,-1428 122.16,-1435.88 131.27,-1441.56 141.15,-1445.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="140.21,-1449.01 150.81,-1449.05 142.55,-1442.41 140.21,-1449.01"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="834,-1384 685,-1384 685,-1360 834,-1360 834,-1384"/>
<text text-anchor="middle" x="759.5" y="-1369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M40.35,-923.44C39.8,-992.87 40.95,-1331.48 115,-1395 199.19,-1467.22 539.52,-1413.66 688.3,-1385.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="689.07,-1389.34 698.25,-1384.05 687.78,-1382.46 689.07,-1389.34"/>
</g>
<!-- proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~print_pes_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/print_pes_matrix_elements_summary.html" xlink:title="print_pes_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="865,-672 654,-672 654,-648 865,-648 865,-672"/>
<text text-anchor="middle" x="759.5" y="-657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_pes_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~print_pes_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.55,-898.9C41.41,-862 49.55,-750.42 115,-701 156.06,-670 470,-662.38 643.72,-660.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="643.97,-664.04 653.93,-660.44 643.9,-657.04 643.97,-664.04"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="270,-1344 176,-1344 176,-1320 270,-1320 270,-1344"/>
<text text-anchor="middle" x="223" y="-1329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M41.07,-923.24C44.14,-983.58 60.59,-1248.68 115,-1306 128.1,-1319.8 147.2,-1326.8 165.64,-1330.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="165.37,-1333.7 175.78,-1331.74 166.42,-1326.78 165.37,-1333.7"/>
</g>
<!-- proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~read_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/read_radial_coupling_terms.html" xlink:title="read_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-1264 143,-1264 143,-1240 303,-1240 303,-1264"/>
<text text-anchor="middle" x="223" y="-1249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~read_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M41.58,-923.02C46.57,-975.85 69.15,-1186.72 115,-1231 120.38,-1236.2 126.66,-1240.29 133.41,-1243.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.31,-1246.83 142.89,-1247.34 134.94,-1240.34 132.31,-1246.83"/>
</g>
<!-- proc~print_short_block_summary -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~print_short_block_summary</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/print_short_block_summary.html" xlink:title="print_short_block_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="839,-554 680,-554 680,-530 839,-530 839,-554"/>
<text text-anchor="middle" x="759.5" y="-539.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_short_block_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_short_block_summary -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~print_short_block_summary</title>
<path fill="none" stroke="#ff0000" d="M40.71,-898.79C42.04,-836.17 51.55,-552.01 115,-499 188.67,-437.45 239.66,-469.46 331,-499 349.78,-505.07 348.36,-518.52 367,-525 466.37,-559.53 588.54,-558.55 669.71,-552.36"/>
<polygon fill="#ff0000" stroke="#ff0000" points="670.21,-555.83 679.89,-551.54 669.64,-548.85 670.21,-555.83"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="311.5,-326 134.5,-326 134.5,-302 311.5,-302 311.5,-326"/>
<text text-anchor="middle" x="223" y="-311.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M40.22,-898.52C38.8,-822.33 35.2,-420.17 115,-335 118.18,-331.61 121.74,-328.67 125.56,-326.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.34,-329.15 134.35,-321.2 123.91,-323.05 127.34,-329.15"/>
</g>
<!-- proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~check_nonzero_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/check_nonzero_pes_matrix_elements.html" xlink:title="check_nonzero_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-1710 117.5,-1710 117.5,-1686 328.5,-1686 328.5,-1710"/>
<text text-anchor="middle" x="223" y="-1695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.82,-923.23C43.41,-1016.89 62.02,-1618.62 115,-1677 115.76,-1677.84 116.55,-1678.65 117.36,-1679.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="115.21,-1682.2 125.17,-1685.81 119.63,-1676.78 115.21,-1682.2"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="323.5,-1138 122.5,-1138 122.5,-1114 323.5,-1114 323.5,-1138"/>
<text text-anchor="middle" x="223" y="-1123.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.54,-923.36C45.08,-957.16 59.69,-1051.8 115,-1100 119.19,-1103.65 123.8,-1106.81 128.7,-1109.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.25,-1112.72 137.77,-1114 130.34,-1106.44 127.25,-1112.72"/>
</g>
<!-- proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~print_largest_partial_cross_sections</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/print_largest_partial_cross_sections.html" xlink:title="print_largest_partial_cross_sections">
<polygon fill="#d9534f" stroke="#d9534f" points="1101,-1525 901,-1525 901,-1501 1101,-1501 1101,-1525"/>
<text text-anchor="middle" x="1001" y="-1510.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_cross_sections</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_cross_sections</title>
<path fill="none" stroke="#ff0000" d="M41.08,-923C45.07,-1003.57 69.78,-1463.7 115,-1504 171.59,-1554.44 666.83,-1532.46 890.81,-1519.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="891.16,-1523.23 900.95,-1519.16 890.76,-1516.24 891.16,-1523.23"/>
</g>
<!-- proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~calculate_state_to_state_cross_section</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/calculate_state_to_state_cross_section.html" xlink:title="calculate_state_to_state_cross_section">
<polygon fill="#d9534f" stroke="#d9534f" points="331,-902 115,-902 115,-878 331,-878 331,-902"/>
<text text-anchor="middle" x="223" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_state_to_state_cross_section</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section</title>
<path fill="none" stroke="#ff0000" d="M79.44,-906.49C88.19,-905.48 97.9,-904.36 108.03,-903.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="108.75,-906.63 118.28,-902 107.94,-899.67 108.75,-906.63"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1063,-986 939,-986 939,-962 1063,-962 1063,-986"/>
<text text-anchor="middle" x="1001" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M42.68,-923.24C48.5,-951.75 67.32,-1022.36 115,-1051 197.3,-1100.43 237.57,-1073.06 331,-1051 348.41,-1046.89 349.93,-1038.36 367,-1033 397.75,-1023.34 621.92,-994.13 654,-991 748.85,-981.75 858.84,-977.44 928.89,-975.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="929.03,-978.99 938.93,-975.23 928.84,-972 929.03,-978.99"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="312,-452 134,-452 134,-428 312,-428 312,-452"/>
<text text-anchor="middle" x="223" y="-437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M40.78,-898.97C42.55,-834.61 54.05,-531.53 115,-466 118.04,-462.73 121.41,-459.84 125.04,-457.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.15,-460.1 133.9,-451.94 123.53,-454.11 127.15,-460.1"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="269.5,-944 176.5,-944 176.5,-920 269.5,-920 269.5,-944"/>
<text text-anchor="middle" x="223" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M79.44,-915.51C104.76,-918.44 138.18,-922.3 166.3,-925.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.06,-929.05 176.4,-926.72 166.87,-922.1 166.06,-929.05"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node23"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-1180 177.5,-1180 177.5,-1156 268.5,-1156 268.5,-1180"/>
<text text-anchor="middle" x="223" y="-1165.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M40.32,-923.02C40.45,-961.98 46.45,-1085.72 115,-1147 129.17,-1159.67 148.69,-1165.63 167.17,-1168.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.98,-1171.69 177.3,-1169.29 167.73,-1164.74 166.98,-1171.69"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="295.5,-860 150.5,-860 150.5,-836 295.5,-836 295.5,-860"/>
<text text-anchor="middle" x="223" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M58.08,-898.94C72.71,-889.46 94.38,-876.61 115,-869 123.13,-866 131.77,-863.4 140.49,-861.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.44,-864.53 150.33,-858.77 139.79,-857.72 141.44,-864.53"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-284 167,-284 167,-260 279,-260 279,-284"/>
<text text-anchor="middle" x="223" y="-269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.12,-898.85C45.42,-816.29 72.02,-339.27 115,-293 125.83,-281.34 141.09,-275.07 156.7,-271.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.65,-275.3 166.97,-270.26 156.54,-268.39 157.65,-275.3"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="250,-776 196,-776 196,-752 250,-752 250,-776"/>
<text text-anchor="middle" x="223" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M44.03,-898.61C52.04,-872.93 74.12,-813.9 115,-785 135.55,-770.47 163.61,-765.37 185.84,-763.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="186.1,-767.31 195.91,-763.33 185.76,-760.32 186.1,-767.31"/>
</g>
<!-- proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~save_partial_xs_single_block</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/save_partial_xs_single_block.html" xlink:title="save_partial_xs_single_block">
<polygon fill="#d9534f" stroke="#d9534f" points="574.5,-108 410.5,-108 410.5,-84 574.5,-84 574.5,-108"/>
<text text-anchor="middle" x="492.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_single_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_single_block -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_single_block</title>
<path fill="none" stroke="#ff0000" d="M40.76,-898.92C42.93,-805.08 59.12,-194.73 115,-138 153.45,-98.97 301.31,-92.95 399.9,-93.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="400.14,-97.01 410.17,-93.59 400.2,-90.01 400.14,-97.01"/>
</g>
<!-- proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~save_s_matrix_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/save_s_matrix_file_header.html" xlink:title="save_s_matrix_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="299.5,-1222 146.5,-1222 146.5,-1198 299.5,-1198 299.5,-1222"/>
<text text-anchor="middle" x="223" y="-1207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_file_header -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_file_header</title>
<path fill="none" stroke="#ff0000" d="M42.03,-923.05C48.45,-971.51 74.65,-1151.31 115,-1189 121.31,-1194.9 128.78,-1199.36 136.78,-1202.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.79,-1206.08 146.39,-1206.16 138.15,-1199.49 135.79,-1206.08"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="800.5,-1426 718.5,-1426 718.5,-1402 800.5,-1402 800.5,-1426"/>
<text text-anchor="middle" x="759.5" y="-1411.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M41.16,-923.17C45.57,-1001.91 71.78,-1437.12 115,-1475 202.78,-1551.95 572.88,-1463.54 708.46,-1427.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="709.42,-1431.09 718.19,-1425.13 707.62,-1424.32 709.42,-1431.09"/>
</g>
<!-- proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~prepare_pes_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/prepare_pes_matrix_elements.html" xlink:title="prepare_pes_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="309,-612 137,-612 137,-588 309,-588 309,-612"/>
<text text-anchor="middle" x="223" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_pes_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_pes_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_pes_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.91,-898.77C47.94,-848.75 73.14,-660.52 115,-621 118.86,-617.36 123.16,-614.26 127.75,-611.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="129.47,-614.69 136.91,-607.14 126.39,-608.4 129.47,-614.69"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="253,-818 193,-818 193,-794 253,-794 253,-818"/>
<text text-anchor="middle" x="223" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M47.67,-898.72C59.27,-880.02 84.04,-844.71 115,-827 135.62,-815.21 161.73,-809.93 182.99,-807.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.36,-811.1 193,-806.7 182.72,-804.12 183.36,-811.1"/>
</g>
<!-- proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~save_s_matrix_block_info</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/save_s_matrix_block_info.html" xlink:title="save_s_matrix_block_info">
<polygon fill="#d9534f" stroke="#d9534f" points="296.5,-532 149.5,-532 149.5,-508 296.5,-508 296.5,-532"/>
<text text-anchor="middle" x="223" y="-517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_s_matrix_block_info</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_s_matrix_block_info -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~save_s_matrix_block_info</title>
<path fill="none" stroke="#ff0000" d="M41.27,-898.93C45.14,-841.72 64.4,-598.51 115,-546 121.96,-538.77 130.57,-533.42 139.86,-529.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.16,-532.72 149.33,-525.97 138.74,-526.15 141.16,-532.72"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="294.5,-368 151.5,-368 151.5,-344 294.5,-344 294.5,-368"/>
<text text-anchor="middle" x="223" y="-353.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.37,-898.96C39.83,-827.13 40.69,-455.53 115,-377 122.3,-369.29 131.53,-363.95 141.5,-360.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.72,-363.6 151.25,-357.32 140.67,-356.91 142.72,-363.6"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="292,-654 154,-654 154,-630 292,-630 292,-654"/>
<text text-anchor="middle" x="223" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.31,-898.75C40.39,-859.06 46.28,-732.77 115,-668 123.28,-660.19 133.51,-654.61 144.31,-650.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="145.48,-653.94 153.93,-647.55 143.34,-647.28 145.48,-653.94"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-881 429,-881 429,-857 556,-857 556,-881"/>
<text text-anchor="middle" x="492.5" y="-866.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M56.3,-923.13C70.71,-933.36 93.03,-947.23 115,-953 207.86,-977.37 241.53,-987.8 331,-953 351.23,-945.13 348.67,-931.63 367,-920 390.4,-905.15 418.86,-893.11 442.65,-884.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="443.94,-887.72 452.2,-881.09 441.6,-881.13 443.94,-887.72"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1229,-792 1137,-792 1137,-768 1229,-768 1229,-792"/>
<text text-anchor="middle" x="1183" y="-777.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.77,-898.8C42.89,-806.64 58.56,-222.05 115,-171 197.88,-96.05 1029.28,-283.31 1101,-369 1151.49,-429.33 1174.49,-681.26 1180.41,-757.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1176.92,-758.1 1181.16,-767.81 1183.9,-757.58 1176.92,-758.1"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1055.5,-752 946.5,-752 946.5,-728 1055.5,-728 1055.5,-752"/>
<text text-anchor="middle" x="1001" y="-737.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.28,-898.67C45.05,-843.52 63.35,-620.35 115,-579 163.72,-540 734.58,-587.35 865,-639 911.9,-657.58 956.84,-696.92 981.2,-720.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="978.8,-723.19 988.36,-727.75 983.73,-718.23 978.8,-723.19"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-734 176,-734 176,-710 270,-710 270,-734"/>
<text text-anchor="middle" x="223" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M42.04,-898.97C46.69,-867.8 63.63,-784 115,-743 129.22,-731.65 147.85,-725.86 165.57,-723.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.39,-726.48 175.86,-721.73 165.5,-719.54 166.39,-726.48"/>
</g>
<!-- proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~save_partial_xs_file_header</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/save_partial_xs_file_header.html" xlink:title="save_partial_xs_file_header">
<polygon fill="#d9534f" stroke="#d9534f" points="302.5,-1386 143.5,-1386 143.5,-1362 302.5,-1362 302.5,-1386"/>
<text text-anchor="middle" x="223" y="-1371.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_partial_xs_file_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_partial_xs_file_header -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;proc~save_partial_xs_file_header</title>
<path fill="none" stroke="#ff0000" d="M40.75,-923C42.32,-987.17 52.98,-1289.3 115,-1353 120.36,-1358.5 126.7,-1362.79 133.59,-1366.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.69,-1369.52 143.27,-1370.05 135.33,-1363.04 132.69,-1369.52"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="274,-204 172,-204 172,-180 274,-180 274,-204"/>
<text text-anchor="middle" x="223" y="-189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.98,-898.85C44.53,-810.74 68.14,-271.46 115,-218 126.8,-204.54 144.28,-197.45 161.71,-193.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.64,-197.26 171.92,-192.14 161.48,-190.36 162.64,-197.26"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="268.5,-410 177.5,-410 177.5,-386 268.5,-386 268.5,-410"/>
<text text-anchor="middle" x="223" y="-395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M40.53,-898.58C40.93,-829.24 46.44,-490.61 115,-419 128.43,-404.97 148.27,-398.82 167.23,-396.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.69,-399.95 177.33,-395.56 167.06,-392.98 167.69,-399.95"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="279,-71 167,-71 167,-47 279,-47 279,-71"/>
<text text-anchor="middle" x="223" y="-56.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.81,-898.97C43.43,-802.83 62.8,-161.07 115,-95 125.46,-81.75 141,-73.35 157.01,-68.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.39,-71.26 166.99,-65.09 156.41,-64.55 158.39,-71.26"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="786.5,-352 732.5,-352 732.5,-328 786.5,-328 786.5,-352"/>
<text text-anchor="middle" x="759.5" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M40.95,-898.8C44.26,-812.63 66.04,-297.62 115,-251 155.5,-212.44 571.32,-204.22 618,-235 651.91,-257.36 622.47,-293.39 654,-319 673.01,-334.44 700.29,-339.53 722.22,-340.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="722.37,-344.35 732.49,-341.21 722.62,-337.35 722.37,-344.35"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ffb600" d="M832.36,-946C862.81,-951.09 898.21,-957 928.61,-962.08"/>
<polygon fill="#ffb600" stroke="#ffb600" points="928.28,-965.57 938.72,-963.76 929.43,-958.67 928.28,-965.57"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffb600" d="M818,-921.97C887.15,-906.33 1005.82,-875.75 1101,-832 1121.05,-822.78 1141.98,-809.23 1157.53,-798.28"/>
<polygon fill="#ffb600" stroke="#ffb600" points="1159.94,-800.85 1166.02,-792.18 1155.86,-795.17 1159.94,-800.85"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-1304 732.5,-1304 732.5,-1280 786.5,-1280 786.5,-1304"/>
<text text-anchor="middle" x="759.5" y="-1289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline</title>
<path fill="none" stroke="#ffda00" d="M589.55,-1293.28C635.52,-1292.93 687.85,-1292.53 721.93,-1292.28"/>
<polygon fill="#ffda00" stroke="#ffda00" points="722.35,-1295.77 732.32,-1292.2 722.3,-1288.77 722.35,-1295.77"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1036,-1284 966,-1284 966,-1260 1036,-1260 1036,-1284"/>
<text text-anchor="middle" x="1001" y="-1269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#daff00" d="M820.19,-1359.96C835.06,-1356.2 850.81,-1351.55 865,-1346 904.19,-1330.68 946.24,-1306.22 972.8,-1289.65"/>
<polygon fill="#daff00" stroke="#daff00" points="974.93,-1292.44 981.52,-1284.15 971.2,-1286.52 974.93,-1292.44"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#b6ff00" d="M775.88,-672.06C797.4,-689.39 836.97,-723.01 865,-757 919.39,-822.96 968.38,-912.55 989.29,-952.84"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="986.3,-954.68 993.99,-961.98 992.53,-951.48 986.3,-954.68"/>
</g>
<!-- proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~print_pes_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#b6ff00" d="M863.53,-648C934.06,-644.4 1027.71,-648.97 1101,-686 1132.8,-702.07 1157.31,-736.6 1170.69,-759.04"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="1167.72,-760.89 1175.73,-767.83 1173.79,-757.41 1167.72,-760.89"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="533,-1264 452,-1264 452,-1240 533,-1240 533,-1264"/>
<text text-anchor="middle" x="492.5" y="-1249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#6dff00" d="M303.17,-1252C348.15,-1252 403.05,-1252 441.95,-1252"/>
<polygon fill="#6dff00" stroke="#6dff00" points="441.98,-1255.5 451.98,-1252 441.98,-1248.5 441.98,-1255.5"/>
</g>
<!-- proc~print_short_block_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~print_short_block_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#48ff00" d="M778.81,-554.21C802.19,-570.73 842.31,-602.39 865,-639 894.78,-687.05 881.03,-708.11 901,-761 928.24,-833.14 969.25,-914.93 988.83,-952.74"/>
<polygon fill="#48ff00" stroke="#48ff00" points="985.82,-954.54 993.54,-961.79 992.03,-951.31 985.82,-954.54"/>
</g>
<!-- proc~print_short_block_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~print_short_block_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#48ff00" d="M839.35,-537.32C914.19,-537.02 1026.07,-547.79 1101,-606 1150.58,-644.51 1171.05,-720.58 1178.41,-758.07"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1174.98,-758.76 1180.22,-767.97 1181.86,-757.5 1174.98,-758.76"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="519.5,-436 465.5,-436 465.5,-412 519.5,-412 519.5,-436"/>
<text text-anchor="middle" x="492.5" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#24ff00" d="M311.53,-324.2C318.47,-327.05 325.07,-330.6 331,-335 358.45,-355.39 339.28,-382.98 367,-403 392.49,-421.41 428.51,-425.78 455.25,-426.07"/>
<polygon fill="#24ff00" stroke="#24ff00" points="455.39,-429.57 465.36,-425.99 455.34,-422.57 455.39,-429.57"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="577,-1710 408,-1710 408,-1686 577,-1686 577,-1710"/>
<text text-anchor="middle" x="492.5" y="-1695.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~check_nonzero_pes_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#00ff00" d="M328.57,-1698C351.32,-1698 375.25,-1698 397.55,-1698"/>
<polygon fill="#00ff00" stroke="#00ff00" points="397.68,-1701.5 407.68,-1698 397.68,-1694.5 397.68,-1701.5"/>
</g>
<!-- proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff48" d="M1053.27,-1500.92C1071.09,-1494.16 1089.48,-1483.78 1101,-1468 1180.98,-1358.47 1182.9,-907.95 1182.23,-802.26"/>
<polygon fill="#00ff48" stroke="#00ff48" points="1185.73,-802.09 1182.15,-792.12 1178.73,-802.14 1185.73,-802.09"/>
</g>
<!-- proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#00ff6d" d="M331.26,-881.58C360.65,-879.27 391.81,-876.83 418.77,-874.71"/>
<polygon fill="#00ff6d" stroke="#00ff6d" points="419.18,-878.19 428.88,-873.92 418.63,-871.21 419.18,-878.19"/>
</g>
<!-- proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~wavenumber_squared_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/wavenumber_squared_from_energy.html" xlink:title="wavenumber_squared_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="594,-516 391,-516 391,-492 594,-492 594,-516"/>
<text text-anchor="middle" x="492.5" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_squared_from_energy</text>
</a>
</g>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#00ffb6" d="M277.29,-452.02C294.51,-456.16 313.64,-461.01 331,-466 347.21,-470.66 350.72,-473.6 367,-478 382.98,-482.32 400.27,-486.33 416.74,-489.86"/>
<polygon fill="#00ffb6" stroke="#00ffb6" points="416.36,-493.35 426.87,-491.98 417.8,-486.5 416.36,-493.35"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ffb6" d="M312.33,-434.72C360.95,-431.81 418.65,-428.36 455.17,-426.17"/>
<polygon fill="#00ffb6" stroke="#00ffb6" points="455.56,-429.66 465.34,-425.56 455.15,-422.67 455.56,-429.66"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#00ffff" d="M268.7,-1169.29C289.9,-1167.61 314.2,-1162.01 331,-1147 370.62,-1111.59 332.08,-1073.05 367,-1033 387.42,-1009.58 419.17,-994.74 445.5,-985.8"/>
<polygon fill="#00ffff" stroke="#00ffff" points="446.84,-989.04 455.29,-982.65 444.7,-982.38 446.84,-989.04"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="540,-1066 445,-1066 445,-1042 540,-1042 540,-1066"/>
<text text-anchor="middle" x="492.5" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#00ffff" d="M268.62,-1167.78C289.3,-1165.67 313.18,-1160.15 331,-1147 358.2,-1126.93 339.92,-1100.24 367,-1080 386.34,-1065.55 411.86,-1058.7 434.76,-1055.59"/>
<polygon fill="#00ffff" stroke="#00ffff" points="435.2,-1059.07 444.73,-1054.45 434.4,-1052.11 435.2,-1059.07"/>
</g>
<!-- proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~check_namelist_basis</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/check_namelist_basis.html" xlink:title="check_namelist_basis">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1102 696,-1102 696,-1078 823,-1078 823,-1102"/>
<text text-anchor="middle" x="759.5" y="-1087.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_basis</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_basis -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_basis</title>
<path fill="none" stroke="#00ffff" d="M268.74,-1161.29C288.1,-1157.85 310.89,-1153.1 331,-1147 347.59,-1141.97 350.21,-1136.3 367,-1132 475.69,-1104.15 605.94,-1094.75 685.42,-1091.59"/>
<polygon fill="#00ffff" stroke="#00ffff" points="685.95,-1095.07 695.81,-1091.2 685.69,-1088.07 685.95,-1095.07"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#00ffff" d="M268.73,-1170.73C288.73,-1173.43 312.02,-1178.72 331,-1189 351.17,-1199.93 346.89,-1214.95 367,-1226 389.76,-1238.51 417.88,-1245.01 441.63,-1248.38"/>
<polygon fill="#00ffff" stroke="#00ffff" points="441.5,-1251.9 451.86,-1249.69 442.38,-1244.95 441.5,-1251.9"/>
</g>
<!-- proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~check_namelist_input</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/check_namelist_input.html" xlink:title="check_namelist_input">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-1224 696,-1224 696,-1200 823,-1200 823,-1224"/>
<text text-anchor="middle" x="759.5" y="-1209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_input</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_input -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_input</title>
<path fill="none" stroke="#00ffff" d="M268.56,-1177.26C296.67,-1182.74 333.81,-1189.31 367,-1193 477.68,-1205.31 606.84,-1209.65 685.63,-1211.17"/>
<polygon fill="#00ffff" stroke="#00ffff" points="685.87,-1214.68 695.93,-1211.36 685.99,-1207.68 685.87,-1214.68"/>
</g>
<!-- proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~check_namelist_potential</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/check_namelist_potential.html" xlink:title="check_namelist_potential">
<polygon fill="#d9534f" stroke="#d9534f" points="833.5,-1144 685.5,-1144 685.5,-1120 833.5,-1120 833.5,-1144"/>
<text text-anchor="middle" x="759.5" y="-1129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_namelist_potential</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~check_namelist_potential -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~read_input_file&#45;&gt;proc~check_namelist_potential</title>
<path fill="none" stroke="#00ffff" d="M268.68,-1161.87C296.84,-1158.22 333.99,-1153.76 367,-1151 472.95,-1142.14 595.39,-1137.02 674.74,-1134.37"/>
<polygon fill="#00ffff" stroke="#00ffff" points="675.28,-1137.86 685.16,-1134.03 675.05,-1130.86 675.28,-1137.86"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="529.5,-1184 455.5,-1184 455.5,-1160 529.5,-1160 529.5,-1184"/>
<text text-anchor="middle" x="492.5" y="-1169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#00ffff" d="M268.77,-1168.67C317.65,-1169.4 395.54,-1170.57 445.06,-1171.31"/>
<polygon fill="#00ffff" stroke="#00ffff" points="445.13,-1174.81 455.18,-1171.46 445.23,-1167.81 445.13,-1174.81"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-150 465.5,-150 465.5,-126 519.5,-126 519.5,-150"/>
<text text-anchor="middle" x="492.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00b6ff" d="M248.21,-259.87C296.25,-235.8 403.71,-181.98 458.3,-154.63"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="460.16,-157.61 467.54,-150 457.03,-151.35 460.16,-157.61"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="519.5,-268 465.5,-268 465.5,-244 519.5,-244 519.5,-268"/>
<text text-anchor="middle" x="492.5" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#00b6ff" d="M279.1,-268.7C331.77,-265.55 409.69,-260.89 455.05,-258.18"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="455.53,-261.66 465.3,-257.57 455.11,-254.67 455.53,-261.66"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#00b6ff" d="M279.02,-271.19C297.66,-273.68 317.22,-279.74 331,-293 381.03,-341.13 323.32,-391.04 367,-445 383.66,-465.59 409.21,-479.41 432.83,-488.46"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="431.86,-491.83 442.46,-491.93 434.24,-485.24 431.86,-491.83"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-394 422.5,-394 422.5,-370 562.5,-370 562.5,-394"/>
<text text-anchor="middle" x="492.5" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#00b6ff" d="M279.22,-273.53C297.13,-276.33 316.18,-281.99 331,-293 358.45,-313.39 339.28,-340.98 367,-361 380.17,-370.51 396.15,-376.28 412.21,-379.67"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="411.73,-383.14 422.19,-381.48 412.98,-376.25 411.73,-383.14"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="539,-310 446,-310 446,-286 539,-286 539,-310"/>
<text text-anchor="middle" x="492.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#00b6ff" d="M279.1,-277.36C324.89,-281.81 389.74,-288.11 435.72,-292.58"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="435.51,-296.07 445.81,-293.56 436.19,-289.11 435.51,-296.07"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00b6ff" d="M279.25,-271.96C297.59,-274.57 316.89,-280.52 331,-293 369.53,-327.08 328.02,-369.44 367,-403 391.05,-423.71 427.72,-427.71 455.04,-427.28"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="455.51,-430.76 465.37,-426.9 455.25,-423.77 455.51,-430.76"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="540.5,-352 444.5,-352 444.5,-328 540.5,-328 540.5,-352"/>
<text text-anchor="middle" x="492.5" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#00b6ff" d="M279.26,-278.17C296.31,-281.3 314.85,-285.99 331,-293 349.1,-300.86 348.79,-311.38 367,-319 388.04,-327.8 412.53,-332.92 434.2,-335.89"/>
<polygon fill="#00b6ff" stroke="#00b6ff" points="433.91,-339.38 444.26,-337.15 434.78,-332.43 433.91,-339.38"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#006dff" d="M564.88,-108.04C592.65,-112.48 624.76,-117.32 654,-121 753.01,-133.46 1029.22,-94.68 1101,-164 1144.75,-206.25 1174.28,-652.16 1180.69,-757.7"/>
<polygon fill="#006dff" stroke="#006dff" points="1177.21,-758.07 1181.3,-767.84 1184.19,-757.65 1177.21,-758.07"/>
</g>
<!-- proc~save_partial_xs_single_block&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~save_partial_xs_single_block&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#006dff" d="M574.69,-95.3C590.8,-98.84 606.32,-105.43 618,-117 682.78,-181.18 590.23,-253.81 654,-319 671.43,-336.81 699.44,-341.7 722.08,-342.32"/>
<polygon fill="#006dff" stroke="#006dff" points="722.36,-345.82 732.36,-342.34 722.37,-338.82 722.36,-345.82"/>
</g>
<!-- proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~save_s_matrix_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#0048ff" d="M299.58,-1221.87C345.06,-1229.01 401.69,-1237.9 441.61,-1244.17"/>
<polygon fill="#0048ff" stroke="#0048ff" points="441.21,-1247.65 451.63,-1245.74 442.3,-1240.73 441.21,-1247.65"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0024ff" d="M800.65,-1412.84C873.59,-1408.36 1027.12,-1387.54 1101,-1293 1162.16,-1214.73 1178.05,-891.15 1181.28,-802.53"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1184.79,-802.39 1181.64,-792.27 1177.79,-802.14 1184.79,-802.39"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0024ff" d="M800.52,-1412.33C821.02,-1409.95 845.66,-1404.64 865,-1393 886.65,-1379.97 882.91,-1366.64 901,-1349 923.77,-1326.78 952.81,-1304.84 973.53,-1290.1"/>
<polygon fill="#0024ff" stroke="#0024ff" points="975.69,-1292.86 981.86,-1284.24 971.67,-1287.13 975.69,-1292.86"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1048,-1154 954,-1154 954,-1130 1048,-1130 1048,-1154"/>
<text text-anchor="middle" x="1001" y="-1139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#0024ff" d="M800.65,-1415.7C822.32,-1414.45 848.04,-1409.13 865,-1393 912.17,-1348.13 870.2,-1308.36 901,-1251 920.5,-1214.69 954.7,-1180.89 977.35,-1160.83"/>
<polygon fill="#0024ff" stroke="#0024ff" points="979.86,-1163.29 985.12,-1154.09 975.28,-1158 979.86,-1163.29"/>
</g>
<!-- proc~numerov&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~numerov&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#2400ff" d="M253.17,-811.22C274.74,-815.2 304.8,-821.01 331,-827 367.1,-835.26 407.43,-845.82 438.63,-854.28"/>
<polygon fill="#2400ff" stroke="#2400ff" points="437.85,-857.7 448.42,-856.95 439.69,-850.94 437.85,-857.7"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#6d00ff" d="M294.68,-365.38C307.07,-368.28 319.63,-372.06 331,-377 349.1,-384.86 348.79,-395.38 367,-403 395.26,-414.82 429.76,-420 455.28,-422.26"/>
<polygon fill="#6d00ff" stroke="#6d00ff" points="455.03,-425.75 465.27,-423.03 455.57,-418.77 455.03,-425.75"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#9100ff" d="M263.16,-654.06C286.41,-663.24 314.5,-678.25 331,-701 381.21,-770.22 319.94,-818.6 367,-890 387.56,-921.2 424.12,-943.79 452.31,-957.63"/>
<polygon fill="#9100ff" stroke="#9100ff" points="450.99,-960.88 461.52,-961.99 453.98,-954.55 450.99,-960.88"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#9100ff" d="M292.14,-633.25C305.35,-630.28 318.86,-626.3 331,-621 387.32,-596.4 443.02,-549.33 471.66,-523.02"/>
<polygon fill="#9100ff" stroke="#9100ff" points="474.07,-525.56 479,-516.18 469.3,-520.43 474.07,-525.56"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#9100ff" d="M292.21,-640.2C306.47,-636.86 320.38,-630.99 331,-621 377.17,-577.58 326.57,-531.82 367,-483 389.49,-455.85 427.35,-440.4 455.43,-432.19"/>
<polygon fill="#9100ff" stroke="#9100ff" points="456.58,-435.5 465.29,-429.48 454.72,-428.75 456.58,-435.5"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#b600ff" d="M556.13,-861.89C666.4,-849.21 902.39,-821.35 1101,-793 1109.31,-791.81 1118.09,-790.48 1126.68,-789.14"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1127.3,-792.59 1136.63,-787.57 1126.21,-785.67 1127.3,-792.59"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00da" d="M270.25,-710.87C430.21,-673.43 957.98,-558.9 1101,-642 1144.59,-667.33 1167.09,-726.1 1176.49,-758.17"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1173.15,-759.23 1179.18,-767.93 1179.9,-757.36 1173.15,-759.23"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="618,-765 367,-765 367,-741 618,-741 618,-765"/>
<text text-anchor="middle" x="492.5" y="-750.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#ff00da" d="M270.29,-727.36C300.01,-730.81 339.99,-735.44 377.78,-739.82"/>
<polygon fill="#ff00da" stroke="#ff00da" points="377.51,-743.31 387.85,-740.99 378.32,-736.36 377.51,-743.31"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="588.5,-723 396.5,-723 396.5,-699 588.5,-699 588.5,-723"/>
<text text-anchor="middle" x="492.5" y="-708.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#ff00da" d="M270.29,-720.1C302.2,-718.78 345.94,-716.99 386.11,-715.33"/>
<polygon fill="#ff00da" stroke="#ff00da" points="386.39,-718.83 396.24,-714.92 386.1,-711.83 386.39,-718.83"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="589,-807 396,-807 396,-783 589,-783 589,-807"/>
<text text-anchor="middle" x="492.5" y="-792.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#ff00da" d="M270.17,-725.78C289.68,-728.69 312.19,-733.86 331,-743 349.99,-752.23 347.89,-765.03 367,-774 373.07,-776.85 379.46,-779.32 386.01,-781.45"/>
<polygon fill="#ff00da" stroke="#ff00da" points="385.13,-784.84 395.71,-784.35 387.13,-778.13 385.13,-784.84"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00b6" d="M252.62,-1386.13C377.94,-1437.12 881.75,-1619.81 1101,-1360 1174.01,-1273.49 1181.29,-898.62 1181.95,-802.52"/>
<polygon fill="#ff00b6" stroke="#ff00b6" points="1185.45,-802.47 1182,-792.45 1178.45,-802.43 1185.45,-802.47"/>
</g>
<!-- proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~save_partial_xs_file_header&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff00b6" d="M302.68,-1367.64C312.91,-1364.3 322.7,-1359.59 331,-1353 361.54,-1328.76 336.14,-1296.83 367,-1273 387.95,-1256.82 416.84,-1251.24 441.51,-1249.85"/>
<polygon fill="#ff00b6" stroke="#ff00b6" points="441.92,-1253.33 451.79,-1249.49 441.68,-1246.34 441.92,-1253.33"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff006d" d="M268.76,-402.4C288.44,-405.44 311.46,-410.52 331,-419 349.1,-426.86 348.63,-437.79 367,-445 672.98,-565 846.84,-326.62 1101,-535 1170.1,-591.66 1180.69,-708.76 1182,-757.72"/>
<polygon fill="#ff006d" stroke="#ff006d" points="1178.51,-757.92 1182.16,-767.86 1185.51,-757.81 1178.51,-757.92"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ff006d" d="M268.57,-398.68C289.12,-400.91 312.9,-406.4 331,-419 356.21,-436.56 341.9,-460.29 367,-478 372.52,-481.89 378.49,-485.22 384.73,-488.08"/>
<polygon fill="#ff006d" stroke="#ff006d" points="383.47,-491.34 394.05,-491.92 386.14,-484.87 383.47,-491.34"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff006d" d="M268.77,-402.35C321.15,-407.44 406.85,-415.77 455.25,-420.48"/>
<polygon fill="#ff006d" stroke="#ff006d" points="454.98,-423.97 465.27,-421.45 455.66,-417 454.98,-423.97"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff0048" d="M248.98,-71.09C277.07,-84.21 324.34,-104.91 367,-117 396.16,-125.26 430.13,-130.73 455.22,-134"/>
<polygon fill="#ff0048" stroke="#ff0048" points="455.03,-137.51 465.38,-135.28 455.9,-130.56 455.03,-137.51"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="556,-66 429,-66 429,-42 556,-42 556,-66"/>
<text text-anchor="middle" x="492.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff0048" d="M279.1,-57.97C319.54,-57.21 374.86,-56.18 418.9,-55.36"/>
<polygon fill="#ff0048" stroke="#ff0048" points="419.04,-58.86 428.97,-55.17 418.91,-51.86 419.04,-58.86"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="565,-24 420,-24 420,0 565,0 565,-24"/>
<text text-anchor="middle" x="492.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ff0048" d="M279.32,-48.77C305.83,-43.91 338.04,-38.07 367,-33 380.73,-30.59 395.31,-28.09 409.48,-25.68"/>
<polygon fill="#ff0048" stroke="#ff0048" points="410.44,-29.07 419.71,-23.95 409.27,-22.17 410.44,-29.07"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M786.94,-1283.38C810.59,-1274.38 844.6,-1258.03 865,-1233 898.04,-1192.47 878.17,-1168.04 901,-1121 924.52,-1072.54 962.16,-1021.62 983.62,-994.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="986.51,-996.25 989.98,-986.24 981.02,-991.9 986.51,-996.25"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M786.59,-1289.82C827.22,-1286.43 906.11,-1279.84 955.75,-1275.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="956.2,-1279.17 965.88,-1274.85 955.62,-1272.19 956.2,-1279.17"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff4500" d="M1036.1,-1261.22C1058.04,-1252.51 1085.28,-1238.02 1101,-1216 1149.49,-1148.06 1173.95,-882.41 1180.3,-802.72"/>
<polygon fill="#ff4500" stroke="#ff4500" points="1183.82,-802.6 1181.1,-792.36 1176.84,-802.06 1183.82,-802.6"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="832,-1689 687,-1689 687,-1665 832,-1665 832,-1689"/>
<text text-anchor="middle" x="759.5" y="-1674.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#a2ff00" d="M577.35,-1691.36C609.09,-1688.84 645.16,-1685.98 676.71,-1683.48"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="677.09,-1686.96 686.79,-1682.68 676.54,-1679.98 677.09,-1686.96"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="799.5,-1731 719.5,-1731 719.5,-1707 799.5,-1707 799.5,-1731"/>
<text text-anchor="middle" x="759.5" y="-1716.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#a2ff00" d="M577.35,-1704.64C620.73,-1708.08 672.19,-1712.16 709.16,-1715.09"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="708.94,-1718.58 719.18,-1715.88 709.49,-1711.61 708.94,-1718.58"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#5cff00" d="M540.24,-1046.62C629.33,-1032.55 823.9,-1001.81 929.1,-985.2"/>
<polygon fill="#5cff00" stroke="#5cff00" points="929.67,-988.65 939,-983.63 928.58,-981.74 929.67,-988.65"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#5cff00" d="M540.44,-1055.76C667.52,-1059.56 1014.52,-1063.3 1101,-995 1162.18,-946.68 1177.15,-846.83 1180.82,-802.29"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1184.31,-802.45 1181.53,-792.23 1177.33,-801.96 1184.31,-802.45"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#5cff00" d="M540.19,-1043.52C567.15,-1035.01 599.31,-1020.15 618,-995 681.82,-909.14 574.63,-828.73 654,-757 693.97,-720.88 847.45,-726.99 935.99,-733.91"/>
<polygon fill="#5cff00" stroke="#5cff00" points="935.95,-737.42 946.19,-734.74 936.51,-730.44 935.95,-737.42"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#5cff00" d="M540.11,-1044.41C567.57,-1036.17 600.3,-1021.29 618,-995 696.8,-877.94 561.52,-467.59 654,-361 670.51,-341.97 699.02,-337.24 722.09,-336.99"/>
<polygon fill="#5cff00" stroke="#5cff00" points="722.19,-340.49 732.24,-337.15 722.3,-333.49 722.19,-340.49"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff2e" d="M537.12,-491.99C563.44,-482.83 596.02,-467.83 618,-445 646.18,-415.74 622.47,-386.61 654,-361 673.01,-345.56 700.29,-340.47 722.22,-339.16"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="722.62,-342.65 732.49,-338.79 722.37,-335.65 722.62,-342.65"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff2e" d="M505.17,-516.25C531.06,-544.29 592.96,-616.43 618,-690 637.48,-747.24 612.24,-1189.27 654,-1233 674.51,-1254.47 867.33,-1265.96 955.9,-1270.14"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="955.76,-1273.63 965.91,-1270.6 956.09,-1266.64 955.76,-1273.63"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~check_namelist_basis&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff73" d="M785.68,-1077.81C828.91,-1056.86 917.31,-1014.05 965.98,-990.48"/>
<polygon fill="#00ff73" stroke="#00ff73" points="967.69,-993.54 975.16,-986.03 964.63,-987.24 967.69,-993.54"/>
</g>
<!-- proc~check_namelist_basis&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~check_namelist_basis&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ff73" d="M821.89,-1102.05C836.07,-1104.91 851.07,-1108 865,-1111 891.03,-1116.6 919.81,-1123.16 944.08,-1128.8"/>
<polygon fill="#00ff73" stroke="#00ff73" points="943.3,-1132.21 953.83,-1131.07 944.89,-1125.39 943.3,-1132.21"/>
</g>
<!-- proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~modified_bessel_temme_algorithm</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/modified_bessel_temme_algorithm.html" xlink:title="modified_bessel_temme_algorithm">
<polygon fill="#d9534f" stroke="#d9534f" points="859,-436 660,-436 660,-412 859,-412 859,-436"/>
<text text-anchor="middle" x="759.5" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_temme_algorithm</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~modified_bessel_temme_algorithm</title>
<path fill="none" stroke="#00ffb9" d="M562.78,-392.98C596.42,-398.31 637.17,-404.77 672.75,-410.41"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="672.21,-413.87 682.64,-411.98 673.31,-406.95 672.21,-413.87"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffff" d="M539.11,-292.96C566.01,-292.7 598.51,-297.62 618,-319 690.07,-398.04 588.37,-714.53 654,-799 714.71,-877.13 777.72,-823.39 865,-870 909.51,-893.77 954.63,-932.02 979.79,-954.92"/>
<polygon fill="#00ffff" stroke="#00ffff" points="977.51,-957.57 987.23,-961.77 982.25,-952.42 977.51,-957.57"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="803,-394 716,-394 716,-370 803,-370 803,-394"/>
<text text-anchor="middle" x="759.5" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ffff" d="M539.2,-298.27C563.91,-300.19 594.15,-305.51 618,-319 639.4,-331.1 632.79,-348.57 654,-361 669.55,-370.11 688.39,-375.33 705.77,-378.3"/>
<polygon fill="#00ffff" stroke="#00ffff" points="705.39,-381.78 715.79,-379.8 706.42,-374.86 705.39,-381.78"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-112 732.5,-112 732.5,-88 786.5,-88 786.5,-112"/>
<text text-anchor="middle" x="759.5" y="-97.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#00ffff" d="M539.11,-298.1C563.93,-296.31 594.31,-290.99 618,-277 682.19,-239.09 728.5,-159.94 748.1,-121.66"/>
<polygon fill="#00ffff" stroke="#00ffff" points="751.37,-122.94 752.71,-112.43 745.11,-119.81 751.37,-122.94"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0073ff" d="M588.54,-705.11C735.14,-697.23 1009.11,-687.6 1101,-719 1125.4,-727.34 1148.39,-746.1 1163.6,-760.63"/>
<polygon fill="#0073ff" stroke="#0073ff" points="1161.24,-763.22 1170.81,-767.77 1166.17,-758.25 1161.24,-763.22"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0073ff" d="M503.68,-698.73C527,-670.05 584.85,-595.72 618,-525 642,-473.81 612.29,-441.17 654,-403 667.94,-390.25 687.38,-384.32 705.72,-381.81"/>
<polygon fill="#0073ff" stroke="#0073ff" points="706.17,-385.29 715.75,-380.75 705.44,-378.32 706.17,-385.29"/>
</g>
<!-- proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~print_sum_of_squares</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/print_sum_of_squares.html" xlink:title="print_sum_of_squares">
<polygon fill="#d9534f" stroke="#d9534f" points="823,-790 696,-790 696,-766 823,-766 823,-790"/>
<text text-anchor="middle" x="759.5" y="-775.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_sum_of_squares</text>
</a>
</g>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~print_sum_of_squares</title>
<path fill="none" stroke="#0073ff" d="M575.56,-723.05C589.79,-725.65 604.38,-728.64 618,-732 651.62,-740.29 688.84,-752.62 716.51,-762.43"/>
<polygon fill="#0073ff" stroke="#0073ff" points="715.66,-765.84 726.25,-765.92 718.02,-759.25 715.66,-765.84"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#1700ff" d="M519.52,-424.65C545.96,-424.2 587.28,-420.37 618,-403 639.4,-390.9 632.79,-373.43 654,-361 674.62,-348.91 701.04,-343.67 722.15,-341.45"/>
<polygon fill="#1700ff" stroke="#1700ff" points="722.69,-344.92 732.35,-340.57 722.08,-337.95 722.69,-344.92"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#5c00ff" d="M520.53,-1239.96C552.02,-1226.35 605.89,-1204.35 654,-1191 745.82,-1165.52 783.84,-1202.92 865,-1153 897.74,-1132.86 960.32,-1037.25 987.21,-994.61"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="990.18,-996.46 992.52,-986.13 984.24,-992.74 990.18,-996.46"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#5c00ff" d="M533.27,-1252.09C558.86,-1253.69 592.07,-1258.75 618,-1273 638.96,-1284.52 632.15,-1303.27 654,-1313 739.67,-1351.15 772.24,-1326.78 865,-1313 897.66,-1308.15 933.35,-1297.04 959.82,-1287.61"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="961.29,-1290.8 969.5,-1284.09 958.9,-1284.22 961.29,-1290.8"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#a200ff" d="M823.12,-1205.16C837.93,-1201.28 852.91,-1195.27 865,-1186 891.2,-1165.9 883.76,-1149.17 901,-1121 929.26,-1074.82 965.44,-1022.68 985.31,-994.58"/>
<polygon fill="#a200ff" stroke="#a200ff" points="988.22,-996.53 991.15,-986.34 982.51,-992.48 988.22,-996.53"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#a200ff" d="M823.2,-1222.43C899.2,-1231.22 1026.35,-1232.91 1101,-1163 1154.32,-1113.07 1175.21,-876.94 1180.53,-802.52"/>
<polygon fill="#a200ff" stroke="#a200ff" points="1184.04,-802.6 1181.23,-792.38 1177.05,-802.12 1184.04,-802.6"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~check_namelist_input&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#a200ff" d="M808.89,-1224.01C826.55,-1228.4 846.68,-1233.41 865,-1238 895.46,-1245.62 929.77,-1254.27 956.17,-1260.93"/>
<polygon fill="#a200ff" stroke="#a200ff" points="955.33,-1264.33 965.88,-1263.38 957.05,-1257.54 955.33,-1264.33"/>
</g>
<!-- proc~check_namelist_input&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~check_namelist_input&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#a200ff" d="M811.99,-1199.96C828.94,-1195.79 847.84,-1190.92 865,-1186 895.47,-1177.26 929.38,-1166.2 955.6,-1157.35"/>
<polygon fill="#a200ff" stroke="#a200ff" points="956.9,-1160.61 965.25,-1154.08 954.65,-1153.98 956.9,-1160.61"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~check_namelist_potential&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00d0" d="M833.57,-1123.13C844.49,-1120.17 855.31,-1116.24 865,-1111 918.47,-1082.1 964.16,-1025.03 986.09,-994.46"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="988.99,-996.43 991.88,-986.24 983.26,-992.4 988.99,-996.43"/>
</g>
<!-- proc~check_namelist_potential&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~check_namelist_potential&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#ff00d0" d="M833.66,-1135.05C868.91,-1136.53 910.55,-1138.27 943.34,-1139.63"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="943.52,-1143.14 953.66,-1140.07 943.82,-1136.15 943.52,-1143.14"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0045" d="M540.68,-334.92C567.28,-334.86 598.92,-339.98 618,-361 694.22,-444.96 579.21,-784.76 654,-870 717.12,-941.94 773.94,-883.56 865,-913 901.56,-924.82 941.42,-943.62 968.28,-957.22"/>
<polygon fill="#ff0045" stroke="#ff0045" points="966.72,-960.35 977.21,-961.8 969.91,-954.12 966.72,-960.35"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0045" d="M540.57,-347.46C586.95,-354.81 657.67,-366.02 705.88,-373.66"/>
<polygon fill="#ff0045" stroke="#ff0045" points="705.38,-377.12 715.81,-375.23 706.48,-370.21 705.38,-377.12"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="786.5,-310 732.5,-310 732.5,-286 786.5,-286 786.5,-310"/>
<text text-anchor="middle" x="759.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#ff0045" d="M540.57,-332.54C592.56,-324.3 675.14,-311.21 722.31,-303.74"/>
<polygon fill="#ff0045" stroke="#ff0045" points="723.05,-307.16 732.38,-302.14 721.95,-300.25 723.05,-307.16"/>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ffda00" d="M781.02,-436.03C805.94,-451.93 846.89,-482.47 865,-521 925.77,-650.32 845.79,-1031.21 901,-1163 916.82,-1200.75 951.58,-1233.92 975.4,-1253.47"/>
<polygon fill="#ffda00" stroke="#ffda00" points="973.32,-1256.29 983.32,-1259.8 977.69,-1250.83 973.32,-1256.29"/>
</g>
<!-- proc~rgamma -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>proc~rgamma</title>
<g id="a_program~~scattering~~CallsGraph_node73"><a xlink:href=".././proc/rgamma.html" xlink:title="rgamma">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1030,-436 972,-436 972,-412 1030,-412 1030,-436"/>
<text text-anchor="middle" x="1001" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rgamma</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~modified_bessel_temme_algorithm&#45;&gt;proc~rgamma</title>
<path fill="none" stroke="#ffda00" d="M859.3,-424C895.4,-424 934.13,-424 961.8,-424"/>
<polygon fill="#ffda00" stroke="#ffda00" points="961.83,-427.5 971.83,-424 961.83,-420.5 961.83,-427.5"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#48ff00" d="M803.08,-378.51C884.36,-372.79 1057.45,-365.54 1101,-403 1155.55,-449.92 1175.6,-683.87 1180.63,-757.66"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1177.14,-757.96 1181.29,-767.71 1184.13,-757.51 1177.14,-757.96"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff91" d="M783.48,-790.1C805.32,-802.05 838.65,-821.47 865,-842 910.7,-877.6 957.63,-926.95 982.32,-954.1"/>
<polygon fill="#00ff91" stroke="#00ff91" points="979.95,-956.7 989.25,-961.78 985.15,-952.01 979.95,-956.7"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff91" d="M823.15,-778.3C905.34,-778.69 1048.31,-779.37 1126.69,-779.74"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1126.82,-783.24 1136.84,-779.79 1126.86,-776.24 1126.82,-783.24"/>
</g>
<!-- proc~print_sum_of_squares&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~print_sum_of_squares&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#00ff91" d="M823.11,-768.07C857.93,-762.54 901.16,-755.68 936.17,-750.13"/>
<polygon fill="#00ff91" stroke="#00ff91" points="936.95,-753.55 946.28,-748.52 935.86,-746.63 936.95,-753.55"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-70 974,-70 974,-46 1028,-46 1028,-70"/>
<text text-anchor="middle" x="1001" y="-55.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ff00da" d="M786.59,-95.43C829.51,-87.9 915.11,-72.89 963.84,-64.34"/>
<polygon fill="#ff00da" stroke="#ff00da" points="964.7,-67.74 973.95,-62.57 963.49,-60.85 964.7,-67.74"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node75" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node75"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1028,-112 974,-112 974,-88 1028,-88 1028,-112"/>
<text text-anchor="middle" x="1001" y="-97.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ff00da" d="M786.59,-100C829.51,-100 915.11,-100 963.84,-100"/>
<polygon fill="#ff00da" stroke="#ff00da" points="963.95,-103.5 973.95,-100 963.95,-96.5 963.95,-103.5"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node76" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node76"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1210,-91 1156,-91 1156,-67 1210,-67 1210,-91"/>
<text text-anchor="middle" x="1183" y="-76.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ff00" d="M1028.17,-61.05C1059.1,-64.66 1110.75,-70.69 1145.57,-74.75"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1145.46,-78.26 1155.79,-75.94 1146.27,-71.31 1145.46,-78.26"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#0000ff" d="M1028.17,-96.95C1059.1,-93.34 1110.75,-87.31 1145.57,-83.25"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1146.27,-86.69 1155.79,-82.06 1145.46,-79.74 1146.27,-86.69"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~12">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~5">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholddiag">consecutive_blocks_thresholddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-consecutive_blocks_thresholdoff">consecutive_blocks_thresholdoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-count_blocks">count_blocks</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~6">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~3">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_algebraic_coefficients~3">nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~3">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~2">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_algebraic_coefficients~3">number_of_nonzero_algebraic_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_pes_matrix_elements~3">number_of_nonzero_pes_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~3">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~3">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent~2">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~5">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~5">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv~2">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block~2">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_indices~12"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~8"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholddiag</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-consecutive_blocks_thresholdoff"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>consecutive_blocks_thresholdoff</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-count_blocks"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>count_blocks</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_algebraic_coefficients~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_algebraic_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~2"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_algebraic_coefficients~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_algebraic_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_pes_matrix_elements~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_pes_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~3"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~5"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">data_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_short_block_summary</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">pes_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">prepare_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="n">print_pes_matrix_elements_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">propagator_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">numerov</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">save_s_matrix_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">save_s_matrix_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_s_matrix_block_info</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">check_cross_section_thresholds</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">save_partial_xs_file_header</span><span class="p">,</span><span class="w"> </span><span class="n">save_partial_xs_single_block</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">save_s_matrix_file_header</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">save_partial_xs_file_header</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize arrays that save the state-to-state cross-sections</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;jtot_loop&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">count_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_blocks</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">print_short_block_summary</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">count_blocks</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the PES matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_pes_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_pes_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_pes_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_algebraic_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_algebraic_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reduced_mass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">save_s_matrix_block_info</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w"> </span><span class="n">wv</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">s_matrix_real</span><span class="p">,</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">print_partial_cross_sections</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">save_partial_xs_single_block</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">count_blocks</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span>
<span class="k">         do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">consecutive_blocks_thresholddiag</span><span class="p">,</span><span class="w"> </span><span class="n">consecutive_blocks_thresholdoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if elastic_xs_threshold/inelastic_xs_threshold condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-10 13:20            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>