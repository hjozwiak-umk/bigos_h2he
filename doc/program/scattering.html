<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">216 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~11">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~4">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~6">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~6">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~4">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~4">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~2">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~4">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~2">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/state_to_state_cross_sections_mod.html'>state_to_state_cross_sections_mod</a></li>
                <li><a href='../module/coupling_matrix_mod.html'>coupling_matrix_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/radial_coupling_terms_mod.html'>radial_coupling_terms_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="405pt"
 viewBox="0.00 0.00 641.00 405.31" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.41 1.41) rotate(0) translate(4 568.23)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-568.23 901,-568.23 901,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="897,-286.07 818,-286.07 818,-262.07 897,-262.07 897,-286.07"/>
<text text-anchor="middle" x="857.5" y="-271.67" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-288.07 0,-288.07 0,-264.07 94,-264.07 94,-288.07"/>
<text text-anchor="middle" x="47" y="-273.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C682.75,-460.71 706.71,-514.15 655,-539.07 537.38,-595.73 490.51,-541.1 362,-518.07"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="633.5,-121.07 480.5,-121.07 480.5,-97.07 633.5,-97.07 633.5,-121.07"/>
<text text-anchor="middle" x="557" y="-106.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-50.07C722.75,-43.81 644.53,-73.66 596.28,-93.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="594.71,-90.05 586.76,-97.06 597.34,-96.53 594.71,-90.05"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="602,-530.07 512,-530.07 512,-506.07 602,-506.07 602,-530.07"/>
<text text-anchor="middle" x="557" y="-515.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C695.94,-455.13 694.22,-474.25 655,-492.07 641.46,-498.22 626.17,-503.16 611.8,-507.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="610.86,-503.64 602.03,-509.5 612.59,-510.42 610.86,-503.64"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="618.5,-450.07 495.5,-450.07 495.5,-426.07 618.5,-426.07 618.5,-450.07"/>
<text text-anchor="middle" x="557" y="-435.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C702.42,-452.34 662.54,-453.57 628.96,-450.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="629.06,-447.2 618.76,-449.69 628.37,-454.16 629.06,-447.2"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-376.07 334,-376.07 334,-352.07 388,-352.07 388,-376.07"/>
<text text-anchor="middle" x="361" y="-361.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C681.51,-461.36 704.97,-364.05 655,-333.07 617.67,-309.91 601.93,-313.63 558,-314.07"/>
</g>
<!-- module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~radial_coupling_terms_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/radial_coupling_terms_mod.html" xlink:title="radial_coupling_terms_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="637,-286.07 477,-286.07 477,-262.07 637,-262.07 637,-286.07"/>
<text text-anchor="middle" x="557" y="-271.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">radial_coupling_terms_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M852.6,-286.14C841.25,-318.93 804.68,-409.08 737.5,-438.07"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C670.3,-466.19 711.43,-343.17 655,-300.07 650,-296.25 644.48,-292.99 638.69,-290.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="639.97,-286.94 629.4,-286.22 637.21,-293.38 639.97,-286.94"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-416.07 134,-416.07 134,-392.07 259,-392.07 259,-416.07"/>
<text text-anchor="middle" x="196.5" y="-401.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C658.81,-471.15 443.67,-497.58 362,-480.07"/>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="782,-286.07 691,-286.07 691,-262.07 782,-262.07 782,-286.07"/>
<text text-anchor="middle" x="736.5" y="-271.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M817.86,-274.07C809.67,-274.07 800.87,-274.07 792.21,-274.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="792.14,-270.57 782.14,-274.07 792.14,-277.57 792.14,-270.57"/>
</g>
<!-- module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~state_to_state_cross_sections_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/state_to_state_cross_sections_mod.html" xlink:title="state_to_state_cross_sections_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="655,-408.07 459,-408.07 459,-384.07 655,-384.07 655,-408.07"/>
<text text-anchor="middle" x="557" y="-393.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">state_to_state_cross_sections_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~state_to_state_cross_sections_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~state_to_state_cross_sections_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C701.55,-452.71 690.97,-425.65 655,-417.07 645.45,-414.79 635.34,-412.48 625.4,-410.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="626.06,-406.84 615.54,-408.1 624.55,-413.67 626.06,-406.84"/>
</g>
<!-- module~coupling_matrix_mod -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~coupling_matrix_mod</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/coupling_matrix_mod.html" xlink:title="coupling_matrix_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="620.5,-366.07 493.5,-366.07 493.5,-342.07 620.5,-342.07 620.5,-366.07"/>
<text text-anchor="middle" x="557" y="-351.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">coupling_matrix_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~coupling_matrix_mod -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~coupling_matrix_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-438.07C693.78,-456.06 696.13,-394.36 655,-375.07 647.32,-371.46 639.01,-368.47 630.59,-365.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="631.25,-362.54 620.69,-363.29 629.42,-369.29 631.25,-362.54"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-160.07 130,-160.07 130,-136.07 263,-136.07 263,-160.07"/>
<text text-anchor="middle" x="196.5" y="-145.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M854.86,-261.88C848.66,-221.42 822.49,-91.78 737.5,-50.07"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.5,-50.07C561.18,35.5 481.25,-2.03 299,-69.07 265.29,-81.46 233.87,-109.47 215.18,-128.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.56,-126.24 208.2,-135.9 217.63,-131.07 212.56,-126.24"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M525.15,-96.98C498.56,-87.24 458.9,-74.35 423,-69.07 368.48,-61.04 353.36,-60 299,-69.07 220.67,-82.13 190.78,-75.96 130,-127.07 89.19,-161.38 65.15,-221.43 54.53,-253.83"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="51.09,-253.09 51.44,-263.68 57.77,-255.18 51.09,-253.09"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M547.8,-121.3C519.92,-162.87 430.15,-296.57 423,-305.07 411.02,-319.31 396.01,-333.86 383.88,-344.95"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="381.47,-342.41 376.38,-351.7 386.15,-347.61 381.47,-342.41"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M533.62,-121.27C474.17,-153.86 315.7,-241.87 299,-263.07 265.86,-305.14 299.43,-338.81 263,-378.07 259.87,-381.43 256.25,-384.38 252.35,-386.94"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="250.42,-384.01 243.44,-391.98 253.87,-390.1 250.42,-384.01"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M480.41,-117.29C419.4,-123.92 333.99,-133.22 273.01,-139.85"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="272.62,-136.37 263.06,-140.93 273.38,-143.33 272.62,-136.37"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-102.07 334,-102.07 334,-78.07 388,-78.07 388,-102.07"/>
<text text-anchor="middle" x="361" y="-87.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M480.44,-101.66C452.21,-98.9 421.43,-95.89 398.32,-93.62"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="398.57,-90.13 388.28,-92.64 397.89,-97.1 398.57,-90.13"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-296.07 299,-296.07 299,-272.07 423,-272.07 423,-296.07"/>
<text text-anchor="middle" x="361" y="-281.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M548.06,-121.12C529.32,-148.75 479.62,-217.43 423,-258.07 418.09,-261.59 412.62,-264.76 407.04,-267.58"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="405.18,-264.58 397.6,-271.99 408.15,-270.93 405.18,-264.58"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M511.69,-522.48C472.11,-525.38 412.72,-527.16 362,-518.07"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M527.69,-505.96C506.67,-495.86 478.4,-479.78 459,-459.07 435.36,-433.82 448.39,-413.55 423,-390.07 415.86,-383.46 406.8,-378.39 397.85,-374.55"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="398.87,-371.19 388.29,-370.86 396.35,-377.72 398.87,-371.19"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M511.99,-509.91C472.61,-502.5 413.34,-491.08 362,-480.07"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M534.82,-450.23C492.19,-474.12 397.14,-524.37 362,-518.07"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M360,-518.07C281.89,-504.06 265.99,-484.15 197.5,-444.07"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M495.45,-429.16C483.07,-426.19 470.36,-422.25 459,-417.07 440.81,-408.76 440.32,-400.06 423,-390.07 415.03,-385.47 406.09,-381.21 397.57,-377.52"/>
<polygon fill="#5cff00" stroke="#5cff00" points="398.76,-374.23 388.19,-373.62 396.07,-380.69 398.76,-374.23"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M509.88,-450.14C457.17,-463.61 376.32,-483.14 362,-480.07"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M360,-480.07C331.51,-473.95 324.57,-470.04 299,-456.07 281.68,-446.6 280.3,-439.56 263,-430.07 256.44,-426.47 249.27,-423.1 242.16,-420.06"/>
<polygon fill="#5cff00" stroke="#5cff00" points="243.15,-416.69 232.57,-416.14 240.49,-423.17 243.15,-416.69"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M333.84,-369.09C301.02,-374.28 243.46,-379.63 197.5,-364.07"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M195.5,-364.07C148.1,-348.01 99.45,-315.18 71.57,-294.48"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="73.36,-291.45 63.27,-288.22 69.14,-297.03 73.36,-291.45"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M333.89,-370.49C313.05,-375.62 283.04,-383.01 256.47,-389.55"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="255.36,-386.22 246.49,-392.01 257.03,-393.02 255.36,-386.22"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M343.08,-351.87C329.28,-341.06 310.27,-324.08 299,-305.07 268.21,-253.13 303.29,-219.04 263,-174.07 259.98,-170.69 256.46,-167.75 252.66,-165.19"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="254.36,-162.13 243.95,-160.16 250.86,-168.19 254.36,-162.13"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M533.14,-261.89C476.67,-233.27 325.83,-165.79 197.5,-188.07"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M491.1,-286.12C479.95,-289.67 468.81,-294.22 459,-300.07 439.01,-311.97 442.1,-324.78 423,-338.07 415.23,-343.47 406.15,-348.09 397.41,-351.86"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="396.09,-348.62 388.14,-355.63 398.72,-355.11 396.09,-348.62"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M511.09,-286.1C494.69,-290.49 476.01,-295.5 459,-300.07 387.88,-319.15 363.01,-306.67 299,-343.07 279.6,-354.09 281.73,-365.94 263,-378.07 257.27,-381.77 250.93,-385.1 244.52,-388.03"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="242.95,-384.9 235.13,-392.05 245.7,-391.34 242.95,-384.9"/>
</g>
<!-- module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~radial_coupling_terms_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M476.81,-278.15C462.4,-278.89 447.44,-279.66 433.27,-280.39"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="432.91,-276.91 423.11,-280.92 433.27,-283.9 432.91,-276.91"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M155.67,-392.05C146.76,-388.36 137.68,-383.73 130,-378.07 99.77,-355.75 74.37,-319.7 60.19,-296.97"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="62.99,-294.86 54.81,-288.13 57.01,-298.49 62.99,-294.86"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M360,-168.07C287.6,-160.75 269.13,-175.27 197.5,-188.07"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M195.5,-188.07C144.69,-197.14 95.16,-234.18 68.4,-257.21"/>
<polygon fill="#002eff" stroke="#002eff" points="66.04,-254.63 60.85,-263.86 70.67,-259.88 66.04,-254.63"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M701.98,-286.08C666.66,-297.67 609.17,-313.56 558,-314.07"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M556,-314.07C499.33,-314.63 436.21,-334.73 397.8,-349.27"/>
<polygon fill="#002eff" stroke="#002eff" points="396.19,-346.14 388.12,-353.02 398.71,-352.67 396.19,-346.14"/>
</g>
<!-- module~propagators&#45;&gt;module~radial_coupling_terms_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~propagators&#45;&gt;module~radial_coupling_terms_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M690.71,-274.07C677.53,-274.07 662.61,-274.07 647.66,-274.07"/>
<polygon fill="#002eff" stroke="#002eff" points="647.32,-270.57 637.32,-274.07 647.32,-277.57 647.32,-270.57"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M710.83,-261.91C651.99,-234.06 498.16,-168.07 362,-168.07"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M360,-168.07C331.66,-165.2 300.61,-161.52 273.32,-158.09"/>
<polygon fill="#002eff" stroke="#002eff" points="273.41,-154.58 263.05,-156.79 272.53,-161.52 273.41,-154.58"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M360,-442.07C287.91,-446.45 259.84,-480.55 197.5,-444.07"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M195.5,-444.07C169.34,-428.75 153.66,-444.01 130,-425.07 88.17,-391.58 64.43,-330.69 54.16,-298.08"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="57.42,-296.75 51.19,-288.18 50.72,-298.77 57.42,-296.75"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M483.21,-384.06C454.18,-379.27 422.05,-373.97 398.17,-370.03"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="398.59,-366.55 388.15,-368.38 397.45,-373.46 398.59,-366.55"/>
</g>
<!-- module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~state_to_state_cross_sections_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M498.73,-408.08C485.65,-410.93 471.83,-414.03 459,-417.07 415.68,-427.33 406.44,-439.36 362,-442.07"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M360,-442.07C316.76,-444.7 268.59,-431.29 236,-419.68"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="237.01,-416.32 226.41,-416.16 234.59,-422.89 237.01,-416.32"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M496.84,-366.11C484.3,-368.88 471.18,-371.93 459,-375.07 415.42,-386.28 406.9,-401.17 362,-404.07"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M360,-404.07C341.44,-405.26 215.11,-370.03 197.5,-364.07"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M493.28,-357.3C461.81,-358.92 424.82,-360.83 398.14,-362.2"/>
<polygon fill="#e700ff" stroke="#e700ff" points="397.9,-358.71 388.09,-362.72 398.26,-365.7 397.9,-358.71"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M360,-404.07C330.41,-405.97 297.73,-406.31 269.48,-406.05"/>
<polygon fill="#e700ff" stroke="#e700ff" points="269.33,-402.55 259.29,-405.93 269.25,-409.55 269.33,-402.55"/>
</g>
<!-- module~coupling_matrix_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~coupling_matrix_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M522.65,-342.03C490.17,-330.31 440.64,-312.44 405.17,-299.64"/>
<polygon fill="#e700ff" stroke="#e700ff" points="406.16,-296.28 395.56,-296.18 403.78,-302.86 406.16,-296.28"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M155.67,-160.08C146.76,-163.77 137.68,-168.4 130,-174.07 99.77,-196.38 74.37,-232.43 60.19,-255.16"/>
<polygon fill="#ff008b" stroke="#ff008b" points="57.01,-253.64 54.81,-264 62.99,-257.27 57.01,-253.64"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M350.42,-271.96C326.82,-243.72 263.04,-176.69 197.5,-188.07"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M320.54,-296.21C312.81,-299.82 305.19,-304.38 299,-310.07 273.83,-333.21 288.46,-355.24 263,-378.07 259.06,-381.6 254.58,-384.68 249.85,-387.36"/>
<polygon fill="#00ffff" stroke="#00ffff" points="247.91,-384.42 240.55,-392.04 251.05,-390.68 247.91,-384.42"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-296.07 130,-296.07 130,-272.07 263,-272.07 263,-296.07"/>
<text text-anchor="middle" x="196.5" y="-281.67" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M298.57,-284.07C290.32,-284.07 281.79,-284.07 273.34,-284.07"/>
<polygon fill="#00ffff" stroke="#00ffff" points="273.09,-280.57 263.09,-284.07 273.09,-287.57 273.09,-280.57"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="759pt"
 viewBox="0.00 0.00 641.00 758.73" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.31 2.31) rotate(0) translate(4 1749)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1749 1477,-1749 1477,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-875 0,-875 0,-851 79,-851 79,-875"/>
<text text-anchor="middle" x="39.5" y="-860.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="285,-1745 183,-1745 183,-1721 285,-1721 285,-1745"/>
<text text-anchor="middle" x="234" y="-1730.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.72,-875.18C42.61,-973.91 57.47,-1641.53 115,-1707 129.41,-1723.39 151.59,-1730.76 172.85,-1733.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="172.52,-1737.21 182.84,-1734.82 173.29,-1730.25 172.52,-1737.21"/>
</g>
<!-- proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~set_space_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/set_space_fixed_channels.html" xlink:title="set_space_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="1082,-658 933,-658 933,-634 1082,-634 1082,-658"/>
<text text-anchor="middle" x="1007.5" y="-643.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_space_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_space_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~set_space_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M44.2,-850.96C52.53,-825.97 75.18,-768.37 115,-739 300.64,-602.07 390,-642.76 619,-615 729.75,-601.58 759.14,-602.57 870,-615 898.46,-618.19 929.65,-625.01 955.02,-631.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="954.23,-634.86 964.79,-633.98 955.99,-628.09 954.23,-634.86"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="785,-938 704,-938 704,-914 785,-914 785,-938"/>
<text text-anchor="middle" x="744.5" y="-923.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M79.27,-874.29C90.69,-877.24 103.27,-880.11 115,-882 328.46,-916.4 586.99,-923.91 693.72,-925.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="693.83,-929.05 703.87,-925.69 693.92,-922.05 693.83,-929.05"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="278.5,-444 189.5,-444 189.5,-420 278.5,-420 278.5,-444"/>
<text text-anchor="middle" x="234" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M40.98,-850.83C43.65,-789.66 58.63,-516.37 115,-458 131.49,-440.92 156.46,-433.86 179.19,-431.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.78,-434.76 189.44,-430.42 179.18,-427.79 179.78,-434.76"/>
</g>
<!-- proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~read_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/read_radial_coupling_terms.html" xlink:title="read_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="314,-972 154,-972 154,-948 314,-948 314,-972"/>
<text text-anchor="middle" x="234" y="-957.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~read_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M49.65,-875.14C62.44,-891.21 87.24,-919.23 115,-934 124.05,-938.82 133.95,-942.74 144.04,-945.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.17,-949.33 153.75,-948.79 145.14,-942.62 143.17,-949.33"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="305.5,-1509 162.5,-1509 162.5,-1485 305.5,-1485 305.5,-1509"/>
<text text-anchor="middle" x="234" y="-1494.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M41.16,-875.2C45.68,-957.1 73.24,-1425.07 115,-1471 124.92,-1481.91 138.28,-1488.79 152.46,-1493.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="151.81,-1496.47 162.37,-1495.56 153.54,-1489.69 151.81,-1496.47"/>
</g>
<!-- proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~set_body_fixed_channels</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/set_body_fixed_channels.html" xlink:title="set_body_fixed_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-402 162,-402 162,-378 306,-378 306,-402"/>
<text text-anchor="middle" x="234" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_body_fixed_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_body_fixed_channels -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~set_body_fixed_channels</title>
<path fill="none" stroke="#ff0000" d="M40.68,-850.71C41.93,-785 51.16,-475.66 115,-411 124.94,-400.93 137.93,-394.73 151.64,-391.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.72,-394.4 161.71,-388.8 151.19,-387.57 152.72,-394.4"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="533,-1148 439,-1148 439,-1124 533,-1124 533,-1148"/>
<text text-anchor="middle" x="486" y="-1133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.6,-875.23C41.62,-912.59 50.15,-1025.91 115,-1080 204.17,-1154.37 349.17,-1152.19 428.59,-1144.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="429.32,-1147.54 438.88,-1142.98 428.56,-1140.58 429.32,-1147.54"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="353,-360 115,-360 115,-336 353,-336 353,-360"/>
<text text-anchor="middle" x="234" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.5,-850.96C40.73,-782.27 45.41,-440.46 115,-369 115.94,-368.04 116.91,-367.11 117.9,-366.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="120.19,-368.87 125.98,-360 115.92,-363.32 120.19,-368.87"/>
</g>
<!-- proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~calculate_state_to_state_cross_section</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/calculate_state_to_state_cross_section.html" xlink:title="calculate_state_to_state_cross_section">
<polygon fill="#d9534f" stroke="#d9534f" points="342,-1627 126,-1627 126,-1603 342,-1603 342,-1627"/>
<text text-anchor="middle" x="234" y="-1612.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_state_to_state_cross_section</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_state_to_state_cross_section</title>
<path fill="none" stroke="#ff0000" d="M40.9,-875.15C44,-965.7 65.36,-1533.32 115,-1589 117.75,-1592.08 120.77,-1594.85 124.01,-1597.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="122.2,-1600.32 132.48,-1602.89 126.05,-1594.47 122.2,-1600.32"/>
</g>
<!-- proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~check_cross_section_thresholds</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/check_cross_section_thresholds.html" xlink:title="check_cross_section_thresholds">
<polygon fill="#d9534f" stroke="#d9534f" points="324,-276 144,-276 144,-252 324,-252 324,-276"/>
<text text-anchor="middle" x="234" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_cross_section_thresholds</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_cross_section_thresholds -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~check_cross_section_thresholds</title>
<path fill="none" stroke="#ff0000" d="M40.21,-850.95C38.63,-775.63 34.02,-369.96 115,-285 120.6,-279.12 127.24,-274.55 134.46,-271.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="136.01,-274.16 143.9,-267.08 133.32,-267.7 136.01,-274.16"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="334.5,-234 133.5,-234 133.5,-210 334.5,-210 334.5,-234"/>
<text text-anchor="middle" x="234" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.1,-850.81C45.32,-767.91 71.49,-289.05 115,-243 117.89,-239.94 121.06,-237.23 124.45,-234.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.53,-237.68 133.29,-229.53 122.92,-231.68 126.53,-237.68"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-562 204,-562 204,-538 264,-538 264,-562"/>
<text text-anchor="middle" x="234" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M41.97,-850.97C48.24,-801.78 74.22,-616.58 115,-577 135.68,-556.93 168.05,-550.62 193.67,-549.08"/>
<polygon fill="#ff0000" stroke="#ff0000" points="193.96,-552.57 203.82,-548.69 193.69,-545.57 193.96,-552.57"/>
</g>
<!-- proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~calculate_largest_wavenumber</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/calculate_largest_wavenumber.html" xlink:title="calculate_largest_wavenumber">
<polygon fill="#d94e8f" stroke="#d94e8f" points="575,-1391 397,-1391 397,-1367 575,-1367 575,-1391"/>
<text text-anchor="middle" x="486" y="-1376.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_largest_wavenumber</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_largest_wavenumber -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_largest_wavenumber</title>
<path fill="none" stroke="#ff0000" d="M40.62,-875.07C41.54,-940.98 49.38,-1256.9 115,-1322 188.49,-1394.9 313.76,-1399.15 397.93,-1391.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="398.35,-1395.44 407.98,-1391.03 397.7,-1388.47 398.35,-1395.44"/>
</g>
<!-- proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~reduce_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/reduce_radial_coupling_terms.html" xlink:title="reduce_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="830.5,-1354 658.5,-1354 658.5,-1330 830.5,-1330 830.5,-1354"/>
<text text-anchor="middle" x="744.5" y="-1339.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reduce_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~reduce_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~reduce_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M41.74,-875.1C47.3,-927.3 71.68,-1132.72 115,-1178 155.24,-1220.06 562.22,-1308.2 619,-1321 630.36,-1323.56 642.37,-1325.96 654.26,-1328.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="653.75,-1331.63 664.21,-1329.96 654.99,-1324.74 653.75,-1331.63"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="306.5,-192 161.5,-192 161.5,-168 306.5,-168 306.5,-192"/>
<text text-anchor="middle" x="234" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M41.01,-850.82C44.7,-764.78 68.62,-250.45 115,-201 124.68,-190.68 137.54,-184.36 151.21,-180.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.29,-183.99 161.28,-178.38 150.75,-177.16 152.29,-183.99"/>
</g>
<!-- proc~print_channels -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~print_channels</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/print_channels.html" xlink:title="print_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="531.5,-1551 440.5,-1551 440.5,-1527 531.5,-1527 531.5,-1551"/>
<text text-anchor="middle" x="486" y="-1536.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_channels -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~print_channels</title>
<path fill="none" stroke="#ff0000" d="M40.96,-875.11C44.3,-960.66 66.23,-1471.92 115,-1518 159.01,-1559.59 338.36,-1551.37 430.21,-1544.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="430.75,-1547.57 440.43,-1543.27 430.18,-1540.6 430.75,-1547.57"/>
</g>
<!-- proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~interpolate_radial_coupling_terms</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/interpolate_radial_coupling_terms.html" xlink:title="interpolate_radial_coupling_terms">
<polygon fill="#d9534f" stroke="#d9534f" points="583,-816 389,-816 389,-792 583,-792 583,-816"/>
<text text-anchor="middle" x="486" y="-801.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_radial_coupling_terms</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~interpolate_radial_coupling_terms</title>
<path fill="none" stroke="#ff0000" d="M62.28,-850.94C76.76,-843.53 96.47,-834.61 115,-830 201.99,-808.38 303.78,-802.59 378.55,-801.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="378.94,-805.3 388.92,-801.72 378.89,-798.3 378.94,-805.3"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="549.5,-1665 422.5,-1665 422.5,-1641 549.5,-1641 549.5,-1665"/>
<text text-anchor="middle" x="486" y="-1650.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M40.73,-875.11C42.65,-969.2 57.3,-1581.12 115,-1636 156.14,-1675.12 316.54,-1668.37 412.12,-1660.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="412.64,-1663.87 422.3,-1659.53 412.04,-1656.9 412.64,-1663.87"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1062,-364 953,-364 953,-340 1062,-340 1062,-364"/>
<text text-anchor="middle" x="1007.5" y="-349.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.07,-850.81C44.09,-791.95 60.19,-537.76 115,-486 192.64,-412.68 276.11,-527.11 353,-453 419.29,-389.11 324.09,-314.29 389,-249 426.82,-210.95 820.75,-185.72 870,-207 928.93,-232.46 974.18,-297.26 994.6,-330.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="991.81,-333.11 999.91,-339.94 997.84,-329.55 991.81,-333.11"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="281,-150 187,-150 187,-126 281,-126 281,-150"/>
<text text-anchor="middle" x="234" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.92,-850.92C44.1,-762.07 65.73,-211.89 115,-159 130.56,-142.3 154.45,-136.06 176.68,-134.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="176.91,-137.87 186.74,-133.9 176.58,-130.87 176.91,-137.87"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="278,-108 190,-108 190,-84 278,-84 278,-108"/>
<text text-anchor="middle" x="234" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.85,-850.79C43.57,-758.55 62.87,-173.28 115,-117 131.26,-99.45 156.72,-93.42 179.83,-92.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="180.01,-95.61 189.9,-91.82 179.8,-88.62 180.01,-95.61"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1473,-1221 1381,-1221 1381,-1197 1473,-1197 1473,-1221"/>
<text text-anchor="middle" x="1427" y="-1206.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.7,-875.24C42.44,-971.7 56.04,-1607.04 115,-1665 173.8,-1722.81 402.54,-1693 485,-1693 485,-1693 485,-1693 1008.5,-1693 1158.61,-1693 1234.18,-1765.25 1345,-1664 1409.84,-1604.76 1423.02,-1314.06 1425.48,-1231.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1428.98,-1231.14 1425.75,-1221.05 1421.98,-1230.95 1428.98,-1231.14"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="781.5,-896 707.5,-896 707.5,-872 781.5,-872 781.5,-896"/>
<text text-anchor="middle" x="744.5" y="-881.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M79.05,-864.15C199.28,-867.74 567.16,-878.73 697.29,-882.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="697.23,-886.12 707.33,-882.92 697.44,-879.12 697.23,-886.12"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="333.5,-318 134.5,-318 134.5,-294 333.5,-294 333.5,-318"/>
<text text-anchor="middle" x="234" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.34,-850.9C39.64,-778.69 39.74,-405.17 115,-327 118.21,-323.66 121.76,-320.75 125.55,-318.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="127.31,-321.24 134.24,-313.22 123.82,-315.17 127.31,-321.24"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1272,-1432 1218,-1432 1218,-1408 1272,-1408 1272,-1432"/>
<text text-anchor="middle" x="1245" y="-1417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M40.36,-875.03C39.79,-945.17 40.65,-1300.82 115,-1372 195.54,-1449.11 1023.44,-1427.12 1207.76,-1421.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1208.12,-1424.72 1218,-1420.9 1207.89,-1417.72 1208.12,-1424.72"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="785.5,-1106 703.5,-1106 703.5,-1082 785.5,-1082 785.5,-1106"/>
<text text-anchor="middle" x="744.5" y="-1091.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M42.4,-875.04C47.77,-904.61 65.97,-980.95 115,-1016 207.54,-1082.14 561.02,-1092.32 693.22,-1093.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="693.42,-1097.29 703.46,-1093.89 693.49,-1090.29 693.42,-1097.29"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="531.5,-1011 440.5,-1011 440.5,-987 531.5,-987 531.5,-1011"/>
<text text-anchor="middle" x="486" y="-996.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M43.98,-875.08C51.88,-900.04 73.77,-956.95 115,-981 213.88,-1038.69 354.15,-1024.85 430.43,-1011.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="431.13,-1014.5 440.31,-1009.22 429.84,-1007.62 431.13,-1014.5"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="555,-1349 417,-1349 417,-1325 555,-1325 555,-1349"/>
<text text-anchor="middle" x="486" y="-1334.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.93,-875.27C43.35,-936.94 57.29,-1212.4 115,-1270 191.26,-1346.11 322.97,-1351.93 406.94,-1346.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="407.22,-1349.95 416.94,-1345.74 406.71,-1342.97 407.22,-1349.95"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="863.5,-1312 625.5,-1312 625.5,-1288 863.5,-1288 863.5,-1312"/>
<text text-anchor="middle" x="744.5" y="-1297.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M39.97,-875.09C38.85,-916.71 41.03,-1055.51 115,-1127 269.01,-1275.85 397.13,-1135.57 583,-1242 602.91,-1253.4 598.68,-1268.34 619,-1279 622.77,-1280.98 626.68,-1282.77 630.69,-1284.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="629.62,-1287.74 640.21,-1287.93 632.05,-1281.18 629.62,-1287.74"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-753 430,-753 430,-729 542,-729 542,-753"/>
<text text-anchor="middle" x="486" y="-738.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M50.42,-850.88C63.52,-835.8 88.07,-810.52 115,-798 214.21,-751.88 342.93,-741.77 419.45,-740.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="419.95,-743.74 429.89,-740.09 419.84,-736.74 419.95,-743.74"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="280.5,-66 187.5,-66 187.5,-42 280.5,-42 280.5,-66"/>
<text text-anchor="middle" x="234" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.78,-850.72C43.07,-755.31 60.01,-134.69 115,-75 130.59,-58.08 154.72,-51.86 177.11,-50.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.4,-53.74 187.24,-49.81 177.1,-46.75 177.4,-53.74"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1069.5,-871 945.5,-871 945.5,-847 1069.5,-847 1069.5,-871"/>
<text text-anchor="middle" x="1007.5" y="-856.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M79.16,-861.78C90.69,-861.47 103.36,-861.17 115,-861 420.21,-856.56 784.26,-857.77 935.35,-858.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="935.41,-862.07 945.43,-858.62 935.45,-855.07 935.41,-862.07"/>
</g>
<!-- proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~count_open_channels_in_block</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/count_open_channels_in_block.html" xlink:title="count_open_channels_in_block">
<polygon fill="#d94e8f" stroke="#d94e8f" points="574.5,-1471 397.5,-1471 397.5,-1447 574.5,-1447 574.5,-1471"/>
<text text-anchor="middle" x="486" y="-1456.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_channels_in_block</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_channels_in_block -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_channels_in_block</title>
<path fill="none" stroke="#ff0000" d="M41.17,-875.01C45.68,-953.66 72.68,-1393.14 115,-1433 152.97,-1468.77 291.08,-1469.68 387.36,-1465.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="387.59,-1469.02 397.42,-1465.06 387.27,-1462.02 387.59,-1469.02"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="523,-282 449,-282 449,-258 523,-258 523,-282"/>
<text text-anchor="middle" x="486" y="-267.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M41.45,-850.81C45.96,-796.24 67,-575.08 115,-529 192.54,-454.56 276.85,-561.86 353,-486 415.44,-423.8 327.71,-354.33 389,-291 401.79,-277.78 420.84,-271.97 438.61,-269.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="439.24,-273.13 448.86,-268.7 438.58,-266.16 439.24,-273.13"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="542,-602 430,-602 430,-578 542,-578 542,-602"/>
<text text-anchor="middle" x="486" y="-587.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M39.84,-850.93C38.35,-810.09 39.58,-676.24 115,-616 160.46,-579.68 326.14,-581.68 419.63,-586"/>
<polygon fill="#ff0000" stroke="#ff0000" points="419.68,-589.51 429.83,-586.5 420.02,-582.52 419.68,-589.51"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="261,-24 207,-24 207,0 261,0 261,-24"/>
<text text-anchor="middle" x="234" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M40.72,-850.7C42.58,-752.36 57.13,-96.11 115,-33 135.3,-10.86 170.22,-7.01 196.82,-7.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.74,-11.37 206.92,-8.42 197.13,-4.38 196.74,-11.37"/>
</g>
<!-- proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~print_largest_partial_cross_sections</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/print_largest_partial_cross_sections.html" xlink:title="print_largest_partial_cross_sections">
<polygon fill="#d9534f" stroke="#d9534f" points="1345,-1626 1145,-1626 1145,-1602 1345,-1602 1345,-1626"/>
<text text-anchor="middle" x="1245" y="-1611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_cross_sections</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_cross_sections -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_cross_sections</title>
<path fill="none" stroke="#ff0000" d="M40.91,-875.08C43.97,-962.72 64.73,-1498.89 115,-1548 151.11,-1583.28 858.17,-1604.48 1134.58,-1611.44"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1134.55,-1614.94 1144.63,-1611.7 1134.72,-1607.95 1134.55,-1614.94"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1280,-949 1210,-949 1210,-925 1280,-925 1280,-949"/>
<text text-anchor="middle" x="1245" y="-934.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_space_fixed_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~set_space_fixed_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff2800" d="M1038.97,-658.11C1060.48,-667.81 1088.93,-683.07 1109,-703 1174.33,-767.85 1218.84,-870.8 1236.05,-915.32"/>
<polygon fill="#ff2800" stroke="#ff2800" points="1232.84,-916.74 1239.66,-924.85 1239.39,-914.25 1232.84,-916.74"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff5000" d="M785.19,-922.34C810.01,-919.32 842.39,-914.01 870,-905 887.01,-899.45 889.31,-893.43 906,-887 918.85,-882.05 932.94,-877.57 946.39,-873.72"/>
<polygon fill="#ff5000" stroke="#ff5000" points="947.35,-877.08 956.04,-871.02 945.47,-870.34 947.35,-877.08"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff5000" d="M785.06,-924.67C851.86,-922.71 991.26,-919.78 1109,-925 1139.4,-926.35 1173.54,-929.4 1199.88,-932.08"/>
<polygon fill="#ff5000" stroke="#ff5000" points="1199.62,-935.58 1209.93,-933.13 1200.35,-928.61 1199.62,-935.58"/>
</g>
<!-- proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~read_radial_coupling_terms&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ffa100" d="M314.17,-954.71C420.24,-947.61 605.32,-935.24 693.73,-929.33"/>
<polygon fill="#ffa100" stroke="#ffa100" points="694.02,-932.82 703.76,-928.66 693.55,-925.83 694.02,-932.82"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="771.5,-1510 717.5,-1510 717.5,-1486 771.5,-1486 771.5,-1510"/>
<text text-anchor="middle" x="744.5" y="-1495.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ffc900" d="M305.7,-1497.14C415.62,-1497.36 623.53,-1497.76 707.23,-1497.93"/>
<polygon fill="#ffc900" stroke="#ffc900" points="707.27,-1501.43 717.28,-1497.95 707.28,-1494.43 707.27,-1501.43"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#e4ff00" d="M533.15,-1128.44C578.21,-1121.07 646.58,-1109.87 693.05,-1102.26"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="693.9,-1105.67 703.2,-1100.6 692.77,-1098.76 693.9,-1105.67"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="841,-1228 648,-1228 648,-1204 841,-1204 841,-1228"/>
<text text-anchor="middle" x="744.5" y="-1213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#e4ff00" d="M512.78,-1148.19C539.03,-1160.21 581.12,-1178.4 619,-1190 633.64,-1194.48 649.47,-1198.44 664.79,-1201.83"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="664.25,-1205.3 674.76,-1203.98 665.72,-1198.46 664.25,-1205.3"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="840.5,-1148 648.5,-1148 648.5,-1124 840.5,-1124 840.5,-1148"/>
<text text-anchor="middle" x="744.5" y="-1133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#e4ff00" d="M533.15,-1136C562.42,-1136 601.53,-1136 638.08,-1136"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="638.31,-1139.5 648.31,-1136 638.31,-1132.5 638.31,-1139.5"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="870,-1270 619,-1270 619,-1246 870,-1246 870,-1270"/>
<text text-anchor="middle" x="744.5" y="-1255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#e4ff00" d="M522.51,-1148.14C541.88,-1155.97 565.41,-1167.6 583,-1183 604.7,-1202 594.79,-1221.31 619,-1237 621.5,-1238.62 624.09,-1240.13 626.74,-1241.53"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="625.48,-1244.8 636.01,-1245.9 628.46,-1238.47 625.48,-1244.8"/>
</g>
<!-- proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~zero_projections_3j_condition</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/zero_projections_3j_condition.html" xlink:title="zero_projections_3j_condition">
<polygon fill="#d94e8f" stroke="#d94e8f" points="829,-160 660,-160 660,-136 829,-136 829,-160"/>
<text text-anchor="middle" x="744.5" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zero_projections_3j_condition</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#bbff00" d="M340.27,-335.92C344.8,-333.38 349.08,-330.42 353,-327 392.38,-292.6 349.8,-249.61 389,-215 408.46,-197.82 551.42,-174.79 649.74,-160.69"/>
<polygon fill="#bbff00" stroke="#bbff00" points="650.3,-164.15 659.71,-159.27 649.31,-157.22 650.3,-164.15"/>
</g>
<!-- proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~calculate_state_to_state_cross_section&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#93ff00" d="M314.1,-1627.02C345.46,-1631.79 381.3,-1637.24 412.03,-1641.91"/>
<polygon fill="#93ff00" stroke="#93ff00" points="411.82,-1645.42 422.24,-1643.46 412.88,-1638.5 411.82,-1645.42"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#1aff00" d="M264.03,-550.83C290.73,-549.96 329.63,-544.32 353,-521 400.01,-474.1 337.5,-417.91 389,-376 431.13,-341.71 793.03,-346.65 942.42,-350.22"/>
<polygon fill="#1aff00" stroke="#1aff00" points="942.72,-353.72 952.8,-350.47 942.89,-346.73 942.72,-353.72"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#1aff00" d="M264.19,-550.44C290.62,-549.26 329.01,-543.37 353,-521 391.24,-485.34 346.75,-439.8 389,-409 432.19,-377.52 826.64,-377.75 870,-409 911.05,-438.58 873.34,-478.36 906,-517 971.98,-595.04 1019.37,-575.91 1109,-625 1214.6,-682.83 1275.27,-659.85 1345,-758 1395.16,-828.61 1418.59,-1105.42 1424.48,-1186.54"/>
<polygon fill="#1aff00" stroke="#1aff00" points="1420.99,-1186.92 1425.19,-1196.65 1427.98,-1186.43 1420.99,-1186.92"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#1aff00" d="M264.18,-552.12C291.19,-552.35 330.46,-548.02 353,-524 424.7,-447.59 317.24,-367.36 389,-291 401.6,-277.59 420.62,-271.76 438.41,-269.49"/>
<polygon fill="#1aff00" stroke="#1aff00" points="439.06,-272.94 448.69,-268.54 438.41,-265.97 439.06,-272.94"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="808,-484 681,-484 681,-460 808,-460 808,-484"/>
<text text-anchor="middle" x="744.5" y="-469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#1aff00" d="M264.19,-548.05C289.07,-545.37 325.11,-539.02 353,-524 372.65,-513.42 368.53,-497.89 389,-489 479.96,-449.51 596.65,-452.95 670.77,-460.95"/>
<polygon fill="#1aff00" stroke="#1aff00" points="670.61,-464.46 680.94,-462.11 671.4,-457.5 670.61,-464.46"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="536.5,-442 435.5,-442 435.5,-418 536.5,-418 536.5,-442"/>
<text text-anchor="middle" x="486" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#1aff00" d="M264.03,-550.22C289.81,-549 327.29,-543.56 353,-524 380.22,-503.29 362.29,-477.35 389,-456 399.43,-447.67 412.31,-442 425.21,-438.14"/>
<polygon fill="#1aff00" stroke="#1aff00" points="426.28,-441.48 435.05,-435.53 424.48,-434.71 426.28,-441.48"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="559,-522 413,-522 413,-498 559,-498 559,-522"/>
<text text-anchor="middle" x="486" y="-507.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#1aff00" d="M264.17,-545.33C297.96,-539.93 355.1,-530.78 402.79,-523.15"/>
<polygon fill="#1aff00" stroke="#1aff00" points="403.49,-526.59 412.81,-521.55 402.38,-519.67 403.49,-526.59"/>
</g>
<!-- proc~centrifugal_matrix -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~centrifugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/centrifugal_matrix.html" xlink:title="centrifugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="541,-324 431,-324 431,-300 541,-300 541,-324"/>
<text text-anchor="middle" x="486" y="-309.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">centrifugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~centrifugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~numerov&#45;&gt;proc~centrifugal_matrix</title>
<path fill="none" stroke="#1aff00" d="M264.24,-551.92C291.09,-551.99 330.09,-547.51 353,-524 411.77,-463.7 331.68,-399.68 389,-338 397.58,-328.77 409.07,-322.69 421.11,-318.71"/>
<polygon fill="#1aff00" stroke="#1aff00" points="422.18,-322.05 430.85,-315.95 420.27,-315.31 422.18,-322.05"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="817,-526 672,-526 672,-502 817,-502 817,-526"/>
<text text-anchor="middle" x="744.5" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#1aff00" d="M264.37,-548.9C324.32,-546.55 465.09,-540.46 583,-531 608.53,-528.95 636.29,-526.2 661.43,-523.51"/>
<polygon fill="#1aff00" stroke="#1aff00" points="662.1,-526.95 671.67,-522.4 661.35,-520 662.1,-526.95"/>
</g>
<!-- proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>proc~wavenumber_squared_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././proc/wavenumber_squared_from_energy.html" xlink:title="wavenumber_squared_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1109,-1394 906,-1394 906,-1370 1109,-1370 1109,-1394"/>
<text text-anchor="middle" x="1007.5" y="-1379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_squared_from_energy</text>
</a>
</g>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#00ff0d" d="M567.47,-1391.03C584.45,-1393.1 602.28,-1394.93 619,-1396 730.33,-1403.14 758.59,-1401.7 870,-1396 878.38,-1395.57 887.04,-1395 895.74,-1394.32"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="896.27,-1397.79 905.95,-1393.49 895.7,-1390.81 896.27,-1397.79"/>
</g>
<!-- proc~calculate_largest_wavenumber&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~calculate_largest_wavenumber&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ff0d" d="M513.01,-1391.07C559.29,-1412.54 655.98,-1457.4 708.21,-1481.63"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="706.88,-1484.87 717.43,-1485.9 709.83,-1478.52 706.88,-1484.87"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff35" d="M830.74,-1346C950.33,-1348.52 1172.56,-1341.85 1345,-1271 1368.85,-1261.2 1391.78,-1242.49 1407.11,-1228.17"/>
<polygon fill="#00ff35" stroke="#00ff35" points="1409.62,-1230.61 1414.4,-1221.16 1404.77,-1225.57 1409.62,-1230.61"/>
</g>
<!-- proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~reduce_radial_coupling_terms&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff35" d="M830.51,-1342.16C845.31,-1338.43 859.36,-1331.9 870,-1321 909.07,-1281 889.89,-1125.54 906,-1072 928.17,-998.32 972.05,-917.86 993.75,-880.41"/>
<polygon fill="#00ff35" stroke="#00ff35" points="996.97,-881.83 999,-871.44 990.93,-878.3 996.97,-881.83"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~print_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff86" d="M531.95,-1549.89C672.54,-1581.03 1108.58,-1655.12 1345,-1441 1407.37,-1384.51 1421.71,-1277.35 1425.01,-1231.13"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1428.52,-1231.2 1425.63,-1221 1421.53,-1230.77 1428.52,-1231.2"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~print_channels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#00ff86" d="M531.58,-1546.61C605.56,-1557.12 756.75,-1569.53 870,-1519 926.37,-1493.85 972.18,-1434.16 993.52,-1402.52"/>
<polygon fill="#00ff86" stroke="#00ff86" points="996.53,-1404.3 999.11,-1394.03 990.69,-1400.45 996.53,-1404.3"/>
</g>
<!-- proc~print_channels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~print_channels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#00ff86" d="M531.68,-1531.86C581.48,-1523.9 661.06,-1511.18 707.19,-1503.8"/>
<polygon fill="#00ff86" stroke="#00ff86" points="708.01,-1507.22 717.33,-1502.18 706.9,-1500.31 708.01,-1507.22"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="771.5,-816 717.5,-816 717.5,-792 771.5,-792 771.5,-816"/>
<text text-anchor="middle" x="744.5" y="-801.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~interpolate_radial_coupling_terms&#45;&gt;proc~spline</title>
<path fill="none" stroke="#00ffae" d="M583.24,-804C626.54,-804 675.03,-804 707.22,-804"/>
<polygon fill="#00ffae" stroke="#00ffae" points="707.48,-807.5 717.48,-804 707.48,-800.5 707.48,-807.5"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ffd6" d="M549.64,-1656.14C737.16,-1664.92 1284.77,-1685.93 1345,-1635 1407.46,-1582.18 1422.25,-1312.06 1425.29,-1231.63"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="1428.8,-1231.3 1425.66,-1221.18 1421.81,-1231.06 1428.8,-1231.3"/>
</g>
<!-- proc~process_single_matrix_element -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~process_single_matrix_element</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/process_single_matrix_element.html" xlink:title="process_single_matrix_element">
<polygon fill="#d9534f" stroke="#d9534f" points="575.5,-160 396.5,-160 396.5,-136 575.5,-136 575.5,-160"/>
<text text-anchor="middle" x="486" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">process_single_matrix_element</text>
</a>
</g>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~process_single_matrix_element -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~process_single_matrix_element</title>
<path fill="none" stroke="#0035ff" d="M333.56,-297.28C340.59,-294.08 347.19,-290.05 353,-285 391.83,-251.26 351.87,-210.6 389,-175 393.24,-170.93 398.05,-167.47 403.2,-164.52"/>
<polygon fill="#0035ff" stroke="#0035ff" points="404.77,-167.64 412.14,-160.03 401.63,-161.39 404.77,-167.64"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#1a00ff" d="M785.54,-1097.48C810.35,-1100.43 842.59,-1105.72 870,-1115 887.14,-1120.8 888.8,-1128.4 906,-1134 1069.41,-1187.14 1273.91,-1202.69 1370.54,-1207.19"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="1370.52,-1210.69 1380.66,-1207.64 1370.83,-1203.7 1370.52,-1210.69"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#1a00ff" d="M785.63,-1101.1C868.03,-1114.89 1053.21,-1141.62 1109,-1114 1175.59,-1081.04 1218.31,-997.75 1235.45,-958.32"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="1238.68,-959.66 1239.34,-949.08 1232.23,-956.94 1238.68,-959.66"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1054.5,-1105 960.5,-1105 960.5,-1081 1054.5,-1081 1054.5,-1105"/>
<text text-anchor="middle" x="1007.5" y="-1090.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#1a00ff" d="M785.71,-1093.85C829.63,-1093.68 900.31,-1093.41 949.84,-1093.22"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="950.09,-1096.72 960.07,-1093.18 950.06,-1089.72 950.09,-1096.72"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#4300ff" d="M531.68,-990.44C548.27,-986.36 566.95,-980.66 583,-973 600.81,-964.5 600.79,-954.62 619,-947 642.52,-937.16 670.36,-931.93 693.74,-929.15"/>
<polygon fill="#4300ff" stroke="#4300ff" points="694.23,-932.61 703.8,-928.06 693.49,-925.65 694.23,-932.61"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#4300ff" d="M499.65,-986.91C521.85,-966.45 570.14,-925.25 619,-905 643.81,-894.72 673.38,-889.47 697.48,-886.79"/>
<polygon fill="#4300ff" stroke="#4300ff" points="697.84,-890.27 707.44,-885.79 697.14,-883.3 697.84,-890.27"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="782.5,-1064 706.5,-1064 706.5,-1040 782.5,-1040 782.5,-1064"/>
<text text-anchor="middle" x="744.5" y="-1049.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#4300ff" d="M531.73,-1010.68C557.21,-1017.12 589.78,-1025 619,-1031 644.44,-1036.22 672.99,-1041.11 696.34,-1044.85"/>
<polygon fill="#4300ff" stroke="#4300ff" points="695.9,-1048.33 706.33,-1046.43 697,-1041.41 695.9,-1048.33"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="781.5,-1022 707.5,-1022 707.5,-998 781.5,-998 781.5,-1022"/>
<text text-anchor="middle" x="744.5" y="-1007.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#4300ff" d="M531.68,-1000.92C577.98,-1002.9 650.03,-1005.99 697,-1008.01"/>
<polygon fill="#4300ff" stroke="#4300ff" points="697.06,-1011.51 707.2,-1008.44 697.36,-1004.52 697.06,-1011.51"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="792,-980 697,-980 697,-956 792,-956 792,-980"/>
<text text-anchor="middle" x="744.5" y="-965.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#4300ff" d="M531.68,-993.6C574.74,-988.4 640.06,-980.5 686.77,-974.86"/>
<polygon fill="#4300ff" stroke="#4300ff" points="687.23,-978.33 696.73,-973.65 686.39,-971.38 687.23,-978.33"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#6b00ff" d="M538.76,-1349.01C562.99,-1354.16 592.34,-1359.74 619,-1363 711.78,-1374.35 817.83,-1378.98 895.51,-1380.84"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="895.72,-1384.34 905.8,-1381.07 895.88,-1377.34 895.72,-1384.34"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#6b00ff" d="M555.24,-1346.6C564.91,-1349.46 574.46,-1353.18 583,-1358 603.26,-1369.44 601.97,-1380.15 619,-1396 652.27,-1426.95 693.51,-1459.74 719.17,-1479.54"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="717.17,-1482.42 727.24,-1485.74 721.44,-1476.87 717.17,-1482.42"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#9300ff" d="M863.63,-1297.41C985.66,-1292.59 1180.88,-1278.88 1345,-1240 1360.36,-1236.36 1376.72,-1230.51 1390.68,-1224.86"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1392.04,-1228.08 1399.93,-1221.01 1389.35,-1221.62 1392.04,-1228.08"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#9300ff" d="M858.83,-1287.96C862.83,-1285.37 866.58,-1282.4 870,-1279 936.2,-1213.14 877.82,-1161.03 906,-1072 929.33,-998.28 973.03,-917.25 994.28,-879.93"/>
<polygon fill="#9300ff" stroke="#9300ff" points="997.46,-881.43 999.4,-871.01 991.39,-877.94 997.46,-881.43"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#bb00ff" d="M540.36,-753.04C556.52,-759.32 572.7,-768.79 583,-783 632,-850.61 561.58,-1096.38 619,-1157 696.59,-1238.92 773.53,-1136.48 870,-1195 904.1,-1215.68 967.35,-1316.66 994.07,-1361.03"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="991.2,-1363.04 999.34,-1369.82 997.21,-1359.45 991.2,-1363.04"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="814.5,-648 674.5,-648 674.5,-624 814.5,-624 814.5,-648"/>
<text text-anchor="middle" x="744.5" y="-633.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#bb00ff" d="M501.76,-728.75C525.09,-710.09 572.6,-674.83 619,-657 633.27,-651.52 649,-647.46 664.34,-644.47"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="665.13,-647.88 674.34,-642.65 663.88,-640.99 665.13,-647.88"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="792.5,-774 696.5,-774 696.5,-750 792.5,-750 792.5,-774"/>
<text text-anchor="middle" x="744.5" y="-759.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#bb00ff" d="M542.03,-745.51C584.54,-748.99 643.21,-753.79 686.27,-757.31"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="686.06,-760.81 696.31,-758.14 686.63,-753.83 686.06,-760.81"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="791,-690 698,-690 698,-666 791,-666 791,-690"/>
<text text-anchor="middle" x="744.5" y="-675.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#bb00ff" d="M520.27,-728.98C546.74,-719.76 584.88,-707.26 619,-699 641.35,-693.59 666.28,-689.09 687.93,-685.66"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="688.6,-689.1 697.95,-684.11 687.53,-682.18 688.6,-689.1"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="771.5,-732 717.5,-732 717.5,-708 771.5,-708 771.5,-732"/>
<text text-anchor="middle" x="744.5" y="-717.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#bb00ff" d="M542.03,-736.49C591.93,-732.41 664.09,-726.5 707.15,-722.98"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="707.49,-726.46 717.17,-722.16 706.92,-719.48 707.49,-726.46"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#bb00ff" d="M541.15,-753.04C557.16,-759.3 573.04,-768.76 583,-783 657,-888.83 568.3,-1244.23 619,-1363 640.3,-1412.91 688.31,-1456.13 718.1,-1479.49"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="716.28,-1482.5 726.34,-1485.82 720.54,-1476.95 716.28,-1482.5"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="771.5,-568 717.5,-568 717.5,-544 771.5,-544 771.5,-568"/>
<text text-anchor="middle" x="744.5" y="-553.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#bb00ff" d="M497.24,-728.91C518.15,-704.79 568.09,-650 619,-615 646.96,-595.77 682.17,-579.74 708,-569.26"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="709.41,-572.47 717.41,-565.52 706.83,-565.96 709.41,-572.47"/>
</g>
<!-- proc~count_open_channels_in_block&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~count_open_channels_in_block&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff00c9" d="M566.05,-1471.02C613.08,-1478.17 670.5,-1486.9 707.04,-1492.46"/>
<polygon fill="#ff00c9" stroke="#ff00c9" points="706.81,-1495.96 717.22,-1494 707.86,-1489.04 706.81,-1495.96"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff0078" d="M510.23,-577.98C530.4,-567.02 559.91,-549.74 583,-531 601.06,-516.34 598.47,-503.94 619,-493 634.68,-484.64 652.92,-479.47 670.53,-476.3"/>
<polygon fill="#ff0078" stroke="#ff0078" points="671.47,-479.7 680.79,-474.66 670.36,-472.79 671.47,-479.7"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ff0078" d="M542.03,-579.27C555.83,-575.47 570.31,-570.47 583,-564 601.31,-554.67 600.26,-543.43 619,-535 632.32,-529.01 647.14,-524.72 661.77,-521.64"/>
<polygon fill="#ff0078" stroke="#ff0078" points="662.7,-525.03 671.86,-519.7 661.38,-518.15 662.7,-525.03"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ff0078" d="M542.03,-582.71C591.93,-576.09 664.09,-566.53 707.15,-560.82"/>
<polygon fill="#ff0078" stroke="#ff0078" points="707.72,-564.27 717.17,-559.49 706.8,-557.33 707.72,-564.27"/>
</g>
<!-- proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~print_largest_partial_cross_sections&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0028" d="M1325.64,-1601.92C1332.84,-1598.34 1339.48,-1593.78 1345,-1588 1394.84,-1535.8 1418.03,-1304.95 1424.23,-1231.51"/>
<polygon fill="#ff0028" stroke="#ff0028" points="1427.76,-1231.38 1425.09,-1221.13 1420.78,-1230.81 1427.76,-1231.38"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1080,-160 935,-160 935,-136 1080,-136 1080,-160"/>
<text text-anchor="middle" x="1007.5" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ff0000" d="M829.16,-148C859.7,-148 894.19,-148 924.58,-148"/>
<polygon fill="#ff0000" stroke="#ff0000" points="924.72,-151.5 934.72,-148 924.72,-144.5 924.72,-151.5"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1047.5,-202 967.5,-202 967.5,-178 1047.5,-178 1047.5,-202"/>
<text text-anchor="middle" x="1007.5" y="-187.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~zero_projections_3j_condition&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ff0000" d="M820.29,-160.04C864.26,-167.11 918.63,-175.86 957.23,-182.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="956.76,-185.54 967.19,-183.67 957.87,-178.63 956.76,-185.54"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff4200" d="M771.74,-809.45C796.94,-814.69 836.08,-822.85 870,-830 892.82,-834.81 917.78,-840.1 940.04,-844.83"/>
<polygon fill="#ff4200" stroke="#ff4200" points="939.55,-848.31 950.06,-846.96 941.01,-841.46 939.55,-848.31"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff4200" d="M771.68,-801.8C832.96,-797.63 989.61,-792.65 1109,-838 1155.83,-855.79 1200.79,-894.5 1225.18,-917.89"/>
<polygon fill="#ff4200" stroke="#ff4200" points="1222.75,-920.42 1232.35,-924.91 1227.64,-915.41 1222.75,-920.42"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff8500" d="M1280.2,-937.97C1301.34,-940.33 1327.65,-946.69 1345,-963 1410.04,-1024.17 1422.92,-1138.46 1425.42,-1186.66"/>
<polygon fill="#ff8500" stroke="#ff8500" points="1421.93,-1187.06 1425.84,-1196.91 1428.93,-1186.78 1421.93,-1187.06"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#f3ff00" d="M1083.01,-1394.02C1124.6,-1400.73 1174.54,-1408.79 1207.66,-1414.14"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1207.35,-1417.63 1217.78,-1415.77 1208.47,-1410.72 1207.35,-1417.63"/>
</g>
<!-- proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~wavenumber_squared_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#f3ff00" d="M1015.04,-1369.63C1047.53,-1308.25 1191.54,-1036.12 1232.87,-958.02"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1236.01,-959.57 1237.6,-949.1 1229.83,-956.3 1236.01,-959.57"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#2cff00" d="M536.76,-438.15C574.79,-444.38 627.79,-453.05 670.61,-460.06"/>
<polygon fill="#2cff00" stroke="#2cff00" points="670.26,-463.55 680.7,-461.72 671.39,-456.65 670.26,-463.55"/>
</g>
<!-- proc~calculate_single_pes_matrix_element -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~calculate_single_pes_matrix_element</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/calculate_single_pes_matrix_element.html" xlink:title="calculate_single_pes_matrix_element">
<polygon fill="#d94e8f" stroke="#d94e8f" points="850,-442 639,-442 639,-418 850,-418 850,-442"/>
<text text-anchor="middle" x="744.5" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_single_pes_matrix_element</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~calculate_single_pes_matrix_element -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~calculate_single_pes_matrix_element</title>
<path fill="none" stroke="#2cff00" d="M536.76,-430C562.99,-430 596.33,-430 628.54,-430"/>
<polygon fill="#2cff00" stroke="#2cff00" points="628.95,-433.5 638.95,-430 628.95,-426.5 628.95,-433.5"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff16" d="M814.56,-634.14C834.51,-636.91 854.94,-643.42 870,-657 914.52,-697.15 871.67,-737.85 906,-787 922.67,-810.87 949.88,-829.65 971.79,-842.04"/>
<polygon fill="#00ff16" stroke="#00ff16" points="970.35,-845.25 980.81,-846.96 973.7,-839.1 970.35,-845.25"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1051,-736 964,-736 964,-712 1051,-712 1051,-736"/>
<text text-anchor="middle" x="1007.5" y="-721.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ff16" d="M814.52,-644C832.81,-647.1 852.37,-651.32 870,-657 908.88,-669.53 950.64,-691.39 977.58,-706.73"/>
<polygon fill="#00ff16" stroke="#00ff16" points="976.06,-709.89 986.47,-711.85 979.55,-703.83 976.06,-709.89"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="1034.5,-466 980.5,-466 980.5,-442 1034.5,-442 1034.5,-466"/>
<text text-anchor="middle" x="1007.5" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#00ff16" d="M791.16,-623.97C817.4,-614.95 849.18,-600.09 870,-577 902.19,-541.3 869.82,-506.65 906,-475 923.44,-459.74 949.1,-454.56 970.12,-453.16"/>
<polygon fill="#00ff16" stroke="#00ff16" points="970.46,-456.65 980.31,-452.75 970.18,-449.66 970.46,-456.65"/>
</g>
<!-- proc~process_single_matrix_element&#45;&gt;proc~zero_projections_3j_condition -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~process_single_matrix_element&#45;&gt;proc~zero_projections_3j_condition</title>
<path fill="none" stroke="#00ff58" d="M575.63,-148C599.45,-148 625.29,-148 649.4,-148"/>
<polygon fill="#00ff58" stroke="#00ff58" points="649.61,-151.5 659.61,-148 649.61,-144.5 649.61,-151.5"/>
</g>
<!-- proc~percival_seaton_coefficient -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~percival_seaton_coefficient</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/percival_seaton_coefficient.html" xlink:title="percival_seaton_coefficient">
<polygon fill="#d94e8f" stroke="#d94e8f" points="823.5,-118 665.5,-118 665.5,-94 823.5,-94 823.5,-118"/>
<text text-anchor="middle" x="744.5" y="-103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">percival_seaton_coefficient</text>
</a>
</g>
</g>
<!-- proc~process_single_matrix_element&#45;&gt;proc~percival_seaton_coefficient -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~process_single_matrix_element&#45;&gt;proc~percival_seaton_coefficient</title>
<path fill="none" stroke="#00ff58" d="M560.5,-135.96C591.49,-130.89 627.73,-124.96 659.75,-119.71"/>
<polygon fill="#00ff58" stroke="#00ff58" points="660.68,-123.11 669.99,-118.04 659.55,-116.2 660.68,-123.11"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff9b" d="M782.74,-1049.79C849.26,-1046.77 992.42,-1044.53 1109,-1072 1220.43,-1098.26 1342,-1161.57 1396.59,-1192.05"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1394.94,-1195.14 1405.37,-1196.99 1398.37,-1189.04 1394.94,-1195.14"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff9b" d="M782.62,-1055.21C809.83,-1055.52 846.05,-1051.39 870,-1031 907.89,-998.75 875.55,-964.35 906,-925 922.58,-903.57 948.18,-886.91 969.4,-875.68"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="971.16,-878.71 978.48,-871.06 967.98,-872.48 971.16,-878.71"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff9b" d="M782.69,-1046.52C807.51,-1042.66 840.82,-1037.12 870,-1031 990.38,-1005.76 1130.59,-968.34 1200.18,-949.21"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1201.21,-952.56 1209.92,-946.53 1199.35,-945.81 1201.21,-952.56"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#00ff9b" d="M782.62,-1057.83C826.33,-1064.7 899.4,-1076.18 950.12,-1084.14"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="949.85,-1087.64 960.27,-1085.74 950.93,-1080.73 949.85,-1087.64"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ffdd" d="M792.56,-766.11C816.27,-769.13 845.18,-774.29 870,-783 911.16,-797.45 954.47,-823.74 980.99,-841.29"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="979.06,-844.21 989.32,-846.87 982.96,-838.39 979.06,-844.21"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#00ffdd" d="M792.77,-755.12C838.2,-748.5 906.74,-738.52 953.89,-731.66"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="954.52,-735.11 963.91,-730.2 953.51,-728.18 954.52,-735.11"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="1034.5,-778 980.5,-778 980.5,-754 1034.5,-754 1034.5,-778"/>
<text text-anchor="middle" x="1007.5" y="-763.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#00ffdd" d="M792.77,-762.72C843.74,-763.51 923.78,-764.73 970.09,-765.44"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="970.21,-768.94 980.26,-765.6 970.32,-761.94 970.21,-768.94"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ddff" d="M559.13,-499.31C593.93,-494.16 635.59,-487.99 670.49,-482.82"/>
<polygon fill="#00ddff" stroke="#00ddff" points="671.24,-486.24 680.62,-481.32 670.22,-479.32 671.24,-486.24"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00ddff" d="M559.13,-511.12C591.09,-511.62 628.84,-512.21 661.83,-512.73"/>
<polygon fill="#00ddff" stroke="#00ddff" points="661.86,-516.23 671.91,-512.88 661.97,-509.23 661.86,-516.23"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ddff" d="M549.07,-522.02C571.13,-526.22 596.16,-530.91 619,-535 648.64,-540.31 682.32,-545.96 707.17,-550.07"/>
<polygon fill="#00ddff" stroke="#00ddff" points="706.81,-553.56 717.24,-551.73 707.94,-546.65 706.81,-553.56"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0058ff" d="M791.02,-675.34C816.72,-676.18 848.01,-681.4 870,-699 903,-725.4 879.8,-753.84 906,-787 924.28,-810.13 951.88,-829.17 973.54,-841.85"/>
<polygon fill="#0058ff" stroke="#0058ff" points="971.98,-844.99 982.41,-846.89 975.44,-838.91 971.98,-844.99"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0058ff" d="M791.06,-685.53C814.64,-689.46 843.88,-694.41 870,-699 897.63,-703.86 928.37,-709.47 953.67,-714.15"/>
<polygon fill="#0058ff" stroke="#0058ff" points="953.33,-717.64 963.8,-716.02 954.6,-710.76 953.33,-717.64"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="1034.5,-508 980.5,-508 980.5,-484 1034.5,-484 1034.5,-508"/>
<text text-anchor="middle" x="1007.5" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#0058ff" d="M791.23,-677.78C815.94,-675.88 846.19,-670.55 870,-657 900.81,-639.47 963.02,-556.47 991.57,-516.98"/>
<polygon fill="#0058ff" stroke="#0058ff" points="994.76,-518.54 997.75,-508.37 989.07,-514.45 994.76,-518.54"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#2c00ff" d="M840.65,-1143C850.81,-1145.5 860.78,-1148.76 870,-1153 889.45,-1161.95 886.17,-1176.93 906,-1185 1064.47,-1249.47 1272.91,-1231.72 1370.77,-1218.09"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1371.33,-1221.55 1380.73,-1216.66 1370.34,-1214.62 1371.33,-1221.55"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#2c00ff" d="M840.64,-1133.58C851.72,-1129.6 861.93,-1123.66 870,-1115 926.33,-1054.57 850.85,-806.51 906,-745 917.99,-731.63 936.1,-725.53 953.66,-723.05"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="954.31,-726.5 963.89,-721.98 953.58,-719.54 954.31,-726.5"/>
</g>
<!-- proc~centrifugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~centrifugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#6e00ff" d="M499.72,-324.28C518.38,-342.42 554.1,-377.63 583,-409 599.66,-427.08 597.6,-438.9 619,-451 634.55,-459.79 652.82,-465.12 670.5,-468.29"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="670.39,-471.81 680.82,-469.92 671.48,-464.9 670.39,-471.81"/>
</g>
<!-- proc~calculate_offdiagonal_centrifugal_element -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~calculate_offdiagonal_centrifugal_element</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/calculate_offdiagonal_centrifugal_element.html" xlink:title="calculate_offdiagonal_centrifugal_element">
<polygon fill="#d94e8f" stroke="#d94e8f" points="864.5,-282 624.5,-282 624.5,-258 864.5,-258 864.5,-282"/>
<text text-anchor="middle" x="744.5" y="-267.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_offdiagonal_centrifugal_element</text>
</a>
</g>
</g>
<!-- proc~centrifugal_matrix&#45;&gt;proc~calculate_offdiagonal_centrifugal_element -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~centrifugal_matrix&#45;&gt;proc~calculate_offdiagonal_centrifugal_element</title>
<path fill="none" stroke="#6e00ff" d="M541.08,-303.14C575.49,-297.51 620.74,-290.1 659.74,-283.72"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="660.73,-287.1 670.03,-282.03 659.59,-280.19 660.73,-287.1"/>
</g>
<!-- proc~calculate_diagonal_centrifugal_element -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~calculate_diagonal_centrifugal_element</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/calculate_diagonal_centrifugal_element.html" xlink:title="calculate_diagonal_centrifugal_element">
<polygon fill="#d94e8f" stroke="#d94e8f" points="857.5,-240 631.5,-240 631.5,-216 857.5,-216 857.5,-240"/>
<text text-anchor="middle" x="744.5" y="-225.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_diagonal_centrifugal_element</text>
</a>
</g>
</g>
<!-- proc~centrifugal_matrix&#45;&gt;proc~calculate_diagonal_centrifugal_element -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~centrifugal_matrix&#45;&gt;proc~calculate_diagonal_centrifugal_element</title>
<path fill="none" stroke="#6e00ff" d="M541.12,-306.48C555.44,-303.37 570.41,-298.53 583,-291 604.1,-278.39 597.6,-261.1 619,-249 622.29,-247.14 625.71,-245.43 629.22,-243.87"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="630.72,-247.03 638.69,-240.05 628.11,-240.54 630.72,-247.03"/>
</g>
<!-- proc~delta_for_zero_omega -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>proc~delta_for_zero_omega</title>
<g id="a_program~~scattering~~CallsGraph_node73"><a xlink:href=".././proc/delta_for_zero_omega.html" xlink:title="delta_for_zero_omega">
<polygon fill="#d94e8f" stroke="#d94e8f" points="809.5,-324 679.5,-324 679.5,-300 809.5,-300 809.5,-324"/>
<text text-anchor="middle" x="744.5" y="-309.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">delta_for_zero_omega</text>
</a>
</g>
</g>
<!-- proc~centrifugal_matrix&#45;&gt;proc~delta_for_zero_omega -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~centrifugal_matrix&#45;&gt;proc~delta_for_zero_omega</title>
<path fill="none" stroke="#6e00ff" d="M541.08,-312C578.21,-312 627.97,-312 668.86,-312"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="669.05,-315.5 679.05,-312 669.05,-308.5 669.05,-315.5"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#b100ff" d="M771.89,-1498.76C832.34,-1499.93 985.19,-1499.63 1109,-1472 1144.59,-1464.06 1183.23,-1448.4 1210.01,-1436.33"/>
<polygon fill="#b100ff" stroke="#b100ff" points="1211.68,-1439.42 1219.32,-1432.07 1208.77,-1433.06 1211.68,-1439.42"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0085" d="M792.11,-973.12C818.86,-973.28 850.84,-968.24 870,-947 952.95,-855.08 832.79,-490.85 906,-391 915.17,-378.49 928.93,-370 943.35,-364.23"/>
<polygon fill="#ff0085" stroke="#ff0085" points="944.64,-367.48 952.88,-360.81 942.28,-360.89 944.64,-367.48"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0085" d="M792.11,-962.65C901.7,-952.71 1178.98,-943.37 1345,-1078 1381.44,-1107.55 1405.98,-1158.13 1417.81,-1187.03"/>
<polygon fill="#ff0085" stroke="#ff0085" points="1414.67,-1188.6 1421.6,-1196.62 1421.18,-1186.03 1414.67,-1188.6"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0085" d="M792,-973.96C815.57,-977.45 844.52,-982.48 870,-989 978.93,-1016.89 1028.08,-993.93 1109,-1072 1206.03,-1165.61 1234.51,-1336.91 1241.78,-1397.8"/>
<polygon fill="#ff0085" stroke="#ff0085" points="1238.31,-1398.29 1242.9,-1407.84 1245.27,-1397.51 1238.31,-1398.29"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0085" d="M792.22,-964.64C816.1,-961.8 845.27,-956.59 870,-947 875.95,-944.69 941.71,-901.66 979.74,-876.64"/>
<polygon fill="#ff0085" stroke="#ff0085" points="981.88,-879.43 988.31,-871 978.03,-873.58 981.88,-879.43"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M1051.29,-728.88C1069.61,-731.98 1090.91,-737 1109,-745 1227.45,-797.4 1271.14,-809.59 1345,-916 1405.7,-1003.45 1421.03,-1134.98 1424.81,-1186.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1421.32,-1187.18 1425.46,-1196.93 1428.3,-1186.72 1421.32,-1187.18"/>
</g>
<!-- proc~calculate_single_pes_matrix_element&#45;&gt;proc~wavenumber_squared_from_energy -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~calculate_single_pes_matrix_element&#45;&gt;proc~wavenumber_squared_from_energy</title>
<path fill="none" stroke="#ff8b00" d="M850.23,-436.09C857.63,-439.83 864.38,-444.71 870,-451 919.14,-506.03 890.87,-1041.79 906,-1114 925.99,-1209.43 974.38,-1316.02 995.89,-1360.59"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="992.87,-1362.39 1000.4,-1369.85 999.16,-1359.32 992.87,-1362.39"/>
</g>
<!-- proc~get_radial_coupling_term_value -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~get_radial_coupling_term_value</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/get_radial_coupling_term_value.html" xlink:title="get_radial_coupling_term_value">
<polygon fill="#d9534f" stroke="#d9534f" points="1098.5,-424 916.5,-424 916.5,-400 1098.5,-400 1098.5,-424"/>
<text text-anchor="middle" x="1007.5" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_radial_coupling_term_value</text>
</a>
</g>
</g>
<!-- proc~calculate_single_pes_matrix_element&#45;&gt;proc~get_radial_coupling_term_value -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~calculate_single_pes_matrix_element&#45;&gt;proc~get_radial_coupling_term_value</title>
<path fill="none" stroke="#ff8b00" d="M850.15,-422.78C868.58,-421.51 887.73,-420.19 906.04,-418.93"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="906.38,-422.41 916.11,-418.23 905.9,-415.43 906.38,-422.41"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node76" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node76"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1272,-466 1218,-466 1218,-442 1272,-442 1272,-466"/>
<text text-anchor="middle" x="1245" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#e7ff00" d="M1034.6,-454C1076.69,-454 1159.65,-454 1207.55,-454"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1207.78,-457.5 1217.78,-454 1207.78,-450.5 1207.78,-457.5"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node77" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node77"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1272,-508 1218,-508 1218,-484 1272,-484 1272,-508"/>
<text text-anchor="middle" x="1245" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#e7ff00" d="M1034.6,-458.66C1076.78,-466.18 1160,-481.02 1207.85,-489.55"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1207.32,-493.01 1217.78,-491.32 1208.55,-486.12 1207.32,-493.01"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#00ff2e" d="M1034.6,-491.34C1076.78,-483.82 1160,-468.98 1207.85,-460.45"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1208.55,-463.88 1217.78,-458.68 1207.32,-456.99 1208.55,-463.88"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#00ff2e" d="M1034.6,-496C1076.69,-496 1159.65,-496 1207.55,-496"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1207.78,-499.5 1217.78,-496 1207.78,-492.5 1207.78,-499.5"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node75" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="1034.5,-118 980.5,-118 980.5,-94 1034.5,-94 1034.5,-118"/>
<text text-anchor="middle" x="1007.5" y="-103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~percival_seaton_coefficient&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~percival_seaton_coefficient&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#e700ff" d="M823.81,-106C872.4,-106 932.54,-106 970.22,-106"/>
<polygon fill="#e700ff" stroke="#e700ff" points="970.23,-109.5 980.23,-106 970.23,-102.5 970.23,-109.5"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node78" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node78"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1272,-424 1218,-424 1218,-400 1272,-400 1272,-424"/>
<text text-anchor="middle" x="1245" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~get_radial_coupling_term_value&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~get_radial_coupling_term_value&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#ff0000" d="M1098.54,-412C1136.59,-412 1178.73,-412 1207.81,-412"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1207.91,-415.5 1217.91,-412 1207.91,-408.5 1207.91,-415.5"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node79" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node79"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1454,-487 1400,-487 1400,-463 1454,-463 1454,-487"/>
<text text-anchor="middle" x="1427" y="-472.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ffff" d="M1272.17,-457.05C1303.1,-460.66 1354.75,-466.69 1389.57,-470.75"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1389.46,-474.26 1399.79,-471.94 1390.27,-467.31 1389.46,-474.26"/>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge140" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#7f00ff" d="M1272.17,-492.95C1303.1,-489.34 1354.75,-483.31 1389.57,-479.25"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1390.27,-482.69 1399.79,-478.06 1389.46,-475.74 1390.27,-482.69"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_indices~11">channel_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channel_l_values~4">channel_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~8">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~2">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~2">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-largest_wavevector">largest_wavevector</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~6">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~6">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~5">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~4">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~4">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~2">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~4">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~2">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~2">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponent">parity_exponent</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_exponenttmp">parity_exponenttmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_indices~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channel_l_values~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channel_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~8"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~2"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-largest_wavevector"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>largest_wavevector</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~6"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~6"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~2"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~2"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponent"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponent</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_exponenttmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_exponenttmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">radial_coupling_terms_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">read_radial_coupling_terms</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">reduce_radial_coupling_terms</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">set_number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">set_body_fixed_channels</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_space_fixed_channels</span><span class="p">,</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_largest_wavenumber</span><span class="p">,</span><span class="w"> </span><span class="n">print_channels</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">coupling_matrix_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">calculate_s_matrix</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">state_to_state_cross_sections_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">,</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">print_largest_partial_cross_sections</span><span class="p">,</span><span class="w"> </span><span class="n">check_cross_section_thresholds</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">write_message</span><span class="p">,</span><span class="w"> </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_exponenttmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">largest_wavevector</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channel_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">reduce_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">interpolate_radial_coupling_terms</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_exponent</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channel_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channel_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channel_indices and channel_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_body_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_space_fixed_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_channels</span><span class="p">(</span><span class="n">parity_exponent</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_channels_in_block</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">largest_wavevector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculate_largest_wavenumber</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">largest_wavevector</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channel_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_exponent</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channel_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channel_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_state_to_state_cross_section</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channel_indices</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channel_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_exponent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_cross_sections</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_cross_section_thresholds</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-04 15:34            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>