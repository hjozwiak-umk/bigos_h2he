<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.01">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">215 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~5">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/potential.html'>POTENTIAL</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href='../module/unitarity_check_mod.html'>unitarity_check_mod</a></li>
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
                <li><a href='../module/pes_coupling_matrix.html'>PES_COUPLING_MATRIX</a></li>
                <li><a href='../module/statetostatexs.html'>statetostateXS</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="372pt"
 viewBox="0.00 0.00 641.00 371.77" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.34 1.34) rotate(0) translate(4 495.95)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-495.95 858,-495.95 858,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="854,-310 775,-310 775,-286 854,-286 854,-310"/>
<text text-anchor="middle" x="814.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-148 134,-148 134,-124 259,-124 259,-148"/>
<text text-anchor="middle" x="196.5" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-136C629,-108.15 605.72,-139.95 536.5,-136"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-136C514.86,-134.88 381.53,-93.62 362,-96"/>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-387 130,-387 130,-363 263,-363 263,-387"/>
<text text-anchor="middle" x="196.5" y="-372.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M805.18,-310.07C774.54,-352.92 663.15,-494.87 536.5,-488"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-488C474.15,-496.73 306.14,-424.64 232.66,-391.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="233.9,-388.03 223.35,-387.06 231,-394.4 233.9,-388.03"/>
</g>
<!-- module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~pes_coupling_matrix</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/pes_coupling_matrix.html" xlink:title="PES_COUPLING_MATRIX">
<polygon fill="#337ab7" stroke="#337ab7" points="603.5,-226 467.5,-226 467.5,-202 603.5,-202 603.5,-226"/>
<text text-anchor="middle" x="535.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PES_COUPLING_MATRIX</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~pes_coupling_matrix</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-136C667.08,-124.85 598.08,-169.66 560.95,-196.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="558.75,-193.27 552.67,-201.95 562.83,-198.96 558.75,-193.27"/>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="739,-310 648,-310 648,-286 739,-286 739,-310"/>
<text text-anchor="middle" x="693.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.86,-298C766.67,-298 757.87,-298 749.21,-298"/>
<polygon fill="#ff0000" stroke="#ff0000" points="749.14,-294.5 739.14,-298 749.14,-301.5 749.14,-294.5"/>
</g>
<!-- module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~unitarity_check_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/unitarity_check_mod.html" xlink:title="unitarity_check_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="597,-66 474,-66 474,-42 597,-42 597,-66"/>
<text text-anchor="middle" x="535.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~unitarity_check_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~unitarity_check_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-136C651.39,-117.97 652.23,-94.92 612,-75 607.98,-73.01 603.75,-71.18 599.42,-69.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="600.43,-66.16 589.84,-66.1 598.09,-72.75 600.43,-66.16"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-148 334,-148 334,-124 388,-124 388,-148"/>
<text text-anchor="middle" x="361" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-136C487.49,-133.31 433.15,-133.93 398.22,-134.8"/>
<polygon fill="#ff0000" stroke="#ff0000" points="397.94,-131.31 388.04,-135.08 398.13,-138.3 397.94,-131.31"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="612,-268 459,-268 459,-244 612,-244 612,-268"/>
<text text-anchor="middle" x="535.5" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-136C640.56,-113.22 659.45,-203.94 612,-235 609.41,-236.7 606.68,-238.26 603.86,-239.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="602.28,-236.57 594.6,-243.87 605.16,-242.95 602.28,-236.57"/>
</g>
<!-- module~potential -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~potential</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/potential.html" xlink:title="POTENTIAL">
<polygon fill="#337ab7" stroke="#337ab7" points="571,-310 500,-310 500,-286 571,-286 571,-310"/>
<text text-anchor="middle" x="535.5" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POTENTIAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~potential</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-136C626.41,-107.02 668.93,-232.66 612,-277 603.04,-283.98 591.9,-288.64 580.95,-291.75"/>
<polygon fill="#ff0000" stroke="#ff0000" points="579.89,-288.4 571.02,-294.19 581.57,-295.2 579.89,-288.4"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-108 490.5,-108 490.5,-84 580.5,-84 580.5,-108"/>
<text text-anchor="middle" x="535.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-136C660.06,-121.78 621.53,-111.83 590.87,-105.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="591.3,-101.93 580.8,-103.38 589.91,-108.79 591.3,-101.93"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-267 0,-267 0,-243 94,-243 94,-267"/>
<text text-anchor="middle" x="47" y="-252.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.5,-488C458.52,-498.22 438.57,-484.16 362,-488"/>
</g>
<!-- module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~statetostatexs</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/statetostatexs.html" xlink:title="statetostateXS">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-24 490.5,-24 490.5,0 580.5,0 580.5,-24"/>
<text text-anchor="middle" x="535.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">statetostateXS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;module~statetostatexs</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M809.36,-285.66C797.63,-253.03 760.66,-165.01 694.5,-136"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-136C639.29,-112.67 660.3,-65.29 612,-33 605.48,-28.64 598.07,-25.18 590.49,-22.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="591.46,-19.07 580.87,-19.32 589.31,-25.73 591.46,-19.07"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M156.2,-148.13C147.17,-151.83 137.91,-156.44 130,-162 101.63,-181.96 76.48,-213.64 61.74,-234.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="58.73,-232.58 55.91,-242.79 64.48,-236.57 58.73,-232.58"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M156.18,-362.9C147.15,-359.19 137.89,-354.58 130,-349 101.35,-328.74 76.12,-296.47 61.46,-275.51"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="64.19,-273.31 55.66,-267.02 58.41,-277.26 64.19,-273.31"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M486.05,-201.99C451.61,-193.78 404.18,-183.14 362,-176"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M360,-176C322.52,-169.65 280.9,-159.35 249.17,-150.78"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="249.8,-147.33 239.23,-148.07 247.96,-154.08 249.8,-147.33"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M492.44,-201.96C481.3,-198.12 469.46,-193.43 459,-188 441.48,-178.91 440.18,-171.71 423,-162 414.99,-157.47 406.03,-153.24 397.51,-149.56"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="398.71,-146.27 388.13,-145.65 396.01,-152.73 398.71,-146.27"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M360,-176C288.79,-163.94 268.77,-164.3 197.5,-176"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node13"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-308 299,-308 299,-284 423,-284 423,-308"/>
<text text-anchor="middle" x="361" y="-293.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M478.77,-226.04C471.89,-228.52 465.13,-231.48 459,-235 439.65,-246.11 441.58,-257.64 423,-270 417.65,-273.56 411.74,-276.8 405.76,-279.69"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="404.04,-276.63 396.39,-283.95 406.94,-283 404.04,-276.63"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-228 334,-228 334,-204 388,-204 388,-228"/>
<text text-anchor="middle" x="361" y="-213.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M467.31,-214.78C443.9,-215.05 418.51,-215.34 398.53,-215.58"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="398.28,-212.08 388.32,-215.69 398.36,-219.08 398.28,-212.08"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M534.5,-374C447.03,-397.13 342.26,-392.68 273.01,-385.53"/>
<polygon fill="#5cff00" stroke="#5cff00" points="273.38,-382.05 263.06,-384.46 272.63,-389.01 273.38,-382.05"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M686.71,-285.71C675.56,-263.48 648.93,-216.69 612,-193 576.83,-170.44 458.8,-150.31 398.35,-141.19"/>
<polygon fill="#5cff00" stroke="#5cff00" points="398.52,-137.67 388.12,-139.66 397.49,-144.6 398.52,-137.67"/>
</g>
<!-- module~propagators&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~propagators&#45;&gt;module~potential</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M647.8,-298C626.92,-298 602.13,-298 581.26,-298"/>
<polygon fill="#5cff00" stroke="#5cff00" points="581.05,-294.5 571.05,-298 581.05,-301.5 581.05,-294.5"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M534.5,-374C446,-398.75 453.78,-483.39 362,-488"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M360,-488C286.12,-491.71 264.39,-483.58 197.5,-452"/>
</g>
<!-- module~propagators&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~propagators&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M673.75,-310.16C645.37,-327.84 589.22,-360.06 536.5,-374"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M534.5,-374C481.64,-387.98 472.94,-344.28 423,-322 415.68,-318.73 407.83,-315.32 400.28,-312.09"/>
<polygon fill="#5cff00" stroke="#5cff00" points="401.52,-308.81 390.94,-308.1 398.77,-315.25 401.52,-308.81"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M490.25,-66.03C447.74,-77.36 386.48,-93.02 362,-96"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M360,-96C320.83,-100.77 277.49,-111.74 245.43,-120.98"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="244.04,-117.74 235.43,-123.91 246.01,-124.46 244.04,-117.74"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~unitarity_check_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M478.77,-66.04C471.89,-68.52 465.13,-71.48 459,-75 439.65,-86.11 441.58,-97.64 423,-110 415.27,-115.14 406.36,-119.63 397.77,-123.35"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="396.23,-120.21 388.3,-127.24 398.88,-126.68 396.23,-120.21"/>
</g>
<!-- module~unitarity_check_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~unitarity_check_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M473.8,-57.53C440.73,-58.92 399.1,-59.8 362,-58"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M360,-58C287.86,-54.49 260.24,-22.22 197.5,-58"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M333.89,-136C316.39,-136 292.41,-136 269.45,-136"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="269.34,-132.5 259.34,-136 269.34,-139.5 269.34,-132.5"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M333.86,-141.36C321.61,-145.16 307.81,-151.51 299,-162 253.78,-215.82 298.75,-255.48 263,-316 253.39,-332.26 237.83,-346.55 224.29,-357"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="222.15,-354.23 216.18,-362.98 226.31,-359.86 222.15,-354.23"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M333.81,-143.8C301.91,-152.99 246.24,-168 197.5,-176"/>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M195.5,-176C147.13,-183.94 98.44,-215.74 70.87,-236.49"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="68.47,-233.92 62.69,-242.79 72.74,-239.46 68.47,-233.92"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M458.81,-267.85C427.83,-269.71 392.24,-267.9 362,-256"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M360,-256C333.58,-245.6 320.49,-255.57 299,-237 271.02,-212.83 290.04,-187.22 263,-162 259.24,-158.49 254.94,-155.43 250.4,-152.77"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="251.9,-149.61 241.41,-148.13 248.69,-155.83 251.9,-149.61"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M360,-336C327.87,-344.98 291.81,-353.76 261.84,-360.71"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="260.88,-357.34 251.92,-362.99 262.46,-364.16 260.88,-357.34"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M473.28,-243.97C468.15,-241.52 463.3,-238.56 459,-235 431.15,-211.92 449.28,-186.86 423,-162 415.8,-155.19 406.54,-150.02 397.43,-146.15"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="398.66,-142.88 388.07,-142.59 396.17,-149.42 398.66,-142.88"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M477.36,-268.1C470.93,-270.55 464.67,-273.49 459,-277 438.67,-289.6 443.14,-304.09 423,-317 399.09,-332.32 389.35,-328.36 362,-336"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M360,-336C261.18,-363.61 225.92,-352.45 130,-316 105.85,-306.82 82.64,-288.35 67.12,-274.12"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="69.41,-271.47 59.74,-267.14 64.6,-276.56 69.41,-271.47"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M482.74,-268C464.24,-272.29 443.19,-277.17 423.91,-281.64"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="422.97,-278.27 414.02,-283.94 424.55,-285.09 422.97,-278.27"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M482.74,-244C455.48,-237.68 422.71,-230.08 398.19,-224.39"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="398.76,-220.93 388.23,-222.08 397.18,-227.75 398.76,-220.93"/>
</g>
<!-- module~potential&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~potential&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M499.68,-290.7C456.86,-281.51 386.81,-265.77 362,-256"/>
</g>
<!-- module~potential&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~potential&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M499.71,-295.53C485.48,-292.85 469.85,-287.51 459,-277 420.53,-239.74 458.94,-201.71 423,-162 416.23,-154.53 406.96,-149.12 397.68,-145.25"/>
<polygon fill="#002eff" stroke="#002eff" points="398.71,-141.9 388.12,-141.74 396.3,-148.47 398.71,-141.9"/>
</g>
<!-- module~potential&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~potential&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M517.37,-310.05C457.83,-351.3 260.06,-482.58 197.5,-452"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M195.5,-452C119.83,-416.28 73.61,-319.91 56.07,-276.6"/>
<polygon fill="#002eff" stroke="#002eff" points="59.23,-275.06 52.31,-267.03 52.71,-277.62 59.23,-275.06"/>
</g>
<!-- module~potential&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~potential&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M499.59,-297.6C480.47,-297.37 456.05,-297.09 433.11,-296.82"/>
<polygon fill="#002eff" stroke="#002eff" points="433.08,-293.32 423.04,-296.71 433,-300.32 433.08,-293.32"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M490.36,-93.07C455.41,-91.46 405.4,-90.71 362,-96"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M490.08,-106.3C461.52,-112.92 424.9,-121.41 398.14,-127.62"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="396.99,-124.29 388.04,-129.96 398.57,-131.11 396.99,-124.29"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M490.26,-84.48C447.76,-73.74 386.5,-59.19 362,-58"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~statetostatexs&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M360,-20C298.78,-35.1 242.52,-87.3 215.08,-116.26"/>
<polygon fill="#ff008b" stroke="#ff008b" points="212.35,-114.05 208.12,-123.77 217.49,-118.81 212.35,-114.05"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge45" class="edge">
<title>module~statetostatexs&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M490.26,-17.59C479.12,-20.7 467.83,-25.53 459,-33 430.16,-57.41 450.17,-83.75 423,-110 415.87,-116.89 406.64,-122.08 397.52,-125.94"/>
<polygon fill="#ff008b" stroke="#ff008b" points="396.26,-122.68 388.16,-129.5 398.75,-129.22 396.26,-122.68"/>
</g>
<!-- module~statetostatexs&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~statetostatexs&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M490.22,-9.37C454.97,-8.38 404.64,-9.48 362,-20"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M360,-20C287.99,-37.76 261.93,-21.25 197.5,-58"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M195.5,-58C123.33,-99.16 75.69,-191.47 56.96,-233.46"/>
<polygon fill="#ff008b" stroke="#ff008b" points="53.69,-232.2 52.92,-242.77 60.11,-234.99 53.69,-232.2"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge46" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M318.52,-284C311.3,-280.42 304.38,-275.84 299,-270 264.7,-232.8 297.76,-198.77 263,-162 259.71,-158.52 255.89,-155.49 251.78,-152.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="253.46,-149.79 243.02,-148.01 250.07,-155.92 253.46,-149.79"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge48" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M326.02,-283.95C316.92,-280.08 307.31,-275.38 299,-270 247.4,-236.56 258.17,-166.04 197.5,-176"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node15" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node15"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-307 130,-307 130,-283 263,-283 263,-307"/>
<text text-anchor="middle" x="196.5" y="-292.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge47" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.57,-295.62C290.32,-295.57 281.79,-295.52 273.34,-295.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.11,-291.97 263.09,-295.4 273.07,-298.97 273.11,-291.97"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="809pt"
 viewBox="0.00 0.00 641.00 808.53" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.19 2.19) rotate(0) translate(4 1766.94)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1766.94 1400,-1766.94 1400,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-857.94 0,-857.94 0,-833.94 79,-833.94 79,-857.94"/>
<text text-anchor="middle" x="39.5" y="-843.54" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="810,-1211.94 729,-1211.94 729,-1187.94 810,-1187.94 810,-1211.94"/>
<text text-anchor="middle" x="769.5" y="-1197.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M41.4,-858.28C45.64,-912.49 65.47,-1128.61 115,-1169.94 160.89,-1208.22 573.09,-1203.83 718.22,-1201.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="718.68,-1204.55 728.6,-1200.85 718.54,-1197.55 718.68,-1204.55"/>
</g>
<!-- proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~potential_interpolation</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/potential_interpolation.html" xlink:title="potential_interpolation">
<polygon fill="#d9534f" stroke="#d9534f" points="591.5,-1253.94 458.5,-1253.94 458.5,-1229.94 591.5,-1229.94 591.5,-1253.94"/>
<text text-anchor="middle" x="525" y="-1239.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_interpolation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~potential_interpolation</title>
<path fill="none" stroke="#ff0000" d="M41.03,-857.98C43.87,-916.16 59.23,-1167.24 115,-1215.94 162.91,-1257.77 343.41,-1253.85 447.91,-1247.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.33,-1251.16 458.09,-1247.06 447.9,-1244.18 448.33,-1251.16"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node4"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="333,-815.94 188,-815.94 188,-791.94 333,-791.94 333,-815.94"/>
<text text-anchor="middle" x="260.5" y="-801.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M79.31,-833.96C90.73,-830.72 103.3,-827.42 115,-824.94 135.24,-820.63 157.27,-816.94 177.89,-813.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.48,-817.35 187.88,-812.46 177.48,-810.42 178.48,-817.35"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~set_number_of_open_channels_wavmax</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/set_number_of_open_channels_wavmax.html" xlink:title="set_number_of_open_channels_wavmax">
<polygon fill="#d9534f" stroke="#d9534f" points="373.5,-445.94 147.5,-445.94 147.5,-421.94 373.5,-421.94 373.5,-445.94"/>
<text text-anchor="middle" x="260.5" y="-431.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_open_channels_wavmax</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax</title>
<path fill="none" stroke="#ff0000" d="M40.99,-833.71C43.65,-773.48 58.46,-509.04 115,-454.94 121.73,-448.5 129.49,-443.48 137.87,-439.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.22,-442.82 147.17,-435.82 136.59,-436.34 139.22,-442.82"/>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="570.5,-1369.94 479.5,-1369.94 479.5,-1345.94 570.5,-1345.94 570.5,-1369.94"/>
<text text-anchor="middle" x="525" y="-1355.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M40.39,-857.96C40.07,-926.54 42.15,-1267.55 115,-1333.94 214.25,-1424.37 389.53,-1394.48 474.73,-1372.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="475.65,-1375.93 484.42,-1369.99 473.86,-1369.16 475.65,-1375.93"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="581,-1539.94 469,-1539.94 469,-1515.94 581,-1515.94 581,-1539.94"/>
<text text-anchor="middle" x="525" y="-1525.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.96,-858.06C44.31,-943.72 66.32,-1455.61 115,-1501.94 162.78,-1547.4 355.84,-1540.65 458.71,-1533.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="459.26,-1536.94 468.98,-1532.73 458.76,-1529.96 459.26,-1536.94"/>
</g>
<!-- proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~print_largest_partial_xs</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/print_largest_partial_xs.html" xlink:title="print_largest_partial_xs">
<polygon fill="#d9534f" stroke="#d9534f" points="837.5,-1459.94 701.5,-1459.94 701.5,-1435.94 837.5,-1435.94 837.5,-1459.94"/>
<text text-anchor="middle" x="769.5" y="-1445.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_xs</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_xs</title>
<path fill="none" stroke="#ff0000" d="M40.28,-858.02C39.22,-930.13 37.61,-1303.01 115,-1377.94 195.34,-1455.71 535.72,-1455.43 690.87,-1451.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="691.37,-1454.51 701.26,-1450.71 691.16,-1447.51 691.37,-1454.51"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="304.5,-1291.94 216.5,-1291.94 216.5,-1267.94 304.5,-1267.94 304.5,-1291.94"/>
<text text-anchor="middle" x="260.5" y="-1277.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.92,-858.23C43.31,-920.06 57.14,-1196.22 115,-1253.94 138.51,-1277.39 175.51,-1283.7 206.19,-1284.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="206.32,-1287.75 216.32,-1284.23 206.31,-1280.75 206.32,-1287.75"/>
</g>
<!-- proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~potential_reduction</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/potential_reduction.html" xlink:title="potential_reduction">
<polygon fill="#d9534f" stroke="#d9534f" points="827,-1581.94 712,-1581.94 712,-1557.94 827,-1557.94 827,-1581.94"/>
<text text-anchor="middle" x="769.5" y="-1567.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_reduction</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~potential_reduction</title>
<path fill="none" stroke="#ff0000" d="M40.89,-858.08C43.82,-946.21 63.79,-1485.36 115,-1533.94 197.75,-1612.43 552.62,-1589.95 701.91,-1576.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="702.23,-1580.08 711.87,-1575.69 701.6,-1573.11 702.23,-1580.08"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="833,-1005.94 706,-1005.94 706,-981.94 833,-981.94 833,-1005.94"/>
<text text-anchor="middle" x="769.5" y="-991.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M77.68,-857.98C89.5,-861.38 102.7,-864.75 115,-866.94 223.19,-886.16 516.11,-844.68 608,-904.94 636.6,-923.69 616.28,-952.91 644,-972.94 658.99,-983.76 677.63,-989.74 695.87,-992.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="695.55,-996.37 705.95,-994.34 696.55,-989.44 695.55,-996.37"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1089,-1406.94 965,-1406.94 965,-1382.94 1089,-1382.94 1089,-1406.94"/>
<text text-anchor="middle" x="1027" y="-1392.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.18,-858.13C45.74,-937.99 73,-1384.31 115,-1425.94 176.65,-1487.03 811.45,-1492.44 895,-1468.94 913.05,-1463.86 914.77,-1456.33 931,-1446.94 951.88,-1434.85 975.7,-1421.81 994.26,-1411.82"/>
<polygon fill="#ff0000" stroke="#ff0000" points="996.02,-1414.84 1003.18,-1407.03 992.71,-1408.68 996.02,-1414.84"/>
</g>
<!-- proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~print_bf_channels</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/print_bf_channels.html" xlink:title="print_bf_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="822.5,-448.94 716.5,-448.94 716.5,-424.94 822.5,-424.94 822.5,-448.94"/>
<text text-anchor="middle" x="769.5" y="-434.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_bf_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~print_bf_channels</title>
<path fill="none" stroke="#ff0000" d="M40.43,-833.51C40.33,-765.66 43.62,-440.81 115,-379.94 204.17,-303.89 572.34,-386.96 713.28,-422.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="712.47,-425.86 723.02,-424.92 714.19,-419.07 712.47,-425.86"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="562,-566.94 488,-566.94 488,-542.94 562,-542.94 562,-566.94"/>
<text text-anchor="middle" x="525" y="-552.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M42,-833.78C48.18,-785.79 73.36,-610.41 115,-576.94 169.62,-533.02 382.6,-543.69 477.7,-550.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="477.64,-554.43 487.88,-551.72 478.19,-547.45 477.64,-554.43"/>
</g>
<!-- proc~crosssection -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~crosssection</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/crosssection.html" xlink:title="CROSSSECTION">
<polygon fill="#d9534f" stroke="#d9534f" points="573,-1173.94 477,-1173.94 477,-1149.94 573,-1149.94 573,-1173.94"/>
<text text-anchor="middle" x="525" y="-1159.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CROSSSECTION</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~crosssection -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~crosssection</title>
<path fill="none" stroke="#ff0000" d="M41.7,-858.15C46.98,-908.98 69.86,-1102.81 115,-1139.94 167.12,-1182.79 366.74,-1174.2 466.53,-1166.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="467.02,-1170.36 476.73,-1166.11 466.5,-1163.38 467.02,-1170.36"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="305,-1017.94 216,-1017.94 216,-993.94 305,-993.94 305,-1017.94"/>
<text text-anchor="middle" x="260.5" y="-1003.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M43.1,-858.05C49.71,-885.67 69.94,-953.34 115,-984.94 141.18,-1003.29 176.64,-1008.66 205.88,-1009.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.91,-1012.88 215.94,-1009.45 205.96,-1005.88 205.91,-1012.88"/>
</g>
<!-- proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~set_channels_l_values</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/set_channels_l_values.html" xlink:title="set_channels_l_values">
<polygon fill="#d9534f" stroke="#d9534f" points="325.5,-689.94 195.5,-689.94 195.5,-665.94 325.5,-665.94 325.5,-689.94"/>
<text text-anchor="middle" x="260.5" y="-675.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_l_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_l_values</title>
<path fill="none" stroke="#ff0000" d="M42.78,-833.57C48.81,-804.69 68.06,-732.66 115,-698.94 135.09,-684.5 160.85,-678.02 185.05,-675.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.62,-678.99 195.3,-674.69 185.05,-672.02 185.62,-678.99"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="379.5,-1059.94 141.5,-1059.94 141.5,-1035.94 379.5,-1035.94 379.5,-1059.94"/>
<text text-anchor="middle" x="260.5" y="-1045.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M41.5,-858.05C44.92,-891.15 59.26,-983.47 115,-1026.94 120.18,-1030.98 125.8,-1034.41 131.7,-1037.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="130.64,-1040.68 141.2,-1041.49 133.45,-1034.27 130.64,-1040.68"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-975.94 161,-975.94 161,-951.94 360,-951.94 360,-975.94"/>
<text text-anchor="middle" x="260.5" y="-961.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M46.61,-858.12C57.42,-878.3 81.92,-918.37 115,-937.94 126.1,-944.5 138.46,-949.49 151.15,-953.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="150.33,-956.67 160.89,-955.92 152.17,-949.91 150.33,-956.67"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="572,-1063.94 478,-1063.94 478,-1039.94 572,-1039.94 572,-1063.94"/>
<text text-anchor="middle" x="525" y="-1049.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.13,-858.12C39.7,-896.92 44.28,-1018 115,-1068.94 169.86,-1108.45 369.1,-1079.84 467.8,-1062.54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.66,-1065.94 477.89,-1060.75 467.43,-1059.05 468.66,-1065.94"/>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~calculate_sf_matrix_from_bf_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/calculate_sf_matrix_from_bf_matrix.html" xlink:title="calculate_sf_matrix_from_bf_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="361,-773.94 160,-773.94 160,-749.94 361,-749.94 361,-773.94"/>
<text text-anchor="middle" x="260.5" y="-759.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sf_matrix_from_bf_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_sf_matrix_from_bf_matrix</title>
<path fill="none" stroke="#ff0000" d="M50.72,-833.9C63.94,-819.23 88.44,-794.9 115,-782.94 125.93,-778.02 137.74,-774.2 149.75,-771.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="150.88,-774.57 159.86,-768.95 149.34,-767.74 150.88,-774.57"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="581,-170.94 469,-170.94 469,-146.94 581,-146.94 581,-170.94"/>
<text text-anchor="middle" x="525" y="-156.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M41.16,-833.82C45.61,-753.47 72.59,-299.52 115,-256.94 207.04,-164.52 290.16,-278.89 406,-218.94 426.95,-208.09 421.74,-192.02 442,-179.94 447.38,-176.72 453.25,-174 459.29,-171.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="460.56,-174.95 468.87,-168.39 458.28,-168.33 460.56,-174.95"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="307,-731.94 214,-731.94 214,-707.94 307,-707.94 307,-731.94"/>
<text text-anchor="middle" x="260.5" y="-717.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M45.28,-833.73C54.79,-811.2 78.39,-763.33 115,-740.94 141.29,-724.85 175.2,-719.31 203.56,-717.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.85,-721.41 213.73,-717.59 203.62,-714.42 203.85,-721.41"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1396,-1146.94 1304,-1146.94 1304,-1122.94 1396,-1122.94 1396,-1146.94"/>
<text text-anchor="middle" x="1350" y="-1132.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.99,-833.8C44.66,-744.56 69.21,-191.78 115,-134.94 235,14.03 332.71,-0.94 524,-0.94 524,-0.94 524,-0.94 1028,-0.94 1158.46,-0.94 1213.07,-51.6 1268,-169.94 1349.42,-345.35 1349.92,-984.81 1349.18,-1112.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1345.68,-1112.74 1349.11,-1122.76 1352.68,-1112.79 1345.68,-1112.74"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="888.5,-1707.94 650.5,-1707.94 650.5,-1683.94 888.5,-1683.94 888.5,-1707.94"/>
<text text-anchor="middle" x="769.5" y="-1693.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.88,-858.17C43.82,-949.33 64.22,-1520.74 115,-1575.94 260.72,-1734.33 541.16,-1725.58 682.55,-1709.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="683.38,-1712.61 692.89,-1707.95 682.55,-1705.66 683.38,-1712.61"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1268,-1026.94 1159,-1026.94 1159,-1002.94 1268,-1002.94 1268,-1026.94"/>
<text text-anchor="middle" x="1213.5" y="-1012.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.28,-833.5C39.28,-762.59 38.27,-410.11 115,-343.94 212.94,-259.46 277,-334.72 406,-343.94 730.74,-367.13 911.86,-246.12 1123,-493.94 1188.78,-571.15 1207.69,-903.46 1211.63,-992.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1208.14,-993.01 1212.05,-1002.85 1215.13,-992.71 1208.14,-993.01"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1054,-526.94 1000,-526.94 1000,-502.94 1054,-502.94 1054,-526.94"/>
<text text-anchor="middle" x="1027" y="-512.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M40.59,-833.54C41.36,-768.65 48.5,-468.97 115,-412.94 205.22,-336.91 527.67,-438.27 644,-457.94 770.46,-479.32 921.19,-500.57 989.33,-509.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="989.16,-513.46 999.55,-511.35 990.11,-506.52 989.16,-513.46"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="287.5,-529.94 233.5,-529.94 233.5,-505.94 287.5,-505.94 287.5,-529.94"/>
<text text-anchor="middle" x="260.5" y="-515.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M41.74,-833.89C47.26,-782.83 71.18,-585.04 115,-543.94 143.85,-516.87 190.83,-513.06 223.35,-514.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="223.19,-517.76 233.36,-514.81 223.57,-510.77 223.19,-517.76"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="307.5,-487.94 213.5,-487.94 213.5,-463.94 307.5,-463.94 307.5,-487.94"/>
<text text-anchor="middle" x="260.5" y="-473.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M41.27,-833.92C45.13,-778.07 64.12,-544.57 115,-496.94 138.18,-475.24 173.26,-469.75 203.05,-469.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.26,-473.3 213.34,-470.02 203.42,-466.3 203.26,-473.3"/>
</g>
<!-- proc~potential_read -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~potential_read</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/potential_read.html" xlink:title="potential_read">
<polygon fill="#d9534f" stroke="#d9534f" points="569.5,-937.94 480.5,-937.94 480.5,-913.94 569.5,-913.94 569.5,-937.94"/>
<text text-anchor="middle" x="525" y="-923.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_read</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_read -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~potential_read</title>
<path fill="none" stroke="#ff0000" d="M52.4,-857.94C66.13,-870.92 90.05,-890.96 115,-899.94 235.94,-943.44 389.85,-938.5 469.98,-931.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="470.66,-935.27 480.32,-930.91 470.05,-928.29 470.66,-935.27"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="806.5,-1295.94 732.5,-1295.94 732.5,-1271.94 806.5,-1271.94 806.5,-1295.94"/>
<text text-anchor="middle" x="769.5" y="-1281.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M40.48,-858.07C40.65,-924.33 45.15,-1241.59 115,-1300.94 160.94,-1339.96 580.64,-1302.51 722.15,-1288.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="722.64,-1292.1 732.25,-1287.64 721.95,-1285.14 722.64,-1292.1"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node32"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="810.5,-1047.94 728.5,-1047.94 728.5,-1023.94 810.5,-1023.94 810.5,-1047.94"/>
<text text-anchor="middle" x="769.5" y="-1033.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M42.26,-858.04C49.14,-903.49 75.76,-1062.82 115,-1091.94 203.05,-1157.27 501.94,-1100.7 608,-1072.94 624.94,-1068.5 627.24,-1061.99 644,-1056.94 667.93,-1049.72 695.25,-1044.77 718.18,-1041.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="718.95,-1044.92 728.39,-1040.1 718,-1037.99 718.95,-1044.92"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="332,-609.94 189,-609.94 189,-585.94 332,-585.94 332,-609.94"/>
<text text-anchor="middle" x="260.5" y="-595.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M40.56,-833.78C41.45,-796.09 49.63,-680.41 115,-623.94 132.56,-608.77 155.9,-601.1 178.69,-597.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.3,-600.96 188.75,-596.18 178.38,-594.02 179.3,-600.96"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>proc~set_channels_level_indices_channels_omega_values</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././proc/set_channels_level_indices_channels_omega_values.html" xlink:title="set_channels_level_indices_channels_omega_values">
<polygon fill="#d9534f" stroke="#d9534f" points="406,-857.94 115,-857.94 115,-833.94 406,-833.94 406,-857.94"/>
<text text-anchor="middle" x="260.5" y="-843.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_level_indices_channels_omega_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values</title>
<path fill="none" stroke="#ff0000" d="M79.15,-845.94C86.9,-845.94 95.49,-845.94 104.58,-845.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="104.64,-849.44 114.64,-845.94 104.64,-842.44 104.64,-849.44"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-289.94 230.5,-289.94 230.5,-265.94 290.5,-265.94 290.5,-289.94"/>
<text text-anchor="middle" x="260.5" y="-275.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M40.32,-833.7C39.51,-760.71 39.05,-383.1 115,-303.94 141.67,-276.14 187.22,-272.1 220.06,-273.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="220.04,-276.96 230.23,-274.06 220.46,-269.97 220.04,-276.96"/>
</g>
<!-- proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~check_dtol_otol</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/check_dtol_otol.html" xlink:title="check_dtol_otol">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-209.94 213,-209.94 213,-185.94 308,-185.94 308,-209.94"/>
<text text-anchor="middle" x="260.5" y="-195.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_dtol_otol</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~check_dtol_otol</title>
<path fill="none" stroke="#ff0000" d="M41.1,-833.7C45.31,-750.55 71.4,-270.18 115,-223.94 137.07,-200.52 172.51,-193.88 202.77,-193.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.81,-196.66 212.8,-193.12 202.79,-189.66 202.81,-196.66"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-167.94 209.5,-167.94 209.5,-143.94 311.5,-143.94 311.5,-167.94"/>
<text text-anchor="middle" x="260.5" y="-153.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M40.97,-833.89C44.44,-747.67 67.32,-226.24 115,-176.94 136.36,-154.85 169.89,-148.97 199.27,-148.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.4,-152.4 209.47,-149.1 199.54,-145.4 199.4,-152.4"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node38"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="594,-646.94 456,-646.94 456,-622.94 594,-622.94 594,-646.94"/>
<text text-anchor="middle" x="525" y="-632.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M41.06,-833.52C43.39,-798.73 55.2,-700.04 115,-656.94 166.01,-620.17 341.75,-623.7 445.53,-629.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="445.47,-632.9 455.65,-629.98 445.87,-625.91 445.47,-632.9"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M810.19,-1198.69C836.23,-1199.68 869.96,-1204.56 895,-1220.94 919.45,-1236.93 913.87,-1252.27 931,-1275.94 956.96,-1311.79 989.6,-1351.65 1009.08,-1374.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1006.51,-1377.32 1015.62,-1382.73 1011.87,-1372.82 1006.51,-1377.32"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node56"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1062,-946.94 992,-946.94 992,-922.94 1062,-922.94 1062,-946.94"/>
<text text-anchor="middle" x="1027" y="-932.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M810.22,-1188.38C836.77,-1179.05 871.08,-1163.68 895,-1140.94 919.5,-1117.64 913.44,-1102.82 931,-1073.94 957.33,-1030.63 991.58,-982.22 1010.94,-955.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1013.84,-957.43 1016.9,-947.29 1008.18,-953.32 1013.84,-957.43"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="796.5,-1253.94 742.5,-1253.94 742.5,-1229.94 796.5,-1229.94 796.5,-1253.94"/>
<text text-anchor="middle" x="769.5" y="-1239.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~potential_interpolation&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~potential_interpolation&#45;&gt;proc~spline</title>
<path fill="none" stroke="#ff2900" d="M591.62,-1241.94C636.69,-1241.94 694.85,-1241.94 731.92,-1241.94"/>
<polygon fill="#ff2900" stroke="#ff2900" points="732.25,-1245.44 742.25,-1241.94 732.25,-1238.44 732.25,-1245.44"/>
</g>
<!-- proc~set_number_of_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~set_number_of_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff5200" d="M333.2,-793.03C453.66,-777.72 702.37,-759.13 895,-830.94 942.39,-848.6 985.93,-890.36 1008.92,-915.26"/>
<polygon fill="#ff5200" stroke="#ff5200" points="1006.34,-917.62 1015.65,-922.7 1011.54,-912.93 1006.34,-917.62"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff7c00" d="M373.62,-443.19C384.85,-446.18 395.84,-450.02 406,-454.94 425.81,-464.52 421.74,-480.35 442,-488.94 541.24,-530.97 877.82,-521.15 989.58,-516.59"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="989.84,-520.08 999.68,-516.16 989.55,-513.09 989.84,-520.08"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ffa500" d="M536.63,-1345.65C552.28,-1327.56 582.43,-1292.67 608,-1262.94 624.03,-1244.3 622.6,-1233.04 644,-1220.94 666.52,-1208.2 694.74,-1202.74 718.62,-1200.56"/>
<polygon fill="#ffa500" stroke="#ffa500" points="719.19,-1204.03 728.9,-1199.8 718.67,-1197.05 719.19,-1204.03"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ffa500" d="M570.92,-1346.68C583.28,-1342.79 596.45,-1337.88 608,-1331.94 625.78,-1322.78 625.62,-1312.82 644,-1304.94 668.68,-1294.35 698.24,-1289.08 722.37,-1286.47"/>
<polygon fill="#ffa500" stroke="#ffa500" points="722.73,-1289.96 732.35,-1285.51 722.06,-1282.99 722.73,-1289.96"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="806.5,-1417.94 732.5,-1417.94 732.5,-1393.94 806.5,-1393.94 806.5,-1417.94"/>
<text text-anchor="middle" x="769.5" y="-1403.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#ffa500" d="M570.76,-1366.8C613.84,-1375.32 678.68,-1388.16 722.25,-1396.78"/>
<polygon fill="#ffa500" stroke="#ffa500" points="721.81,-1400.26 732.3,-1398.77 723.17,-1393.39 721.81,-1400.26"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="807.5,-1337.94 731.5,-1337.94 731.5,-1313.94 807.5,-1313.94 807.5,-1337.94"/>
<text text-anchor="middle" x="769.5" y="-1323.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#ffa500" d="M570.76,-1352.03C613.46,-1346.39 677.54,-1337.94 721.1,-1332.19"/>
<polygon fill="#ffa500" stroke="#ffa500" points="721.7,-1335.64 731.15,-1330.86 720.78,-1328.7 721.7,-1335.64"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="817,-1089.94 722,-1089.94 722,-1065.94 817,-1065.94 817,-1089.94"/>
<text text-anchor="middle" x="769.5" y="-1075.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#ffa500" d="M540.31,-1345.66C558.88,-1328.9 590.93,-1297.03 608,-1262.94 641.4,-1196.2 589.96,-1150.39 644,-1098.94 661.85,-1081.94 688.04,-1075.82 711.79,-1074.31"/>
<polygon fill="#ffa500" stroke="#ffa500" points="711.94,-1077.8 721.79,-1073.92 711.67,-1070.81 711.94,-1077.8"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="817.5,-1623.94 721.5,-1623.94 721.5,-1599.94 817.5,-1599.94 817.5,-1623.94"/>
<text text-anchor="middle" x="769.5" y="-1609.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#ffce00" d="M544.35,-1540.17C566.86,-1554.59 606.64,-1578.19 644,-1590.94 665.49,-1598.27 689.98,-1603.1 711.51,-1606.26"/>
<polygon fill="#ffce00" stroke="#ffce00" points="711.12,-1609.74 721.5,-1607.64 712.07,-1602.81 711.12,-1609.74"/>
</g>
<!-- proc~is_open -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~is_open</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/is_open.html" xlink:title="is_open">
<polygon fill="#d94e8f" stroke="#d94e8f" points="796.5,-567.94 742.5,-567.94 742.5,-543.94 796.5,-543.94 796.5,-567.94"/>
<text text-anchor="middle" x="769.5" y="-553.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_open</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ffce00" d="M535.37,-1515.65C553.4,-1491.21 592.5,-1434.08 608,-1378.94 632.13,-1293.06 584.9,-643.74 644,-576.94 665.54,-552.59 703.9,-549.4 732.36,-551.03"/>
<polygon fill="#ffce00" stroke="#ffce00" points="732.11,-554.52 742.36,-551.82 732.66,-547.54 732.11,-554.52"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="839.5,-1665.94 699.5,-1665.94 699.5,-1641.94 839.5,-1641.94 839.5,-1665.94"/>
<text text-anchor="middle" x="769.5" y="-1651.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#ffce00" d="M535.54,-1540.07C553.89,-1562.49 596.53,-1610.17 644,-1632.94 657.94,-1639.62 673.66,-1644.22 689.11,-1647.37"/>
<polygon fill="#ffce00" stroke="#ffce00" points="688.73,-1650.86 699.2,-1649.24 690,-1643.97 688.73,-1650.86"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="816,-1749.94 723,-1749.94 723,-1725.94 816,-1725.94 816,-1749.94"/>
<text text-anchor="middle" x="769.5" y="-1735.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#ffce00" d="M529.68,-1540.16C540.68,-1574.45 576.82,-1671.96 644,-1716.94 663.98,-1730.31 689.7,-1736.08 712.57,-1738.3"/>
<polygon fill="#ffce00" stroke="#ffce00" points="712.61,-1741.82 722.85,-1739.09 713.14,-1734.84 712.61,-1741.82"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="796.5,-250.94 742.5,-250.94 742.5,-226.94 796.5,-226.94 796.5,-250.94"/>
<text text-anchor="middle" x="769.5" y="-236.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#ffce00" d="M535.41,-1515.66C553.5,-1491.24 592.71,-1434.14 608,-1378.94 665.17,-1172.56 575.58,-618.86 644,-415.94 665.82,-351.23 719.41,-289.18 748.66,-258.63"/>
<polygon fill="#ffce00" stroke="#ffce00" points="751.41,-260.83 755.88,-251.22 746.4,-255.94 751.41,-260.83"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="796.5,-1539.94 742.5,-1539.94 742.5,-1515.94 796.5,-1515.94 796.5,-1539.94"/>
<text text-anchor="middle" x="769.5" y="-1525.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#ffce00" d="M581.03,-1527.94C627.34,-1527.94 692.23,-1527.94 732.26,-1527.94"/>
<polygon fill="#ffce00" stroke="#ffce00" points="732.36,-1531.44 742.36,-1527.94 732.36,-1524.44 732.36,-1531.44"/>
</g>
<!-- proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~wavenumber_from_energy</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/wavenumber_from_energy.html" xlink:title="wavenumber_from_energy">
<polygon fill="#d94e8f" stroke="#d94e8f" points="847,-609.94 692,-609.94 692,-585.94 847,-585.94 847,-609.94"/>
<text text-anchor="middle" x="769.5" y="-595.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wavenumber_from_energy</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#ffce00" d="M535.36,-1515.65C553.37,-1491.2 592.43,-1434.06 608,-1378.94 630.97,-1297.58 587.91,-682.18 644,-618.94 653.93,-607.74 667.41,-601.03 681.85,-597.19"/>
<polygon fill="#ffce00" stroke="#ffce00" points="682.94,-600.54 691.96,-594.98 681.44,-593.7 682.94,-600.54"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#fff800" d="M837.54,-1437.54C856.19,-1434.4 876.43,-1430.76 895,-1426.94 919.77,-1421.83 946.96,-1415.33 970.11,-1409.53"/>
<polygon fill="#fff800" stroke="#fff800" points="971.27,-1412.85 980.11,-1407.01 969.56,-1406.06 971.27,-1412.85"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#fff800" d="M837.55,-1456.09C911.62,-1461.98 1032.41,-1462.15 1123,-1415.94 1237.98,-1357.29 1314.34,-1210.85 1339.71,-1156.07"/>
<polygon fill="#fff800" stroke="#fff800" points="1342.91,-1157.5 1343.86,-1146.94 1336.53,-1154.6 1342.91,-1157.5"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#fff800" d="M837.7,-1450.9C858.51,-1448.4 879.91,-1441.76 895,-1426.94 957.23,-1365.77 869.64,-1295.97 931,-1233.94 992.17,-1172.09 1053.93,-1248.82 1123,-1195.94 1175.69,-1155.59 1199.4,-1075.93 1208.17,-1037.17"/>
<polygon fill="#fff800" stroke="#fff800" points="1211.68,-1037.47 1210.35,-1026.96 1204.84,-1036.01 1211.68,-1037.47"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#b3ff00" d="M827.17,-1572.03C850.37,-1570.13 876.15,-1564.14 895,-1548.94 928.53,-1521.89 903.94,-1492.46 931,-1458.94 947.07,-1439.03 970.97,-1422.97 990.78,-1411.92"/>
<polygon fill="#b3ff00" stroke="#b3ff00" points="992.69,-1414.87 999.84,-1407.05 989.38,-1408.7 992.69,-1414.87"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#b3ff00" d="M827.1,-1570.1C849.76,-1567.8 875.15,-1562.03 895,-1548.94 919.7,-1532.64 906.7,-1509.82 931,-1492.94 1002.73,-1443.08 1042.79,-1485.53 1123,-1450.94 1194.65,-1420.03 1219.88,-1413.36 1268,-1351.94 1315.8,-1290.91 1337.54,-1198.74 1345.37,-1156.94"/>
<polygon fill="#b3ff00" stroke="#b3ff00" points="1348.83,-1157.46 1347.14,-1147 1341.94,-1156.23 1348.83,-1157.46"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#89ff00" d="M833.41,-986.3C950.37,-973.33 1195.96,-952.24 1268,-993.94 1312.34,-1019.6 1334.52,-1079.74 1343.68,-1112.57"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1340.38,-1113.79 1346.3,-1122.57 1347.15,-1112.01 1340.38,-1113.79"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#37ff00" d="M822.62,-430.11C897.89,-423.27 1037.37,-422.38 1123,-493.94 1323.79,-661.72 1346.3,-1019.79 1348.73,-1112.6"/>
<polygon fill="#37ff00" stroke="#37ff00" points="1345.23,-1112.87 1348.94,-1122.79 1352.23,-1112.72 1345.23,-1112.87"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#37ff00" d="M822.79,-445.78C845.24,-450.11 871.63,-455.91 895,-462.94 928.04,-472.86 964.42,-487.63 990.44,-498.89"/>
<polygon fill="#37ff00" stroke="#37ff00" points="989.31,-502.22 999.88,-503.02 992.12,-495.8 989.31,-502.22"/>
</g>
<!-- proc~crosssection&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~crosssection&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#00ff1b" d="M538.46,-1149.92C555.26,-1133.4 585.62,-1102.37 608,-1072.94 626.36,-1048.78 618.81,-1031.85 644,-1014.94 659.2,-1004.73 677.74,-998.95 695.82,-995.79"/>
<polygon fill="#00ff1b" stroke="#00ff1b" points="696.42,-999.24 705.79,-994.3 695.38,-992.32 696.42,-999.24"/>
</g>
<!-- proc~crosssection&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~crosssection&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#00ff1b" d="M545.54,-1174.09C562.81,-1185.25 588.24,-1202.78 608,-1220.94 626.11,-1237.57 622.6,-1250.83 644,-1262.94 667.62,-1276.29 697.52,-1281.64 722.09,-1283.61"/>
<polygon fill="#00ff1b" stroke="#00ff1b" points="722.06,-1287.11 732.26,-1284.25 722.51,-1280.12 722.06,-1287.11"/>
</g>
<!-- proc~set_channels_l_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~set_channels_l_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#00ff6e" d="M325.97,-671.71C447.77,-663.26 715.54,-660.75 895,-777.94 949.92,-813.8 993.8,-879.67 1013.97,-913.56"/>
<polygon fill="#00ff6e" stroke="#00ff6e" points="1011.18,-915.72 1019.24,-922.6 1017.23,-912.2 1011.18,-915.72"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="597.5,-1021.94 452.5,-1021.94 452.5,-997.94 597.5,-997.94 597.5,-1021.94"/>
<text text-anchor="middle" x="525" y="-1007.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#00ff97" d="M344.56,-1035.91C375.73,-1031.4 411.11,-1026.28 442.18,-1021.78"/>
<polygon fill="#00ff97" stroke="#00ff97" points="442.7,-1025.24 452.1,-1020.34 441.7,-1018.31 442.7,-1025.24"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="565,-979.94 485,-979.94 485,-955.94 565,-955.94 565,-979.94"/>
<text text-anchor="middle" x="525" y="-965.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#00ff97" d="M379.54,-1037.6C388.73,-1034.76 397.67,-1031.25 406,-1026.94 426.65,-1016.23 421.95,-1000.73 442,-988.94 451.99,-983.06 463.62,-978.81 474.91,-975.74"/>
<polygon fill="#00ff97" stroke="#00ff97" points="475.83,-979.12 484.71,-973.34 474.16,-972.32 475.83,-979.12"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#00ffc0" d="M350.68,-975.98C369.01,-978.71 388.16,-981.75 406,-984.94 423.75,-988.1 442.91,-991.97 460.52,-995.7"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="460.18,-999.21 470.69,-997.88 461.64,-992.36 460.18,-999.21"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#00ffc0" d="M360.37,-965.44C399.45,-966.04 442.61,-966.7 474.79,-967.19"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="474.78,-970.69 484.84,-967.34 474.89,-963.69 474.78,-970.69"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="1054,-671.94 1000,-671.94 1000,-647.94 1054,-647.94 1054,-671.94"/>
<text text-anchor="middle" x="1027" y="-657.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#00ffc0" d="M291.94,-951.83C413.06,-903.67 860.48,-725.75 990.41,-674.09"/>
<polygon fill="#00ffc0" stroke="#00ffc0" points="991.9,-677.26 999.9,-670.31 989.32,-670.76 991.9,-677.26"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#00ffea" d="M572.18,-1048.89C613.82,-1046.14 674.94,-1042.11 717.89,-1039.27"/>
<polygon fill="#00ffea" stroke="#00ffea" points="718.38,-1042.75 728.12,-1038.6 717.92,-1035.77 718.38,-1042.75"/>
</g>
<!-- proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>proc~calculate_sum_of_squares_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node59"><a xlink:href=".././proc/calculate_sum_of_squares_for_each_channel.html" xlink:title="calculate_sum_of_squares_for_each_channel">
<polygon fill="#d9534f" stroke="#d9534f" points="895,-963.94 644,-963.94 644,-939.94 895,-939.94 895,-963.94"/>
<text text-anchor="middle" x="769.5" y="-949.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_sum_of_squares_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~calculate_sum_of_squares_for_each_channel</title>
<path fill="none" stroke="#00ffea" d="M572.12,-1046.56C584.63,-1043.46 597.57,-1038.59 608,-1030.94 632.46,-1012.99 618.81,-989.85 644,-972.94 646.43,-971.3 648.95,-969.78 651.53,-968.37"/>
<polygon fill="#00ffea" stroke="#00ffea" points="653.12,-971.49 660.57,-963.96 650.05,-965.2 653.12,-971.49"/>
</g>
<!-- proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~check_unitarity_for_each_channel</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/check_unitarity_for_each_channel.html" xlink:title="check_unitarity_for_each_channel">
<polygon fill="#d94e8f" stroke="#d94e8f" points="866,-921.94 673,-921.94 673,-897.94 866,-897.94 866,-921.94"/>
<text text-anchor="middle" x="769.5" y="-907.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_unitarity_for_each_channel</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~check_unitarity_for_each_channel</title>
<path fill="none" stroke="#00ffea" d="M572.38,-1048.12C585.18,-1045.07 598.21,-1039.83 608,-1030.94 642.95,-999.15 607.76,-961.23 644,-930.94 649.78,-926.1 656.26,-922.19 663.13,-919.04"/>
<polygon fill="#00ffea" stroke="#00ffea" points="664.75,-922.16 672.73,-915.19 662.14,-915.66 664.75,-922.16"/>
</g>
<!-- proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~handle_unitarity_output_message</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/handle_unitarity_output_message.html" xlink:title="handle_unitarity_output_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1123,-1266.94 931,-1266.94 931,-1242.94 1123,-1242.94 1123,-1266.94"/>
<text text-anchor="middle" x="1027" y="-1252.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">handle_unitarity_output_message</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~handle_unitarity_output_message</title>
<path fill="none" stroke="#00ffea" d="M537.78,-1064.11C557.65,-1083.83 600.01,-1122.43 644,-1140.94 748,-1184.69 788.56,-1141.52 895,-1178.94 916,-1186.31 966.51,-1217.17 998.32,-1237.22"/>
<polygon fill="#00ffea" stroke="#00ffea" points="996.83,-1240.42 1007.15,-1242.81 1000.57,-1234.51 996.83,-1240.42"/>
</g>
<!-- proc~calculate_single_sf_element -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~calculate_single_sf_element</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/calculate_single_sf_element.html" xlink:title="calculate_single_SF_element">
<polygon fill="#d9534f" stroke="#d9534f" points="608,-727.94 442,-727.94 442,-703.94 608,-703.94 608,-727.94"/>
<text text-anchor="middle" x="525" y="-713.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_single_SF_element</text>
</a>
</g>
</g>
<!-- proc~calculate_sf_matrix_from_bf_matrix&#45;&gt;proc~calculate_single_sf_element -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~calculate_sf_matrix_from_bf_matrix&#45;&gt;proc~calculate_single_sf_element</title>
<path fill="none" stroke="#00eaff" d="M350.68,-749.9C369.01,-747.16 388.16,-744.12 406,-740.94 423.75,-737.77 442.91,-733.9 460.52,-730.17"/>
<polygon fill="#00eaff" stroke="#00eaff" points="461.64,-733.51 470.69,-727.99 460.18,-726.66 461.64,-733.51"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="833,-208.94 706,-208.94 706,-184.94 833,-184.94 833,-208.94"/>
<text text-anchor="middle" x="769.5" y="-194.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00c0ff" d="M581.03,-167.56C615,-172.88 658.99,-179.77 695.81,-185.55"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="695.57,-189.05 706,-187.14 696.66,-182.13 695.57,-189.05"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00c0ff" d="M581.07,-168.48C590.43,-171.36 599.77,-175.09 608,-179.94 628.05,-191.73 623.47,-206.99 644,-217.94 671.2,-232.44 706.09,-237.34 732,-238.82"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="732.02,-242.32 742.16,-239.25 732.32,-235.33 732.02,-242.32"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="842,-166.94 697,-166.94 697,-142.94 842,-142.94 842,-166.94"/>
<text text-anchor="middle" x="769.5" y="-152.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00c0ff" d="M581.03,-158.03C612.19,-157.51 651.77,-156.86 686.52,-156.29"/>
<polygon fill="#00c0ff" stroke="#00c0ff" points="686.72,-159.78 696.66,-156.12 686.6,-152.79 686.72,-159.78"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0044ff" d="M882.96,-1683.91C887.25,-1681.33 891.3,-1678.36 895,-1674.94 943.15,-1630.47 903.89,-1591.6 931,-1531.94 951.55,-1486.72 987.23,-1440.56 1008.53,-1415.04"/>
<polygon fill="#0044ff" stroke="#0044ff" points="1011.37,-1417.11 1015.16,-1407.21 1006.03,-1412.58 1011.37,-1417.11"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0044ff" d="M850.14,-1683.9C865.1,-1681.24 880.58,-1678.23 895,-1674.94 1067.78,-1635.49 1161.19,-1675.36 1268,-1533.94 1313.89,-1473.18 1339.91,-1232.1 1347,-1157.23"/>
<polygon fill="#0044ff" stroke="#0044ff" points="1350.5,-1157.34 1347.94,-1147.06 1343.53,-1156.7 1350.5,-1157.34"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~potential_read&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#8900ff" d="M569.91,-928.04C583.84,-930.87 598.16,-936.42 608,-946.94 667.89,-1010.99 590.52,-1071.44 644,-1140.94 662.37,-1164.8 692.78,-1179.47 718.96,-1188.2"/>
<polygon fill="#8900ff" stroke="#8900ff" points="718.16,-1191.62 728.74,-1191.27 720.25,-1184.94 718.16,-1191.62"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~potential_read&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#8900ff" d="M569.63,-927.36C583.88,-930.09 598.48,-935.74 608,-946.94 665.83,-1014.91 582.01,-1282.73 644,-1346.94 654.67,-1357.99 846.97,-1377.91 954.57,-1388.27"/>
<polygon fill="#8900ff" stroke="#8900ff" points="954.42,-1391.78 964.7,-1389.25 955.08,-1384.81 954.42,-1391.78"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~potential_read&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#8900ff" d="M545.1,-913.82C567.69,-900.27 606.93,-879.15 644,-870.94 752.91,-846.8 783.93,-860.55 895,-870.94 997.67,-880.53 1033.31,-863.05 1123,-913.94 1157.18,-933.33 1184.99,-970.67 1200.11,-994.11"/>
<polygon fill="#8900ff" stroke="#8900ff" points="1197.17,-996.02 1205.44,-1002.64 1203.11,-992.3 1197.17,-996.02"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~potential_read&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#8900ff" d="M555.96,-913.76C579.46,-904.89 613.23,-893.65 644,-888.94 754.27,-872.05 785.03,-870.19 895,-888.94 928.5,-894.65 964.84,-908.02 990.72,-918.88"/>
<polygon fill="#8900ff" stroke="#8900ff" points="989.53,-922.18 1000.1,-922.9 992.29,-915.75 989.53,-922.18"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#dc00ff" d="M810.71,-1038.22C876.47,-1042.41 1010.93,-1052.9 1123,-1073.94 1185.7,-1085.7 1256.49,-1105.98 1301.86,-1119.9"/>
<polygon fill="#dc00ff" stroke="#dc00ff" points="1300.84,-1123.25 1311.43,-1122.85 1302.91,-1116.56 1300.84,-1123.25"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1074,-1106.94 980,-1106.94 980,-1082.94 1074,-1082.94 1074,-1106.94"/>
<text text-anchor="middle" x="1027" y="-1092.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#dc00ff" d="M810.63,-1041.1C835.19,-1044.65 867.14,-1049.99 895,-1056.94 911.36,-1061.02 914.86,-1064.04 931,-1068.94 943.65,-1072.77 957.32,-1076.66 970.24,-1080.22"/>
<polygon fill="#dc00ff" stroke="#dc00ff" points="969.38,-1083.62 979.95,-1082.88 971.23,-1076.86 969.38,-1083.62"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#dc00ff" d="M810.76,-1033.06C835.64,-1030.33 867.9,-1025.07 895,-1014.94 935.42,-999.83 977.11,-971.83 1002.3,-953.29"/>
<polygon fill="#dc00ff" stroke="#dc00ff" points="1004.58,-955.96 1010.49,-947.16 1000.39,-950.35 1004.58,-955.96"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff00f8" d="M332.27,-594.7C402.37,-591.2 512.73,-584.89 608,-575.94 650.89,-571.91 700,-565.52 732.49,-561.06"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="733,-564.52 742.42,-559.68 732.04,-557.59 733,-564.52"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff00ce" d="M406.06,-834.89C536.05,-828.88 731.17,-829.64 895,-870.94 933.04,-880.52 973.03,-901.96 998.67,-917.38"/>
<polygon fill="#ff00ce" stroke="#ff00ce" points="997.08,-920.51 1007.43,-922.76 1000.74,-914.54 997.08,-920.51"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff00a5" d="M275.6,-290.04C302.1,-313.03 360.76,-364.99 406,-412.94 445.07,-454.35 486.73,-506.65 508.58,-534.8"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="505.81,-536.95 514.7,-542.72 511.35,-532.67 505.81,-536.95"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00a5" d="M290.57,-274.14C323.57,-268.25 376.62,-253.71 406,-218.94 453.32,-162.93 386.13,-105.42 442,-57.94 497.38,-10.87 695.82,-38.94 768.5,-38.94 768.5,-38.94 768.5,-38.94 1028,-38.94 1260.12,-38.94 1336.16,-955.76 1347.46,-1112.33"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="1343.99,-1112.9 1348.18,-1122.63 1350.97,-1112.4 1343.99,-1112.9"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff00a5" d="M290.53,-275.54C426.74,-264.97 1001.06,-227.99 1123,-344.94 1171.06,-391.02 1204.25,-881.99 1211.16,-992.8"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="1207.67,-993.07 1211.78,-1002.84 1214.66,-992.64 1207.67,-993.07"/>
</g>
<!-- proc~numerov&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~numerov&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff00a5" d="M290.75,-289.66C326.08,-303.42 387.56,-326.12 442,-339.94 639.87,-390.15 707.5,-335.18 895,-415.94 939.69,-435.18 983.03,-472.78 1006.95,-495.7"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="1004.69,-498.38 1014.29,-502.86 1009.57,-493.37 1004.69,-498.38"/>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.58,-273.29C368.3,-260.87 582.6,-226.64 695.98,-208.52"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="696.64,-211.96 705.96,-206.93 695.53,-205.05 696.64,-211.96"/>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.55,-272.8C322.54,-265.76 373.71,-250.25 406,-218.94 434.28,-191.51 408.97,-159.4 442,-137.94 531.18,-79.98 664.73,-115.97 729.92,-139.43"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="728.81,-142.76 739.41,-142.93 731.24,-136.19 728.81,-142.76"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node51"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="575.5,-330.94 474.5,-330.94 474.5,-306.94 575.5,-306.94 575.5,-330.94"/>
<text text-anchor="middle" x="525" y="-316.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#ff00a5" d="M290.6,-282.48C332.23,-288.98 409.75,-301.09 463.99,-309.56"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="463.75,-313.07 474.17,-311.15 464.83,-306.15 463.75,-313.07"/>
</g>
<!-- proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~cenitrfugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/cenitrfugal_matrix.html" xlink:title="cenitrfugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="580,-90.94 470,-90.94 470,-66.94 580,-66.94 580,-90.94"/>
<text text-anchor="middle" x="525" y="-76.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cenitrfugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~numerov&#45;&gt;proc~cenitrfugal_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.63,-273.57C323.19,-267.18 375.34,-252.21 406,-218.94 442,-179.86 404.45,-142.53 442,-104.94 447.22,-99.7 453.49,-95.53 460.21,-92.19"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="461.8,-95.31 469.59,-88.13 459.02,-88.89 461.8,-95.31"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="598,-212.94 452,-212.94 452,-188.94 598,-188.94 598,-212.94"/>
<text text-anchor="middle" x="525" y="-198.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#ff00a5" d="M290.76,-276.34C320.71,-273.87 368.08,-267.63 406,-251.94 424,-244.48 424.52,-235.53 442,-226.94 450.17,-222.92 459.1,-219.34 467.96,-216.22"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="469.14,-219.51 477.51,-213.01 466.92,-212.88 469.14,-219.51"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~is_open -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~is_open</title>
<path fill="none" stroke="#ff0029" d="M575.54,-622.91C586.6,-619.23 598,-614.62 608,-608.94 626.61,-598.36 624.69,-586.19 644,-576.94 671.8,-563.61 706.62,-558.59 732.37,-556.77"/>
<polygon fill="#ff0029" stroke="#ff0029" points="732.67,-560.26 742.45,-556.19 732.26,-553.27 732.67,-560.26"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~wavenumber_from_energy</title>
<path fill="none" stroke="#ff0029" d="M594.2,-624.53C621.39,-620.38 653.02,-615.56 681.81,-611.16"/>
<polygon fill="#ff0029" stroke="#ff0029" points="682.5,-614.6 691.86,-609.63 681.45,-607.68 682.5,-614.6"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M817.63,-1614.67C843.07,-1613.71 873.57,-1608.35 895,-1590.94 929.07,-1563.24 907.8,-1536.22 931,-1498.94 951.62,-1465.8 983.46,-1433.55 1004.51,-1413.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1006.99,-1416.44 1012,-1407.11 1002.26,-1411.28 1006.99,-1416.44"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="1054,-1564.94 1000,-1564.94 1000,-1540.94 1054,-1540.94 1054,-1564.94"/>
<text text-anchor="middle" x="1027" y="-1550.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#ff0000" d="M817.56,-1605.75C841.01,-1602.23 869.69,-1597.25 895,-1590.94 911.36,-1586.85 914.86,-1583.83 931,-1578.94 950.29,-1573.09 971.95,-1567.11 989.72,-1562.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="990.91,-1565.67 999.68,-1559.73 989.12,-1558.91 990.91,-1565.67"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1257,-1524.94 1170,-1524.94 1170,-1500.94 1257,-1500.94 1257,-1524.94"/>
<text text-anchor="middle" x="1213.5" y="-1510.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0000" d="M817.71,-1613.1C842.58,-1611.57 872.49,-1606.17 895,-1590.94 920.44,-1573.72 904.73,-1547.86 931,-1531.94 1001.08,-1489.44 1099.8,-1494.37 1159.79,-1502.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1159.39,-1506.38 1169.8,-1504.4 1160.43,-1499.45 1159.39,-1506.38"/>
</g>
<!-- proc~is_open&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~is_open&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ffb700" d="M796.88,-551.7C842.8,-544.33 937.5,-529.14 989.63,-520.77"/>
<polygon fill="#ffb700" stroke="#ffb700" points="990.44,-524.19 999.76,-519.15 989.33,-517.27 990.44,-524.19"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#fff400" d="M839.62,-1655.03C859.34,-1652.18 879.63,-1645.82 895,-1632.94 931.52,-1602.32 909.23,-1574.33 931,-1531.94 953.81,-1487.52 989.01,-1440.76 1009.55,-1414.98"/>
<polygon fill="#fff400" stroke="#fff400" points="1012.37,-1417.06 1015.92,-1407.07 1006.92,-1412.67 1012.37,-1417.06"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node65"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="1054,-1720.94 1000,-1720.94 1000,-1696.94 1054,-1696.94 1054,-1720.94"/>
<text text-anchor="middle" x="1027" y="-1706.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#fff400" d="M839.52,-1664.48C857.63,-1667.55 877.1,-1671.11 895,-1674.94 927.25,-1681.83 963.52,-1691.38 989.7,-1698.61"/>
<polygon fill="#fff400" stroke="#fff400" points="988.99,-1702.04 999.57,-1701.35 990.87,-1695.3 988.99,-1702.04"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#fff400" d="M839.71,-1645.43C857.91,-1642.33 877.37,-1638.25 895,-1632.94 911.76,-1627.88 914.38,-1622.43 931,-1616.94 1014.03,-1589.49 1042.78,-1608.74 1123,-1573.94 1147.91,-1563.13 1173.19,-1545.11 1190.5,-1531.45"/>
<polygon fill="#fff400" stroke="#fff400" points="1192.73,-1534.15 1198.32,-1525.15 1188.34,-1528.7 1192.73,-1534.15"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#8eff00" d="M807.53,-1332.55C832.42,-1337.27 865.88,-1344.14 895,-1351.94 924.7,-1359.88 957.58,-1370.68 982.96,-1379.47"/>
<polygon fill="#8eff00" stroke="#8eff00" points="982.06,-1382.86 992.65,-1382.85 984.37,-1376.25 982.06,-1382.86"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#8eff00" d="M807.55,-1324.3C872.63,-1320.63 1011.19,-1309.26 1123,-1275.94 1191.21,-1255.6 1208.7,-1247.3 1268,-1207.94 1291.58,-1192.28 1315.25,-1170.01 1330.86,-1154.19"/>
<polygon fill="#8eff00" stroke="#8eff00" points="1333.39,-1156.61 1337.84,-1147 1328.36,-1151.74 1333.39,-1156.61"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#8eff00" d="M807.61,-1329.77C835.18,-1330.47 871.87,-1326.57 895,-1304.94 945.39,-1257.81 890.66,-1209.9 931,-1153.94 944.46,-1135.26 965.84,-1121.22 984.91,-1111.54"/>
<polygon fill="#8eff00" stroke="#8eff00" points="986.56,-1114.63 994.04,-1107.13 983.51,-1108.33 986.56,-1114.63"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#8eff00" d="M807.54,-1330.26C835.44,-1331.31 872.59,-1327.63 895,-1304.94 968.01,-1231 892.74,-1170.54 931,-1073.94 949.47,-1027.3 985.86,-980.73 1007.85,-955.09"/>
<polygon fill="#8eff00" stroke="#8eff00" points="1010.78,-957.07 1014.71,-947.23 1005.5,-952.46 1010.78,-957.07"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#51ff00" d="M816.16,-1742.14C842.57,-1741.97 874.52,-1736.91 895,-1716.94 954.97,-1658.45 898.44,-1609.11 931,-1531.94 950.31,-1486.17 986.42,-1440.2 1008.13,-1414.87"/>
<polygon fill="#51ff00" stroke="#51ff00" points="1010.97,-1416.94 1014.89,-1407.1 1005.69,-1412.34 1010.97,-1416.94"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="1054,-1762.94 1000,-1762.94 1000,-1738.94 1054,-1738.94 1054,-1762.94"/>
<text text-anchor="middle" x="1027" y="-1748.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#51ff00" d="M816.18,-1740.26C865.85,-1742.79 944.22,-1746.77 989.81,-1749.09"/>
<polygon fill="#51ff00" stroke="#51ff00" points="989.68,-1752.59 999.84,-1749.6 990.03,-1745.6 989.68,-1752.59"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#51ff00" d="M816.19,-1735.8C840.47,-1733.32 870.31,-1728.04 895,-1716.94 913.74,-1708.51 913.32,-1698.4 931,-1687.94 1010.42,-1640.95 1047.12,-1661.45 1123,-1608.94 1153.63,-1587.74 1181.64,-1554.47 1197.88,-1533.18"/>
<polygon fill="#51ff00" stroke="#51ff00" points="1200.72,-1535.24 1203.9,-1525.13 1195.11,-1531.05 1200.72,-1535.24"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#14ff00" d="M817.01,-1073.8C843.22,-1074.1 874.67,-1079.28 895,-1098.94 952.71,-1154.74 897.01,-1203.21 931,-1275.94 949.52,-1315.57 983.8,-1353.69 1005.72,-1375.69"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1003.33,-1378.25 1012.91,-1382.78 1008.24,-1373.26 1003.33,-1378.25"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#14ff00" d="M817.03,-1082.71C840.74,-1085.91 869.8,-1091.03 895,-1098.94 911.88,-1104.23 913.83,-1111.67 931,-1115.94 1057.68,-1147.38 1212.46,-1144.04 1293.48,-1139.26"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1294.17,-1142.72 1303.94,-1138.61 1293.74,-1135.74 1294.17,-1142.72"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#14ff00" d="M817.38,-1071.25C897.07,-1059.89 1059.02,-1036.81 1148.86,-1024.01"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1149.51,-1027.45 1158.92,-1022.57 1148.53,-1020.52 1149.51,-1027.45"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#14ff00" d="M817.25,-1082.91C843.88,-1082.97 875.68,-1077.89 895,-1056.94 958.2,-988.39 897.3,-725.86 931,-638.94 947.31,-596.86 982.55,-557.1 1005.22,-534.42"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1007.97,-536.63 1012.67,-527.13 1003.07,-531.62 1007.97,-536.63"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ffe0" d="M542.87,-306.82C559.83,-294.4 586.49,-274.22 608,-254.94 625.08,-239.62 623.68,-228.59 644,-217.94 659.74,-209.68 678,-204.55 695.6,-201.39"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="696.55,-204.78 705.87,-199.75 695.44,-197.87 696.55,-204.78"/>
</g>
<!-- proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~radtermvalue</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/radtermvalue.html" xlink:title="RADTERMVALUE">
<polygon fill="#d9534f" stroke="#d9534f" points="818,-1131.94 721,-1131.94 721,-1107.94 818,-1107.94 818,-1131.94"/>
<text text-anchor="middle" x="769.5" y="-1117.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RADTERMVALUE</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~radtermvalue</title>
<path fill="none" stroke="#00ffe0" d="M532.16,-331.13C548.08,-363.3 590.52,-453.52 608,-533.94 621.36,-595.41 601.88,-1052.21 644,-1098.94 660.57,-1117.31 686.73,-1123.57 710.8,-1124.82"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="710.88,-1128.32 720.96,-1125.06 711.05,-1121.32 710.88,-1128.32"/>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0066ff" d="M544.99,-91.11C562.12,-102.42 587.66,-120.17 608,-137.94 625.52,-153.24 623.47,-164.99 644,-175.94 659.68,-184.3 677.92,-189.47 695.53,-192.63"/>
<polygon fill="#0066ff" stroke="#0066ff" points="695.36,-196.15 705.79,-194.27 696.47,-189.24 695.36,-196.15"/>
</g>
<!-- dfloat -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>dfloat</title>
<polygon fill="#777777" stroke="#777777" points="796.5,-90.94 742.5,-90.94 742.5,-66.94 796.5,-66.94 796.5,-90.94"/>
<text text-anchor="middle" x="769.5" y="-76.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfloat</text>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;dfloat -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;dfloat</title>
<path fill="none" stroke="#0066ff" d="M580.12,-78.94C626.51,-78.94 692.03,-78.94 732.32,-78.94"/>
<polygon fill="#0066ff" stroke="#0066ff" points="732.48,-82.44 742.48,-78.94 732.48,-75.44 732.48,-82.44"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#0028ff" d="M598.1,-199.75C628.83,-199.24 664.63,-198.65 695.47,-198.14"/>
<polygon fill="#0028ff" stroke="#0028ff" points="695.78,-201.64 705.72,-197.97 695.66,-194.64 695.78,-201.64"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#0028ff" d="M598.1,-212.23C642.13,-219.13 696.57,-227.66 731.89,-233.2"/>
<polygon fill="#0028ff" stroke="#0028ff" points="731.78,-236.72 742.21,-234.82 732.87,-229.81 731.78,-236.72"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#0028ff" d="M580.54,-188.88C600.47,-184.61 623.22,-179.89 644,-175.94 657.91,-173.29 672.73,-170.64 687.11,-168.16"/>
<polygon fill="#0028ff" stroke="#0028ff" points="687.71,-171.61 696.98,-166.47 686.53,-164.71 687.71,-171.61"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#1400ff" d="M1062.26,-928.89C1112.41,-922.03 1206.5,-916.89 1268,-960.94 1319.04,-997.49 1338.82,-1074.48 1345.72,-1112.59"/>
<polygon fill="#1400ff" stroke="#1400ff" points="1342.3,-1113.38 1347.4,-1122.67 1349.2,-1112.23 1342.3,-1113.38"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#5100ff" d="M847,-588.44C863.05,-585.5 879.73,-581.73 895,-576.94 931.13,-565.58 970.06,-546.14 996.01,-532.06"/>
<polygon fill="#5100ff" stroke="#5100ff" points="997.88,-535.02 1004.95,-527.13 994.5,-528.89 997.88,-535.02"/>
</g>
<!-- proc~wavenumber_from_energy&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~wavenumber_from_energy&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#5100ff" d="M847.32,-598.7C864.41,-602.02 881.45,-608.15 895,-618.94 919.75,-638.64 994.07,-844.5 1018.28,-912.95"/>
<polygon fill="#5100ff" stroke="#5100ff" points="1015.1,-914.44 1021.72,-922.7 1021.7,-912.11 1015.1,-914.44"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00b7" d="M796.76,-1241.77C823.01,-1242.63 863.86,-1246.8 895,-1262.94 946.7,-1289.73 990.57,-1344.28 1011.98,-1374.18"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1009.29,-1376.43 1017.89,-1382.61 1015.02,-1372.42 1009.29,-1376.43"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff00b7" d="M796.72,-1245.21C824.71,-1247.15 868.59,-1245.48 895,-1220.94 944.27,-1175.14 903.58,-1135.36 931,-1073.94 951.55,-1027.89 987.54,-980.79 1008.83,-954.96"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="1011.72,-956.96 1015.45,-947.05 1006.35,-952.47 1011.72,-956.96"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff007a" d="M1076.69,-1242.88C1091.67,-1238.84 1108.12,-1234.04 1123,-1228.94 1191.9,-1205.29 1269.86,-1171.16 1313.86,-1151.19"/>
<polygon fill="#ff007a" stroke="#ff007a" points="1315.33,-1154.37 1322.97,-1147.04 1312.42,-1148 1315.33,-1154.37"/>
</g>
<!-- proc~handle_unitarity_output_message&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~handle_unitarity_output_message&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff007a" d="M1038.41,-1267.12C1056.36,-1288.31 1094.01,-1333.57 1123,-1373.94 1152.21,-1414.6 1183.17,-1464.38 1199.93,-1491.98"/>
<polygon fill="#ff007a" stroke="#ff007a" points="1197.07,-1494.02 1205.24,-1500.76 1203.06,-1490.39 1197.07,-1494.02"/>
</g>
<!-- proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~p_coeff</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/p_coeff.html" xlink:title="p_coeff">
<polygon fill="#d94e8f" stroke="#d94e8f" points="796.5,-651.94 742.5,-651.94 742.5,-627.94 796.5,-627.94 796.5,-651.94"/>
<text text-anchor="middle" x="769.5" y="-637.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_coeff</text>
</a>
</g>
</g>
<!-- proc~calculate_single_sf_element&#45;&gt;proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~calculate_single_sf_element&#45;&gt;proc~p_coeff</title>
<path fill="none" stroke="#ff003d" d="M550.79,-703.75C574.3,-692.6 610.88,-676.3 644,-665.94 673.13,-656.82 707.11,-649.96 732.2,-645.59"/>
<polygon fill="#ff003d" stroke="#ff003d" points="733.1,-648.99 742.37,-643.87 731.93,-642.09 733.1,-648.99"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node71" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node71"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1240.5,-1762.94 1186.5,-1762.94 1186.5,-1738.94 1240.5,-1738.94 1240.5,-1762.94"/>
<text text-anchor="middle" x="1213.5" y="-1748.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ffda00" d="M1054.23,-1714.64C1073.32,-1718.81 1099.78,-1724.64 1123,-1729.94 1140.49,-1733.92 1159.87,-1738.45 1176.11,-1742.29"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1175.74,-1745.79 1186.28,-1744.69 1177.36,-1738.98 1175.74,-1745.79"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node72" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node72"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1240.5,-1720.94 1186.5,-1720.94 1186.5,-1696.94 1240.5,-1696.94 1240.5,-1720.94"/>
<text text-anchor="middle" x="1213.5" y="-1706.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ffda00" d="M1054.04,-1708.94C1085.96,-1708.94 1140.21,-1708.94 1176.21,-1708.94"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1176.29,-1712.44 1186.29,-1708.94 1176.29,-1705.44 1176.29,-1712.44"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#48ff00" d="M1054.04,-1750.94C1085.96,-1750.94 1140.21,-1750.94 1176.21,-1750.94"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1176.29,-1754.44 1186.29,-1750.94 1176.29,-1747.44 1176.29,-1754.44"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#48ff00" d="M1054.23,-1745.23C1073.32,-1741.06 1099.78,-1735.23 1123,-1729.94 1140.49,-1725.95 1159.87,-1721.42 1176.11,-1717.59"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1177.36,-1720.89 1186.28,-1715.18 1175.74,-1714.08 1177.36,-1720.89"/>
</g>
<!-- proc~p_coeff&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~p_coeff&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#00ff91" d="M796.88,-642C842.8,-645.6 937.5,-653.01 989.63,-657.09"/>
<polygon fill="#00ff91" stroke="#00ff91" points="989.52,-660.59 999.76,-657.88 990.07,-653.61 989.52,-660.59"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0091ff" d="M815.72,-1131.98C841.97,-1141.04 873.91,-1155.92 895,-1178.94 926.07,-1212.84 908.37,-1235.91 931,-1275.94 952.55,-1314.06 985.99,-1352.67 1006.91,-1375.18"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1004.6,-1377.83 1014,-1382.71 1009.69,-1373.03 1004.6,-1377.83"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge140" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0091ff" d="M818.18,-1119.85C842.6,-1117.9 871.95,-1112.5 895,-1098.94 953.85,-1064.3 996.73,-992.5 1015.49,-956.5"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1018.73,-957.86 1020.14,-947.36 1012.49,-954.69 1018.73,-957.86"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node73" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node73"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1054,-1186.94 1000,-1186.94 1000,-1162.94 1054,-1162.94 1054,-1186.94"/>
<text text-anchor="middle" x="1027" y="-1172.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge141" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#0091ff" d="M818.12,-1129.74C841.33,-1134.55 869.64,-1140.48 895,-1145.94 927.17,-1152.85 963.72,-1160.97 990.02,-1166.85"/>
<polygon fill="#0091ff" stroke="#0091ff" points="989.4,-1170.3 999.92,-1169.07 990.93,-1163.47 989.4,-1170.3"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge142" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#4800ff" d="M1250.78,-1500.81C1257.28,-1497.23 1263.43,-1492.67 1268,-1486.94 1309.53,-1434.77 1337.96,-1226.37 1346.39,-1157.3"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1349.9,-1157.46 1347.61,-1147.11 1342.95,-1156.62 1349.9,-1157.46"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node74" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node74"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1377,-1741.94 1323,-1741.94 1323,-1717.94 1377,-1717.94 1377,-1741.94"/>
<text text-anchor="middle" x="1350" y="-1727.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge143" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#ff0000" d="M1240.75,-1746.84C1261.3,-1743.63 1290.12,-1739.13 1312.85,-1735.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1313.47,-1739.02 1322.81,-1734.02 1312.39,-1732.11 1313.47,-1739.02"/>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge144" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ff00" d="M1240.75,-1713.03C1261.3,-1716.24 1290.12,-1720.74 1312.85,-1724.29"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1312.39,-1727.76 1322.81,-1725.85 1313.47,-1720.85 1312.39,-1727.76"/>
</g>
<!-- proc~ispline&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge145" class="edge">
<title>proc~ispline&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#0000ff" d="M1051.53,-1162.84C1071.57,-1151.97 1100.59,-1134.84 1123,-1115.94 1152.28,-1091.24 1180.66,-1056.9 1197.35,-1035.3"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1200.28,-1037.23 1203.56,-1027.16 1194.71,-1032.99 1200.28,-1037.23"/>
</g>
<!-- proc~ispline&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge146" class="edge">
<title>proc~ispline&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0000ff" d="M1054.16,-1185.1C1075.55,-1194.67 1105.08,-1210.98 1123,-1233.94 1185.7,-1314.28 1205.08,-1439.75 1210.54,-1490.5"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1207.08,-1491.08 1211.55,-1500.68 1214.05,-1490.39 1207.08,-1491.08"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~5">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~4">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~4">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_level_indices~13"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_level_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~3"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij~10"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~15"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_index"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_index</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_indextmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_indextmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate~2"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavmax~2"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">POTENTIAL</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PES_COUPLING_MATRIX</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">unitarity_check_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">unitarity_check</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">statetostateXS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w"> </span><span class="n">write_message</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_indextmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wavmax</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channels_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_read</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_reduction</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_interpolation</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">terminate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_index</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_index</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channels_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channels_level_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channels_level_indices and channels_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_level_indices_channels_omega_values</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_l_values</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_bf_channels</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">! and the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_number_of_open_channels_wavmax</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">wavmax</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">wavmax</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_sf_matrix_from_bf_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">CROSSSECTION</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_xs</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_dtol_otol</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-01-02 16:05            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>