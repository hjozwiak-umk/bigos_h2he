<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="BIGOS – Binary Inelastic scattering and Generalized Optical cross Section package, vs. 0.00">
    <meta name="author" content="Hubert Jóźwiak" >
    <link rel="icon" href="../favicon.png">

    <title>SCATTERING &ndash; the SCATTERING code</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">the SCATTERING code </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Program Description</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../program/scattering.html">Program</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../program/scattering.html">Program</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>SCATTERING      <small>Program</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title="100.0% of total for programs.">213 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/scattering.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/scattering.f90.html'>scattering.f90</a></li>
          <li class="active">SCATTERING</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-0">Variables</a>
        </h3>
      </div>
      <div id="vars-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen~4">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2~4">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~8">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/array_operations_mod.html'>array_operations_mod</a></li>
                <li><a href='../module/io_mod.html'>io_mod</a></li>
                <li><a href='../module/potential.html'>POTENTIAL</a></li>
                <li><a href='../module/pes_coupling_matrix.html'>PES_COUPLING_MATRIX</a></li>
                <li><a href='../module/boundary_conditions_mod.html'>boundary_conditions_mod</a></li>
                <li><a href='../module/propagators.html'>PROPAGATORS</a></li>
                <li><a href='../module/utility_functions_mod.html'>utility_functions_mod</a></li>
                <li><a href='../module/statetostatexs.html'>statetostateXS</a></li>
                <li><a href='../module/channels_mod.html'>channels_mod</a></li>
                <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~UsesGraph Pages: 1 -->
<svg id="programscatteringUsesGraph" width="641pt" height="332pt"
 viewBox="0.00 0.00 641.00 332.12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~UsesGraph" class="graph" transform="scale(1.34 1.34) rotate(0) translate(4 442.63)">
<title>program~~scattering~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-442.63 858,-442.63 858,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~UsesGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="854,-317.42 775,-317.42 775,-293.42 854,-293.42 854,-317.42"/>
<text text-anchor="middle" x="814.5" y="-303.02" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_node2" class="node">
<title>module~array_operations_mod</title>
<g id="a_program~~scattering~~UsesGraph_node2"><a xlink:href=".././module/array_operations_mod.html" xlink:title="array_operations_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-319.42 130,-319.42 130,-295.42 263,-295.42 263,-319.42"/>
<text text-anchor="middle" x="196.5" y="-305.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">array_operations_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-385.42C624.95,-401.06 605.52,-378.82 536.5,-385.42"/>
</g>
<!-- module~channels_mod -->
<g id="program~~scattering~~UsesGraph_node3" class="node">
<title>module~channels_mod</title>
<g id="a_program~~scattering~~UsesGraph_node3"><a xlink:href=".././module/channels_mod.html" xlink:title="channels_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-357.42 490.5,-357.42 490.5,-333.42 580.5,-333.42 580.5,-357.42"/>
<text text-anchor="middle" x="535.5" y="-343.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">channels_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~channels_mod -->
<g id="program~~scattering~~UsesGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;module~channels_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-385.42C681.97,-387.86 627.26,-372.76 585.58,-360.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="586.41,-357.02 575.83,-357.52 584.41,-363.73 586.41,-357.02"/>
</g>
<!-- module~potential -->
<g id="program~~scattering~~UsesGraph_node4" class="node">
<title>module~potential</title>
<g id="a_program~~scattering~~UsesGraph_node4"><a xlink:href=".././module/potential.html" xlink:title="POTENTIAL">
<polygon fill="#337ab7" stroke="#337ab7" points="571,-277.42 500,-277.42 500,-253.42 571,-253.42 571,-277.42"/>
<text text-anchor="middle" x="535.5" y="-263.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POTENTIAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;module~potential</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-143.42C640.49,-119.13 659.87,-212.74 612,-244.42 602.71,-250.57 591.63,-254.93 580.86,-258.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="579.94,-254.65 571.12,-260.52 581.67,-261.43 579.94,-254.65"/>
</g>
<!-- module~propagators -->
<g id="program~~scattering~~UsesGraph_node5" class="node">
<title>module~propagators</title>
<g id="a_program~~scattering~~UsesGraph_node5"><a xlink:href=".././module/propagators.html" xlink:title="PROPAGATORS">
<polygon fill="#337ab7" stroke="#337ab7" points="739,-317.42 648,-317.42 648,-293.42 739,-293.42 739,-317.42"/>
<text text-anchor="middle" x="693.5" y="-303.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PROPAGATORS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~propagators -->
<g id="program~~scattering~~UsesGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;module~propagators</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.86,-305.42C766.67,-305.42 757.87,-305.42 749.21,-305.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="749.14,-301.92 739.14,-305.42 749.14,-308.92 749.14,-301.92"/>
</g>
<!-- module~io_mod -->
<g id="program~~scattering~~UsesGraph_node6" class="node">
<title>module~io_mod</title>
<g id="a_program~~scattering~~UsesGraph_node6"><a xlink:href=".././module/io_mod.html" xlink:title="io_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="388,-319.42 334,-319.42 334,-295.42 388,-295.42 388,-319.42"/>
<text text-anchor="middle" x="361" y="-305.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M802.11,-317.43C782.44,-337.07 739.85,-374.92 694.5,-385.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-385.42C648.77,-395.55 652.47,-343.84 612,-324.42 580.81,-309.45 570.86,-309.5 536.5,-305.42"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_node7" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~scattering~~UsesGraph_node7"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="94,-279.42 0,-279.42 0,-255.42 94,-255.42 94,-279.42"/>
<text text-anchor="middle" x="47" y="-265.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-385.42C622.98,-401.52 605.85,-406.6 536.5,-423.42"/>
</g>
<!-- module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_node8" class="node">
<title>module~boundary_conditions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node8"><a xlink:href=".././module/boundary_conditions_mod.html" xlink:title="boundary_conditions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="612,-155.42 459,-155.42 459,-131.42 612,-131.42 612,-155.42"/>
<text text-anchor="middle" x="535.5" y="-141.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">boundary_conditions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~boundary_conditions_mod -->
<g id="program~~scattering~~UsesGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;module~boundary_conditions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-143.42C667.58,-131.79 637.89,-129.38 611.14,-130.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="610.78,-127.23 601.04,-131.39 611.25,-134.21 610.78,-127.23"/>
</g>
<!-- module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_node9" class="node">
<title>module~pes_coupling_matrix</title>
<g id="a_program~~scattering~~UsesGraph_node9"><a xlink:href=".././module/pes_coupling_matrix.html" xlink:title="PES_COUPLING_MATRIX">
<polygon fill="#337ab7" stroke="#337ab7" points="603.5,-113.42 467.5,-113.42 467.5,-89.42 603.5,-89.42 603.5,-113.42"/>
<text text-anchor="middle" x="535.5" y="-99.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PES_COUPLING_MATRIX</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~pes_coupling_matrix -->
<g id="program~~scattering~~UsesGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;module~pes_coupling_matrix</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-143.42C666.92,-131.48 637.35,-122.43 610.87,-115.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="611.43,-112.39 600.88,-113.45 609.79,-119.2 611.43,-112.39"/>
</g>
<!-- module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_node10" class="node">
<title>module~utility_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node10"><a xlink:href=".././module/utility_functions_mod.html" xlink:title="utility_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="259,-222.42 134,-222.42 134,-198.42 259,-198.42 259,-222.42"/>
<text text-anchor="middle" x="196.5" y="-208.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility_functions_mod</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M809.28,-293.24C797.36,-261.04 759.96,-173.98 694.5,-143.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-143.42C651.33,-124.2 652.02,-101.92 612,-80.42 534,-38.52 510.4,-31.6 423,-17.42 368.6,-8.59 342.15,16.86 299,-17.42 243.62,-61.41 305.05,-115.55 263,-172.42 256.66,-180.99 247.77,-187.94 238.57,-193.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.83,-190.41 229.74,-198.28 240.19,-196.55 236.83,-190.41"/>
</g>
<!-- module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_node11" class="node">
<title>module~statetostatexs</title>
<g id="a_program~~scattering~~UsesGraph_node11"><a xlink:href=".././module/statetostatexs.html" xlink:title="statetostateXS">
<polygon fill="#337ab7" stroke="#337ab7" points="580.5,-235.42 490.5,-235.42 490.5,-211.42 580.5,-211.42 580.5,-235.42"/>
<text text-anchor="middle" x="535.5" y="-221.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">statetostateXS</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;module~statetostatexs -->
<g id="program~~scattering~~UsesGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;module~statetostatexs</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M692.5,-143.42C667.1,-131.56 597.46,-178.2 560.42,-205.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="558.13,-202.62 552.18,-211.38 562.3,-208.25 558.13,-202.62"/>
</g>
<!-- module~array_operations_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge11" class="edge">
<title>module~array_operations_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M151.25,-295.42C135.86,-291.24 118.41,-286.51 102.31,-282.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="103.05,-278.72 92.48,-279.48 101.21,-285.48 103.05,-278.72"/>
</g>
<!-- module~channels_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge14" class="edge">
<title>module~channels_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M490.08,-335.63C461.52,-329.34 424.9,-321.28 398.14,-315.38"/>
<polygon fill="#ff9900" stroke="#ff9900" points="398.56,-311.89 388.04,-313.16 397.05,-318.73 398.56,-311.89"/>
</g>
<!-- module~channels_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge13" class="edge">
<title>module~channels_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M360,-347.42C332.76,-339.41 322.72,-344.03 299,-328.42 278.46,-314.9 283.67,-299.73 263,-286.42 237.52,-270 227.75,-269.3 197.5,-267.42"/>
</g>
<!-- module~channels_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge12" class="edge">
<title>module~channels_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M490.29,-352.95C454.85,-357.33 404.24,-359.83 362,-347.42"/>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M360,-347.42C332.76,-339.41 320.49,-346.98 299,-328.42 271.02,-304.24 287.34,-281.25 263,-253.42 254.1,-243.24 242.23,-234.48 231.04,-227.58"/>
<polygon fill="#ff9900" stroke="#ff9900" points="232.68,-224.48 222.29,-222.44 229.14,-230.52 232.68,-224.48"/>
</g>
<!-- module~potential&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge17" class="edge">
<title>module~potential&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M499.59,-273.92C470.09,-281.1 427.99,-291.35 398.14,-298.62"/>
<polygon fill="#cbff00" stroke="#cbff00" points="397.03,-295.29 388.14,-301.06 398.68,-302.09 397.03,-295.29"/>
</g>
<!-- module~potential&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge16" class="edge">
<title>module~potential&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M360,-267.42C288.01,-261.64 269.58,-271.89 197.5,-267.42"/>
</g>
<!-- module~potential&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge15" class="edge">
<title>module~potential&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M499.74,-267.69C464.86,-269.52 409.62,-271.24 362,-267.42"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M360,-267.42C312.6,-263.62 261.38,-242.54 229.37,-227.12"/>
<polygon fill="#cbff00" stroke="#cbff00" points="230.6,-223.82 220.08,-222.54 227.51,-230.1 230.6,-223.82"/>
</g>
<!-- module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_node12" class="node">
<title>module~math_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node12"><a xlink:href=".././module/math_functions_mod.html" xlink:title="math_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="423,-163.42 299,-163.42 299,-139.42 423,-139.42 423,-163.42"/>
<text text-anchor="middle" x="361" y="-149.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math_functions_mod</text>
</a>
</g>
</g>
<!-- module~potential&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge18" class="edge">
<title>module~potential&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M499.86,-261.76C485.99,-258.86 470.58,-253.68 459,-244.42 432.6,-223.31 447.96,-200.22 423,-177.42 419.17,-173.92 414.79,-170.84 410.19,-168.15"/>
<polygon fill="#cbff00" stroke="#cbff00" points="411.61,-164.95 401.12,-163.44 408.38,-171.16 411.61,-164.95"/>
</g>
<!-- module~propagators&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge19" class="edge">
<title>module~propagators&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M679.92,-317.57C664.93,-331.38 638.56,-353.67 612,-366.42 580.81,-381.39 570.84,-381.14 536.5,-385.42"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M534.5,-385.42C430.1,-398.43 399.66,-392.03 299,-361.42 271.84,-353.16 243.53,-337.41 223.73,-325.04"/>
<polygon fill="#33ff00" stroke="#33ff00" points="225.58,-322.07 215.27,-319.64 221.81,-327.97 225.58,-322.07"/>
</g>
<!-- module~propagators&#45;&gt;module~potential -->
<g id="program~~scattering~~UsesGraph_edge21" class="edge">
<title>module~propagators&#45;&gt;module~potential</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M647.8,-293.96C626.83,-288.58 601.91,-282.19 580.97,-276.82"/>
<polygon fill="#33ff00" stroke="#33ff00" points="581.6,-273.37 571.05,-274.28 579.86,-280.15 581.6,-273.37"/>
</g>
<!-- module~propagators&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge22" class="edge">
<title>module~propagators&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M647.96,-308.2C616.66,-309.48 573.88,-309.86 536.5,-305.42"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M534.5,-305.42C487.74,-299.86 433.34,-301.89 398.33,-304.27"/>
<polygon fill="#33ff00" stroke="#33ff00" points="397.84,-300.8 388.12,-305.02 398.35,-307.78 397.84,-300.8"/>
</g>
<!-- module~propagators&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge20" class="edge">
<title>module~propagators&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M685.21,-317.71C672.71,-337.73 645.31,-377.34 612,-399.42 582.65,-418.87 570.79,-415.42 536.5,-423.42"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M534.5,-423.42C354.66,-465.39 292.68,-415.82 130,-328.42 107.91,-316.55 85.21,-299.19 69.31,-286.02"/>
<polygon fill="#33ff00" stroke="#33ff00" points="71.56,-283.34 61.66,-279.57 67.05,-288.69 71.56,-283.34"/>
</g>
<!-- module~propagators&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge23" class="edge">
<title>module~propagators&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M686.69,-293.28C675.53,-271.34 648.86,-225.24 612,-202.42 596.81,-193.02 501.49,-175.21 433.07,-163.33"/>
<polygon fill="#33ff00" stroke="#33ff00" points="433.63,-159.87 423.18,-161.62 432.44,-166.77 433.63,-159.87"/>
</g>
<!-- module~io_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge25" class="edge">
<title>module~io_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M333.89,-307.42C317.39,-307.42 295.16,-307.42 273.43,-307.42"/>
<polygon fill="#00ff66" stroke="#00ff66" points="273.17,-303.92 263.16,-307.42 273.16,-310.92 273.17,-303.92"/>
</g>
<!-- module~io_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge26" class="edge">
<title>module~io_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M334,-297.95C302.28,-287.11 246.8,-270.48 197.5,-267.42"/>
</g>
<!-- module~io_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge24" class="edge">
<title>module~io_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M333.76,-297.96C322.71,-293.55 309.91,-287.84 299,-281.42 281.53,-271.14 279.49,-265.21 263,-253.42 250.83,-244.72 237.03,-235.55 225.25,-227.94"/>
<polygon fill="#00ff66" stroke="#00ff66" points="226.99,-224.9 216.69,-222.44 223.21,-230.79 226.99,-224.9"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~array_operations_mod -->
<g id="program~~scattering~~UsesGraph_edge28" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~array_operations_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M360,-191.42C332.43,-200.83 320.84,-196.14 299,-215.42 273.95,-237.53 288.02,-259.27 263,-281.42 258.94,-285.02 254.31,-288.15 249.44,-290.87"/>
<polygon fill="#0066ff" stroke="#0066ff" points="247.88,-287.74 240.49,-295.33 251,-294 247.88,-287.74"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge29" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M514,-155.52C497.4,-166.16 474.34,-182.95 459,-202.42 435.11,-232.72 450.62,-254.47 423,-281.42 415.91,-288.34 406.68,-293.55 397.57,-297.41"/>
<polygon fill="#0066ff" stroke="#0066ff" points="396.31,-294.14 388.2,-300.96 398.79,-300.69 396.31,-294.14"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge30" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M479.43,-131.4C396.99,-114.53 246,-88.36 197.5,-111.42"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge31" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M485.34,-155.49C450.57,-164.42 403.04,-177.41 362,-191.42"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M360,-191.42C331.14,-201.27 297.92,-206.2 269.06,-208.6"/>
<polygon fill="#0066ff" stroke="#0066ff" points="268.76,-205.11 259.05,-209.35 269.28,-212.1 268.76,-205.11"/>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge32" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M458.84,-146.93C450.34,-147.32 441.71,-147.72 433.27,-148.11"/>
<polygon fill="#0066ff" stroke="#0066ff" points="432.93,-144.63 423.1,-148.59 433.25,-151.62 432.93,-144.63"/>
</g>
<!-- fwigxjpf -->
<g id="program~~scattering~~UsesGraph_node13" class="node">
<title>fwigxjpf</title>
<polygon fill="#337ab7" stroke="#337ab7" points="388,-83.42 334,-83.42 334,-59.42 388,-59.42 388,-83.42"/>
<text text-anchor="middle" x="361" y="-69.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwigxjpf</text>
</g>
<!-- module~boundary_conditions_mod&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge27" class="edge">
<title>module~boundary_conditions_mod&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M482.09,-131.31C474.19,-128.79 466.27,-125.83 459,-122.42 441.37,-114.14 440.05,-106.84 423,-97.42 414.95,-92.97 405.98,-88.76 397.45,-85.08"/>
<polygon fill="#0066ff" stroke="#0066ff" points="398.65,-81.79 388.08,-81.17 395.95,-88.25 398.65,-81.79"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge35" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M470.54,-113.43C466.3,-115.91 462.38,-118.87 459,-122.42 409.03,-174.88 469.41,-225.78 423,-281.42 416.49,-289.23 407.21,-294.74 397.85,-298.62"/>
<polygon fill="#3200ff" stroke="#3200ff" points="396.4,-295.42 388.17,-302.09 398.77,-302 396.4,-295.42"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge34" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M519.52,-89.18C490.43,-66.84 423.74,-22.55 362,-31.42"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M360,-31.42C280.32,-42.87 270.24,-76.93 197.5,-111.42"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M195.5,-111.42C168.11,-124.41 154,-111.91 130,-130.42 90.92,-160.55 66.54,-215.02 55.31,-245.41"/>
<polygon fill="#3200ff" stroke="#3200ff" points="51.93,-244.48 51.89,-255.08 58.53,-246.82 51.93,-244.48"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge36" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M360,-31.42C331.89,-35.46 318.93,-30.19 299,-50.42 259.33,-90.69 297.93,-127.97 263,-172.42 256.29,-180.96 247.09,-187.94 237.71,-193.49"/>
<polygon fill="#3200ff" stroke="#3200ff" points="235.85,-190.52 228.73,-198.37 239.19,-196.67 235.85,-190.52"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;module~math_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge37" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;module~math_functions_mod</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M490.54,-113.49C480.19,-116.38 469.2,-119.48 459,-122.42 443.48,-126.9 426.61,-131.89 411.35,-136.46"/>
<polygon fill="#3200ff" stroke="#3200ff" points="410.16,-133.17 401.59,-139.39 412.18,-139.87 410.16,-133.17"/>
</g>
<!-- module~pes_coupling_matrix&#45;&gt;fwigxjpf -->
<g id="program~~scattering~~UsesGraph_edge33" class="edge">
<title>module~pes_coupling_matrix&#45;&gt;fwigxjpf</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M467.31,-89.73C443.79,-85.64 418.28,-81.21 398.25,-77.72"/>
<polygon fill="#3200ff" stroke="#3200ff" points="398.77,-74.26 388.32,-76 397.57,-81.16 398.77,-74.26"/>
</g>
<!-- module~utility_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge38" class="edge">
<title>module~utility_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M164.22,-222.51C142.22,-231.01 112.57,-242.47 88.73,-251.68"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="87.3,-248.48 79.24,-255.35 89.83,-255.01 87.3,-248.48"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~io_mod -->
<g id="program~~scattering~~UsesGraph_edge41" class="edge">
<title>module~statetostatexs&#45;&gt;module~io_mod</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M490.18,-231.56C479.52,-234.63 468.48,-238.8 459,-244.42 439.26,-256.12 441.92,-268.44 423,-281.42 415.19,-286.77 406.1,-291.37 397.36,-295.15"/>
<polygon fill="#ff0098" stroke="#ff0098" points="396.04,-291.91 388.09,-298.91 398.68,-298.39 396.04,-291.91"/>
</g>
<!-- module~statetostatexs&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge40" class="edge">
<title>module~statetostatexs&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M360,-229.42C285.91,-232.83 271.53,-272.01 197.5,-267.42"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M195.5,-267.42C165.47,-265.56 131.94,-265.4 104.44,-265.78"/>
<polygon fill="#ff0098" stroke="#ff0098" points="104.16,-262.29 94.22,-265.95 104.27,-269.29 104.16,-262.29"/>
</g>
<!-- module~statetostatexs&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge39" class="edge">
<title>module~statetostatexs&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M490.17,-224.69C455.32,-225.75 405.55,-227.41 362,-229.42"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M360,-229.42C330.18,-230.79 297.46,-227.84 269.24,-223.87"/>
<polygon fill="#ff0098" stroke="#ff0098" points="269.47,-220.37 259.06,-222.37 268.45,-227.29 269.47,-220.37"/>
</g>
<!-- module~math_functions_mod&#45;&gt;iso_fortran_env -->
<g id="program~~scattering~~UsesGraph_edge44" class="edge">
<title>module~math_functions_mod&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M330.1,-139.32C289.9,-123.86 220.79,-100.35 197.5,-111.42"/>
</g>
<!-- module~math_functions_mod&#45;&gt;module~utility_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge42" class="edge">
<title>module~math_functions_mod&#45;&gt;module~utility_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M326.72,-163.5C301.75,-172.57 267.35,-185.06 240.32,-194.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="238.94,-191.65 230.73,-198.35 241.33,-198.23 238.94,-191.65"/>
</g>
<!-- module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_node14" class="node">
<title>module~special_functions_mod</title>
<g id="a_program~~scattering~~UsesGraph_node14"><a xlink:href=".././module/special_functions_mod.html" xlink:title="special_functions_mod">
<polygon fill="#337ab7" stroke="#337ab7" points="263,-163.42 130,-163.42 130,-139.42 263,-139.42 263,-163.42"/>
<text text-anchor="middle" x="196.5" y="-149.02" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">special_functions_mod</text>
</a>
</g>
</g>
<!-- module~math_functions_mod&#45;&gt;module~special_functions_mod -->
<g id="program~~scattering~~UsesGraph_edge43" class="edge">
<title>module~math_functions_mod&#45;&gt;module~special_functions_mod</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.57,-151.42C290.32,-151.42 281.79,-151.42 273.34,-151.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="273.09,-147.92 263.09,-151.42 273.09,-154.92 273.09,-147.92"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringUsesGraph = svgPanZoom('#programscatteringUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>

    
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~scattering~~CallsGraph Pages: 1 -->
<svg id="programscatteringCallsGraph" width="641pt" height="995pt"
 viewBox="0.00 0.00 641.00 995.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~scattering~~CallsGraph" class="graph" transform="scale(2.03 2.03) rotate(0) translate(4 2019)">
<title>program~~scattering~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2019 1299,-2019 1299,4 -4,4"/>
<!-- program~scattering -->
<g id="program~~scattering~~CallsGraph_node1" class="node">
<title>program~scattering</title>
<polygon fill="none" stroke="black" points="79,-819 0,-819 0,-795 79,-795 79,-819"/>
<text text-anchor="middle" x="39.5" y="-804.6" font-family="Helvetica,sans-Serif" font-size="10.50">SCATTERING</text>
</g>
<!-- proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_node2" class="node">
<title>proc~read_input_file</title>
<g id="a_program~~scattering~~CallsGraph_node2"><a xlink:href=".././proc/read_input_file.html" xlink:title="read_input_file">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-1161 215,-1161 215,-1137 306,-1137 306,-1161"/>
<text text-anchor="middle" x="260.5" y="-1146.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_input_file</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~read_input_file -->
<g id="program~~scattering~~CallsGraph_edge1" class="edge">
<title>program~scattering&#45;&gt;proc~read_input_file</title>
<path fill="none" stroke="#ff0000" d="M42.02,-819.3C48.46,-869.64 75.04,-1059.27 115,-1102 138.15,-1126.76 174.46,-1138.5 204.89,-1144.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="204.52,-1147.55 214.95,-1145.72 205.65,-1140.64 204.52,-1147.55"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_node3" class="node">
<title>proc~print_coupling_matrix_elements_summary</title>
<g id="a_program~~scattering~~CallsGraph_node3"><a xlink:href=".././proc/print_coupling_matrix_elements_summary.html" xlink:title="print_coupling_matrix_elements_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="862,-1821 624,-1821 624,-1797 862,-1797 862,-1821"/>
<text text-anchor="middle" x="743" y="-1806.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_coupling_matrix_elements_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary -->
<g id="program~~scattering~~CallsGraph_edge4" class="edge">
<title>program~scattering&#45;&gt;proc~print_coupling_matrix_elements_summary</title>
<path fill="none" stroke="#ff0000" d="M40.48,-819.07C40.37,-926.25 42.12,-1712.61 115,-1783 184.85,-1850.46 461.46,-1836.58 623,-1821.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="623.36,-1825.41 632.99,-1821 622.71,-1818.44 623.36,-1825.41"/>
</g>
<!-- fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_node4" class="node">
<title>fwig_temp_init</title>
<polygon fill="#777777" stroke="#777777" points="305,-402 216,-402 216,-378 305,-378 305,-402"/>
<text text-anchor="middle" x="260.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_init -->
<g id="program~~scattering~~CallsGraph_edge2" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_init</title>
<path fill="none" stroke="#ff0000" d="M41.02,-794.81C43.86,-734.77 59.38,-471.05 115,-416 138.44,-392.8 175.09,-386.41 205.62,-385.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.71,-389.26 215.71,-385.75 205.7,-382.26 205.71,-389.26"/>
</g>
<!-- proc~numerov -->
<g id="program~~scattering~~CallsGraph_node5" class="node">
<title>proc~numerov</title>
<g id="a_program~~scattering~~CallsGraph_node5"><a xlink:href=".././proc/numerov.html" xlink:title="numerov">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-718 230.5,-718 230.5,-694 290.5,-694 290.5,-718"/>
<text text-anchor="middle" x="260.5" y="-703.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">numerov</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~numerov -->
<g id="program~~scattering~~CallsGraph_edge5" class="edge">
<title>program~scattering&#45;&gt;proc~numerov</title>
<path fill="none" stroke="#ff0000" d="M66.92,-794.82C106.24,-776.68 180.23,-742.56 224.17,-722.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="225.72,-725.44 233.33,-718.07 222.78,-719.08 225.72,-725.44"/>
</g>
<!-- proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_node6" class="node">
<title>proc~print_bf_channels</title>
<g id="a_program~~scattering~~CallsGraph_node6"><a xlink:href=".././proc/print_bf_channels.html" xlink:title="print_bf_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="796,-823 690,-823 690,-799 796,-799 796,-823"/>
<text text-anchor="middle" x="743" y="-808.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_bf_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_bf_channels -->
<g id="program~~scattering~~CallsGraph_edge3" class="edge">
<title>program~scattering&#45;&gt;proc~print_bf_channels</title>
<path fill="none" stroke="#ff0000" d="M79.37,-815.55C90.8,-817.73 103.35,-819.79 115,-821 324.12,-842.74 378.07,-839.55 588,-828 618.26,-826.33 651.71,-822.84 679.69,-819.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="680.23,-822.91 689.73,-818.21 679.38,-815.97 680.23,-822.91"/>
</g>
<!-- proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_node7" class="node">
<title>proc~check_dtol_otol</title>
<g id="a_program~~scattering~~CallsGraph_node7"><a xlink:href=".././proc/check_dtol_otol.html" xlink:title="check_dtol_otol">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-360 213,-360 213,-336 308,-336 308,-360"/>
<text text-anchor="middle" x="260.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_dtol_otol</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_dtol_otol -->
<g id="program~~scattering~~CallsGraph_edge6" class="edge">
<title>program~scattering&#45;&gt;proc~check_dtol_otol</title>
<path fill="none" stroke="#ff0000" d="M40.72,-794.63C42.14,-729.86 52.08,-430.42 115,-369 137.64,-346.9 172.54,-341.36 202.37,-341.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.6,-344.99 212.68,-341.74 202.77,-337.99 202.6,-344.99"/>
</g>
<!-- proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_node8" class="node">
<title>proc~set_number_of_channels</title>
<g id="a_program~~scattering~~CallsGraph_node8"><a xlink:href=".././proc/set_number_of_channels.html" xlink:title="set_number_of_channels">
<polygon fill="#d9534f" stroke="#d9534f" points="333,-979 188,-979 188,-955 333,-955 333,-979"/>
<text text-anchor="middle" x="260.5" y="-964.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_channels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_channels -->
<g id="program~~scattering~~CallsGraph_edge7" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_channels</title>
<path fill="none" stroke="#ff0000" d="M43.1,-819.12C49.71,-846.73 69.94,-914.4 115,-946 133.18,-958.75 155.83,-965.23 177.77,-968.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.45,-971.73 187.78,-969.39 178.25,-964.78 177.45,-971.73"/>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node9" class="node">
<title>proc~check_nonzero_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node9"><a xlink:href=".././proc/check_nonzero_coupling_matrix_elements.html" xlink:title="check_nonzero_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="379.5,-318 141.5,-318 141.5,-294 379.5,-294 379.5,-318"/>
<text text-anchor="middle" x="260.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_nonzero_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge8" class="edge">
<title>program~scattering&#45;&gt;proc~check_nonzero_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.52,-794.82C40.89,-726.87 46.24,-395.1 115,-327 120.08,-321.97 125.8,-317.79 131.95,-314.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="133.81,-317.32 141.25,-309.78 130.73,-311.04 133.81,-317.32"/>
</g>
<!-- proc~etotal -->
<g id="program~~scattering~~CallsGraph_node10" class="node">
<title>proc~etotal</title>
<g id="a_program~~scattering~~CallsGraph_node10"><a xlink:href=".././proc/etotal.html" xlink:title="ETOTAL">
<polygon fill="#d94e8f" stroke="#d94e8f" points="987,-541 933,-541 933,-517 987,-517 987,-541"/>
<text text-anchor="middle" x="960" y="-526.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ETOTAL</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge9" class="edge">
<title>program~scattering&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff0000" d="M40.09,-794.88C39.49,-755.04 43.41,-627.28 115,-567 214.77,-482.99 307.19,-614.14 406,-529 450.12,-490.98 395.5,-438.07 442,-403 481.12,-373.49 771.5,-365.59 862,-410 904.17,-430.69 934.24,-479.29 948.9,-507.56"/>
<polygon fill="#ff0000" stroke="#ff0000" points="945.83,-509.26 953.43,-516.64 952.09,-506.13 945.83,-509.26"/>
</g>
<!-- proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_node11" class="node">
<title>proc~unitarity_check</title>
<g id="a_program~~scattering~~CallsGraph_node11"><a xlink:href=".././proc/unitarity_check.html" xlink:title="unitarity_check">
<polygon fill="#d9534f" stroke="#d9534f" points="1007,-1741 913,-1741 913,-1717 1007,-1717 1007,-1741"/>
<text text-anchor="middle" x="960" y="-1726.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">unitarity_check</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~unitarity_check -->
<g id="program~~scattering~~CallsGraph_edge10" class="edge">
<title>program~scattering&#45;&gt;proc~unitarity_check</title>
<path fill="none" stroke="#ff0000" d="M40.78,-819.28C43.15,-917.4 60.92,-1572.35 115,-1639 260.89,-1818.8 392.57,-1743.01 624,-1750 729.73,-1753.19 756.82,-1761.25 862,-1750 875.38,-1748.57 889.62,-1746.06 902.96,-1743.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="903.93,-1746.63 912.95,-1741.07 902.43,-1739.79 903.93,-1746.63"/>
</g>
<!-- proc~potential_read -->
<g id="program~~scattering~~CallsGraph_node12" class="node">
<title>proc~potential_read</title>
<g id="a_program~~scattering~~CallsGraph_node12"><a xlink:href=".././proc/potential_read.html" xlink:title="potential_read">
<polygon fill="#d9534f" stroke="#d9534f" points="559.5,-1424 470.5,-1424 470.5,-1400 559.5,-1400 559.5,-1424"/>
<text text-anchor="middle" x="515" y="-1409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_read</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_read -->
<g id="program~~scattering~~CallsGraph_edge11" class="edge">
<title>program~scattering&#45;&gt;proc~potential_read</title>
<path fill="none" stroke="#ff0000" d="M41.17,-819.07C45.68,-898.1 72.68,-1339.71 115,-1380 208.23,-1468.75 375.42,-1445.82 460.74,-1426.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="461.8,-1429.71 470.73,-1424.02 460.2,-1422.9 461.8,-1429.71"/>
</g>
<!-- proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node13" class="node">
<title>proc~count_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node13"><a xlink:href=".././proc/count_open_basis_levels.html" xlink:title="count_open_basis_levels">
<polygon fill="#d94e8f" stroke="#d94e8f" points="586.5,-339 443.5,-339 443.5,-315 586.5,-315 586.5,-339"/>
<text text-anchor="middle" x="515" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">count_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~count_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge12" class="edge">
<title>program~scattering&#45;&gt;proc~count_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M41.53,-794.93C46.31,-741.87 68.12,-530.19 115,-487 211.16,-398.42 303.56,-525.23 406,-444 440.08,-416.98 410.78,-383.29 442,-353 445.57,-349.54 449.63,-346.53 453.97,-343.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="455.94,-346.84 463.18,-339.11 452.7,-340.64 455.94,-346.84"/>
</g>
<!-- proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_node14" class="node">
<title>proc~time_count_summary</title>
<g id="a_program~~scattering~~CallsGraph_node14"><a xlink:href=".././proc/time_count_summary.html" xlink:title="time_count_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="578.5,-297 451.5,-297 451.5,-273 578.5,-273 578.5,-297"/>
<text text-anchor="middle" x="515" y="-282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">time_count_summary</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge13" class="edge">
<title>program~scattering&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0000" d="M41.14,-794.85C44.44,-737.32 61.47,-492.95 115,-444 211.06,-356.17 304.52,-492.51 406,-411 444.46,-380.11 406.31,-340.06 442,-306 443.26,-304.79 444.59,-303.66 445.97,-302.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="447.92,-305.49 454.42,-297.13 444.12,-299.61 447.92,-305.49"/>
</g>
<!-- proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_node15" class="node">
<title>proc~calculate_s_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node15"><a xlink:href=".././proc/calculate_s_matrix.html" xlink:title="calculate_s_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-819 459,-819 459,-795 571,-795 571,-819"/>
<text text-anchor="middle" x="515" y="-804.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_s_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_s_matrix -->
<g id="program~~scattering~~CallsGraph_edge14" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_s_matrix</title>
<path fill="none" stroke="#ff0000" d="M79.25,-807C160.31,-807 348.55,-807 448.66,-807"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.95,-810.5 458.95,-807 448.95,-803.5 448.95,-810.5"/>
</g>
<!-- proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_node16" class="node">
<title>proc~print_largest_partial_xs</title>
<g id="a_program~~scattering~~CallsGraph_node16"><a xlink:href=".././proc/print_largest_partial_xs.html" xlink:title="print_largest_partial_xs">
<polygon fill="#d9534f" stroke="#d9534f" points="811,-1863 675,-1863 675,-1839 811,-1839 811,-1863"/>
<text text-anchor="middle" x="743" y="-1848.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_largest_partial_xs</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~print_largest_partial_xs -->
<g id="program~~scattering~~CallsGraph_edge15" class="edge">
<title>program~scattering&#45;&gt;proc~print_largest_partial_xs</title>
<path fill="none" stroke="#ff0000" d="M40.44,-819.2C40.02,-929.27 39.43,-1748.44 115,-1822 191.1,-1896.07 514.74,-1874.16 664.9,-1859.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="665.36,-1862.96 674.97,-1858.49 664.67,-1856 665.36,-1862.96"/>
</g>
<!-- proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_node17" class="node">
<title>proc~units_conversion</title>
<g id="a_program~~scattering~~CallsGraph_node17"><a xlink:href=".././proc/units_conversion.html" xlink:title="units_conversion">
<polygon fill="#d9534f" stroke="#d9534f" points="311.5,-192 209.5,-192 209.5,-168 311.5,-168 311.5,-192"/>
<text text-anchor="middle" x="260.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_conversion</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~units_conversion -->
<g id="program~~scattering~~CallsGraph_edge16" class="edge">
<title>program~scattering&#45;&gt;proc~units_conversion</title>
<path fill="none" stroke="#ff0000" d="M41.12,-794.8C45.41,-712.93 71.73,-245.23 115,-201 136.41,-179.12 169.77,-173.21 199.05,-173.07"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.15,-176.57 209.21,-173.24 199.27,-169.57 199.15,-176.57"/>
</g>
<!-- proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_node18" class="node">
<title>proc~save_open_basis_levels</title>
<g id="a_program~~scattering~~CallsGraph_node18"><a xlink:href=".././proc/save_open_basis_levels.html" xlink:title="save_open_basis_levels">
<polygon fill="#d9534f" stroke="#d9534f" points="584,-457 446,-457 446,-433 584,-433 584,-457"/>
<text text-anchor="middle" x="515" y="-442.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_open_basis_levels</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~save_open_basis_levels -->
<g id="program~~scattering~~CallsGraph_edge17" class="edge">
<title>program~scattering&#45;&gt;proc~save_open_basis_levels</title>
<path fill="none" stroke="#ff0000" d="M41.93,-794.94C46.32,-763.74 62.68,-680.13 115,-642 220.19,-565.34 308.02,-694.68 406,-609 455.34,-565.86 396.53,-513.2 442,-466 442.94,-465.02 443.92,-464.09 444.94,-463.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="447.29,-465.83 453.42,-457.19 443.23,-460.13 447.29,-465.83"/>
</g>
<!-- proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_node19" class="node">
<title>proc~integer_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node19"><a xlink:href=".././proc/integer_to_character.html" xlink:title="integer_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1022,-1503 898,-1503 898,-1479 1022,-1479 1022,-1503"/>
<text text-anchor="middle" x="960" y="-1488.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">integer_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge18" class="edge">
<title>program~scattering&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M41.09,-819.19C45.19,-902.07 70.74,-1380.81 115,-1426 221.04,-1534.26 703.94,-1510.28 887.72,-1496.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="888.1,-1500.34 897.81,-1496.11 887.58,-1493.36 888.1,-1500.34"/>
</g>
<!-- interface~append -->
<g id="program~~scattering~~CallsGraph_node20" class="node">
<title>interface~append</title>
<g id="a_program~~scattering~~CallsGraph_node20"><a xlink:href=".././interface/append.html" xlink:title="append">
<polygon fill="#a7506f" stroke="#a7506f" points="287.5,-150 233.5,-150 233.5,-126 287.5,-126 287.5,-150"/>
<text text-anchor="middle" x="260.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">append</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~append -->
<g id="program~~scattering~~CallsGraph_edge19" class="edge">
<title>program~scattering&#45;&gt;interface~append</title>
<path fill="none" stroke="#ff0000" d="M41.02,-794.79C44.77,-709.65 68.81,-206.59 115,-159 142.56,-130.6 190.24,-129.03 223.25,-132.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="223.09,-135.63 233.41,-133.27 223.87,-128.67 223.09,-135.63"/>
</g>
<!-- proc~write_message -->
<g id="program~~scattering~~CallsGraph_node21" class="node">
<title>proc~write_message</title>
<g id="a_program~~scattering~~CallsGraph_node21"><a xlink:href=".././proc/write_message.html" xlink:title="write_message">
<polygon fill="#d9534f" stroke="#d9534f" points="1295,-1101 1203,-1101 1203,-1077 1295,-1077 1295,-1101"/>
<text text-anchor="middle" x="1249" y="-1086.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_message</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge20" class="edge">
<title>program~scattering&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff0000" d="M40.24,-819.04C40.14,-857.39 45.6,-977.29 115,-1030 148.09,-1055.13 820.5,-1065.82 862,-1068 979.78,-1074.2 1117.75,-1081.78 1192.69,-1085.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1192.66,-1089.43 1202.84,-1086.49 1193.05,-1082.44 1192.66,-1089.43"/>
</g>
<!-- proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_node22" class="node">
<title>proc~float_to_character</title>
<g id="a_program~~scattering~~CallsGraph_node22"><a xlink:href=".././proc/float_to_character.html" xlink:title="float_to_character">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1167,-1672 1058,-1672 1058,-1648 1167,-1648 1167,-1672"/>
<text text-anchor="middle" x="1112.5" y="-1657.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float_to_character</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge21" class="edge">
<title>program~scattering&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M40.4,-819.33C39.64,-932.29 36.47,-1785.39 115,-1862 352.66,-2093.87 538.58,-1947.14 862,-1872 938.5,-1854.23 962.71,-1848.5 1022,-1797 1059.99,-1764 1088.25,-1711.09 1102.06,-1681.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1105.38,-1682.78 1106.34,-1672.23 1099.01,-1679.88 1105.38,-1682.78"/>
</g>
<!-- fwig_table_init -->
<g id="program~~scattering~~CallsGraph_node23" class="node">
<title>fwig_table_init</title>
<polygon fill="#777777" stroke="#777777" points="304.5,-108 216.5,-108 216.5,-84 304.5,-84 304.5,-108"/>
<text text-anchor="middle" x="260.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_init</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_init -->
<g id="program~~scattering~~CallsGraph_edge22" class="edge">
<title>program~scattering&#45;&gt;fwig_table_init</title>
<path fill="none" stroke="#ff0000" d="M40.93,-794.86C44.16,-706.8 65.87,-167.97 115,-117 138,-93.14 175.19,-88.17 206.08,-89.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="206.12,-92.53 216.28,-89.52 206.46,-85.54 206.12,-92.53"/>
</g>
<!-- proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_node24" class="node">
<title>proc~file_io_status</title>
<g id="a_program~~scattering~~CallsGraph_node24"><a xlink:href=".././proc/file_io_status.html" xlink:title="file_io_status">
<polygon fill="#d9534f" stroke="#d9534f" points="783.5,-1299 702.5,-1299 702.5,-1275 783.5,-1275 783.5,-1299"/>
<text text-anchor="middle" x="743" y="-1284.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">file_io_status</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge23" class="edge">
<title>program~scattering&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M41.37,-819.32C45.65,-876.63 66.29,-1116.47 115,-1170 266.34,-1336.33 572.14,-1312.4 692.1,-1295.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="692.72,-1298.84 702.11,-1293.93 691.71,-1291.91 692.72,-1298.84"/>
</g>
<!-- proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_node25" class="node">
<title>proc~potential_interpolation</title>
<g id="a_program~~scattering~~CallsGraph_node25"><a xlink:href=".././proc/potential_interpolation.html" xlink:title="potential_interpolation">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-1341 194,-1341 194,-1317 327,-1317 327,-1341"/>
<text text-anchor="middle" x="260.5" y="-1326.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_interpolation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_interpolation -->
<g id="program~~scattering~~CallsGraph_edge24" class="edge">
<title>program~scattering&#45;&gt;proc~potential_interpolation</title>
<path fill="none" stroke="#ff0000" d="M40.49,-819.09C40.69,-888.04 45.22,-1231.17 115,-1303 132.72,-1321.24 158.57,-1329.21 183.52,-1332.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.49,-1335.66 193.76,-1333.09 184.13,-1328.69 183.49,-1335.66"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_node26" class="node">
<title>proc~set_channels_level_indices_channels_omega_values</title>
<g id="a_program~~scattering~~CallsGraph_node26"><a xlink:href=".././proc/set_channels_level_indices_channels_omega_values.html" xlink:title="set_channels_level_indices_channels_omega_values">
<polygon fill="#d9534f" stroke="#d9534f" points="406,-937 115,-937 115,-913 406,-913 406,-937"/>
<text text-anchor="middle" x="260.5" y="-922.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_level_indices_channels_omega_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values -->
<g id="program~~scattering~~CallsGraph_edge25" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_level_indices_channels_omega_values</title>
<path fill="none" stroke="#ff0000" d="M46.61,-819.18C57.42,-839.36 81.92,-879.44 115,-899 121.94,-903.1 129.37,-906.59 137.07,-909.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="135.98,-912.88 146.57,-912.91 138.31,-906.28 135.98,-912.88"/>
</g>
<!-- interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_node27" class="node">
<title>interface~allocate_2d</title>
<g id="a_program~~scattering~~CallsGraph_node27"><a xlink:href=".././interface/allocate_2d.html" xlink:title="allocate_2d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-499 478,-499 478,-475 552,-475 552,-499"/>
<text text-anchor="middle" x="515" y="-484.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_2d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge26" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff0000" d="M44.05,-794.85C52.09,-769.68 74.23,-711.98 115,-685 224.02,-612.85 307.94,-728.47 406,-642 450.65,-602.63 401.5,-556.63 442,-513 449.05,-505.4 458.49,-500.02 468.21,-496.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="469.6,-499.43 477.94,-492.9 467.34,-492.81 469.6,-499.43"/>
</g>
<!-- proc~write_header -->
<g id="program~~scattering~~CallsGraph_node28" class="node">
<title>proc~write_header</title>
<g id="a_program~~scattering~~CallsGraph_node28"><a xlink:href=".././proc/write_header.html" xlink:title="write_header">
<polygon fill="#d9534f" stroke="#d9534f" points="784,-865 702,-865 702,-841 784,-841 784,-865"/>
<text text-anchor="middle" x="743" y="-850.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_header</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~write_header -->
<g id="program~~scattering~~CallsGraph_edge27" class="edge">
<title>program~scattering&#45;&gt;proc~write_header</title>
<path fill="none" stroke="#ff0000" d="M59.55,-819.08C74.11,-827.58 95.01,-838.26 115,-843 324.12,-892.64 583.6,-871.66 691.39,-859.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="692.12,-862.9 701.65,-858.28 691.31,-855.95 692.12,-862.9"/>
</g>
<!-- proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_node29" class="node">
<title>proc~set_channels_l_values</title>
<g id="a_program~~scattering~~CallsGraph_node29"><a xlink:href=".././proc/set_channels_l_values.html" xlink:title="set_channels_l_values">
<polygon fill="#d9534f" stroke="#d9534f" points="325.5,-1021 195.5,-1021 195.5,-997 325.5,-997 325.5,-1021"/>
<text text-anchor="middle" x="260.5" y="-1006.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_channels_l_values</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_channels_l_values -->
<g id="program~~scattering~~CallsGraph_edge28" class="edge">
<title>program~scattering&#45;&gt;proc~set_channels_l_values</title>
<path fill="none" stroke="#ff0000" d="M41.5,-819.12C44.92,-852.21 59.26,-944.53 115,-988 134.77,-1003.41 160.82,-1010.05 185.36,-1012.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.16,-1015.89 195.39,-1013.13 185.67,-1008.91 185.16,-1015.89"/>
</g>
<!-- proc~bf_to_sf_transformation -->
<g id="program~~scattering~~CallsGraph_node30" class="node">
<title>proc~bf_to_sf_transformation</title>
<g id="a_program~~scattering~~CallsGraph_node30"><a xlink:href=".././proc/bf_to_sf_transformation.html" xlink:title="bf_to_sf_transformation">
<polygon fill="#d9534f" stroke="#d9534f" points="329.5,-234 191.5,-234 191.5,-210 329.5,-210 329.5,-234"/>
<text text-anchor="middle" x="260.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bf_to_sf_transformation</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~bf_to_sf_transformation -->
<g id="program~~scattering~~CallsGraph_edge29" class="edge">
<title>program~scattering&#45;&gt;proc~bf_to_sf_transformation</title>
<path fill="none" stroke="#ff0000" d="M40.21,-794.73C38.71,-719.79 34.69,-324.36 115,-243 132.14,-225.64 156.82,-218.36 180.94,-216.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="181.49,-219.51 191.23,-215.34 181.01,-212.53 181.49,-219.51"/>
</g>
<!-- proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_node31" class="node">
<title>proc~calculate_k_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node31"><a xlink:href=".././proc/calculate_k_matrix.html" xlink:title="calculate_k_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="571,-1382 459,-1382 459,-1358 571,-1358 571,-1382"/>
<text text-anchor="middle" x="515" y="-1367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_k_matrix</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~calculate_k_matrix -->
<g id="program~~scattering~~CallsGraph_edge30" class="edge">
<title>program~scattering&#45;&gt;proc~calculate_k_matrix</title>
<path fill="none" stroke="#ff0000" d="M40.18,-819.4C38.52,-893.37 34.01,-1275.71 115,-1350 162.13,-1393.23 348.42,-1384.56 448.91,-1376.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="449.28,-1379.8 458.95,-1375.48 448.69,-1372.83 449.28,-1379.8"/>
</g>
<!-- fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_node32" class="node">
<title>fwig_temp_free</title>
<polygon fill="#777777" stroke="#777777" points="307.5,-66 213.5,-66 213.5,-42 307.5,-42 307.5,-66"/>
<text text-anchor="middle" x="260.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_temp_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_temp_free -->
<g id="program~~scattering~~CallsGraph_edge31" class="edge">
<title>program~scattering&#45;&gt;fwig_temp_free</title>
<path fill="none" stroke="#ff0000" d="M40.86,-794.71C43.62,-703.16 62.97,-129.31 115,-75 137.22,-51.81 172.83,-46.43 203.14,-46.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.07,-50.41 213.19,-47.28 203.32,-43.41 203.07,-50.41"/>
</g>
<!-- proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_node33" class="node">
<title>proc~potential_reduction</title>
<g id="a_program~~scattering~~CallsGraph_node33"><a xlink:href=".././proc/potential_reduction.html" xlink:title="potential_reduction">
<polygon fill="#d9534f" stroke="#d9534f" points="800.5,-1741 685.5,-1741 685.5,-1717 800.5,-1717 800.5,-1741"/>
<text text-anchor="middle" x="743" y="-1726.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">potential_reduction</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~potential_reduction -->
<g id="program~~scattering~~CallsGraph_edge32" class="edge">
<title>program~scattering&#45;&gt;proc~potential_reduction</title>
<path fill="none" stroke="#ff0000" d="M41.03,-819.21C45.03,-910.22 71.79,-1480.95 115,-1543 241.96,-1725.3 541.09,-1737.59 675.07,-1733.26"/>
<polygon fill="#ff0000" stroke="#ff0000" points="675.33,-1736.75 685.19,-1732.89 675.07,-1729.75 675.33,-1736.75"/>
</g>
<!-- interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_node34" class="node">
<title>interface~allocate_1d</title>
<g id="a_program~~scattering~~CallsGraph_node34"><a xlink:href=".././interface/allocate_1d.html" xlink:title="allocate_1d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-1101 478,-1101 478,-1077 552,-1077 552,-1101"/>
<text text-anchor="middle" x="515" y="-1086.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_1d</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge33" class="edge">
<title>program~scattering&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M42.2,-819.19C48.93,-865.73 75.38,-1031.2 115,-1063 168.16,-1105.67 374.57,-1098.17 467.82,-1092.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.06,-1095.86 477.81,-1091.72 467.61,-1088.87 468.06,-1095.86"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_node35" class="node">
<title>proc~set_number_of_open_channels_wavmax</title>
<g id="a_program~~scattering~~CallsGraph_node35"><a xlink:href=".././proc/set_number_of_open_channels_wavmax.html" xlink:title="set_number_of_open_channels_wavmax">
<polygon fill="#d9534f" stroke="#d9534f" points="373.5,-600 147.5,-600 147.5,-576 373.5,-576 373.5,-600"/>
<text text-anchor="middle" x="260.5" y="-585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_number_of_open_channels_wavmax</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax -->
<g id="program~~scattering~~CallsGraph_edge34" class="edge">
<title>program~scattering&#45;&gt;proc~set_number_of_open_channels_wavmax</title>
<path fill="none" stroke="#ff0000" d="M41.26,-794.71C44.09,-760.19 57.12,-661.79 115,-614 121.93,-608.28 129.68,-603.64 137.91,-599.9"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.44,-603.05 147.38,-596.04 136.8,-596.57 139.44,-603.05"/>
</g>
<!-- proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_node36" class="node">
<title>proc~prepare_coupling_matrix_elements</title>
<g id="a_program~~scattering~~CallsGraph_node36"><a xlink:href=".././proc/prepare_coupling_matrix_elements.html" xlink:title="prepare_coupling_matrix_elements">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-276 161,-276 161,-252 360,-252 360,-276"/>
<text text-anchor="middle" x="260.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">prepare_coupling_matrix_elements</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements -->
<g id="program~~scattering~~CallsGraph_edge35" class="edge">
<title>program~scattering&#45;&gt;proc~prepare_coupling_matrix_elements</title>
<path fill="none" stroke="#ff0000" d="M40.35,-794.72C39.76,-723.07 40.49,-359.7 115,-285 125.01,-274.96 137.55,-268.31 151.02,-264.04"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.24,-267.33 160.98,-261.34 150.41,-260.58 152.24,-267.33"/>
</g>
<!-- proc~crosssection -->
<g id="program~~scattering~~CallsGraph_node37" class="node">
<title>proc~crosssection</title>
<g id="a_program~~scattering~~CallsGraph_node37"><a xlink:href=".././proc/crosssection.html" xlink:title="CROSSSECTION">
<polygon fill="#d9534f" stroke="#d9534f" points="308.5,-520 212.5,-520 212.5,-496 308.5,-496 308.5,-520"/>
<text text-anchor="middle" x="260.5" y="-505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">CROSSSECTION</text>
</a>
</g>
</g>
<!-- program~scattering&#45;&gt;proc~crosssection -->
<g id="program~~scattering~~CallsGraph_edge36" class="edge">
<title>program~scattering&#45;&gt;proc~crosssection</title>
<path fill="none" stroke="#ff0000" d="M42.1,-794.82C48.65,-746.68 75.05,-570.57 115,-534 138.21,-512.75 172.64,-505.95 202.06,-504.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.33,-508.1 212.24,-504.34 202.15,-501.1 202.33,-508.1"/>
</g>
<!-- fwig_table_free -->
<g id="program~~scattering~~CallsGraph_node38" class="node">
<title>fwig_table_free</title>
<polygon fill="#777777" stroke="#777777" points="307,-24 214,-24 214,0 307,0 307,-24"/>
<text text-anchor="middle" x="260.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig_table_free</text>
</g>
<!-- program~scattering&#45;&gt;fwig_table_free -->
<g id="program~~scattering~~CallsGraph_edge37" class="edge">
<title>program~scattering&#45;&gt;fwig_table_free</title>
<path fill="none" stroke="#ff0000" d="M40.78,-794.92C43.07,-701.09 60,-90.73 115,-33 137.31,-9.58 173.27,-4.29 203.74,-4.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.7,-8.38 213.83,-5.28 203.98,-1.38 203.7,-8.38"/>
</g>
<!-- proc~read_input_file&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge40" class="edge">
<title>proc~read_input_file&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#ff0000" d="M306.14,-1159.18C392.58,-1178.98 575.46,-1221.31 588,-1228 607.15,-1238.21 604.74,-1250.99 624,-1261 644.97,-1271.9 670.33,-1278.24 692.17,-1281.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="691.82,-1285.42 702.24,-1283.48 692.89,-1278.5 691.82,-1285.42"/>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge42" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0000" d="M306.06,-1138.41C351.47,-1127.62 421.59,-1110.96 467.64,-1100.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.73,-1103.35 477.65,-1097.64 467.12,-1096.54 468.73,-1103.35"/>
</g>
<!-- proc~input_summary -->
<g id="program~~scattering~~CallsGraph_node45" class="node">
<title>proc~input_summary</title>
<g id="a_program~~scattering~~CallsGraph_node45"><a xlink:href=".././proc/input_summary.html" xlink:title="input_summary">
<polygon fill="#d9534f" stroke="#d9534f" points="562.5,-1181 467.5,-1181 467.5,-1157 562.5,-1157 562.5,-1181"/>
<text text-anchor="middle" x="515" y="-1166.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_summary</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_summary -->
<g id="program~~scattering~~CallsGraph_edge39" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_summary</title>
<path fill="none" stroke="#ff0000" d="M306.06,-1152.53C348.18,-1155.87 411.56,-1160.89 457.27,-1164.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="457.07,-1168 467.32,-1165.3 457.63,-1161.02 457.07,-1168"/>
</g>
<!-- proc~input_check -->
<g id="program~~scattering~~CallsGraph_node53" class="node">
<title>proc~input_check</title>
<g id="a_program~~scattering~~CallsGraph_node53"><a xlink:href=".././proc/input_check.html" xlink:title="input_check">
<polygon fill="#d9534f" stroke="#d9534f" points="781,-1101 705,-1101 705,-1077 781,-1077 781,-1101"/>
<text text-anchor="middle" x="743" y="-1086.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">input_check</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;proc~input_check -->
<g id="program~~scattering~~CallsGraph_edge41" class="edge">
<title>proc~read_input_file&#45;&gt;proc~input_check</title>
<path fill="none" stroke="#ff0000" d="M306.15,-1143.9C369.06,-1136.67 487.35,-1122.87 588,-1110 623.95,-1105.4 664.57,-1099.85 695.06,-1095.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="695.57,-1099.07 704.99,-1094.22 694.61,-1092.14 695.57,-1099.07"/>
</g>
<!-- interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_node55" class="node">
<title>interface~allocate_3d</title>
<g id="a_program~~scattering~~CallsGraph_node55"><a xlink:href=".././interface/allocate_3d.html" xlink:title="allocate_3d">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-1261 478,-1261 478,-1237 552,-1237 552,-1261"/>
<text text-anchor="middle" x="515" y="-1246.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_3d</text>
</a>
</g>
</g>
<!-- proc~read_input_file&#45;&gt;interface~allocate_3d -->
<g id="program~~scattering~~CallsGraph_edge38" class="edge">
<title>proc~read_input_file&#45;&gt;interface~allocate_3d</title>
<path fill="none" stroke="#ff0000" d="M289.8,-1161.04C325.21,-1176 387.8,-1202.11 442,-1223 451.11,-1226.51 460.92,-1230.15 470.29,-1233.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="469.23,-1236.89 479.83,-1237 471.61,-1230.31 469.23,-1236.89"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge44" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff2900" d="M785.43,-1796.91C810.57,-1787.68 841.62,-1772.64 862,-1750 925.91,-1678.97 949.08,-1561.87 956.22,-1513.24"/>
<polygon fill="#ff2900" stroke="#ff2900" points="959.71,-1513.56 957.61,-1503.18 952.78,-1512.6 959.71,-1513.56"/>
</g>
<!-- proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge43" class="edge">
<title>proc~print_coupling_matrix_elements_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff2900" d="M862.06,-1812.23C972.83,-1812.45 1127.25,-1804.52 1167,-1761 1211.96,-1711.77 1240.87,-1221.66 1246.84,-1111.09"/>
<polygon fill="#ff2900" stroke="#ff2900" points="1250.34,-1111.24 1247.38,-1101.07 1243.35,-1110.87 1250.34,-1111.24"/>
</g>
<!-- proc~numerov&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge53" class="edge">
<title>proc~numerov&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff7c00" d="M290.76,-707.91C322.7,-708.4 373.61,-704.27 406,-677 439.91,-648.46 408.21,-612.68 442,-584 505.01,-530.54 542.05,-556.57 624,-546 731.88,-532.09 860.68,-529.43 922.43,-529"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="922.83,-532.5 932.81,-528.95 922.8,-525.5 922.83,-532.5"/>
</g>
<!-- proc~numerov&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge49" class="edge">
<title>proc~numerov&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff7c00" d="M290.73,-708.52C323.13,-709.62 374.89,-706.11 406,-677 450.71,-635.16 395.26,-583.57 442,-544 491.28,-502.28 968.54,-471.79 1022,-508 1219.64,-641.88 1244.48,-976.36 1247.57,-1066.38"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="1244.08,-1066.66 1247.86,-1076.56 1251.07,-1066.46 1244.08,-1066.66"/>
</g>
<!-- proc~numerov&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge48" class="edge">
<title>proc~numerov&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff7c00" d="M274.59,-718.36C304.34,-747.4 376.73,-823.63 406,-904 486.63,-1125.43 357.31,-1213.09 442,-1433 488.98,-1554.97 507.58,-1604.6 624,-1664 768.24,-1737.6 969.18,-1698.95 1061.5,-1674.73"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="1062.66,-1678.04 1071.42,-1672.07 1060.85,-1671.28 1062.66,-1678.04"/>
</g>
<!-- proc~numerov&#45;&gt;interface~allocate_2d -->
<g id="program~~scattering~~CallsGraph_edge52" class="edge">
<title>proc~numerov&#45;&gt;interface~allocate_2d</title>
<path fill="none" stroke="#ff7c00" d="M290.65,-709.48C323.22,-711.63 375.39,-709.58 406,-680 460.6,-627.24 392.03,-570.17 442,-513 448.96,-505.04 458.55,-499.51 468.46,-495.68"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="469.61,-498.99 477.99,-492.5 467.39,-492.35 469.61,-498.99"/>
</g>
<!-- proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_node39" class="node">
<title>proc~pes_contribution</title>
<g id="a_program~~scattering~~CallsGraph_node39"><a xlink:href=".././proc/pes_contribution.html" xlink:title="pes_contribution">
<polygon fill="#d9534f" stroke="#d9534f" points="565.5,-739 464.5,-739 464.5,-715 565.5,-715 565.5,-739"/>
<text text-anchor="middle" x="515" y="-724.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pes_contribution</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~pes_contribution -->
<g id="program~~scattering~~CallsGraph_edge45" class="edge">
<title>proc~numerov&#45;&gt;proc~pes_contribution</title>
<path fill="none" stroke="#ff7c00" d="M290.96,-708.45C330.84,-711.77 402.93,-717.76 454.35,-722.04"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="454.09,-725.53 464.35,-722.87 454.67,-718.55 454.09,-725.53"/>
</g>
<!-- proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_node40" class="node">
<title>proc~cenitrfugal_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node40"><a xlink:href=".././proc/cenitrfugal_matrix.html" xlink:title="cenitrfugal_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="570,-617 460,-617 460,-593 570,-593 570,-617"/>
<text text-anchor="middle" x="515" y="-602.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cenitrfugal_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~cenitrfugal_matrix -->
<g id="program~~scattering~~CallsGraph_edge50" class="edge">
<title>proc~numerov&#45;&gt;proc~cenitrfugal_matrix</title>
<path fill="none" stroke="#ff7c00" d="M290.61,-706.91C321.5,-706.54 370.64,-702.05 406,-680 428.93,-665.7 420.35,-647.18 442,-631 447.03,-627.24 452.66,-623.98 458.49,-621.17"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="460,-624.33 467.76,-617.11 457.2,-617.91 460,-624.33"/>
</g>
<!-- interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node44" class="node">
<title>interface~fill_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node44"><a xlink:href=".././interface/fill_symmetric_matrix.html" xlink:title="fill_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="806.5,-621 679.5,-621 679.5,-597 806.5,-597 806.5,-621"/>
<text text-anchor="middle" x="743" y="-606.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fill_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge46" class="edge">
<title>proc~numerov&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff7c00" d="M290.77,-702.83C320.32,-699.14 367.02,-691.98 406,-680 422.74,-674.86 425.28,-669.2 442,-664 520.58,-639.57 543.05,-644.76 624,-630 638.55,-627.35 654.12,-624.55 669.02,-621.89"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="669.98,-625.27 679.21,-620.07 668.75,-618.38 669.98,-625.27"/>
</g>
<!-- proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_node46" class="node">
<title>proc~calculate_log_der_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node46"><a xlink:href=".././proc/calculate_log_der_matrix.html" xlink:title="calculate_log_der_matrix">
<polygon fill="#d9534f" stroke="#d9534f" points="588,-697 442,-697 442,-673 588,-673 588,-697"/>
<text text-anchor="middle" x="515" y="-682.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_log_der_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;proc~calculate_log_der_matrix -->
<g id="program~~scattering~~CallsGraph_edge47" class="edge">
<title>proc~numerov&#45;&gt;proc~calculate_log_der_matrix</title>
<path fill="none" stroke="#ff7c00" d="M290.96,-703.55C325.27,-700.7 383.42,-695.86 431.74,-691.84"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="432.21,-695.31 441.89,-691 431.63,-688.34 432.21,-695.31"/>
</g>
<!-- interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_node50" class="node">
<title>interface~invert_symmetric_matrix</title>
<g id="a_program~~scattering~~CallsGraph_node50"><a xlink:href=".././interface/invert_symmetric_matrix.html" xlink:title="invert_symmetric_matrix">
<polygon fill="#a7506f" stroke="#a7506f" points="815.5,-663 670.5,-663 670.5,-639 815.5,-639 815.5,-663"/>
<text text-anchor="middle" x="743" y="-648.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">invert_symmetric_matrix</text>
</a>
</g>
</g>
<!-- proc~numerov&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge51" class="edge">
<title>proc~numerov&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#ff7c00" d="M283.83,-718C339.92,-746.34 489.24,-810.5 588,-748 619.58,-728.01 594.3,-694.69 624,-672 634.61,-663.9 647.31,-658.54 660.39,-655.05"/>
<polygon fill="#ff7c00" stroke="#ff7c00" points="661.47,-658.4 670.43,-652.74 659.9,-651.57 661.47,-658.4"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge55" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ffa500" d="M796.24,-810.27C818.75,-807.44 843.99,-800.57 862,-785 934.04,-722.73 952.73,-601.13 957.45,-551.21"/>
<polygon fill="#ffa500" stroke="#ffa500" points="960.95,-551.42 958.3,-541.17 953.97,-550.84 960.95,-551.42"/>
</g>
<!-- proc~print_bf_channels&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge54" class="edge">
<title>proc~print_bf_channels&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ffa500" d="M796.24,-813.4C883.06,-820.02 1058.25,-844.84 1167,-938 1208,-973.12 1231.58,-1034.34 1241.83,-1066.99"/>
<polygon fill="#ffa500" stroke="#ffa500" points="1238.57,-1068.32 1244.8,-1076.9 1245.28,-1066.31 1238.57,-1068.32"/>
</g>
<!-- proc~write_error -->
<g id="program~~scattering~~CallsGraph_node47" class="node">
<title>proc~write_error</title>
<g id="a_program~~scattering~~CallsGraph_node47"><a xlink:href=".././proc/write_error.html" xlink:title="write_error">
<polygon fill="#d9534f" stroke="#d9534f" points="995,-1022 925,-1022 925,-998 995,-998 995,-1022"/>
<text text-anchor="middle" x="960" y="-1007.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_error</text>
</a>
</g>
</g>
<!-- proc~set_number_of_channels&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge56" class="edge">
<title>proc~set_number_of_channels&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#fff800" d="M333.19,-971.42C477.12,-980.29 797.46,-1000.04 914.82,-1007.28"/>
<polygon fill="#fff800" stroke="#fff800" points="914.68,-1010.77 924.88,-1007.9 915.11,-1003.79 914.68,-1010.77"/>
</g>
<!-- proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_node41" class="node">
<title>proc~triangle_inequality_holds</title>
<g id="a_program~~scattering~~CallsGraph_node41"><a xlink:href=".././proc/triangle_inequality_holds.html" xlink:title="triangle_inequality_holds">
<polygon fill="#d94e8f" stroke="#d94e8f" points="587.5,-255 442.5,-255 442.5,-231 587.5,-231 587.5,-255"/>
<text text-anchor="middle" x="515" y="-240.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">triangle_inequality_holds</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge57" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#dcff00" d="M374.15,-293.96C385.05,-291.51 395.83,-288.55 406,-285 423.49,-278.89 424.98,-271.31 442,-264 446.74,-261.96 451.73,-260.05 456.79,-258.28"/>
<polygon fill="#dcff00" stroke="#dcff00" points="458.16,-261.52 466.55,-255.04 455.96,-254.87 458.16,-261.52"/>
</g>
<!-- proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_node57" class="node">
<title>proc~is_sum_even</title>
<g id="a_program~~scattering~~CallsGraph_node57"><a xlink:href=".././proc/is_sum_even.html" xlink:title="is_sum_even">
<polygon fill="#d94e8f" stroke="#d94e8f" points="555,-213 475,-213 475,-189 555,-189 555,-213"/>
<text text-anchor="middle" x="515" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_sum_even</text>
</a>
</g>
</g>
<!-- proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge58" class="edge">
<title>proc~check_nonzero_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#dcff00" d="M379.71,-298.18C389.03,-294.81 397.93,-290.49 406,-285 432.65,-266.84 416.68,-241.97 442,-222 448.76,-216.67 456.83,-212.69 465.09,-209.72"/>
<polygon fill="#dcff00" stroke="#dcff00" points="466.3,-213.01 474.79,-206.68 464.21,-206.33 466.3,-213.01"/>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge59" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#89ff00" d="M1007.28,-1732.12C1054.64,-1732.56 1126.81,-1725.11 1167,-1681 1244.96,-1595.44 1248.55,-1209.18 1248.19,-1111.5"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1251.69,-1111.27 1248.13,-1101.29 1244.69,-1111.31 1251.69,-1111.27"/>
</g>
<!-- proc~write_warning -->
<g id="program~~scattering~~CallsGraph_node48" class="node">
<title>proc~write_warning</title>
<g id="a_program~~scattering~~CallsGraph_node48"><a xlink:href=".././proc/write_warning.html" xlink:title="write_warning">
<polygon fill="#d9534f" stroke="#d9534f" points="1156,-1431 1069,-1431 1069,-1407 1156,-1407 1156,-1431"/>
<text text-anchor="middle" x="1112.5" y="-1416.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_warning</text>
</a>
</g>
</g>
<!-- proc~unitarity_check&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge60" class="edge">
<title>proc~unitarity_check&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#89ff00" d="M967.62,-1716.92C979.05,-1695.94 1003.08,-1651.36 1022,-1613 1052.46,-1551.23 1085.82,-1477.01 1101.84,-1440.89"/>
<polygon fill="#89ff00" stroke="#89ff00" points="1105.22,-1441.92 1106.06,-1431.36 1098.82,-1439.09 1105.22,-1441.92"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge62" class="edge">
<title>proc~potential_read&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#60ff00" d="M532.16,-1424.08C552.42,-1438.45 588.77,-1461.8 624,-1472 712.08,-1497.51 818.51,-1498.83 887.41,-1496.06"/>
<polygon fill="#60ff00" stroke="#60ff00" points="887.89,-1499.55 897.72,-1495.61 887.58,-1492.55 887.89,-1499.55"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge63" class="edge">
<title>proc~potential_read&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#60ff00" d="M517.68,-1424.02C523.75,-1462.31 548.31,-1581.77 624,-1632 691.71,-1676.93 931.41,-1670.27 1047.52,-1664.09"/>
<polygon fill="#60ff00" stroke="#60ff00" points="1047.9,-1667.58 1057.69,-1663.53 1047.51,-1660.59 1047.9,-1667.58"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~file_io_status -->
<g id="program~~scattering~~CallsGraph_edge61" class="edge">
<title>proc~potential_read&#45;&gt;proc~file_io_status</title>
<path fill="none" stroke="#60ff00" d="M559.85,-1405.76C569.98,-1402.64 580.09,-1397.98 588,-1391 618.16,-1364.41 592.45,-1332.93 624,-1308 643.04,-1292.95 669.23,-1287.26 692.09,-1285.51"/>
<polygon fill="#60ff00" stroke="#60ff00" points="692.53,-1289 702.33,-1284.97 692.16,-1282.01 692.53,-1289"/>
</g>
<!-- proc~potential_read&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge64" class="edge">
<title>proc~potential_read&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#60ff00" d="M559.72,-1407.57C570.35,-1404.46 580.73,-1399.34 588,-1391 659.75,-1308.71 547.23,-1225.63 624,-1148 699.32,-1071.83 766.96,-1159.41 862,-1110 897.99,-1091.28 928.46,-1054.16 945.2,-1030.79"/>
<polygon fill="#60ff00" stroke="#60ff00" points="948.27,-1032.49 951.11,-1022.29 942.53,-1028.5 948.27,-1032.49"/>
</g>
<!-- proc~count_open_basis_levels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge65" class="edge">
<title>proc~count_open_basis_levels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#37ff00" d="M578.39,-315C652.26,-304.31 776.1,-297.81 862,-353 917.81,-388.85 944.22,-468.53 954.12,-507.16"/>
<polygon fill="#37ff00" stroke="#37ff00" points="950.73,-508 956.49,-516.89 957.53,-506.35 950.73,-508"/>
</g>
<!-- proc~time_count_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge66" class="edge">
<title>proc~time_count_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0dff00" d="M578.68,-280.2C714.81,-273.73 1035.74,-280.75 1167,-475 1234.24,-574.51 1245.81,-967.89 1247.66,-1066.49"/>
<polygon fill="#0dff00" stroke="#0dff00" points="1244.17,-1066.61 1247.84,-1076.55 1251.17,-1066.49 1244.17,-1066.61"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge69" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ff1b" d="M536.52,-794.97C552.7,-784.49 574.69,-767.87 588,-748 618.52,-702.45 582.97,-666.38 624,-630 636.51,-618.91 652.78,-612.71 669.23,-609.43"/>
<polygon fill="#00ff1b" stroke="#00ff1b" points="670.16,-612.82 679.46,-607.74 669.03,-605.92 670.16,-612.82"/>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge68" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00ff1b" d="M567.84,-794.84C575.3,-791.33 582.35,-786.81 588,-781 623.58,-744.43 585.44,-705.41 624,-672 634.38,-663.01 647.24,-657.26 660.63,-653.67"/>
<polygon fill="#00ff1b" stroke="#00ff1b" points="661.47,-657.07 670.44,-651.43 659.91,-650.25 661.47,-657.07"/>
</g>
<!-- dgemm -->
<g id="program~~scattering~~CallsGraph_node51" class="node">
<title>dgemm</title>
<polygon fill="#777777" stroke="#777777" points="770,-705 716,-705 716,-681 770,-681 770,-705"/>
<text text-anchor="middle" x="743" y="-690.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgemm</text>
</g>
<!-- proc~calculate_s_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge67" class="edge">
<title>proc~calculate_s_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ff1b" d="M564.23,-794.9C572.73,-791.34 581.06,-786.79 588,-781 612.46,-760.58 598.27,-737.79 624,-719 647.57,-701.79 680.37,-695.6 705.41,-693.55"/>
<polygon fill="#00ff1b" stroke="#00ff1b" points="705.86,-697.02 715.62,-692.9 705.41,-690.04 705.86,-697.02"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge70" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#00ff44" d="M811.27,-1851.74C829.59,-1848.8 848.17,-1842.48 862,-1830 863.54,-1828.61 931.76,-1587.43 952.85,-1512.77"/>
<polygon fill="#00ff44" stroke="#00ff44" points="956.26,-1513.58 955.61,-1503.01 949.52,-1511.68 956.26,-1513.58"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge72" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff44" d="M799.47,-1863.03C891.02,-1879.25 1072.95,-1895.52 1167,-1794 1214.66,-1742.56 1241.61,-1225.02 1246.99,-1111.1"/>
<polygon fill="#00ff44" stroke="#00ff44" points="1250.49,-1111.25 1247.46,-1101.1 1243.5,-1110.92 1250.49,-1111.25"/>
</g>
<!-- proc~print_largest_partial_xs&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge71" class="edge">
<title>proc~print_largest_partial_xs&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#00ff44" d="M811.3,-1842.46C828.09,-1839.4 845.9,-1835.33 862,-1830 937.47,-1805 957.57,-1796.58 1022,-1750 1050.6,-1729.33 1078.43,-1699.31 1095.28,-1679.72"/>
<polygon fill="#00ff44" stroke="#00ff44" points="1098,-1681.91 1101.79,-1672.02 1092.66,-1677.39 1098,-1681.91"/>
</g>
<!-- proc~save_open_basis_levels&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge73" class="edge">
<title>proc~save_open_basis_levels&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#00ff97" d="M579.47,-457.04C673.61,-474.89 847.22,-507.8 922.54,-522.09"/>
<polygon fill="#00ff97" stroke="#00ff97" points="922.03,-525.55 932.5,-523.98 923.33,-518.67 922.03,-525.55"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge74" class="edge">
<title>proc~file_io_status&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#006eff" d="M783.7,-1284.94C808.62,-1285.69 840.08,-1290.6 862,-1308 893.81,-1333.26 879.3,-1355.95 898,-1392 912.53,-1420 932.05,-1450.7 945.05,-1470.38"/>
<polygon fill="#006eff" stroke="#006eff" points="942.23,-1472.46 950.69,-1478.84 948.06,-1468.58 942.23,-1472.46"/>
</g>
<!-- proc~file_io_status&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge75" class="edge">
<title>proc~file_io_status&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#006eff" d="M763.11,-1274.78C788.2,-1258.01 832.51,-1225.84 862,-1190 903.88,-1139.1 936.04,-1067.35 950.54,-1031.77"/>
<polygon fill="#006eff" stroke="#006eff" points="953.85,-1032.93 954.31,-1022.34 947.35,-1030.32 953.85,-1032.93"/>
</g>
<!-- proc~spline -->
<g id="program~~scattering~~CallsGraph_node42" class="node">
<title>proc~spline</title>
<g id="a_program~~scattering~~CallsGraph_node42"><a xlink:href=".././proc/spline.html" xlink:title="spline">
<polygon fill="#d9534f" stroke="#d9534f" points="770,-1341 716,-1341 716,-1317 770,-1317 770,-1341"/>
<text text-anchor="middle" x="743" y="-1326.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spline</text>
</a>
</g>
</g>
<!-- proc~potential_interpolation&#45;&gt;proc~spline -->
<g id="program~~scattering~~CallsGraph_edge76" class="edge">
<title>proc~potential_interpolation&#45;&gt;proc~spline</title>
<path fill="none" stroke="#0044ff" d="M327.05,-1329C429.66,-1329 624.83,-1329 705.6,-1329"/>
<polygon fill="#0044ff" stroke="#0044ff" points="705.77,-1332.5 715.77,-1329 705.77,-1325.5 705.77,-1332.5"/>
</g>
<!-- proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge77" class="edge">
<title>proc~set_channels_level_indices_channels_omega_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#001bff" d="M344.85,-913C488.57,-893.96 775.9,-863.67 862,-912 888.79,-927.04 876.51,-949.05 898,-971 906.15,-979.32 916.39,-986.73 926.14,-992.79"/>
<polygon fill="#001bff" stroke="#001bff" points="924.49,-995.88 934.88,-997.97 928.06,-989.86 924.49,-995.88"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge78" class="edge">
<title>proc~write_header&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#3700ff" d="M784.02,-861.88C806.93,-867.12 836.17,-874.07 862,-881 1003.98,-919.11 1049.23,-921.01 1167,-1009 1191.08,-1026.99 1215.14,-1051.85 1230.71,-1069.06"/>
<polygon fill="#3700ff" stroke="#3700ff" points="1228.36,-1071.69 1237.63,-1076.83 1233.59,-1067.03 1228.36,-1071.69"/>
</g>
<!-- proc~write_header&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge79" class="edge">
<title>proc~write_header&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#3700ff" d="M784.02,-852.62C809.07,-854.42 840.55,-860.67 862,-879 895.37,-907.53 870.14,-937.07 898,-971 905.01,-979.54 914.4,-986.81 923.71,-992.68"/>
<polygon fill="#3700ff" stroke="#3700ff" points="922.13,-995.82 932.53,-997.88 925.68,-989.79 922.13,-995.82"/>
</g>
<!-- interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_node49" class="node">
<title>interface~incorrect_value</title>
<g id="a_program~~scattering~~CallsGraph_node49"><a xlink:href=".././interface/incorrect_value.html" xlink:title="incorrect_value">
<polygon fill="#a7506f" stroke="#a7506f" points="1007,-962 913,-962 913,-938 1007,-938 1007,-962"/>
<text text-anchor="middle" x="960" y="-947.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">incorrect_value</text>
</a>
</g>
</g>
<!-- proc~write_header&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge80" class="edge">
<title>proc~write_header&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#3700ff" d="M784.1,-857.62C807.57,-861.34 837.34,-867.86 862,-879 864.03,-879.92 906.32,-911.06 934.38,-931.79"/>
<polygon fill="#3700ff" stroke="#3700ff" points="932.45,-934.72 942.58,-937.85 936.61,-929.09 932.45,-934.72"/>
</g>
<!-- proc~set_channels_l_values&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge81" class="edge">
<title>proc~set_channels_l_values&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#6000ff" d="M325.56,-1009.09C465.31,-1009.29 794.64,-1009.76 914.44,-1009.94"/>
<polygon fill="#6000ff" stroke="#6000ff" points="914.69,-1013.44 924.7,-1009.95 914.7,-1006.44 914.69,-1013.44"/>
</g>
<!-- proc~transform_summation -->
<g id="program~~scattering~~CallsGraph_node58" class="node">
<title>proc~transform_summation</title>
<g id="a_program~~scattering~~CallsGraph_node58"><a xlink:href=".././proc/transform_summation.html" xlink:title="transform_summation">
<polygon fill="#d9534f" stroke="#d9534f" points="580,-133 450,-133 450,-109 580,-109 580,-133"/>
<text text-anchor="middle" x="515" y="-118.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transform_summation</text>
</a>
</g>
</g>
<!-- proc~bf_to_sf_transformation&#45;&gt;proc~transform_summation -->
<g id="program~~scattering~~CallsGraph_edge82" class="edge">
<title>proc~bf_to_sf_transformation&#45;&gt;proc~transform_summation</title>
<path fill="none" stroke="#8900ff" d="M329.53,-223.54C355.15,-221.31 383.5,-215.22 406,-201 430.38,-185.59 419.3,-164.79 442,-147 446.69,-143.32 451.95,-140.14 457.43,-137.38"/>
<polygon fill="#8900ff" stroke="#8900ff" points="459.13,-140.45 466.8,-133.14 456.25,-134.08 459.13,-140.45"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge86" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#b300ff" d="M528.35,-1357.77C545.25,-1340.15 574.96,-1305.78 588,-1270 624.62,-1169.5 552.07,-869.17 624,-790 696.18,-710.56 777.41,-815.07 862,-749 926.58,-698.56 949.16,-596.11 956.17,-551.07"/>
<polygon fill="#b300ff" stroke="#b300ff" points="959.64,-551.57 957.61,-541.17 952.71,-550.56 959.64,-551.57"/>
</g>
<!-- proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_node43" class="node">
<title>proc~modified_bessel_k_ratio</title>
<g id="a_program~~scattering~~CallsGraph_node43"><a xlink:href=".././proc/modified_bessel_k_ratio.html" xlink:title="modified_bessel_k_ratio">
<polygon fill="#d9534f" stroke="#d9534f" points="813,-1623 673,-1623 673,-1599 813,-1599 813,-1623"/>
<text text-anchor="middle" x="743" y="-1608.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modified_bessel_k_ratio</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio -->
<g id="program~~scattering~~CallsGraph_edge87" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~modified_bessel_k_ratio</title>
<path fill="none" stroke="#b300ff" d="M571.31,-1379C577.59,-1381.97 583.38,-1385.87 588,-1391 648.14,-1457.8 560.35,-1526.54 624,-1590 634.54,-1600.51 648.39,-1606.78 662.89,-1610.37"/>
<polygon fill="#b300ff" stroke="#b300ff" points="662.5,-1613.86 673,-1612.44 663.9,-1607 662.5,-1613.86"/>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge84" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#b300ff" d="M528.37,-1357.78C545.3,-1340.17 575.05,-1305.81 588,-1270 626.87,-1162.53 562.14,-853.09 624,-757 642.54,-728.2 678.68,-711.38 706.1,-702.27"/>
<polygon fill="#b300ff" stroke="#b300ff" points="707.26,-705.57 715.76,-699.25 705.17,-698.89 707.26,-705.57"/>
</g>
<!-- proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_node52" class="node">
<title>proc~riccati_bessel_j</title>
<g id="a_program~~scattering~~CallsGraph_node52"><a xlink:href=".././proc/riccati_bessel_j.html" xlink:title="riccati_bessel_j">
<polygon fill="#d9534f" stroke="#d9534f" points="789.5,-1581 696.5,-1581 696.5,-1557 789.5,-1557 789.5,-1581"/>
<text text-anchor="middle" x="743" y="-1566.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_j</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j -->
<g id="program~~scattering~~CallsGraph_edge83" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_j</title>
<path fill="none" stroke="#b300ff" d="M571.31,-1380.59C577.36,-1383.3 583.1,-1386.72 588,-1391 617.66,-1416.92 600.14,-1440.65 624,-1472 649,-1504.85 687.22,-1533.61 713.34,-1551.11"/>
<polygon fill="#b300ff" stroke="#b300ff" points="711.76,-1554.26 722.04,-1556.82 715.6,-1548.41 711.76,-1554.26"/>
</g>
<!-- proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_node54" class="node">
<title>proc~riccati_bessel_y</title>
<g id="a_program~~scattering~~CallsGraph_node54"><a xlink:href=".././proc/riccati_bessel_y.html" xlink:title="riccati_bessel_y">
<polygon fill="#d9534f" stroke="#d9534f" points="791,-1383 695,-1383 695,-1359 791,-1359 791,-1383"/>
<text text-anchor="middle" x="743" y="-1368.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">riccati_bessel_y</text>
</a>
</g>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y -->
<g id="program~~scattering~~CallsGraph_edge88" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;proc~riccati_bessel_y</title>
<path fill="none" stroke="#b300ff" d="M571.29,-1370.24C605.78,-1370.4 650.08,-1370.59 684.9,-1370.75"/>
<polygon fill="#b300ff" stroke="#b300ff" points="684.91,-1374.25 694.92,-1370.79 684.94,-1367.25 684.91,-1374.25"/>
</g>
<!-- dgesv -->
<g id="program~~scattering~~CallsGraph_node56" class="node">
<title>dgesv</title>
<polygon fill="#777777" stroke="#777777" points="770,-1463 716,-1463 716,-1439 770,-1439 770,-1463"/>
<text text-anchor="middle" x="743" y="-1448.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dgesv</text>
</g>
<!-- proc~calculate_k_matrix&#45;&gt;dgesv -->
<g id="program~~scattering~~CallsGraph_edge85" class="edge">
<title>proc~calculate_k_matrix&#45;&gt;dgesv</title>
<path fill="none" stroke="#b300ff" d="M568.35,-1382.06C575.17,-1384.55 581.9,-1387.5 588,-1391 607.1,-1401.94 604.55,-1414.7 624,-1425 649.36,-1438.42 681.3,-1444.92 705.55,-1448.07"/>
<polygon fill="#b300ff" stroke="#b300ff" points="705.43,-1451.58 715.77,-1449.26 706.24,-1444.62 705.43,-1451.58"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge90" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff00f8" d="M761.71,-1716.87C786,-1699.71 830.26,-1666.58 862,-1632 897.56,-1593.26 930.32,-1540.69 947.15,-1511.93"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="950.25,-1513.55 952.23,-1503.14 944.19,-1510.05 950.25,-1513.55"/>
</g>
<!-- proc~potential_reduction&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge89" class="edge">
<title>proc~potential_reduction&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#ff00f8" d="M775.57,-1741.1C855.25,-1769.33 1065.36,-1829.13 1167,-1718 1250.36,-1626.86 1249.82,-1212.37 1248.41,-1111.28"/>
<polygon fill="#ff00f8" stroke="#ff00f8" points="1251.91,-1110.97 1248.25,-1101.03 1244.91,-1111.08 1251.91,-1110.97"/>
</g>
<!-- proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge91" class="edge">
<title>proc~set_number_of_open_channels_wavmax&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#ff00a5" d="M373.81,-581.27C385.66,-576.8 396.74,-570.57 406,-562 452.52,-518.94 391.84,-462.75 442,-424 500.21,-379.03 799.73,-438.89 862,-463 890.66,-474.1 919.23,-495.04 937.87,-510.37"/>
<polygon fill="#ff00a5" stroke="#ff00a5" points="935.79,-513.2 945.69,-516.96 940.3,-507.84 935.79,-513.2"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds -->
<g id="program~~scattering~~CallsGraph_edge92" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~triangle_inequality_holds</title>
<path fill="none" stroke="#ff007c" d="M360.21,-255.79C384.06,-253.81 409.3,-251.71 432.28,-249.8"/>
<polygon fill="#ff007c" stroke="#ff007c" points="432.64,-253.28 442.32,-248.96 432.06,-246.3 432.64,-253.28"/>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even -->
<g id="program~~scattering~~CallsGraph_edge93" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;proc~is_sum_even</title>
<path fill="none" stroke="#ff007c" d="M360.27,-254.82C375.82,-251.9 391.52,-248.06 406,-243 423.49,-236.89 424.98,-229.31 442,-222 449.32,-218.85 457.25,-216.01 465.08,-213.51"/>
<polygon fill="#ff007c" stroke="#ff007c" points="466.35,-216.78 474.9,-210.52 464.32,-210.09 466.35,-216.78"/>
</g>
<!-- fwig3jj -->
<g id="program~~scattering~~CallsGraph_node59" class="node">
<title>fwig3jj</title>
<polygon fill="#777777" stroke="#777777" points="987,-153 933,-153 933,-129 987,-129 987,-153"/>
<text text-anchor="middle" x="960" y="-138.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fwig3jj</text>
</g>
<!-- proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge94" class="edge">
<title>proc~prepare_coupling_matrix_elements&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#ff007c" d="M360.04,-261.87C376.36,-258.2 392.38,-252.28 406,-243 432.65,-224.84 414.74,-197.22 442,-180 482.41,-154.47 811.65,-144.46 922.63,-141.79"/>
<polygon fill="#ff007c" stroke="#ff007c" points="922.76,-145.29 932.67,-141.55 922.6,-138.29 922.76,-145.29"/>
</g>
<!-- proc~crosssection&#45;&gt;proc~time_count_summary -->
<g id="program~~scattering~~CallsGraph_edge96" class="edge">
<title>proc~crosssection&#45;&gt;proc~time_count_summary</title>
<path fill="none" stroke="#ff0052" d="M308.64,-498.42C340.53,-489.55 381.21,-473.16 406,-444 447.05,-395.7 397.83,-351.46 442,-306 443.08,-304.89 444.21,-303.84 445.39,-302.84"/>
<polygon fill="#ff0052" stroke="#ff0052" points="447.56,-305.6 453.79,-297.03 443.58,-299.84 447.56,-305.6"/>
</g>
<!-- proc~crosssection&#45;&gt;interface~allocate_1d -->
<g id="program~~scattering~~CallsGraph_edge95" class="edge">
<title>proc~crosssection&#45;&gt;interface~allocate_1d</title>
<path fill="none" stroke="#ff0052" d="M308.6,-514.75C341.12,-521.99 382.57,-536.82 406,-567 441.9,-613.25 430.19,-770.65 442,-828 460.53,-917.95 492.72,-1022.64 506.92,-1067.16"/>
<polygon fill="#ff0052" stroke="#ff0052" points="503.66,-1068.46 510.05,-1076.91 510.32,-1066.32 503.66,-1068.46"/>
</g>
<!-- proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge98" class="edge">
<title>proc~pes_contribution&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff0000" d="M565.68,-718.55C573.75,-715.55 581.56,-711.49 588,-706 616.44,-681.75 594.3,-652.69 624,-630 637.01,-620.06 653.17,-614.25 669.31,-610.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="670.07,-614.39 679.33,-609.23 668.88,-607.49 670.07,-614.39"/>
</g>
<!-- proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_node60" class="node">
<title>proc~radtermvalue</title>
<g id="a_program~~scattering~~CallsGraph_node60"><a xlink:href=".././proc/radtermvalue.html" xlink:title="RADTERMVALUE">
<polygon fill="#d9534f" stroke="#d9534f" points="791.5,-1181 694.5,-1181 694.5,-1157 791.5,-1157 791.5,-1181"/>
<text text-anchor="middle" x="743" y="-1166.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RADTERMVALUE</text>
</a>
</g>
</g>
<!-- proc~pes_contribution&#45;&gt;proc~radtermvalue -->
<g id="program~~scattering~~CallsGraph_edge97" class="edge">
<title>proc~pes_contribution&#45;&gt;proc~radtermvalue</title>
<path fill="none" stroke="#ff0000" d="M538.56,-739.04C555.2,-749.21 576.82,-765.41 588,-786 657.14,-913.32 541.13,-991.15 624,-1110 638.44,-1130.71 662.33,-1144.53 684.85,-1153.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="683.79,-1156.89 694.39,-1157.12 686.25,-1150.33 683.79,-1156.89"/>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge100" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#ff4800" d="M570.13,-605.96C599.71,-606.48 636.75,-607.14 668.86,-607.71"/>
<polygon fill="#ff4800" stroke="#ff4800" points="669.04,-611.21 679.1,-607.89 669.17,-604.21 669.04,-611.21"/>
</g>
<!-- dfloat -->
<g id="program~~scattering~~CallsGraph_node65" class="node">
<title>dfloat</title>
<polygon fill="#777777" stroke="#777777" points="770,-579 716,-579 716,-555 770,-555 770,-579"/>
<text text-anchor="middle" x="743" y="-564.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dfloat</text>
</g>
<!-- proc~cenitrfugal_matrix&#45;&gt;dfloat -->
<g id="program~~scattering~~CallsGraph_edge99" class="edge">
<title>proc~cenitrfugal_matrix&#45;&gt;dfloat</title>
<path fill="none" stroke="#ff4800" d="M570.13,-595.9C612.09,-588.84 669.06,-579.26 705.69,-573.11"/>
<polygon fill="#ff4800" stroke="#ff4800" points="706.63,-576.5 715.91,-571.39 705.46,-569.59 706.63,-576.5"/>
</g>
<!-- proc~spline&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge101" class="edge">
<title>proc~spline&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ffda00" d="M770.01,-1328.04C795.4,-1328.32 834.18,-1332.09 862,-1350 873.97,-1357.71 922.43,-1432.98 946,-1470.27"/>
<polygon fill="#ffda00" stroke="#ffda00" points="943.13,-1472.28 951.42,-1478.87 949.05,-1468.54 943.13,-1472.28"/>
</g>
<!-- proc~spline&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge102" class="edge">
<title>proc~spline&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ffda00" d="M770.25,-1331.56C796.57,-1332.63 836.73,-1329.99 862,-1308 883.72,-1289.1 935.86,-1097.64 953.25,-1031.97"/>
<polygon fill="#ffda00" stroke="#ffda00" points="956.65,-1032.79 955.82,-1022.22 949.88,-1031 956.65,-1032.79"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge104" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#daff00" d="M813.14,-1606.01C829.81,-1602.86 847.1,-1597.87 862,-1590 897.69,-1571.15 928.25,-1534.5 945.09,-1511.47"/>
<polygon fill="#daff00" stroke="#daff00" points="948.1,-1513.27 951.04,-1503.09 942.4,-1509.21 948.1,-1513.27"/>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge105" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#daff00" d="M813.26,-1609.34C873.35,-1604.78 960.16,-1590.36 1022,-1547 1061.12,-1519.56 1088.79,-1469.25 1102.24,-1440.55"/>
<polygon fill="#daff00" stroke="#daff00" points="1105.46,-1441.93 1106.4,-1431.38 1099.08,-1439.04 1105.46,-1441.93"/>
</g>
<!-- proc~ikv -->
<g id="program~~scattering~~CallsGraph_node61" class="node">
<title>proc~ikv</title>
<g id="a_program~~scattering~~CallsGraph_node61"><a xlink:href=".././proc/ikv.html" xlink:title="ikv">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-2015 933,-2015 933,-1991 987,-1991 987,-2015"/>
<text text-anchor="middle" x="960" y="-2000.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ikv</text>
</a>
</g>
</g>
<!-- proc~modified_bessel_k_ratio&#45;&gt;proc~ikv -->
<g id="program~~scattering~~CallsGraph_edge103" class="edge">
<title>proc~modified_bessel_k_ratio&#45;&gt;proc~ikv</title>
<path fill="none" stroke="#daff00" d="M767.6,-1623.14C795.26,-1638.74 840.12,-1668.58 862,-1708 921.61,-1815.39 820.3,-1886.88 898,-1982 904.31,-1989.73 913.61,-1994.62 923.06,-1997.71"/>
<polygon fill="#daff00" stroke="#daff00" points="922.28,-2001.13 932.84,-2000.33 924.09,-1994.36 922.28,-2001.13"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge108" class="edge">
<title>proc~input_summary&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#48ff00" d="M538.62,-1156.99C555.28,-1146.83 576.91,-1130.64 588,-1110 625.32,-1040.54 570.43,-814.86 624,-757 697.02,-678.12 775.36,-777.61 862,-714 917.58,-673.19 944.11,-590.96 954.08,-551.34"/>
<polygon fill="#48ff00" stroke="#48ff00" points="957.54,-551.9 956.46,-541.36 950.73,-550.28 957.54,-551.9"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge109" class="edge">
<title>proc~input_summary&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#48ff00" d="M537.62,-1181.18C553.98,-1191.53 575.66,-1207.89 588,-1228 627.02,-1291.61 569.73,-1340.78 624,-1392 701.9,-1465.52 761.74,-1392.28 862,-1430 889.29,-1440.27 917.12,-1458.77 935.93,-1472.71"/>
<polygon fill="#48ff00" stroke="#48ff00" points="933.82,-1475.51 943.91,-1478.76 938.05,-1469.93 933.82,-1475.51"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge106" class="edge">
<title>proc~input_summary&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#48ff00" d="M562.76,-1180.13C581.66,-1184.09 603.75,-1188.05 624,-1190 729.29,-1200.14 757.09,-1203.5 862,-1190 988.97,-1173.66 1133.78,-1128.28 1204.51,-1104.3"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1205.65,-1107.61 1213.98,-1101.06 1203.39,-1100.98 1205.65,-1107.61"/>
</g>
<!-- proc~input_summary&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge107" class="edge">
<title>proc~input_summary&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#48ff00" d="M562.74,-1176.77C571.47,-1179.29 580.26,-1182.62 588,-1187 607.69,-1198.15 603.95,-1212.51 624,-1223 719.24,-1272.83 769.36,-1211.48 862,-1266 883.78,-1278.81 877.13,-1295.76 898,-1310 945.84,-1342.63 981.69,-1308.42 1022,-1350 1042.68,-1371.33 1090.57,-1570.27 1106.35,-1637.74"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1103,-1638.79 1108.68,-1647.74 1109.82,-1637.2 1103,-1638.79"/>
</g>
<!-- proc~wavenumberekin -->
<g id="program~~scattering~~CallsGraph_node64" class="node">
<title>proc~wavenumberekin</title>
<g id="a_program~~scattering~~CallsGraph_node64"><a xlink:href=".././proc/wavenumberekin.html" xlink:title="WAVENUMBEREKIN">
<polygon fill="#d94e8f" stroke="#d94e8f" points="799,-945 687,-945 687,-921 799,-921 799,-945"/>
<text text-anchor="middle" x="743" y="-930.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">WAVENUMBEREKIN</text>
</a>
</g>
</g>
<!-- proc~input_summary&#45;&gt;proc~wavenumberekin -->
<g id="program~~scattering~~CallsGraph_edge110" class="edge">
<title>proc~input_summary&#45;&gt;proc~wavenumberekin</title>
<path fill="none" stroke="#48ff00" d="M532.42,-1156.87C547.48,-1145.45 570.09,-1127.52 588,-1110 605.58,-1092.81 607.91,-1086.59 624,-1068 659.48,-1027.01 701.3,-979.31 724.41,-953.01"/>
<polygon fill="#48ff00" stroke="#48ff00" points="727.25,-955.07 731.22,-945.25 721.99,-950.45 727.25,-955.07"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge112" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~fill_symmetric_matrix</title>
<path fill="none" stroke="#00ff00" d="M556.65,-672.97C567.17,-669.15 578.27,-664.47 588,-659 605.91,-648.93 605.3,-638.51 624,-630 638.06,-623.6 653.89,-619.15 669.28,-616.05"/>
<polygon fill="#00ff00" stroke="#00ff00" points="670.1,-619.46 679.3,-614.2 668.84,-612.57 670.1,-619.46"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix -->
<g id="program~~scattering~~CallsGraph_edge111" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;interface~invert_symmetric_matrix</title>
<path fill="none" stroke="#00ff00" d="M588.13,-674.15C611.07,-670.7 636.62,-666.85 660.2,-663.31"/>
<polygon fill="#00ff00" stroke="#00ff00" points="660.8,-666.76 670.17,-661.81 659.76,-659.83 660.8,-666.76"/>
</g>
<!-- proc~calculate_log_der_matrix&#45;&gt;dgemm -->
<g id="program~~scattering~~CallsGraph_edge113" class="edge">
<title>proc~calculate_log_der_matrix&#45;&gt;dgemm</title>
<path fill="none" stroke="#00ff00" d="M588.13,-687.55C627.36,-688.94 674.18,-690.6 705.79,-691.72"/>
<polygon fill="#00ff00" stroke="#00ff00" points="705.78,-695.22 715.89,-692.08 706.02,-688.22 705.78,-695.22"/>
</g>
<!-- proc~write_error&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge114" class="edge">
<title>proc~write_error&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff48" d="M995.28,-1009.66C1037.09,-1010.29 1109.32,-1014.78 1167,-1036 1188.69,-1043.98 1210.45,-1058.68 1225.95,-1070.58"/>
<polygon fill="#00ff48" stroke="#00ff48" points="1223.86,-1073.39 1233.88,-1076.84 1228.2,-1067.9 1223.86,-1073.39"/>
</g>
<!-- proc~write_warning&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge115" class="edge">
<title>proc~write_warning&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#00ff91" d="M1118.45,-1406.86C1138.42,-1357.85 1213.32,-1174.08 1239.17,-1110.67"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1242.48,-1111.83 1243.01,-1101.25 1235.99,-1109.19 1242.48,-1111.83"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge117" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0048ff" d="M789.66,-1561.97C811.9,-1557.79 838.79,-1551.59 862,-1543 886.49,-1533.94 912.47,-1519.73 931.37,-1508.46"/>
<polygon fill="#0048ff" stroke="#0048ff" points="933.31,-1511.38 940.05,-1503.2 929.68,-1505.39 933.31,-1511.38"/>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge118" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#0048ff" d="M789.67,-1567.85C847.21,-1564.63 947.56,-1553 1022,-1512 1054.26,-1494.23 1081.99,-1460.95 1097.71,-1439.39"/>
<polygon fill="#0048ff" stroke="#0048ff" points="1100.57,-1441.4 1103.5,-1431.22 1094.86,-1437.35 1100.57,-1441.4"/>
</g>
<!-- proc~rctj -->
<g id="program~~scattering~~CallsGraph_node63" class="node">
<title>proc~rctj</title>
<g id="a_program~~scattering~~CallsGraph_node63"><a xlink:href=".././proc/rctj.html" xlink:title="rctj">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-1973 933,-1973 933,-1949 987,-1949 987,-1973"/>
<text text-anchor="middle" x="960" y="-1958.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rctj</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_j&#45;&gt;proc~rctj -->
<g id="program~~scattering~~CallsGraph_edge116" class="edge">
<title>proc~riccati_bessel_j&#45;&gt;proc~rctj</title>
<path fill="none" stroke="#0048ff" d="M789.72,-1565.73C814.17,-1566.51 843.05,-1571.88 862,-1590 914.69,-1640.36 879.87,-1679.4 898,-1750 915.86,-1819.54 940.45,-1900.94 952.2,-1939.12"/>
<polygon fill="#0048ff" stroke="#0048ff" points="948.87,-1940.18 955.16,-1948.7 955.56,-1938.12 948.87,-1940.18"/>
</g>
<!-- proc~input_check&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge120" class="edge">
<title>proc~input_check&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#0000ff" d="M781.17,-1097.75C807.98,-1106.07 842.72,-1121.38 862,-1148 926.3,-1236.78 860.48,-1289 898,-1392 908.73,-1421.44 928.87,-1451.58 943.07,-1470.74"/>
<polygon fill="#0000ff" stroke="#0000ff" points="940.29,-1472.87 949.12,-1478.73 945.88,-1468.65 940.29,-1472.87"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_message -->
<g id="program~~scattering~~CallsGraph_edge121" class="edge">
<title>proc~input_check&#45;&gt;proc~write_message</title>
<path fill="none" stroke="#0000ff" d="M781.06,-1089C868.64,-1089 1088.81,-1089 1192.44,-1089"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1192.69,-1092.5 1202.69,-1089 1192.69,-1085.5 1192.69,-1092.5"/>
</g>
<!-- proc~input_check&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge122" class="edge">
<title>proc~input_check&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0000ff" d="M777.12,-1076.83C814.64,-1063.05 875.85,-1040.55 916.77,-1025.52"/>
<polygon fill="#0000ff" stroke="#0000ff" points="918.01,-1028.79 926.19,-1022.05 915.6,-1022.22 918.01,-1028.79"/>
</g>
<!-- proc~input_check&#45;&gt;interface~incorrect_value -->
<g id="program~~scattering~~CallsGraph_edge119" class="edge">
<title>proc~input_check&#45;&gt;interface~incorrect_value</title>
<path fill="none" stroke="#0000ff" d="M762.46,-1076.95C791.34,-1058.12 848.96,-1020.6 898,-989 908.87,-982 920.85,-974.32 931.3,-967.65"/>
<polygon fill="#0000ff" stroke="#0000ff" points="933.47,-970.42 940.02,-962.09 929.71,-964.52 933.47,-970.42"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge124" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#4800ff" d="M791.18,-1375.35C813.65,-1378.89 840.29,-1385.33 862,-1397 896.1,-1415.33 926.56,-1449.11 943.89,-1470.79"/>
<polygon fill="#4800ff" stroke="#4800ff" points="941.17,-1472.99 950.08,-1478.72 946.68,-1468.68 941.17,-1472.99"/>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge125" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#4800ff" d="M791.04,-1372.65C814.54,-1371.16 842.13,-1365.63 862,-1350 893.28,-1325.39 864.68,-1289.76 898,-1268 944.14,-1237.86 974.12,-1240.72 1022,-1268 1070.95,-1295.89 1095.88,-1362.25 1105.95,-1396.97"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1102.58,-1397.93 1108.61,-1406.65 1109.33,-1396.08 1102.58,-1397.93"/>
</g>
<!-- proc~rcty -->
<g id="program~~scattering~~CallsGraph_node62" class="node">
<title>proc~rcty</title>
<g id="a_program~~scattering~~CallsGraph_node62"><a xlink:href=".././proc/rcty.html" xlink:title="rcty">
<polygon fill="#d9534f" stroke="#d9534f" points="987,-1383 933,-1383 933,-1359 987,-1359 987,-1383"/>
<text text-anchor="middle" x="960" y="-1368.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rcty</text>
</a>
</g>
</g>
<!-- proc~riccati_bessel_y&#45;&gt;proc~rcty -->
<g id="program~~scattering~~CallsGraph_edge123" class="edge">
<title>proc~riccati_bessel_y&#45;&gt;proc~rcty</title>
<path fill="none" stroke="#4800ff" d="M791.18,-1371C830.78,-1371 886.53,-1371 922.72,-1371"/>
<polygon fill="#4800ff" stroke="#4800ff" points="922.82,-1374.5 932.82,-1371 922.82,-1367.5 922.82,-1374.5"/>
</g>
<!-- proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_node66" class="node">
<title>proc~p_coeff</title>
<g id="a_program~~scattering~~CallsGraph_node66"><a xlink:href=".././proc/p_coeff.html" xlink:title="p_coeff">
<polygon fill="#d94e8f" stroke="#d94e8f" points="770,-133 716,-133 716,-109 770,-109 770,-133"/>
<text text-anchor="middle" x="743" y="-118.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_coeff</text>
</a>
</g>
</g>
<!-- proc~transform_summation&#45;&gt;proc~p_coeff -->
<g id="program~~scattering~~CallsGraph_edge126" class="edge">
<title>proc~transform_summation&#45;&gt;proc~p_coeff</title>
<path fill="none" stroke="#ff0091" d="M580.16,-121C620.78,-121 671.84,-121 705.62,-121"/>
<polygon fill="#ff0091" stroke="#ff0091" points="705.95,-124.5 715.95,-121 705.95,-117.5 705.95,-124.5"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~integer_to_character -->
<g id="program~~scattering~~CallsGraph_edge127" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~integer_to_character</title>
<path fill="none" stroke="#ff0000" d="M765.7,-1181.16C792.32,-1197.18 836.98,-1227.86 862,-1266 893.94,-1314.7 874.5,-1338.71 898,-1392 910.66,-1420.7 930.42,-1451.04 944,-1470.45"/>
<polygon fill="#ff0000" stroke="#ff0000" points="941.29,-1472.67 949.94,-1478.8 947,-1468.62 941.29,-1472.67"/>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge128" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#ff0000" d="M791.55,-1166.32C814.36,-1163.18 841.19,-1156.6 862,-1143 904.77,-1115.05 935.11,-1061.27 949.52,-1031.37"/>
<polygon fill="#ff0000" stroke="#ff0000" points="952.74,-1032.76 953.8,-1022.22 946.4,-1029.8 952.74,-1032.76"/>
</g>
<!-- proc~ispline -->
<g id="program~~scattering~~CallsGraph_node67" class="node">
<title>proc~ispline</title>
<g id="a_program~~scattering~~CallsGraph_node67"><a xlink:href=".././proc/ispline.html" xlink:title="ispline">
<polygon fill="#d94e8f" stroke="#d94e8f" points="987,-1301 933,-1301 933,-1277 987,-1277 987,-1301"/>
<text text-anchor="middle" x="960" y="-1286.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ispline</text>
</a>
</g>
</g>
<!-- proc~radtermvalue&#45;&gt;proc~ispline -->
<g id="program~~scattering~~CallsGraph_edge129" class="edge">
<title>proc~radtermvalue&#45;&gt;proc~ispline</title>
<path fill="none" stroke="#ff0000" d="M766.72,-1181.09C790.55,-1193.83 829.05,-1214.56 862,-1233 884.75,-1245.73 910.27,-1260.49 929.43,-1271.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="927.88,-1274.8 938.28,-1276.82 931.41,-1268.76 927.88,-1274.8"/>
</g>
<!-- proc~msta2 -->
<g id="program~~scattering~~CallsGraph_node68" class="node">
<title>proc~msta2</title>
<g id="a_program~~scattering~~CallsGraph_node68"><a xlink:href=".././proc/msta2.html" xlink:title="msta2">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1139.5,-1973 1085.5,-1973 1085.5,-1949 1139.5,-1949 1139.5,-1973"/>
<text text-anchor="middle" x="1112.5" y="-1958.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta2</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge131" class="edge">
<title>proc~ikv&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#ffda00" d="M987.22,-1995.68C1011.63,-1988.87 1048.26,-1978.65 1075.43,-1971.07"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1076.64,-1974.36 1085.33,-1968.3 1074.76,-1967.62 1076.64,-1974.36"/>
</g>
<!-- proc~msta1 -->
<g id="program~~scattering~~CallsGraph_node69" class="node">
<title>proc~msta1</title>
<g id="a_program~~scattering~~CallsGraph_node69"><a xlink:href=".././proc/msta1.html" xlink:title="msta1">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1139.5,-2015 1085.5,-2015 1085.5,-1991 1139.5,-1991 1139.5,-2015"/>
<text text-anchor="middle" x="1112.5" y="-2000.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">msta1</text>
</a>
</g>
</g>
<!-- proc~ikv&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge130" class="edge">
<title>proc~ikv&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#ffda00" d="M987.22,-2003C1011.53,-2003 1047.93,-2003 1075.07,-2003"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1075.33,-2006.5 1085.33,-2003 1075.33,-1999.5 1075.33,-2006.5"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta2 -->
<g id="program~~scattering~~CallsGraph_edge133" class="edge">
<title>proc~rctj&#45;&gt;proc~msta2</title>
<path fill="none" stroke="#00ff91" d="M987.22,-1961C1011.53,-1961 1047.93,-1961 1075.07,-1961"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1075.33,-1964.5 1085.33,-1961 1075.33,-1957.5 1075.33,-1964.5"/>
</g>
<!-- proc~rctj&#45;&gt;proc~msta1 -->
<g id="program~~scattering~~CallsGraph_edge132" class="edge">
<title>proc~rctj&#45;&gt;proc~msta1</title>
<path fill="none" stroke="#00ff91" d="M987.22,-1968.32C1011.63,-1975.13 1048.26,-1985.35 1075.43,-1992.93"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1074.76,-1996.38 1085.33,-1995.7 1076.64,-1989.64 1074.76,-1996.38"/>
</g>
<!-- proc~wavenumberekin&#45;&gt;proc~etotal -->
<g id="program~~scattering~~CallsGraph_edge134" class="edge">
<title>proc~wavenumberekin&#45;&gt;proc~etotal</title>
<path fill="none" stroke="#0091ff" d="M787.54,-920.98C812.67,-911.92 842.96,-897.04 862,-874 943.91,-774.87 956.79,-610.93 958.71,-551.44"/>
<polygon fill="#0091ff" stroke="#0091ff" points="962.21,-551.37 958.96,-541.29 955.21,-551.2 962.21,-551.37"/>
</g>
<!-- proc~wavenumberekin&#45;&gt;proc~write_error -->
<g id="program~~scattering~~CallsGraph_edge135" class="edge">
<title>proc~wavenumberekin&#45;&gt;proc~write_error</title>
<path fill="none" stroke="#0091ff" d="M799.21,-941.99C819.31,-946.09 842,-951.69 862,-959 886.26,-967.87 912.08,-981.68 930.97,-992.69"/>
<polygon fill="#0091ff" stroke="#0091ff" points="929.26,-995.75 939.65,-997.84 932.83,-989.73 929.26,-995.75"/>
</g>
<!-- proc~p_coeff&#45;&gt;fwig3jj -->
<g id="program~~scattering~~CallsGraph_edge136" class="edge">
<title>proc~p_coeff&#45;&gt;fwig3jj</title>
<path fill="none" stroke="#ff00da" d="M770.36,-123.45C808.59,-127.01 879.53,-133.61 922.68,-137.62"/>
<polygon fill="#ff00da" stroke="#ff00da" points="922.48,-141.12 932.76,-138.56 923.12,-134.15 922.48,-141.12"/>
</g>
<!-- proc~ispline&#45;&gt;proc~float_to_character -->
<g id="program~~scattering~~CallsGraph_edge137" class="edge">
<title>proc~ispline&#45;&gt;proc~float_to_character</title>
<path fill="none" stroke="#ff0000" d="M987.03,-1294.45C999.25,-1298.27 1013.06,-1304.62 1022,-1315 1027.46,-1321.34 1087.62,-1563.39 1106.12,-1638.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1102.74,-1639.11 1108.54,-1647.98 1109.53,-1637.43 1102.74,-1639.11"/>
</g>
<!-- proc~ispline&#45;&gt;proc~write_warning -->
<g id="program~~scattering~~CallsGraph_edge138" class="edge">
<title>proc~ispline&#45;&gt;proc~write_warning</title>
<path fill="none" stroke="#ff0000" d="M987.01,-1297.09C998.38,-1301.35 1011.5,-1307.32 1022,-1315 1054.08,-1338.47 1082.36,-1375.52 1098.17,-1398.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1095.29,-1400.48 1103.78,-1406.82 1101.1,-1396.57 1095.29,-1400.48"/>
</g>
<!-- proc~envj -->
<g id="program~~scattering~~CallsGraph_node70" class="node">
<title>proc~envj</title>
<g id="a_program~~scattering~~CallsGraph_node70"><a xlink:href=".././proc/envj.html" xlink:title="envj">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1276,-1994 1222,-1994 1222,-1970 1276,-1970 1276,-1994"/>
<text text-anchor="middle" x="1249" y="-1979.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">envj</text>
</a>
</g>
</g>
<!-- proc~msta2&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge139" class="edge">
<title>proc~msta2&#45;&gt;proc~envj</title>
<path fill="none" stroke="#00ff00" d="M1139.75,-1965.1C1160.3,-1968.31 1189.12,-1972.81 1211.85,-1976.36"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1211.39,-1979.83 1221.81,-1977.91 1212.47,-1972.91 1211.39,-1979.83"/>
</g>
<!-- proc~msta1&#45;&gt;proc~envj -->
<g id="program~~scattering~~CallsGraph_edge140" class="edge">
<title>proc~msta1&#45;&gt;proc~envj</title>
<path fill="none" stroke="#0000ff" d="M1139.75,-1998.9C1160.3,-1995.69 1189.12,-1991.19 1211.85,-1987.64"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1212.47,-1991.09 1221.81,-1986.09 1211.39,-1984.17 1212.47,-1991.09"/>
</g>
</g>
</svg>
</div><script>var panprogramscatteringCallsGraph = svgPanZoom('#programscatteringCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
         <h3>Contents</h3>
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#vars-1">Variables</a>
        </h3>
      </div>
      <div id="vars-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../program/scattering.html#variable-bf_log_der_matrix">BF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-sf_log_der_matrix">SF_log_der_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_l_values~5">channels_l_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_level_indices~13">channels_level_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-channels_omega_values~11">channels_omega_values</a>
            <a class="list-group-item" href="../program/scattering.html#variable-err_message~3">err_message</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iblock">iblock</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icheck">icheck</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount~2">icount</a>
            <a class="list-group-item" href="../program/scattering.html#variable-icount2~2">icount2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ij~10">ij</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ilevel~7">ilevel</a>
            <a class="list-group-item" href="../program/scattering.html#variable-io_status~3">io_status</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iomega~2">iomega</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen~4">iopen</a>
            <a class="list-group-item" href="../program/scattering.html#variable-iopen2~4">iopen2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_~5">isize_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-isize_2">isize_2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jinddiag~2">jinddiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff1~2">jindoff1</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jindoff2~2">jindoff2</a>
            <a class="list-group-item" href="../program/scattering.html#variable-jtot_~8">jtot_</a>
            <a class="list-group-item" href="../program/scattering.html#variable-k_matrix~3">k_matrix</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_even~2">len_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-len_odd~2">len_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmat_len">lmat_len</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmax~3">lmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-lmin~3">lmin</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ltmp~3">ltmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsdiag~3">maxXSdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-maxxsoff~3">maxXSoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacdiag~2">ncacdiag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-ncacoff~2">ncacoff</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_coupling_coefficients~4">nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_legendre_indices~4">nonzero_legendre_indices</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nonzero_terms_per_element~4">nonzero_terms_per_element</a>
            <a class="list-group-item" href="../program/scattering.html#variable-nsteps~2">nsteps</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_channels~15">number_of_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_coefficients~6">number_of_nonzero_coupling_coefficients</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_nonzero_coupling_matrix_elements~6">number_of_nonzero_coupling_matrix_elements</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_basis_levels~4">number_of_open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-number_of_open_channels~5">number_of_open_channels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-omegamax~3">omegamax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_levels~4">open_basis_levels</a>
            <a class="list-group-item" href="../program/scattering.html#variable-open_basis_wavevectors~3">open_basis_wavevectors</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_index">parity_index</a>
            <a class="list-group-item" href="../program/scattering.html#variable-parity_indextmp">parity_indextmp</a>
            <a class="list-group-item" href="../program/scattering.html#variable-partial_line">partial_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_imag~3">s_matrix_imag</a>
            <a class="list-group-item" href="../program/scattering.html#variable-s_matrix_real~3">s_matrix_real</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_even">size_even</a>
            <a class="list-group-item" href="../program/scattering.html#variable-size_odd">size_odd</a>
            <a class="list-group-item" href="../program/scattering.html#variable-smatcheckarr">smatcheckarr</a>
            <a class="list-group-item" href="../program/scattering.html#variable-terminate~2">terminate</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling">time_coupling</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_start">time_coupling_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_coupling_stop">time_coupling_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init">time_init</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_init_stop">time_init_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot">time_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_start">time_jtot_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_jtot_stop">time_jtot_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity">time_parity</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_start">time_parity_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_parity_stop">time_parity_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total">time_total</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_start">time_total_start</a>
            <a class="list-group-item" href="../program/scattering.html#variable-time_total_stop">time_total_stop</a>
            <a class="list-group-item" href="../program/scattering.html#variable-unitarity_block_check">unitarity_block_check</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavmax~2">wavmax</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wavvdepth">wavvdepth</a>
            <a class="list-group-item" href="../program/scattering.html#variable-wv">wv</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_block">xs_block</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_jtot">xs_jtot</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_line">xs_line</a>
            <a class="list-group-item" href="../program/scattering.html#variable-xs_total">xs_total</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../program/scattering.html#src">SCATTERING</a>
      </div>
    </div>


     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
        <th>Attributes</th>
        <th></th>
        <th>Name</th>
<th></th><th>Initial</th>        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-bf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>BF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sf_log_der_matrix"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>SF_log_der_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_l_values~5"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_l_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_level_indices~13"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_level_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-channels_omega_values~11"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>channels_omega_values</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err_message~3"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>err_message</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iblock"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iblock</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icheck"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icheck</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-icount2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>icount2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ij~10"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ij</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ilevel~7"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ilevel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-io_status~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>io_status</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iomega~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iomega</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iopen2~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iopen2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isize_2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>isize_2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jinddiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jinddiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff1~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jindoff2~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jindoff2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-jtot_~8"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>jtot_</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-k_matrix~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>k_matrix</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_even~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-len_odd~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>len_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmat_len"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmat_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lmin~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>lmin</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ltmp~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ltmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsdiag~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxxsoff~3"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxXSoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacdiag~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacdiag</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ncacoff~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ncacoff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_coupling_coefficients~4"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_coupling_coefficients</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_legendre_indices~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_legendre_indices</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nonzero_terms_per_element~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>nonzero_terms_per_element</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nsteps~2"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nsteps</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_channels~15"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_coefficients~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_coefficients</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_nonzero_coupling_matrix_elements~6"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_nonzero_coupling_matrix_elements</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_basis_levels~4"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_basis_levels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-number_of_open_channels~5"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>number_of_open_channels</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omegamax~3"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>omegamax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_levels~4"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_levels</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-open_basis_wavevectors~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>open_basis_wavevectors</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_index"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_index</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-parity_indextmp"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>parity_indextmp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-partial_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>partial_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_imag~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_imag</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s_matrix_real~3"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>s_matrix_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_even"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_even</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-size_odd"></span>
              integer(kind=int32)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>size_odd</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-smatcheckarr"></span>
              integer,
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>smatcheckarr</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-terminate~2"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>terminate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_coupling_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_coupling_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_init_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_init_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_jtot_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_jtot_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_parity_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_parity_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_start"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_start</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-time_total_stop"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>time_total_stop</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unitarity_block_check"></span>
              logical
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>unitarity_block_check</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavmax~2"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavmax</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wavvdepth"></span>
              real(kind=dp)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wavvdepth</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-wv"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>wv</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_block"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_block</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_jtot"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_jtot</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_line"></span>
              character(len=200)
            </td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>xs_line</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-xs_total"></span>
              real(kind=dp),
            </td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>xs_total</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    
    
    

    


    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">SCATTERING</span><span class="w"></span>
<span class="w">   </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real32</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">io_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">POTENTIAL</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">channels_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PES_COUPLING_MATRIX</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">PROPAGATORS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">boundary_conditions_mod</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">statetostateXS</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">utility_functions_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">write_header</span><span class="p">,</span><span class="w"> </span><span class="n">file_io_status</span><span class="p">,</span><span class="w"> </span><span class="n">write_message</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">float_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">,</span><span class="w"> </span><span class="n">time_count_summary</span><span class="w"></span>
<span class="w">   </span><span class="k">use </span><span class="n">array_operations_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">append</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">xs_line</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">size_odd</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">parity_indextmp</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">omegamax</span><span class="p">,</span><span class="w"> </span><span class="n">lmin</span><span class="p">,</span><span class="w"> </span><span class="n">lmax</span><span class="p">,</span><span class="w"> </span><span class="n">ltmp</span><span class="p">,</span><span class="w"> </span><span class="n">lmat_len</span><span class="p">,</span><span class="w"> </span><span class="n">len_even</span><span class="p">,</span><span class="w"> </span><span class="n">len_odd</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">ij</span><span class="p">,</span><span class="w"> </span><span class="n">ilevel</span><span class="p">,</span><span class="w"> </span><span class="n">iomega</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">,</span><span class="w"> </span><span class="n">iopen2</span><span class="p">,</span><span class="w"> </span><span class="n">isize_</span><span class="p">,</span><span class="w"> </span><span class="n">isize_2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">icheck</span><span class="p">,</span><span class="w"> </span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">icount2</span><span class="p">,</span><span class="w"> </span><span class="n">io_status</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wavmax</span><span class="p">,</span><span class="w"> </span><span class="n">wavvdepth</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_start</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity_start</span><span class="p">,</span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_coupling</span><span class="w"></span>
<span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">unitarity_block_check</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="w"></span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">channels_l_values</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(:),</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">(:),&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_legendre_indices</span><span class="p">(:),</span><span class="w"> </span><span class="n">smatcheckarr</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wv</span><span class="p">(:),</span><span class="w"> </span><span class="n">open_basis_wavevectors</span><span class="p">(:),</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">nonzero_coupling_coefficients</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_total</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_block</span><span class="p">(:),</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">(:)</span><span class="w"></span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">(:,:),</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">k_matrix</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_real</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">s_matrix_imag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initizalization: start the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialize fwigxjpf library</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print the header</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the input file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">read_input_file</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! S-matrix file: write input parameters and basis levels</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">open</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">smatrixfile</span><span class="p">),</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">,</span><span class="w"> </span><span class="n">reducedmass</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">v1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">j1array</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">elevel</span><span class="p">(</span><span class="n">ilevel</span><span class="p">),</span><span class="w"> </span><span class="n">ilevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nlevel</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">initial</span><span class="p">,</span><span class="w"> </span><span class="n">energy</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare the file with the partial XS</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">partialfile</span><span class="p">),</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">iomsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err_message</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">file_io_status</span><span class="p">(</span><span class="n">io_status</span><span class="p">,</span><span class="w"> </span><span class="n">err_message</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;  jtot  iblock  v1_f  j1_f  &lt;-  v1_i  j1_i&#39;&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Convert units: starting now, everything is in atomic units</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">units_conversion</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Read the radial terms of the potential from external file</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_read</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Reduce matrix elements that are not needed</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_reduction</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Interpolate radial terms                                            </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">potential_interpolation</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Search for energetically accessible levels and prepare the arrays that are</span>
<span class="w">   </span><span class="c">! needed in the calculations of the state-to-state XS                       </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">number_of_open_basis_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count_open_basis_levels</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">save_open_basis_levels</span><span class="p">(</span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">open_basis_wavevectors</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array summed over all blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_total</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single JTOT value</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_jtot</span><span class="p">,</span><span class="w">                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! xs array a single parity block</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">xs_block</span><span class="p">,</span><span class="w">                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">number_of_open_basis_levels</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Initialization is finished                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_init_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_init_stop</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">time_init</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Initialization completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Prepare J-blocks</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! If JTOTMAX=-1 is called, iterate until convergence is achieved:</span>
<span class="w">   </span><span class="c">! this is managed by ncacdiag and ncacoff</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="n">ncacdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">ncacoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">iblock</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Loop over total angular momentum</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** Loop over JTOT: ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">do </span><span class="n">jtot_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtotmin</span><span class="p">,</span><span class="n">jtotmax</span><span class="p">,</span><span class="n">jtotstep</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">write_header</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">opt_integer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">xs_jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">set_number_of_channels</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">size_even</span><span class="p">,</span><span class="w"> </span><span class="n">size_odd</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">parity_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">select case</span><span class="p">(</span><span class="n">parity_index</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_even</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size_odd</span><span class="w"></span>
<span class="w">         </span><span class="k">end select</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Summary of the current block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">iblock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iblock</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Block number: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;jtot: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; parity: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">parity_index</span><span class="p">)</span><span class="w"> </span><span class="p">)))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Number of scattering channels: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare of the basis for each J/p block:</span>
<span class="w">         </span><span class="c">! channels_omega_values holds all values of omega (BF_)</span>
<span class="w">         </span><span class="c">! channels_l_values holds all values of l (SF_)</span>
<span class="w">         </span><span class="c">! channels_level_indices holds the indices which refer to the basis arrays:</span>
<span class="w">         </span><span class="c">!   --   v1level/j1level/elevel</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_omega_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare channels_omega_values, channels_level_indices and channels_l_values</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_level_indices_channels_omega_values</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">set_channels_l_values</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the BF quantum numbers on screen</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_bf_channels</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of open (energetically accessible) channels</span>
<span class="w">         </span><span class="c">! and the largest wavevector in the block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">set_number_of_open_channels_wavmax</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">wavmax</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If there are no open channels, skip this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;No open channels for block no.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">iblock</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="k">cycle</span>
<span class="k">         endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Determine the number of steps on the intermolecular (R) grid</span>
<span class="w">         </span><span class="c">! This is done either directly (if dr &gt; 0)</span>
<span class="w">         </span><span class="c">! or through the number of steps per half de Broglie wavelength</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="n">wavvdepth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="n">vdepth</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">PI</span><span class="o">*</span><span class="p">((</span><span class="n">wavmax</span><span class="o">+</span><span class="n">wavvdepth</span><span class="p">)</span><span class="o">*</span><span class="n">steps</span><span class="p">))</span><span class="w"></span>
<span class="w">         </span><span class="k">else</span>
<span class="k">            </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">((</span><span class="n">Rmax</span><span class="o">-</span><span class="n">Rmin</span><span class="p">)</span><span class="o">/</span><span class="n">dr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the coupling matrix</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_start</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">check_nonzero_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_terms_per_element</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">prepare_coupling_matrix_elements</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">print_coupling_matrix_elements_summary</span><span class="p">(</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_coupling_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Calculations of the coupling &quot;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;matrix took &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_coupling_stop</span><span class="o">-</span><span class="n">time_coupling_start</span><span class="p">,</span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; seconds&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Prepare the log-derivative matrix (Eqs. 6.29 and 6.43)</span>
<span class="w">         </span><span class="c">! and the K-matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">k_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Call the propagator:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">numerov</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_matrix_elements</span><span class="p">,</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_terms_per_element</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">nonzero_legendre_indices</span><span class="p">,</span><span class="w"> </span><span class="n">nonzero_coupling_coefficients</span><span class="p">,</span><span class="w"> </span><span class="n">nsteps</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">BF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Coupled equations were solved from &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmin</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. to &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">Rmax</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u. in &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">nsteps</span><span class="p">)))</span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; steps (dr = &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">((</span><span class="n">rmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rmin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="s2">&quot;(E14.8)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; a.u.)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Transform the log-derivative matrix to the SF frame</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">bf_to_sf_transformation</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_omega_values</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">BF_log_der_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the K-matrix from log-derivative matrix (Eq. 6.53)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_k_matrix</span><span class="p">(</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w"> </span><span class="n">SF_log_der_matrix</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="w"> </span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">k_matrix</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Get the S-matrix from the K-matrix (Eq. 6.57)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_2d</span><span class="p">(</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">calculate_s_matrix</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">k_matrix</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Array of wavevectors (necessary for the XS calculations)</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">allocate_1d</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">            </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dsqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">reducedmass</span><span class="o">*</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">)))))</span><span class="o">/</span><span class="n">bohrtoangstrom</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! S-matrix is written to the binary S-matrix file</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">parity_index</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">channels_level_indices</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">channels_l_values</span><span class="p">(</span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">wv</span><span class="p">(</span><span class="n">iopen</span><span class="p">),</span><span class="w"> </span><span class="n">iopen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_real</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">s_matrix_imag</span><span class="p">(</span><span class="n">iopen</span><span class="p">,</span><span class="n">iopen2</span><span class="p">),</span><span class="w"> </span><span class="n">iopen2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iopen</span><span class="p">),&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="n">iopen</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_channels</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check if the S-matrices are unitary</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">unitarity_check</span><span class="p">(</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">unitarity_block_check</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! If the unitary is not fulfilled, keep the information about this block</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">unitarity_block_check</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">            call </span><span class="n">append</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">,</span><span class="w"> </span><span class="n">jtot_</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">endif</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Calculate all available cross-sections</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">CROSSSECTION</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="n">number_of_open_channels</span><span class="p">,</span><span class="n">number_of_channels</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="n">open_basis_levels</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">open_basis_wavevectors</span><span class="p">,</span><span class="n">s_matrix_real</span><span class="p">,</span><span class="n">s_matrix_imag</span><span class="p">,</span><span class="n">channels_level_indices</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">channels_l_values</span><span class="p">,</span><span class="n">xs_block</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Print the results from this parity block to the partial XS file</span>
<span class="w">         </span><span class="c">! and add the calculated partial XS to the xs_jtot array</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parity_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;(I6,2X,I6,2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">jtot_</span><span class="p">,</span><span class="n">iblock</span><span class="p">,</span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                     </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">partial_line</span><span class="p">,</span><span class="w"> </span><span class="n">unit_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">               </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="o">+</span><span class="w"> </span><span class="n">xs_block</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! Check the time after each parity block:</span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_parity_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_parity_start</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">time_parity_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_parity</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parity block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="c">! ... end of the loop over parity                                      </span>
<span class="w">         </span><span class="c">!---------------------------------------------------------------------!</span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Add the cross-sections from this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">               </span><span class="o">+</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Determine the largest partial elastic/inelastic XS in this Jtot block:</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="n">jinddiag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">jindoff2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="n">maxXSoff</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSdiag</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSdiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jinddiag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            else</span>
<span class="k">               if</span><span class="w"> </span><span class="p">((</span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="n">maxXSoff</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">maxXSoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_jtot</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount</span><span class="w"></span>
<span class="w">                  </span><span class="n">jindoff2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icount2</span><span class="w"></span>
<span class="w">               </span><span class="k">endif</span>
<span class="k">            endif</span>
<span class="k">         enddo</span>
<span class="k">      enddo</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="n">print_largest_partial_xs</span><span class="p">(</span><span class="n">jtot_</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">jinddiag</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">jindoff1</span><span class="p">,</span><span class="w"> </span><span class="n">jindoff2</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="p">,</span><span class="w"> </span><span class="n">open_basis_levels</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!-----------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jtotmax</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">999999</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">check_dtol_otol</span><span class="p">(</span><span class="n">maxXSdiag</span><span class="p">,</span><span class="w"> </span><span class="n">maxXSoff</span><span class="p">,</span><span class="w"> </span><span class="n">ncacdiag</span><span class="p">,</span><span class="w"> </span><span class="n">ncacoff</span><span class="p">,</span><span class="w"> </span><span class="n">terminate</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Check the time after each JTOT block:                                  </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_jtot_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! Print all the XS after current JTOT block                              </span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Cross sections for J: &quot;</span><span class="o">//</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">integer_to_character</span><span class="p">(</span><span class="n">jtot_</span><span class="p">)))</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; and energy: &quot;</span><span class="w"> </span><span class="o">//</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">float_to_character</span><span class="p">(</span><span class="n">ETOTAL</span><span class="p">()</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(F10.4)&quot;</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot; cm-1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">               </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                  </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">               </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">         enddo</span>
<span class="k">      endif</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prntlvl</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_jtot_start</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="n">time_jtot_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_jtot</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;JTOT block completed in &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="c">! terminate the loop if dtol/otol condition is satisfied</span>
<span class="w">      </span><span class="c">!------------------------------------------------------------------------!</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">terminate</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">   enddo</span>

<span class="k">   call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;Loop over JTOT finished&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;SUMMARY&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! if for some JTOTs the S-matrix did not fulfill the unitary check,</span>
<span class="w">   </span><span class="c">! these are listed here</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;*** WARNING ***&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Check unitarity of the S-matrix in the following &quot;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;JTOT blocks:&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icheck</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">smatcheckarr</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;JTOT:&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">integer_to_character</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">smatcheckarr</span><span class="p">(</span><span class="n">icheck</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">      call </span><span class="n">write_message</span><span class="p">(</span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">   </span><span class="k">endif</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Print all the calculated XS                                                </span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;Final state-to-state XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="s2">&quot;  v1_f  j1_f  &lt;-  v1_i  j1_i&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;K.E.&quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">repeat</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;XS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">do </span><span class="n">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">icount2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_open_basis_levels</span><span class="w"></span>
<span class="w">         </span><span class="k">write</span><span class="p">(</span><span class="n">xs_line</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(2X,I4,2X,I4,6X,I4,2X,I4,2X,E16.8,2X,E16.8)&quot;</span><span class="p">)</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount2</span><span class="p">)),</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">v1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">j1array</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)),</span><span class="w">                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="n">etotal</span><span class="p">()</span><span class="o">-</span><span class="n">elevel</span><span class="p">(</span><span class="n">open_basis_levels</span><span class="p">(</span><span class="n">icount</span><span class="p">)))</span><span class="o">*</span><span class="n">hartreetocm</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">            </span><span class="n">xs_total</span><span class="p">((</span><span class="n">icount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">number_of_open_basis_levels</span><span class="o">+</span><span class="n">icount2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">call </span><span class="n">write_message</span><span class="p">(</span><span class="n">xs_line</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_temp_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">fwig_table_free</span><span class="p">();</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="c">! Stop the time count</span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="w">   </span><span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">time_total_stop</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">call </span><span class="n">time_count_summary</span><span class="p">(</span><span class="n">time_total_start</span><span class="p">,</span><span class="w"> </span><span class="n">time_total_stop</span><span class="p">,</span><span class="w"> </span><span class="n">time_total</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;Total CPU time: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="k">close</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="c">!---------------------------------------------------------------------------!</span>
<span class="k">end program </span><span class="n">SCATTERING</span><span class="w"></span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>the SCATTERING code was developed by Hubert Jóźwiak<br>&copy; 2023 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-12-28 16:21            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>